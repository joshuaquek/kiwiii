{"version":3,"file":"dashboardApp.js","sources":["../../src/common/client.js","../../src/common/misc.js","../../src/common/legacySchema.js","../../src/common/idb.js","../../src/common/fetcher.js","../../src/common/mapper.js","../../src/common/collection.js","../../src/common/file.js","../../src/common/specs.js","../../src/component/badge.js","../../src/component/button.js","../../src/component/modal.js","../../src/component/tree.js","../../src/component/formBox.js","../../src/component/shape.js","../../src/component/formListBox.js","../../src/dialog/search.js","../../src/component/dropdown.js","../../src/dialog/formGroup.js","../../src/dialog/struct.js","../../src/dialog/filter.js","../../src/dialog/sdf.js","../../src/dialog/rename.js","../../src/datagrid/component.js","../../src/datagrid/rowFactory.js","../../src/common/image.js","../../src/datagrid/state.js","../../src/datagrid/rowFilter.js","../../src/datagrid/sort.js","../../src/datagrid/table.js","../../src/dashboardApp.js"],"sourcesContent":["\n/** @module common/client */\n\nimport _ from 'lodash';\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\nfunction compatibility() {\n  try {\n    () => {};\n  } catch (err) {\n    return 'Client compatibility error: Arrow function not supported';\n  }\n  try {\n    FormData;\n  } catch (err) {\n    return 'Client compatibility error: FormData not supported';\n  }\n  try {\n    fetch;\n  } catch (err) {\n    return 'Client compatibility error: fetch API not supported';\n  }\n}\n\n\nfunction registerServiceWorker() {\n  if ('serviceWorker' in navigator) {\n    if (!isDebugBuild) {  // Grobal isDebugBuild (see rollup.js)\n      window.addEventListener('load', () => {\n        navigator.serviceWorker.register('../sw.js');  // TODO: root path option\n      });\n    } else {\n      console.info('Service worker is disabled for debugging');\n    }\n  } else {\n    console.info('Service worker is not supported');\n  }\n}\n\n\nfunction registerCtrlCommand(key, callback) {\n  document.addEventListener('keydown', event => {\n    if (event.ctrlKey && event.key === key) {\n      callback();\n    }\n  });\n}\n\n\nexport default {\n  URLQuery, compatibility, registerServiceWorker, registerCtrlCommand\n};\n","\n/** @module common/misc */\n\nimport d3 from 'd3';\n\n\n// TODO: re-define\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  if (['text_field', 'checkbox', 'html'].includes(fmt)) return 'html';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  sortType, formatNum, partialMatch, uuidv4\n};\n","\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: [\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ],\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  data.fields.forEach(e => {\n    if (e.key === 'structure') {\n      e.format = 'svg';\n    }\n    delete e.width;\n    delete e.height;\n  });\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nfunction convertPackage(json) {\n  let specs = {};\n  if (!json.hasOwnProperty('views')) {\n    const now = new Date();\n    const isNW = json.hasOwnProperty('edges');\n    const data = isNW ? convertNetwork(json) : convertTable(json);\n    const nodes = isNW ? data.nodes : data;\n    specs = {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n      name: data.edges.name,\n      views: [],\n      dataset: []\n    };\n    specs.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: nodes.id,\n      name: nodes.name,\n      contents: [{\n        $schema: nodes.$schema,\n        workflowID: nodes.reference.workflow,\n        name: nodes.name,\n        fields: nodes.fields,\n        records: nodes.records,\n        created: nodes.created,\n        status: nodes.status,\n        query: nodes.query,\n        execTime: nodes.execTime,\n        progress: nodes.progress\n      }]\n    });\n    specs.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n      viewID: nodes.id,\n      name: nodes.name,\n      viewType: \"datagrid\",\n      rows: nodes.id,\n      fields: nodes.fields,\n      sortOrder: null,\n      filterText: null,\n      checkpoints: [{\n        type: 'convert',\n        date: now.toString(),\n        description: 'converted from legacy format'\n      }]\n    });\n    if (isNW) {\n      specs.dataset.push({\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: data.edges.id,\n        name: data.edges.name,\n        contents: [{\n          $schema: data.edges.$schema,\n          workflowID: data.edges.reference.workflow,\n          name: data.edges.name,\n          fields: data.edges.fields,\n          records: data.edges.records,\n          created: data.edges.created,\n          status: data.edges.status,\n          query: data.edges.query,\n          execTime: data.edges.execTime,\n          progress: data.edges.progress\n        }]\n      });\n      specs.views.push({\n        $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n        viewID: data.edges.id,\n        name: data.edges.name,\n        viewType: \"network\",\n        nodes: nodes.id,\n        edges: data.edges.id,\n        nodeColor: data.edges.snapshot.nodeColor,\n        nodeSize: data.edges.snapshot.nodeSize,\n        nodeLabel: data.edges.snapshot.nodeLabel,\n        nodeLabelColor: data.edges.snapshot.nodeLabelColor,\n        edgeWidth: data.edges.snapshot.edgeWidth,\n        edgeLabel: data.edges.snapshot.edgeLabel,\n        networkThreshold: data.edges.snapshot.networkThreshold,\n        networkThresholdCutoff: data.edges.snapshot.networkThresholdCutoff,\n        fieldTransform: data.edges.snapshot.fieldTransform,\n        coords: data.edges.snapshot.coords,\n        checkpoints: [{\n          type: 'convert',\n          date: now.toString(),\n          description: 'converted from legacy format'\n        }]\n      });\n    }\n    specs.views.filter(e => e.viewType === 'network')\n      .forEach(view => {\n        view.minConnThld = view.networkThresholdCutoff;\n        view.currentConnThld = view.networkThreshold;\n        if (view.hasOwnProperty('nodeLabel')) {\n          view.nodeLabel.field = view.nodeLabel.text;\n        }\n        if (view.hasOwnProperty('edgeLabel')) {\n          view.edgeLabel.field = 'weight';\n        }\n        if (view.hasOwnProperty('edgeWidth')) {\n          view.edgeWidth.field = 'weight';\n        }\n      });\n  } else {\n    specs = json;\n  }\n  specs.views.filter(e => e.viewType === 'network')\n    .forEach(view => {\n      if (!view.nodeColor.field) { view.nodeColor.field = 'index' ;}\n      if (!view.nodeSize.field) { view.nodeSize.field = 'index' ;}\n      if (!view.nodeLabel.field) { view.nodeLabel.field = 'index' ;}\n      if (!view.nodeLabelColor.field) { view.nodeLabelColor.field = 'index' ;}\n      if (!view.edgeColor) {\n        view.edgeColor = {\n          field: 'weight', color: 'monogray',\n          scale: 'linear', domain: [0, 1],\n          range: ['#999999', '#999999'], unknown: '#cccccc'\n        };\n      } else if (!view.edgeColor.field) { view.edgeColor.field = 'weight' ;}\n      if (!view.edgeWidth.field) { view.edgeWidth.field = 'weight' ;}\n      if (!view.edgeLabel.field) { view.edgeLabel.field = 'weight' ;}\n      if (!view.edgeLabelColor) {\n        view.edgeLabelColor = {\n          field: 'weight', color: 'monoblack',\n          scale: 'linear', domain: [1, 1],\n          range: ['#333333', '#333333'], unknown: '#cccccc'\n        };\n      } else if (!view.edgeLabelColor.field) { view.edgeLabelColor.field = 'weight' ;}\n    });\n  return specs;\n}\n\n\nexport default {\n  convertPackage\n};\n","\n/** @module common/idb */\n\nimport _ from 'lodash';\nimport Dexie from 'Dexie';\n\nimport {default as misc} from './misc.js';\nimport {default as legacy} from './legacySchema.js';\n\n// TODO: need package, view and dataset tables?\nconst schema = {\n  items: 'storeID, sessionStarted'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\n/**\n * Delete all data store\n * Try this before dealing with local db issues\n */\nfunction reset() {\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\n\n/**\n * Returns all data store items\n * @return {array} data store objects\n */\nfunction getAllItems() {\n  return idb.items\n    .orderBy('sessionStarted')\n    .reverse()\n    .toArray();\n}\n\n\n/**\n * Get data store items by store ID\n * @param {string} storeID - store ID\n * @return {array} data store object\n */\nfunction getItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .first()\n    .catch(err => {\n      console.error(`IDBError: Unexpected table ID: ${storeID}`, err);\n    });\n}\n\n\n/**\n * Update data object in the store\n * @param {string} storeID - store ID\n * @param {function} updateFunc - update function\n * @return {integer} - number of updated items\n */\nfunction updateItem(storeID, updateFunc) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .modify(updateFunc)\n    .catch(err => {\n      console.error('IDBError: Update failed', err);\n    });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .delete();\n}\n\n\n/**\n * Returns a view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @return {array} view objects\n */\nfunction getView(storeID, viewID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).views)\n    .then(views => {\n      const view = views.find(e => e.viewID === viewID);\n      if (!view) return;\n      view.storeID = storeID;\n      return view;\n    });\n}\n\n\n/**\n * Append a view next to a specific view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object\n */\nfunction appendView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos + 1, 0, viewObj);\n  });\n}\n\n\n/**\n * Update view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object or update function\n */\nfunction updateView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    if (_.isFunction(viewObj)) {\n      viewObj(item.views[pos]);\n    } else {\n      item.views[pos] = viewObj;\n    }\n  });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteView(storeID, viewID) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos, 1);\n    // prune orphaned collections\n    const bin = {};\n    item.dataset.forEach(e => { bin[e.collectionID] = 0; });\n    item.views.forEach(view => {\n      ['rows', 'items', 'nodes', 'edges']\n        .filter(e => view.hasOwnProperty(e))\n        .forEach(e => { bin[view[e]] += 1; });\n    });\n    Object.entries(bin).forEach(entry => {\n      if (!entry[1]) {\n        const i = item.dataset.findIndex(e => e.collectionID === entry[0]);\n        item.dataset.splice(i, 1);\n      }\n    });\n  });\n}\n\n\n/**\n * Returns all collections in the store\n * @return {array} Collection objects\n */\nfunction getAllCollections() {\n  return getAllItems()\n    .then(items => _.flatten(\n      items.map(item => {\n        return item.dataset.map(coll => {\n          coll.storeID = item.storeID;\n          return coll;\n        });\n      })\n    ));\n}\n\n\n/**\n * Returns a collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @return {array} Collection objects\n */\nfunction getCollection(storeID, collID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).dataset)\n    .then(colls => {\n      const coll = colls.find(e => e.collectionID === collID);\n      if (!coll) return;\n      coll.storeID = storeID;\n      return coll;\n    });\n}\n\n\n/**\n * Update collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @param {object} collObj - Collection object or update function\n */\nfunction updateCollection(storeID, collID, collObj) {\n  return updateItem(storeID, item => {\n    const pos = item.dataset.findIndex(e => e.collectionID === collID);\n    if (_.isFunction(collObj)) {\n      collObj(item.dataset[pos]);\n    } else {\n      item.dataset[pos] = collObj;\n    }\n  });\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - storeID if sucessfully added\n */\nfunction importItem(data) {\n  // Legacy format converter\n  data = legacy.convertPackage(data);\n\n  const now = new Date();\n  data.storeID = misc.uuidv4().slice(0, 8);\n  data.sessionStarted = now.toString();\n  return idb.items.put(data);\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} response - response data\n * @return {string} - viewID if sucessfully added\n */\nfunction newDatagrid(response) {\n  const now = new Date();\n  const date = now.toLocaleString('en-GB', { timeZone: 'Asia/Tokyo'});\n  const storeID = misc.uuidv4().slice(0, 8);\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  const data = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    storeID: storeID,\n    name: response.name,\n    views: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n        viewID: viewID,\n        name: response.name,\n        viewType: \"datagrid\",\n        rows: collectionID,\n        checkpoints: [\n          {type: 'creation', date: date}\n        ]\n      }\n    ],\n    dataset: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: collectionID,\n        name: response.name,\n        contents: [response]\n      }\n    ],\n    sessionStarted: date\n  };\n  return idb.items.put(data)\n    .then(() => ({storeID: storeID, viewID:viewID}));\n}\n\n\n/**\n * Store new network view\n * @param {string} storeID - Store ID\n * @param {string} nodesID - ID of nodes collection\n * @param {string} nodesName - Name of nodes collection\n * @param {object} response - Response object\n */\nfunction newNetwork(storeID, nodesID, nodesName, response) {\n  const viewID = misc.uuidv4().slice(0, 8);\n  const edgesID = response.workflowID.slice(0, 8);\n  return updateItem(storeID, item => {\n    item.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n      viewID: viewID,\n      name: `${nodesName}_${response.name}`,\n      viewType: 'network',\n      nodes: nodesID,\n      edges: edgesID,\n      minConnThld: response.query.params.threshold\n    });\n    item.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: edgesID,\n      name: response.name,\n      contents: [response]\n    });\n  }).then(() => viewID);\n}\n\n\nexport default {\n  reset, getAllItems, getItem, updateItem, deleteItem,\n  getView, appendView, updateView, deleteView,\n  getAllCollections, getCollection, updateCollection,\n  importItem, newDatagrid, newNetwork\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '../req/';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\nfunction serverStatus() {\n  const response = {};\n  return get('server')\n    .then(json)\n    .then(res => {\n      response.server = res;\n    })\n    .then(() => get('schema'))\n    .then(json)\n    .then(res => {\n      response.schema = res;\n    })\n    .then(() => response);\n}\n\n\nexport default {\n  get, json, text, blob, post, error, serverStatus\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: [keyField].concat(mp.fields),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: table.fields.filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key)),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: fields,\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(mp.fields)\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module common/collection */\n\nimport _ from 'lodash';\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as mapper} from './mapper.js';\n\n\nexport default class Collection {\n  /**\n   * Create Collection from a flashflood response datatable\n   * If data is not specified, put datatables later by this.append(data)\n   * @param {object} coll - Collection or response object\n   */\n  constructor(coll) {\n    // Settings\n    this.autoIndex = 'index';  // enumerate records\n\n    this.collectionID = coll.collectionID || null;\n    this.storeID = coll.storeID || null;\n    this.name = coll.name || null;\n    if (coll.records) {\n      this.contents = [coll];\n      this.fields = [];\n    } else {\n      this.contents = coll.contents;\n      this.fields = coll.fields || [];\n    }\n    this.contents.forEach(content => {\n      content.fields.forEach(e => this.addField(e));\n    });\n  }\n\n  /**\n   * Add fields\n   * @param {array} fs - list of fields\n   */\n  addField(field) {\n    if (this.fields.find(e => e.key === field.key)) return;\n    if (!field.hasOwnProperty('name')) field.name = field.key;\n    if (!field.hasOwnProperty('visible')) field.visible = true;\n    if (field.hasOwnProperty('d3_format')) field.format = 'd3_format';\n    if (!field.hasOwnProperty('format')) field.format = 'raw';\n    this.fields.push(field);\n  }\n\n  /**\n   * Update fields properties\n   * @param {array} fs - list of fields\n   */\n  updateFields(fs) {\n    this.fields = [];\n    fs.forEach(e => this.addField(e));\n  }\n\n  /**\n   * Join fields\n   * @param {object} mapping - column mapper object\n   */\n  joinFields(mapping) {\n    this.contents.forEach(c => {\n      mapper.apply(c, mapping);\n    });\n    if (mapping.hasOwnProperty('fields')) {\n      mapping.fields.forEach(e => this.addField(e));\n    } else {\n      this.addField(mapping.field);\n    }\n  }\n\n  /**\n   * Apply function to the original data records\n   * new fields should be manually added by Collection.addField\n   * @param {function} func - function to be applied\n   */\n  apply(func) {\n    this.contents.forEach(content => {\n      content.records.forEach(rcd => {\n        func(rcd);\n      });\n    });\n  }\n\n  /**\n   * Return all records of the collection\n   * @return {array} records\n   */\n  records() {\n    return _.flatten(this.contents.map(e => e.records));\n  }\n\n  fetch(command) {\n    const fs = this.contents\n      .filter(e => ['running', 'ready', 'interrupted', 'queued'].includes(e.status))\n      .map(content => {\n        const query = {id: content.workflowID, command: command};\n        return fetcher.get('progress', query)\n          .then(fetcher.json)\n          .then(data => {\n            return idb.updateCollection(this.storeID, this.collectionID, coll => {\n              const i = coll.contents\n                .findIndex(e => e.workflowID === query.id);\n              if (data.status === 'failure') {  // No data found on server\n                coll.contents[i].status = 'failure';\n              } else {\n                coll.contents[i] = data;\n              }\n            });\n          });\n      });\n    return Promise.all(fs)\n      .then(() => idb.getCollection(this.storeID, this.collectionID))\n      .then(coll => {\n        this.contents = coll.contents;\n      });\n  }\n\n  /**\n   * Retrieve workflows and store it into a local store.\n   * @return {Promise}\n   */\n  pull() {\n    return this.fetch('pull');\n  }\n\n  /**\n   * Retrieve workflows, abort all ongoing workflow task\n   * and store it into a local store.\n   * @return {Promise}\n   */\n  abort() {\n    return this.fetch('abort');\n  }\n\n  /**\n   * Return total number of records\n   * @return {float} total number of records\n   */\n  size() {\n    return _.sum(this.contents.map(e => e.records.length));\n  }\n\n  /**\n   * Return status\n   * @return {string} status\n   */\n  status() {\n    if (this.contents.some(e => e.status === 'interrupted')) return 'interrupted';\n    if (this.contents.some(e => e.status === 'running')) return 'running';\n    if (this.contents.some(e => e.status === 'queued')) return 'queued';\n    if (this.contents.some(e => e.status === 'ready')) return 'ready';\n    if (this.contents.some(e => e.status === 'aborted')) return 'aborted';\n    if (this.contents.some(e => e.status === 'failure')) return 'failure';\n    return 'done';\n  }\n\n  /**\n   * Return ongoing or not\n   * @return {bool} ongoing or not\n   */\n  ongoing() {\n    const s = ['ready', 'queued', 'running', 'interrupted'];\n    return s.includes(this.status());\n  }\n\n  /**\n   * Return percentage of workflow progress\n   * @return {float} progress in percent\n   */\n  progress() {\n    return _.min(this.contents.map(e => e.progress));\n  }\n\n  /**\n   * Return total execution time\n   * @return {float} total time\n   */\n  execTime() {\n    return _.sum(this.contents.map(e => e.execTime));\n  }\n\n  /**\n   * Export collection object as JSON\n   * @return {object} collection JSON\n   */\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: this.collectionID,\n      name: this.name,\n      fields: this.fields,\n      contents: this.contents\n    };\n  }\n}\n","\n/** @module common/file */\n\nimport pako from 'pako';\n\n\nfunction readFile(file, sizeLimit, blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    const truncated = sizeLimit ? file.slice(0, sizeLimit) : file;\n    reader.onload = event => resolve(event.target.result);\n    reader.onerror = error => reject(error);\n    if (blob) {\n      reader.readAsArrayBuffer(truncated);\n    } else {\n      reader.readAsText(truncated);\n    }\n  });\n}\n\n\nfunction parseJSON(data, compressed) {\n  const text = compressed ? pako.inflate(data, {to: 'string'}) : data;\n  return JSON.parse(text);\n}\n\n\nfunction loadJSON(file) {\n  const compressed = file.name.endsWith('c') || file.name.endsWith('.gz');\n  return readFile(file, false, compressed)\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction fetchJSON(url) {\n  const decoded = decodeURIComponent(url);\n  const compressed = decoded.endsWith('c') || decoded.endsWith('.gz');\n  return fetch(decoded)\n    .then(res => compressed ? res.arrayBuffer() : res.json())\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction downloadDataFile(data, name) {\n  try {\n    // cannot hundle large file with dataURI scheme\n    // url = 'data:application/json,' + encodeURIComponent(JSON.stringify(json))\n    const url = window.URL.createObjectURL(new Blob([data]));\n    const a = document.createElement('a');\n    a.download = name;\n    a.href = url;\n    // a.click() does not work on firefox\n    a.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': true,\n      'cancelable': false\n    }));\n    // window.URL.revokeObjectURL(url) does not work on firefox\n  } catch (e) {\n    // no DOM (unit testing)\n  }\n}\n\n\nfunction downloadJSON(json, name, compress=true) {\n  const str = JSON.stringify(json);\n  const data = compress ? pako.gzip(str) : str;\n  const ext = `.ap${compress ? 'c' : 'r'}`;\n  downloadDataFile(data, `${name}${ext}`);\n}\n\n\nexport default {\n  readFile, parseJSON, loadJSON, fetchJSON,\n  downloadDataFile, downloadJSON\n};\n","\n/** @module common/specs */\n\nimport _ from 'lodash';\n\n\n/**\n * Retern if the package has running tasks\n * @param {object} specs - package JSON\n * @return {bool} if there are any ongoing tasks\n */\nfunction isRunning(specs) {\n  return specs.dataset.some(coll => {\n    return coll.contents.some(e => {\n      return ['ready', 'queued', 'running', 'interrupted'].includes(e.status);\n    });\n  });\n}\n\n\nexport default {\n  isRunning\n};\n","\n/** @module component/badge */\n\nimport d3 from 'd3';\n\nconst assetBaseURL = '../assets/';\nconst iconBaseURL = '../assets/icon/';\n\n\nfunction badge(selection) {\n  selection.classed('badge', true);\n  selection.append('img')\n      .classed('icon', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('text', true);\n}\n\n\nfunction updateBadge(selection, text, type, icon) {\n  selection.classed(`badge-${type}`, true);\n  selection.select('.icon')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null);\n  selection.select('.text')\n      .text(text);\n}\n\n\nfunction notify(selection) {\n  selection\n    .style('opacity', 0)\n    .style('display', 'inline')\n    .transition()\n      .duration(500)\n      .ease(d3.easeLinear)\n      .style(\"opacity\", 1.0)\n    .transition()\n      .delay(3000)\n      .duration(1000)\n      .ease(d3.easeLinear)\n      .style(\"opacity\", 0)\n      .on('end', function () {\n        selection.style('display', 'none');\n      });\n}\n\n\nfunction loadingCircle(selection) {\n  selection\n      .style('display', 'none')\n    .append('img')\n      .attr('src', `${assetBaseURL}loading1.gif`)\n      .style('width', '2rem')\n      .style('height', '2rem');\n}\n\n\nfunction alert(selection) {\n  selection.classed('alert', true)\n      .classed('px-1', true)\n      .classed('py-0', true);\n  selection.append('img')\n      .classed('icon', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('text', true)\n      .style('font-size', '75%');\n}\n\n\nfunction updateAlert(selection, text, type, icon) {\n  selection.classed(`alert-${type}`, true);\n  selection.select('.icon')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null);\n  selection.select('.text')\n      .text(text);\n}\n\n\nfunction invalidFeedback(selection) {\n  selection.classed('invalid-feedback', true)\n      .style('display', 'none');\n  selection.append('img')\n      .classed('icon', true)\n      .attr('src', `${iconBaseURL}caution-salmon.svg`)\n      .style('width', '1rem')\n      .style('height', '1rem');\n  selection.append('span')\n      .classed('invalid-msg', true);\n}\n\nfunction updateInvalidMessage(selection, msg) {\n  selection.select('.invalid-msg')\n      .text(msg);\n}\n\n\nexport default {\n  badge, updateBadge, notify, loadingCircle,\n  alert, updateAlert, invalidFeedback, updateInvalidMessage\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\nconst iconBaseURL = '../assets/icon/';\n\n\nfunction buttonBox(selection, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .text(label);\n}\n\n\nfunction menuButton(selection, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, label, type, icon) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, target, label, type, icon) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('href', '#')\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('label', true)\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, label, type, icon) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  const button = selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  button.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  button.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, label, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, label, target, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', `${iconBaseURL}${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, label, accept, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#')\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      });\n  selection.append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n  selection.append('img')\n      .attr('src', `${iconBaseURL}${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  iconBaseURL, buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module component/modal */\n\nimport d3 from 'd3';\n\n\nfunction dialogBase(selection, id) {\n  selection\n      .classed('modal', true)\n      .attr('tabindex', -1)\n      .attr('role', 'dialog')\n      .attr('aria-labelledby', '')\n      .attr('aria-hidden', true)\n      .attr('id', id);\n  selection.append('div')\n      .classed('modal-dialog', true)\n      .attr('role', 'document')\n    .append('div')\n      .classed('modal-content', true);\n}\n\n\nfunction confirmDialog(selection, id) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // body\n  base.append('div')\n      .classed('modal-body', true)\n    .append('div')\n      .classed('message', true);\n  // footer\n  const footer = base.append('div')\n      .classed('modal-footer', true);\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-outline-secondary', true)\n      .classed('cancel', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Cancel');\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-warning', true)\n      .classed('ok', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('OK')\n      .on('click', () => {\n        selection.dispatch('submit');\n      });\n}\n\n\nfunction updateConfirmDialog(selection, message) {\n  selection.select('.message').text(message);\n}\n\n\nfunction submitDialog(selection, id, title) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // header\n  const header = base.append('div')\n      .classed('modal-header', true);\n  header.append('h4')\n      .classed('modal-title', true)\n      .text(title);\n  header.append('button')\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('aria-label', 'Close')\n      .classed('close', true)\n    .append('span')\n      .attr('aria-hidden', true)\n      .html('&times;');\n  // body\n  base.append('div')\n      .classed('modal-body', true);\n  // footer\n  base.append('div')\n      .classed('modal-footer', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-primary', true)\n      .classed('submit', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Submit')\n      .on('click', () => {\n        // Dismiss before submit\n        // Submit event can update the modal itself\n        // (ex. disable submit button before onSubmit call has completed)\n        $(`#${id}`).modal('hide');\n        selection.dispatch('submit');\n      });\n}\n\n\nexport default {\n  confirmDialog, updateConfirmDialog, submitDialog\n};\n","\n/** @module component/tree */\n\nimport d3 from 'd3';\n\n\nfunction nextLevel(selection, node, nodeFactory) {\n  node.children.forEach(child => {\n    const item = selection.append('li').datum(child.data);  // Bind data record\n    const content = item.append('span')\n      .style('display', 'inline-block');\n    const arrow = child.hasOwnProperty('children') ? '▼ ' : '';\n    content.append('span')\n        .classed('arrow', true)\n        .text(arrow);\n    content.call(nodeFactory, child.data);\n\n    // Collapse on click\n    content.select('.arrow')\n      .on('click', function () {\n        const childList = item.select('ul');\n        if (!childList.size()) return;\n        const expanded = childList.style('display') !== 'none';\n        content.select('.arrow').text(expanded ? '▶ ' : '▼ ');\n        childList.style('display', expanded ? 'none' : 'inherit');\n      });\n\n    // Search next level\n    if (!child.hasOwnProperty('children')) return;\n    item.append('ul')\n        .style('list-style-type', 'none')\n        .call(nextLevel, child, nodeFactory);\n  });\n}\n\n\n // Generate tree view\nfunction tree(selection) {\n  selection\n      .classed('viewport', true)\n      .style('overflow-y', 'scroll')\n      .style('height', '400px')\n    .append('div')\n      .classed('body', true);\n}\n\n\n// Generate tree view\nfunction setHeight(selection, height) {\n  selection.style('height', `${height}px`);\n}\n\n\n// Update tree data\nfunction treeItems(selection, items, keyFunc, nodeFactory) {\n  const root = d3.stratify()\n      .id(keyFunc)\n      .parentId(d => d.parent)(items);\n  selection.select('ul').remove();\n  if (!root.hasOwnProperty('children')) return;\n  selection.select('.body').append('ul')\n      .classed('root', true)\n      .style('padding-left', 0)\n      .style('list-style-type', 'none')\n      .call(nextLevel, root, nodeFactory);\n  selection.selectAll('ul.root > li')\n      .classed('my-2', true);\n}\n\n\n/**\n* Node content\n* @param {d3.selection} selection - selection of node content (span element)\n*/\nfunction checkboxNode(selection, item) {\n  selection.append('input')\n      .attr('type', 'checkbox');\n  selection.append('span')\n      .text(item.id);\n}\n\n\n/**\n * Return list of checkbox values\n * @param {d3.selection} selection - selection of node content (span element)\n */\nfunction checkboxValues(selection) {\n  return selection.select('.body')\n    .selectAll('input:checked').data().map(d => d.id);\n}\n\n\nexport default {\n  tree, treeItems, setHeight, checkboxNode, checkboxValues\n};\n","\n/** @module component/formBox */\n\nimport d3 from 'd3';\n\nimport {default as badge} from './badge.js';\n\n\nfunction updateFormValue(selection, value) {\n  selection.select('.form-control').property('value', value);\n  selection.call(setValidity, true);  // Clear validity state\n}\n\n\nfunction formValue(selection) {\n  return selection.select('.form-control').property('value');\n}\n\n\nfunction formValid(selection) {\n  return selection.select('.form-control').node().checkValidity();\n}\n\n\nfunction setValidity(selection, valid) {\n  selection.select('.invalid-feedback')\n      .style('display', valid ? 'none': 'inherit');\n  selection.select('.form-control')\n      .style('background-color', valid ? null : '#ffcccc');\n}\n\n\nfunction textBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .on('input', function () {\n        const valid = formValid(selection);\n        selection.call(setValidity, valid);\n      });\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\n\nfunction readonlyBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .attr('readonly', 'readonly');\n}\n\nfunction updateReadonlyValue(selection, value) {\n  selection.select('.form-control-plaintext').property('value', value);\n}\n\nfunction readonlyValue(selection) {\n  return selection.select('.form-control-plaintext').property('value');\n}\n\n\nfunction textareaBox(selection, label, rows, placeholder) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  const formLabel = selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  formLabel.append('div')\n      .call(badge.invalidFeedback);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows)\n      .attr('placeholder', placeholder)\n      .on('input', function () {\n        const valid = textareaValid(selection);\n        selection.call(setValidity, valid);\n      });\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n')\n    .map(e => e.replace(/^\\s+|\\s+$/g, ''))  // strip spaces\n    .filter(e => e.length > 0);\n  return [];\n}\n\nfunction textareaValid(selection) {\n  return /\\s*?\\w\\s*?/.test(formValue(selection));\n}\n\n\nfunction checkBox(selection, label) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox');\n  box.append('span')\n      .text(label);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'number')\n      .on('input', function () {\n        const valid = formValid(selection);\n        selection.call(setValidity, valid);\n      });\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\nfunction updateNumberRange(selection, min, max, step) {\n  selection.select('.form-control')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step)\n      .dispatch('input', {bubbles: true});\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n    .append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'color');\n}\n\n\nfunction fileInputBox(selection, label, accept) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('form-control-file', true)\n      .classed('col-8', true)\n      .attr('type', 'file')\n      .attr('accept', accept)\n      .on('change', function () {\n        const valid = fileInputValid(selection);\n        selection.call(setValidity, valid);\n      });\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\nfunction clearFileInput(selection) {\n  // TODO: FileList object (input.files) may be a readonly property\n  const label = selection.select('label').text();\n  const accept = selection.select('input').attr('accept');\n  selection.selectAll('*').remove();\n  selection.call(fileInputBox, label, accept);\n}\n\nfunction fileInputValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\nfunction fileInputValid(selection) {\n  // TODO: attribute 'require' does not work with input type=file\n  return selection.select('input').property('files').length > 0;\n}\n\n\nexport default {\n  updateFormValue, formValue, formValid, setValidity,\n  textBox, readonlyBox, updateReadonlyValue, readonlyValue,\n  textareaBox, textareaBoxLines, textareaValid,\n  numberBox, updateNumberRange,\n  checkBox, updateCheckBox, checkBoxValue,\n  colorBox,\n  fileInputBox, clearFileInput, fileInputValue, fileInputValid\n};\n","\n/** @module component/shape */\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction monocolorBar(selection, colors, text) {\n  selection.attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none');\n  const group = selection.append('g');\n  group.append('rect')\n      .attr('x', 0).attr('y', 0)\n      .attr('width', 100).attr('height', 10)\n      .attr('fill', colors[0]);\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 10)\n      .attr('font-size', 12)\n      .text(text);\n}\n\nfunction bicolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n      .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n      .attr('offset', 1).attr('stop-color', colors[1]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction tricolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n    .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n    .attr('offset', 0.5).attr('stop-color', colors[1]);\n  grad.append('stop')\n    .attr('offset', 1).attr('stop-color', colors[2]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction categoricalBar(selection, colors, text) {\n  selection.attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none');\n  const sw = 100 / colors.length;\n  const group = selection.append('g');\n  colors.forEach((e, i) => {\n    group.append('rect')\n        .attr('x', sw * i).attr('y', 0)\n        .attr('width', sw).attr('height', 20)\n        .attr('fill', colors[i]);\n  });\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 20)\n      .attr('font-size', 20)\n      .text(text);\n}\n\nfunction setSize(selection, width, height) {\n  selection.attr('width', width).attr('height', height);\n}\n\n\nconst colorBar = {\n  'monocolor': monocolorBar,\n  'bicolor': bicolorBar,\n  'tricolor': tricolorBar,\n  'categorical': categoricalBar,\n  'custom': monocolorBar\n};\n\n\nexport default {\n  colorBar, setSize\n};\n","\n/** @module component/formListBox */\n\nimport d3 from 'd3';\n\nimport {default as badge} from './badge.js';\nimport {default as box} from './formBox.js';\nimport {default as shape} from './shape.js';\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction selectBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('select')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .on('input', function () {\n        const valid = box.formValid(selection);\n        selection.call(box.setValidity, valid);\n      });\n}\n\nfunction updateSelectBoxOptions(selection, items) {\n  const options = selection.select('select')\n    .selectAll('option')\n      .data(items, d => d.key);\n  options.exit().remove();\n  options.enter()\n    .append('option')\n      .attr('value', d => d.key)\n      .text(d => d.name);\n}\n\nfunction selectedRecord(selection) {\n  const value = box.formValue(selection);\n  return selection.selectAll('select option').data()\n      .find(e => e.key === value);\n}\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction checklistBox(selection, label) {\n  // TODO: scroll\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  const formLabel = selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  formLabel.append('div')\n      .call(badge.invalidFeedback);\n  selection.append('ul')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n}\n\nfunction updateChecklistItems(selection, items) {\n  const listitems = selection.select('ul')\n    .selectAll('li')\n      .data(items, d => d.key);\n  listitems.exit().remove();\n  const form = listitems.enter()\n    .append('li')\n      .attr('class', 'form-check')\n    .append('label')\n      .attr('class', 'form-check-label');\n  form.append('input')\n      .attr('type', 'checkbox')\n      .attr('class', 'form-check-input')\n      .property('value', d => d.key);\n  form.append('span')\n      .text(d => d.name);\n}\n\nfunction checkRequired(selection) {\n  selection.selectAll('input')\n      .on('change', function () {\n        const valid = anyChecked(selection);\n        selection.call(setChecklistValidity, valid);\n      });\n}\n\nfunction updateChecklistValues(selection, values) {\n  selection.selectAll('input')\n    .each(function (d) {\n      d3.select(this).property('checked', values.includes(d.key));\n    });\n  selection.call(setChecklistValidity, true);  // Clear validity state\n}\n\nfunction checklistValues(selection) {\n  return selection.selectAll('input:checked').data().map(d => d.key);\n}\n\nfunction anyChecked(selection) {\n  return checklistValues(selection).length > 0;\n}\n\nfunction setChecklistValidity(selection, valid) {\n  selection.select('.invalid-feedback')\n      .style('display', valid ? 'none': 'inherit');\n  selection.select('.form-control')\n      .style('background-color', valid ? null : 'LightPink');\n}\n\n\nfunction colorScaleBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label || 'Colorscale');\n  const form = selection.append('div')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n  const dropdown = form.append('div')\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  dropdown.append('button')\n      .classed('btn', true)\n      .classed(`btn-light`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  dropdown.append('div')\n      .classed('dropdown-menu', true)\n      .classed('py-0', true);\n  form.append('span')\n      .classed('selected', true);\n}\n\nfunction colorScaleBoxItems(selection, items) {\n  const listitems = selection.select('.dropdown-menu')\n    .selectAll('a')\n      .data(items, d => d);\n  listitems.exit().remove();\n  listitems.enter()\n    .append('a')\n      .classed('dropdown-item', true)\n      .classed('py-0', true)\n      .attr('href', '#')\n      .attr('title', d => d.key)\n      .on('click', function (d) {\n        selection.call(setSelectedColorScale, d);\n        selection.dispatch('change', {bubbles: true});\n      })\n    .append('svg')\n      .each(function (d) {\n        d3.select(this)\n          .call(shape.colorBar[d.type], d.colors, d.text)\n          .call(shape.setSize, 100, 10);\n      });\n}\n\nfunction setSelectedColorScale(selection, item) {\n  const selected = selection.select('.selected');\n  selected.selectAll('svg').remove();\n  selected.datum(item);  // Bind selected item record\n  selected.append('svg')\n      .call(shape.colorBar[item.type], item.colors, item.text)\n      .call(shape.setSize, 100, 10);\n}\n\nfunction updateColorScaleBox(selection, key) {\n  const data = selection.select('.dropdown-menu')\n    .selectAll('a').data();\n  const item = data.find(e => e.key === key);\n  selection.call(setSelectedColorScale, item);\n}\n\nfunction colorScaleBoxValue(selection) {\n  return selection.select('.selected').datum().key;\n}\n\nfunction colorScaleBoxItem(selection) {\n  return selection.select('.selected').datum();\n}\n\n\nexport default {\n  selectBox, updateSelectBoxOptions, selectedRecord,\n  checklistBox, updateChecklistItems, checkRequired, updateChecklistValues,\n  checklistValues, anyChecked, setChecklistValidity,\n  colorScaleBox, colorScaleBoxItems, updateColorScaleBox,\n  colorScaleBoxValue, colorScaleBoxItem\n};\n","\n/** @module dialog/search */\n\nimport d3 from 'd3';\nimport _ from 'lodash';\n\nimport {default as fetcher} from '../common/fetcher.js';\n\nimport {default as badge} from '../component/badge.js';\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'search-dialog';\nconst title = 'Search by compound ID';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-searchtext');\n}\n\n\nfunction body(selection) {\n  const mbody = selection.call(modal.submitDialog, id, title)\n    .select('.modal-body');\n  mbody.append('div')\n      .classed('text-muted', true)\n      .classed('small', true)\n      .classed('text-right', true)\n      .text('Ctrl+F to fill the form with demo queries');\n  mbody.append('div')\n      .classed('field', true)\n      .call(lbox.selectBox, 'Field');\n  mbody.append('div')\n      .classed('query', true)\n      .call(box.textareaBox, 'Query', 12)\n      .call(badge.updateInvalidMessage, 'Please provide valid queries')\n      .on('input', function() {\n        const valid = box.textareaValid(d3.select(this));\n        selection.select('.submit').property('disabled', !valid);\n      });\n}\n\n\nfunction updateBody(selection, resources) {\n  const fields = _(resources.map(e => e.fields))\n    .flatten()\n    .uniqBy('key')\n    .value()\n    .filter(e => e.hasOwnProperty('d3_format')\n                 || ['compound_id', 'numeric', 'text'].includes(e.format));\n  const def = fields.find(e => e.format === 'compound_id') || fields[0];\n  selection.select('.field')\n      .call(lbox.updateSelectBoxOptions, fields)\n      .call(box.updateFormValue, def.key);\n  selection.select('.query')\n      .call(box.updateFormValue, '');\n  selection.select('.submit').property('disabled', true);\n}\n\n\nfunction execute(selection, resources) {\n  const query = {\n    workflow: 'search',\n    targets: resources.map(e => e.id),  // All DBs\n    key: box.formValue(selection.select('.field')),\n    values: box.textareaBoxLines(selection.select('.query'))\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json);\n}\n\n\nfunction fill(selection) {\n  selection.select('.field').call(box.updateFormValue, 'compound_id');\n  selection.select('.query')\n      .call(box.updateFormValue, \"DB00186\\nDB00189\\nDB00193\\nDB00203\\nDB00764\\nDB00863\\nDB00865\\nDB00868\\nDB01143\\nDB01240\\nDB01242\\nDB01361\\nDB01366\\nDB02638\\nDB02959\")\n      .dispatch('input');\n}\n\nexport default {\n  menuLink, body, updateBody, execute, fill\n};\n","\n/** @module component/dropdown */\n\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction dropdownFormGroup(selection, label) {\n  const id = misc.uuidv4().slice(0, 8);\n  selection.classed('mb-3', true)\n    .append('div')\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('justify-content-end', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-sm', true)\n      .classed('btn-outline-primary', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'collapse')\n      .attr('data-target', `#${id}-collapse`)\n      .attr('aria-expanded', 'false')\n      .attr('aria-controls', `${id}-collapse`)\n      .text(label);\n  selection.append('div')\n      .classed('collapse', true)\n      .attr('id', `${id}-collapse`)\n    .append('div')\n      .classed('card', true)\n      .classed('card-body', true);\n}\n\n\nexport default {\n  dropdownFormGroup\n};\n","\n/** @module dialog/formGroup */\n\nimport d3 from 'd3';\n\nimport {default as fetcher} from '../common/fetcher.js';\n\nimport {default as badge} from '../component/badge.js';\nimport {default as button} from '../component/button.js';\nimport {default as dropdown} from '../component/dropdown.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\n\n\n/**\n * Render color range control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction queryMolGroup(selection) {\n  // Query format\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('format', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Format')\n      .call(lbox.updateSelectBoxOptions,\n            [\n              {key: 'molfile', name: 'MDL Molfile'},\n              {key: 'dbid', name: 'Compound ID'}\n            ])\n      .on('change', function () {\n        const value = box.formValue(d3.select(this));\n        selection.select('.source .form-control')\n            .property('disabled', value !== 'dbid');\n        selection.select('.textquery')\n            .property('hidden', value !== 'dbid');\n        selection.select('.areaquery')\n            .property('hidden', value !== 'molfile');\n      });\n\n  // Query ID source\n  selection.append('div')\n      .classed('source', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Source');\n\n  // Database ID query input\n  const queryBox = selection.append('div')\n      .classed('textquery', true)\n      .classed('mb-1', true)\n      .call(box.textBox, 'Query');\n  queryBox.select('.form-control')\n      .attr('required', 'required');\n  queryBox.select('.invalid-feedback')\n      .call(badge.updateInvalidMessage, 'Please provide a valid query');\n\n  // CTAB format structure query input\n  const ctabBox = selection.append('div')\n      .classed('areaquery', true)\n      .classed('mb-1', true)\n      .attr('required', 'required')\n      .call(box.textareaBox, 'Query', 6, null);\n  ctabBox.select('.form-control')\n      .attr('required', 'required');\n  ctabBox.select('.invalid-feedback')\n      .call(badge.updateInvalidMessage,\n            'Please provide a valid CTAB format text (.sdf or .mol)');\n\n  // Preview popover\n  $(function () {\n    $('[data-toggle=\"popover\"]')\n      .popover({html: true, trigger: 'focus'});\n  });\n  selection.append('div')\n      .classed('form-row', true)\n      .classed('justify-content-end', true)\n    .append('button')\n      .classed('preview', true)\n      .attr('data-toggle', 'popover')\n      .attr('data-html', 'true')\n      .attr('data-content', '<div id=\"previmg\"></div>')\n      .call(button.menuButton, 'Structure preview', 'primary')\n      .on('click', function () {\n        const query = queryMolValues(selection);\n        return fetcher.get('strprev', query)\n          .then(fetcher.text)\n          .then(res => d3.select('#previmg').html(res), fetcher.error);\n      });\n}\n\nfunction updateQueryMolResources(selection, resources) {\n  const res = resources.map(d => ({key: d.id, name: d.name}));\n  selection.select('.source')\n      .call(lbox.updateSelectBoxOptions, res);\n}\n\nfunction updateQueryMolValues(selection, values) {\n  selection.select('.format')\n      .call(box.updateFormValue, values.format)\n      .dispatch('change');\n  selection.select('.source')\n      .call(box.updateFormValue, values.source);\n  selection.select('.textquery')\n      .call(box.updateFormValue,\n            values.format === 'dbid' ? values.value : null);\n  selection.select('.areaquery')\n      .call(box.updateFormValue,\n            values.format === 'molfile' ? values.value : null);\n}\n\nfunction queryMolValues(selection) {\n  const format = box.formValue(selection.select('.format'));\n  const source = box.formValue(selection.select('.source'));\n  const textquery = box.formValue(selection.select('.textquery'));\n  const areaquery = box.textareaBoxLines(selection.select('.areaquery'));\n  return {\n    format: format,\n    source: format === 'dbid' ? source : null,\n    value: format === 'molfile' ? areaquery : textquery\n  };\n}\n\nfunction queryMolValid(selection) {\n  const format = box.formValue(selection.select('.format'));\n  const textValid = box.formValid(selection.select('.textquery'));\n  const ctabValid = box.textareaValid(selection.select('.areaquery'));\n  return format === 'molfile' ? ctabValid : textValid;\n}\n\n\nfunction simOptionGroup(selection) {\n  const collapse = selection.append('div')\n      .call(dropdown.dropdownFormGroup, 'Optional parameters')\n    .select('.card-body');\n\n  // Ignore H flag\n  collapse.append('div')\n      .classed('ignoreh', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Ignore explicit hydrogens');\n\n  // Timeout\n  const timeoutBox = collapse.append('div')\n      .classed('timeout', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Timeout')\n      .call(box.updateNumberRange, 1, 999, 1);\n  timeoutBox.select('.form-control')\n      .attr('required', 'required');\n  timeoutBox.select('.invalid-feedback')\n      .call(badge.updateInvalidMessage,\n            'Please provide a valid number (1 to 999)');\n\n  // Diameter\n  const diamBox = collapse.append('div')\n      .classed('diam', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Diameter (MCS-DR/GLS)')\n      .call(box.updateNumberRange, 4, 999, 1);\n  diamBox.select('.form-control')\n      .attr('required', 'required');\n  diamBox.select('.invalid-feedback')\n      .call(badge.updateInvalidMessage,\n            'Please provide a valid number (4 to 999)');\n\n  // Custom layout\n  collapse.selectAll('label.col-form-label')\n      .classed('col-4', false)\n      .classed('col-6', true);\n  collapse.selectAll('input.form-control')\n      .classed('col-8', false)\n      .classed('col-6', true);\n}\n\n\nfunction updateSimOptionValues(selection, values) {\n  selection.select('.ignoreh')\n      .call(box.updateCheckBox, values.ignoreHs);\n  if (values.hasOwnProperty('timeout')) {\n    selection.select('.timeout')\n        .call(box.updateFormValue, values.timeout);\n  }\n  if (values.hasOwnProperty('diameter')) {\n    selection.select('.diam')\n        .call(box.updateFormValue, values.diameter);\n  }\n}\n\n\nfunction simOptionValues(selection) {\n  const timeout = selection.select('.timeout');\n  const diam = selection.select('.diam');\n  const query = {\n    ignoreHs: box.checkBoxValue(selection.select('.ignoreh'))\n  };\n  if (!timeout.select('.form-control').property('disabled')) {\n    query.timeout = box.formValue(timeout);\n  }\n  if (!diam.select('.form-control').property('disabled')) {\n    query.diameter = box.formValue(diam);\n  }\n  return query;\n}\n\nfunction simOptionValid(selection) {\n  const timeoutValid = box.formValid(selection.select('.timeout'));\n  const diamValid = box.formValid(selection.select('.diam'));\n  return timeoutValid && diamValid;\n}\n\n\nexport default {\n  queryMolGroup, updateQueryMolResources, updateQueryMolValues,\n  queryMolValues, queryMolValid,\n  simOptionGroup, updateSimOptionValues, simOptionValues, simOptionValid\n};\n","\n/** @module dialog/struct */\n\nimport d3 from 'd3';\n\nimport {default as fetcher} from '../common/fetcher.js';\n\nimport {default as badge} from '../component/badge.js';\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\nimport {default as group} from './formGroup.js';\n\n\nconst id = 'struct-dialog';\nconst title = 'Search by structure';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-searchchem');\n}\n\n\nfunction body(selection) {\n  const mbody = selection.call(modal.submitDialog, id, title)\n    .select('.modal-body');\n  mbody.append('div')\n      .classed('text-muted', true)\n      .classed('small', true)\n      .classed('text-right', true)\n      .text('Ctrl+F to fill the form with demo queries');\n\n  // Query molecule\n  mbody.append('div')\n      .classed('qmol', true)\n      .call(group.queryMolGroup)\n      .on('input', function() {\n        const valid = dialogFormValid(selection);\n        selection.select('.submit').property('disabled', !valid);\n      });\n\n  // Structure search method\n  mbody.append('div')\n      .classed('method', true)\n      .call(lbox.selectBox, 'Method')\n      .on('change', function () {\n        const value = box.formValue(d3.select(this));\n        const mcs = ['gls', 'rdfmcs'].includes(value);\n        const strMatch = ['exact', 'substr', 'supstr'].includes(value);\n        selection.select('.measure').call(box.updateFormValue, 'sim');\n        selection.select('.measure select').property('disabled', !mcs);\n        selection.select('.thld input').property('disabled', strMatch);\n        selection.select('.diam input').property('disabled', value !== 'gls');\n        selection.select('.timeout input').property('disabled', !mcs);\n      });\n\n  // Measure type\n  mbody.append('div')\n      .classed('measure', true)\n      .call(lbox.selectBox, 'Measure')\n      .call(lbox.updateSelectBoxOptions, [\n              {key: 'sim', name: 'Similarity'},\n              {key: 'edge', name: 'Edge count'}\n            ])\n      .on('change', function () {\n        const value = box.formValue(d3.select(this));\n        const rs = value === 'sim' ? [0.4, 1, 0.01] : [1, 999, 1];\n        selection.select('.thld')\n            .call(box.updateNumberRange, rs[0], rs[1], rs[2]);\n      });\n\n  // Threshold\n  const thldBox = mbody.append('div')\n      .classed('thld', true)\n      .call(box.numberBox, 'Threshold')\n      .on('input', function() {\n        const valid = dialogFormValid(selection);\n        selection.select('.submit').property('disabled', !valid);\n      });\n  thldBox.select('.form-control')\n      .attr('required', 'required');\n  thldBox.select('.invalid-feedback')\n      .call(badge.updateInvalidMessage,\n            'Please provide a valid number (0.40 to 1.00)');\n\n  // Similarity search options\n  mbody.append('div')\n      .classed('option', true)\n      .call(group.simOptionGroup)\n      .on('input', function() {\n        const valid = dialogFormValid(selection);\n        selection.select('.submit').property('disabled', !valid);\n      });\n\n  // Targets\n  mbody.append('div')\n      .classed('target', true)\n      .call(lbox.checklistBox, 'Target databases')\n      .on('input', function() {\n        const valid = dialogFormValid(selection);\n        selection.select('.submit').property('disabled', !valid);\n      });\n}\n\n\nfunction updateBody(selection, resources, rdk) {\n  selection.select('.qmol')\n      .call(group.updateQueryMolResources, resources)\n      .call(group.updateQueryMolValues,\n            {format: 'molfile', source: resources[0].key, value: ''});\n  // Search type\n  const methodList = [\n    {key: 'exact', name: 'Exact match'},\n    {key: 'substr', name: 'Substructure'},\n    {key: 'supstr', name: 'Superstructure'},\n    {key: 'gls', name: 'MCS-DR/GLS'}\n  ];\n  if (rdk) {\n    methodList.push({key: 'rdmorgan', name: 'RDKit Morgan similarity'});\n    methodList.push({key: 'rdfmcs', name: 'RDKit FMCS'});\n  }\n  selection.select('.method')\n      .call(lbox.updateSelectBoxOptions, methodList)\n      .call(box.updateFormValue, 'exact')\n      .dispatch('change');\n  selection.select('.measure')\n      .call(box.updateFormValue, 'sim');\n  selection.select('.thld')\n      .call(box.updateFormValue, 0.5);\n  selection.select('.option')\n      .call(group.updateSimOptionValues,\n            {ignoreHs: true, timeout: 2, diameter: 8});\n  const res = resources.map(d => ({key: d.id, name: d.name}));\n  selection.select('.target')\n      .call(lbox.updateChecklistItems, res)\n      .call(lbox.updateChecklistValues, []);\n  selection.select('.submit').property('disabled', true);\n}\n\n\nfunction dialogFormValid(selection) {\n  const qmolValid = group.queryMolValid(selection.select('.qmol'));\n  const thldValid = box.formValid(selection.select('.thld'));\n  const simOptionValid = group.simOptionValid(selection.select('.option'));\n  const targetChecked = lbox.anyChecked(selection.select('.target'));\n  return qmolValid && thldValid && simOptionValid && targetChecked;\n}\n\n\nfunction execute(selection) {\n  const params = group.simOptionValues(selection.select('.option'));\n  const measure = selection.select('.measure');\n  const thld = selection.select('.thld');\n  if (!measure.select('select').property('disabled')) {\n    params.measure = box.formValue(measure);\n  }\n  if (!thld.select('input').property('disabled')) {\n    params.threshold = box.formValue(thld);\n  }\n  const query = {\n    workflow: box.formValue(selection.select('.method')),\n    targets: lbox.checklistBoxValue(selection.select('.target')),\n    queryMol: group.queryMolGroupValue(selection.select('.qmol')),\n    params: params\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json);\n}\n\n\nfunction fill(selection) {\n  selection.select('.qmol')\n      .call(group.updateQueryMolValues,\n            {format: 'dbid', source: 'drugbankfda', value: 'DB00465'})\n      .dispatch('change');\n  selection.select('.method').call(box.updateFormValue, 'gls')\n      .dispatch('change');\n  selection.select('.measure').call(box.updateFormValue, 'sim');\n  selection.select('.thld').call(box.updateFormValue, 0.7);\n  selection.select('.option')\n    .call(group.updateSimOptionValues,\n          {ignoreHs: true, timeout: 2, diameter: 8});\n  selection.select('.target').call(lbox.updateChecklistValues, 'drugbankfda')\n      .dispatch('change');\n}\n\n\nexport default {\n  menuLink, body, updateBody, execute, fill\n};\n","\n/** @module dialog/filter */\n\nimport _ from 'lodash';\nimport d3 from 'd3';\n\nimport {default as fetcher} from '../common/fetcher.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as badge} from '../component/badge.js';\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'filter-dialog';\nconst title = 'Search by properties';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-searchprop');\n}\n\n\nfunction body(selection) {\n  const mbody = selection.call(modal.submitDialog, id, title)\n    .select('.modal-body');\n  mbody.append('div')\n      .classed('text-muted', true)\n      .classed('small', true)\n      .classed('text-right', true)\n      .text('Ctrl+F to fill the form with demo queries');\n\n  // Key\n  mbody.append('div')\n      .classed('key', true)\n      .call(lbox.selectBox, 'Field')\n      .on('change', function () {\n        const field = lbox.selectedRecord(d3.select(this));\n        const fmt = misc.sortType(field.format || 'd3_format');\n        selection.select('.textvalue')\n            .property('hidden', fmt !== 'text');\n        selection.select('.numvalue')\n            .property('hidden', fmt !== 'numeric');\n      });\n\n  // Operator\n  mbody.append('div')\n      .classed('operator', true)\n      .call(lbox.selectBox, 'Operator')\n      .call(lbox.updateSelectBoxOptions, [\n              {key: 'eq', name: '='},\n              {key: 'gt', name: '>'},\n              {key: 'lt', name: '<'},\n              {key: 'ge', name: '>='},\n              {key: 'le', name: '>='},\n              {key: 'lk', name: 'LIKE'}\n            ]);\n\n  // Text value\n  const textValueBox = mbody.append('div')\n      .classed('textvalue', true)\n      .call(box.textBox, 'Value')\n      .on('input', function() {\n        const valid = dialogFormValid(selection);\n        selection.select('.submit').property('disabled', !valid);\n      });\n  textValueBox.select('.form-control')\n      .attr('required', 'required');\n  textValueBox.select('.invalid-feedback')\n      .call(badge.updateInvalidMessage, 'Please provide a valid text');\n\n  // Numeric value\n  const numValueBox = mbody.append('div')\n      .classed('numvalue', true)\n      .call(box.numberBox, 'Value')\n      .on('input', function() {\n        const valid = dialogFormValid(selection);\n        selection.select('.submit').property('disabled', !valid);\n      });\n  numValueBox.select('.form-control')\n      .attr('required', 'required');\n  numValueBox.select('.invalid-feedback')\n      .call(badge.updateInvalidMessage, 'Please provide a valid number');\n\n  // Target databases\n  mbody.append('div')\n      .classed('target', true)\n      .call(lbox.checklistBox, 'Target databases')\n      .on('change', function() {\n        const valid = dialogFormValid(selection);\n        selection.select('.submit').property('disabled', !valid);\n      })\n    .select('.invalid-feedback')\n      .call(badge.updateInvalidMessage, 'Please choose at least one items');\n}\n\n\nfunction updateBody(selection, resources) {\n  const fields = _(resources.map(e => e.fields))\n    .flatten()\n    .uniqBy('key')\n    .value()\n    .filter(e => e.hasOwnProperty('d3_format')\n                 || ['compound_id', 'numeric', 'text'].includes(e.format));\n  selection.select('.key')\n      .call(lbox.updateSelectBoxOptions, fields)\n      .call(box.updateFormValue, fields[0].key)\n      .dispatch('change');\n  selection.select('.operator').call(box.updateFormValue, 'eq');\n  selection.select('.textvalue').call(box.updateFormValue, null);\n  selection.select('.numvalue').call(box.updateFormValue, null);\n  const res = resources.map(d => ({key: d.id, name: d.name}));\n  selection.select('.target')\n      .call(lbox.updateChecklistItems, res)\n      .call(lbox.checkRequired)\n      .call(lbox.updateChecklistValues, []);\n  selection.select('.submit').property('disabled', true);\n}\n\n\nfunction dialogFormValid(selection) {\n  const fmt = lbox.selectedRecord(selection.select('.key')).format;\n  const type = misc.sortType(fmt);\n  const textValid = box.formValid(selection.select('.textvalue'));\n  const numValid = box.formValid(selection.select('.numvalue'));\n  const targetChecked = lbox.anyChecked(selection.select('.target'));\n  return (type === 'text' ? textValid : numValid) && targetChecked;\n}\n\n\nfunction execute(selection) {\n  const query = {\n    workflow: 'filter',\n    targets: lbox.checklistBoxValue(selection.select('.target')),\n    key: box.formValue(selection.select('.key')),\n    value: box.formValue(selection.select('.value')),\n    operator: box.formValue(selection.select('.operator'))\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json);\n}\n\n\nfunction fill(selection) {\n  selection.select('.key').call(box.updateFormValue, '_mw');\n  selection.select('.operator').call(box.updateFormValue, 'gt');\n  selection.select('.value').call(box.formValue, '1500');\n  selection.select('.target').call(lbox.updateChecklistValues, ['drugbankfda'])\n      .dispatch('change');\n}\n\n\nexport default {\n  menuLink, body, updateBody, execute, fill\n};\n","\n/** @module dialog/sdf */\n\nimport d3 from 'd3';\n\nimport {default as fetcher} from '../common/fetcher.js';\nimport {default as hfile} from '../common/file.js';\n\nimport {default as badge} from '../component/badge.js';\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nfunction getSDFPropList(str) {\n  const re = />.*?<(\\S+)>/g;\n  const uniqCols = new Set();\n  let arr;\n  while ((arr = re.exec(str)) !== null) {\n    uniqCols.add(arr[1]);\n  }\n  return Array.from(uniqCols);\n}\n\n\nconst id = 'sdf-dialog';\nconst title = 'Import SDFile';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-importsdf');\n}\n\n\nfunction body(selection) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n\n  // File input\n  dialog.select('.modal-body').append('div')\n      .classed('file', true)\n      .call(box.fileInputBox, 'File', '.mol,.sdf')\n      .on('change', function () {\n        const valid = box.fileInputValid(d3.select(this));\n        selection.select('.submit').property('disabled', !valid);\n        if (!valid) return;\n        const file = box.fileInputValue(d3.select(this));\n        // Scan only first 100mb of the file due to memory limit.\n        return hfile.readFile(file, 100 * 1024 * 1024, false)\n          .then(data => {\n            const fields = getSDFPropList(data)\n              .map(e => ({key: e, name: e}));\n            selection.select('.field')\n              .call(lbox.updateChecklistItems, fields)\n              .call(lbox.updateChecklistValues, [])\n              .call(lbox.checkRequired);\n            selection.select('.submit').property('disabled', true);\n          });\n      });\n\n  // Select fields to import\n  dialog.select('.modal-body').append('div')\n      .classed('field', true)\n      .call(lbox.checklistBox, 'Fields')\n      .on('input', function () {\n        const fieldChecked = lbox.anyChecked(selection.select('.field'));\n        selection.select('.submit').property('disabled', !fieldChecked);\n      })\n    .select('.invalid-feedback')\n      .call(badge.updateInvalidMessage, 'Please select at least one item');\n\n  // Options\n  dialog.select('.modal-body').append('div')\n      .classed('implh', true)\n      .call(box.checkBox, 'Make hydrogens implicit');\n  dialog.select('.modal-body').append('div')\n      .classed('recalc', true)\n      .call(box.checkBox, 'Recalculate 2D coords');\n}\n\n\nfunction updateBody(selection) {\n  selection.select('.file')\n      .call(box.clearFileInput)\n    .select('.invalid-feedback')\n      .call(badge.updateInvalidMessage, 'Please choose a file');\n  selection.select('.field')\n      .call(lbox.updateChecklistItems, [])\n      .call(lbox.updateChecklistValues, []);\n  selection.select('.implh')\n      .call(box.updateCheckBox, true);\n  selection.select('.recalc')\n      .call(box.updateCheckBox, false);\n  selection.select('.submit').property('disabled', true);\n}\n\n\nfunction execute(selection) {\n  const params = {\n    fields: lbox.checklistValues(selection.select('.field')),\n    implh: box.checkBoxValue(selection.select('.implh')),\n    recalc: box.checkBoxValue(selection.select('.recalc'))\n  };\n  const formData = new FormData();\n  formData.append('contents', box.fileInputValue(selection.select('.file')));\n  formData.append('params', JSON.stringify(params));\n  return fetcher.post('sdfin', formData)\n    .then(fetcher.json);\n}\n\n\n\nexport default {\n  menuLink, body, updateBody, execute\n};\n","\n/** @module dialog/rename */\n\nimport d3 from 'd3';\n\nimport {default as badge} from '../component/badge.js';\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'rename-dialog';\nconst title = 'Rename';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-edittext');\n}\n\n\nfunction body(selection) {\n  const renameBox = selection.call(modal.submitDialog, id, title)\n    .select('.modal-body').append('div')\n      .classed('rename', true)\n      .call(box.textBox, 'New name');\n  renameBox.select('.form-control')\n      .attr('required', 'required');\n  renameBox.select('.invalid-feedback')\n      .call(badge.updateInvalidMessage, 'Please provide a valid name');\n}\n\n\nfunction updateBody(selection, name) {\n  selection.select('.rename')\n      .call(box.formValue, name)\n      .on('input', function () {\n        const valid = box.formValid(d3.select(this));\n        selection.select('.submit').property('disabled', !valid);\n      })\n      .dispatch('input');\n}\n\n\nfunction value(selection) {\n  return box.formValue(selection.select('.rename'));\n}\n\n\nexport default {\n  menuLink, body, updateBody, value\n};\n","\n/** @module datagrid/component */\n\nimport d3 from 'd3';\n\n\nfunction headerCellRenderer(header) {\n  header.style('display', 'inline-block')\n    .style('width', d => `${d.width}%`)\n    .text(d => d.name);\n}\n\n\nfunction updateHeader(selection, state) {\n  const header = selection.select('.dg-header');\n  header.selectAll('.dg-hcell').remove();\n  header.selectAll('.dg-hcell').data(state.visibleFields)\n    .enter().append('div')\n      .classed('dg-hcell', true)\n      .call(state.headerCellRenderer);\n}\n\n\nfunction updateRows(selection, state) {\n  const rows = selection.select('.dg-body')\n    .selectAll('.dg-row')\n      .data(state.recordsToShow(), state.keyFunc);\n  rows.exit().remove();\n  rows.selectAll('.dg-cell').remove();\n  rows.enter()\n    .append('div')\n      .attr('class', 'dg-row')\n      .style('position', 'absolute')\n      .style('width', '100%')\n    .merge(rows)\n      .style('height', `${state.rowHeight}px`)\n      .each(function (d, i) {\n        const rowIndex = state.viewportTop + i;\n        const rowPos = rowIndex * state.rowHeight;\n        d3.select(this)\n          .style('transform', `translate(0px, ${rowPos}px)`)\n          .classed('odd', (rowIndex) % 2 === 0)\n          .call(state.rowFactory(), d);\n      });\n}\n\n\nfunction updateViewport(selection, state, scrollPos) {\n  selection.select('.dg-body').style('height', `${state.bodyHeight}px`);\n  state.setScrollPosition(scrollPos);\n  selection.call(updateRows, state, scrollPos);\n  selection.select('.dg-viewport').node().scrollTop = scrollPos * state.rowHeight;\n}\n\n\nfunction resize(selection, state) {\n  const viewport = selection.select('.dg-viewport');\n  const viewportTop = viewport.node().getBoundingClientRect().top;\n  state.resizeViewport(window.innerHeight - viewportTop - 5);\n  viewport.style('height', `${state.viewportHeight}px`);\n}\n\n\nfunction datagrid(selection, state) {\n  selection.append('div')\n      .classed('dg-header', true);\n  selection.append('div')\n      .classed('dg-viewport', true)\n      .style('overflow-y', 'auto')\n      .on('scroll', function () {\n        const pos = Math.floor(this.scrollTop / state.rowHeight);\n        if (pos !== state.previousViewportTop) {\n          state.setScrollPosition(pos);\n          selection.call(updateRows, state, pos);\n        }\n      })\n    .append('div')\n      .classed('dg-body', true)\n      .style('position', 'relative');\n  state.updateContentsNotifier = () => {\n    state.applyHeader();\n    selection.call(updateHeader, state);\n    selection.call(resize, state);\n    state.applyData();\n    selection.call(updateViewport, state, state.viewportTop);\n  };\n  state.updateFilterNotifier = value => {\n    state.setFilterText(value);\n    selection.call(updateViewport, state, 0);\n  };\n}\n\n\n\nexport default {\n  headerCellRenderer, updateHeader, updateRows, updateViewport,\n  resize, datagrid\n};\n","\n/** @module datagrid/rowFactory */\n\nimport {default as misc} from '../common/misc.js';\nimport {default as img} from '../common/image.js';\n\n\nfunction d3Format(selection, record, field) {\n  selection.text(misc.formatNum(record[field.key], field.d3_format));\n}\n\n\nfunction text(selection, record, field) {\n  selection.text(record[field.key]);\n}\n\n\nfunction date(selection, record, field) {\n  // TODO; formatter\n  selection.text(record[field.key]);\n}\n\n\nfunction html(selection, record, field) {\n  // TODO: Check vulnerabilities\n  selection.html(record[field.key]);\n}\n\n\nfunction compound_id(selection, record, field) {\n  selection.append('a')\n      .attr('href',`profile.html?compound=${record[field.key]}`)\n      .attr('target', '_blank')\n      .text(record[field.key]);\n}\n\n\nfunction image(selection, record, field) {\n  selection.append('img')\n      .attr('width', 180)\n      .attr('height', 180)\n      .attr('src', record[field.key]);\n}\n\nfunction checkbox(selection, record, field) {\n  selection.append('input')\n      .attr('type', 'checkbox')\n      .property('checked', record[field.key])\n      .property('disabled', field.disabled ? record[field.disabled] : false)\n      .on('click', function () {\n        record[field.key] = this.checked;\n      });\n}\n\nfunction textField(selection, record, field) {\n  selection.append('input')\n      .attr('type', 'text')\n      .style('width', '90%')\n      .property('value', record[field.key])\n      .on('change', function () {\n        record[field.key] = this.value;\n      });\n}\n\nfunction call(selection, value) {\n  selection.call(value);\n}\n\n\nconst cellFunc = {\n  numeric: text,\n  text: text,\n  date: date,\n  raw: text,\n  d3_format: d3Format,\n  compound_id: compound_id,\n  assay_id: text,\n  list: text,\n  plot: img.plotCell,\n  image: image,\n  checkbox: checkbox,\n  text_field: textField,\n  control: call,\n  svg: html,\n  html: html\n};\n\n\nfunction rowCell(selection) {\n  selection.classed('dg-cell', true)\n    .classed('align-middle', true)\n    .classed('text-truncate', true)\n    .style('display', 'inline-block');\n}\n\n\nfunction rowFactory(fields) {\n  return (selection, record) => {\n    fields.forEach(field => {\n      const cell = selection.append('div')\n          .call(rowCell)\n          .style('width', `${field.width}%`);\n      if (!record.hasOwnProperty(field.key)) return;\n      cell.call(cellFunc[field.format], record, field);\n    });\n  };\n}\n\n\nexport default {\n  d3Format, text, html, compound_id, image, checkbox, textField, call,\n  rowCell, rowFactory\n};\n","\n/** @module common/image */\n\nimport vega from 'vega';\n\n\nfunction plotCell(selection, record, field) {\n  new vega.View(vega.parse(record[field.key]))\n    .initialize(selection.node())\n    .run();\n}\n\n\nfunction plotThumbnail(vegaSpec) {\n  const view = new vega.View(vega.parse(vegaSpec));\n  return view.toImageURL('png');  // Promise\n}\n\n\nfunction binaryToDataURI(binary) {\n  return new Promise(resolve => {\n    const reader = new FileReader();\n    reader.onload = event => {\n      resolve(event.target.result);\n    };\n    reader.readAsDataURL(binary);\n  });\n}\n\n\nexport default {\n  plotCell, plotThumbnail, binaryToDataURI\n};\n","\n/** @module datagrid/state */\n\nimport _ from 'lodash';\n\nimport Collection from '../common/collection.js';\nimport {default as idb} from '../common/idb.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as component} from './component.js';\nimport {default as factory} from './rowFactory.js';\n\n\nexport default class DatagridState {\n  constructor(view, coll) {\n    this.storeID = view.storeID || null;\n    this.viewID = view.viewID || null;\n    this.name = view.name || null;\n    this.sortOrder = view.sortOrder || [];\n    this.filterText = view.filterText || null;\n    this.rows = new Collection(coll);\n\n    this.visibleFields = null;\n    this.sortedRecords = null;\n    this.filteredRecords = null;\n\n    // TODO: auto adjust\n    this.defaultColumnHeight = {\n      numeric: 40,\n      text: 40,\n      html: 40,\n      none: 200\n    };\n    this.scrollBarSpace = 20;\n    this.keyFunc = d => d.index;\n\n    // Size\n    this.rowHeight = null;\n    this.bodyHeight = null;\n\n    // Viewport\n    this.viewportHeight = null;\n    this.numViewportRows = null;\n    this.viewportTop = 0;\n    this.previousViewportTop = null;\n    this.viewportBottom = null;\n\n    this.fixedViewportHeight = null;\n\n    // Event notifier\n    this.updateContentsNotifier = null;\n    this.updateFilterNotifier = null;\n\n    this.headerCellRenderer = component.headerCellRenderer;\n    this.rowFactory = () => factory.rowFactory(this.visibleFields);\n  }\n\n  /**\n   * Set viewport height and number of rows to show\n   * @param {int} height - viewport height\n   */\n  setViewportSize(height) {\n    this.viewportHeight = this.fixedViewportHeight || height;\n  }\n\n  /**\n   * Set range of the row indices to show\n   * @param {int} position - Index of the top row to show\n   */\n  setScrollPosition(position) {\n    this.previousViewportTop = this.viewportTop;\n    this.viewportTop = position;\n    this.viewportBottom = Math.min(\n      this.viewportTop + this.numViewportRows, this.filteredRecords.length);\n  }\n\n  setNumViewportRows() {\n    this.numViewportRows = Math.ceil(this.viewportHeight / this.rowHeight) + 1;\n  }\n\n  resizeViewport(height) {\n    this.setViewportSize(height);\n    this.setNumViewportRows();\n  }\n\n  /**\n   * Apply header data\n   */\n  applyHeader() {\n    this.visibleFields = this.rows.fields.filter(e => e.visible);\n    const widthfSum = this.visibleFields.reduce((a, c) => a + (c.widthf || 1), 0);\n    this.visibleFields = this.visibleFields.map(e => {\n      const field = {\n        width: (e.widthf || 1) / widthfSum * 100,\n        height: e.height || this.defaultColumnHeight[misc.sortType(e.format)]\n      };\n      return Object.assign(field, e);\n    });\n    this.rowHeight = this.visibleFields\n      .reduce((a, b) => a.height > b.height ? a : b, 0).height;\n  }\n\n  /**\n   * Apply row data\n   * 1. applyHeader: define fields and set rowHeight\n   * 2. resize: measure actual window size and calc viewportHeight\n   * 3. applyData: calc number of rows from rowHeight and viewportHeight\n   * 4. setScrollPosition: calc row index range\n   * 5. recordsToShow: slice rows to show\n   */\n  applyData() {\n    this.setNumViewportRows();\n    this.applyOrder();\n  }\n\n  applyOrder(key, order) {\n    if (key) {\n      this.sortedRecords = _.orderBy(this.rows.records().slice(), [key], [order]);\n    } else {\n      const keys = this.sortOrder.map(e => e.key);\n      const orders = this.sortOrder.map(e => e.order);\n      if (keys) {\n        this.sortedRecords = _.orderBy(this.rows.records().slice(), keys, orders);\n      }\n    }\n    this.applyFilter();\n  }\n\n  applyFilter() {\n    if (this.filterText === null) {\n      this.filteredRecords = this.sortedRecords.slice();\n    } else {\n      const fields = this.visibleFields\n        .filter(e => misc.sortType(e.format) !== 'none')\n        .map(e => e.key);\n      this.filteredRecords = this.sortedRecords.filter(row => {\n        return fields.some(f => misc.partialMatch(this.filterText, row[f]));\n      });\n    }\n    this.bodyHeight = this.filteredRecords.length * this.rowHeight;\n  }\n\n  setSortOrder(key, order) {\n    const ki  = this.sortOrder.findIndex(e => e.key);\n    const obj = {key: key, order: order};\n    if (ki !== -1) this.sortOrder.splice(ki, 1);\n    this.sortOrder.splice(0, 0, obj);\n    this.applyOrder(key, order);\n  }\n\n  setFilterText(text) {\n    this.filterText = text;\n    this.applyFilter();\n  }\n\n  updateFields(fs) {\n    this.rows.updateFields(fs);\n  }\n\n  joinFields(mapping) {\n    this.rows.joinFields(mapping);\n    this.applyData();\n  }\n\n  recordsToShow() {\n    return this.filteredRecords.slice(this.viewportTop, this.viewportBottom);\n  }\n\n  save() {\n    return idb.updateItem(this.storeID, item => {\n      const ci = item.dataset\n        .findIndex(e => e.collectionID === this.rows.collectionID);\n      item.dataset[ci] = this.rows.export();\n      const vi = item.views.findIndex(e => e.viewID === this.viewID);\n      item.views[vi] = this.export();\n    });\n  }\n\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n      viewID: this.viewID,\n      name: this.name,\n      viewType: \"datagrid\",\n      rows: this.rows.collectionID,\n      sortOrder: this.sortOrder,\n      filterText: this.filterText\n    };\n  }\n}\n","\n/** @module datagrid/rowFilter */\n\nimport {default as box} from '../component/formBox.js';\n\n\nfunction setFilter(selection, state) {\n  const searchBox = selection\n      .classed('row', true)\n      .classed('justify-content-end', true)\n    .append('div')\n      .classed('col-5', true)\n      .call(box.textBox, 'Search');\n  searchBox.select('label').classed('text-right', true);\n  searchBox.select('input')\n    .on('keyup', function () {\n      state.updateFilterNotifier(box.formValue(searchBox));\n    });\n}\n\n\nexport default {\n  setFilter\n};\n","\n/** @module datagrid/sort */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as component} from './component.js';\n\n\nfunction setSort(selection, state) {\n  state.headerCellRenderer = header => {\n    header.style('display', 'inline-block')\n      .style('width', d => `${d.width}%`)\n      .text(d => d.name)\n      .filter(d => misc.sortType(d.format) !== 'none')\n      .append('span').append('a')\n        .attr('id', d => `sort-${d.key}`)\n        .text('^v')\n        .style('display', 'inline-block')\n        .style('width', '30px')\n        .style('text-align', 'center')\n      .on('click', d => {\n        const isAsc = d3.select(`#sort-${d.key}`).text() === 'v';\n        d3.select(`#sort-${d.key}`).text(isAsc ? '^' : 'v');\n        state.setSortOrder(d.key, isAsc ? 'desc' : 'asc');\n        selection.call(component.updateRows, state);\n      });\n  };\n}\n\n\nexport default {\n  setSort\n};\n","\n/** @module datagrid/table */\n\nimport Collection from '../common/collection.js';\n\nimport DatagridState from './state.js';\nimport {default as component} from './component.js';\nimport {default as rowf} from './rowFilter.js';\nimport {default as sort} from './sort.js';\n\n\nfunction table(selection, fields, records, rowFactory, height) {\n  const data = {\n    fields: fields,\n    records: records\n  };\n  const state = new DatagridState({}, data);\n  state.keyFunc = d => d;\n  if (rowFactory) {\n    state.rowFactory = () => rowFactory(state.visibleFields);\n  }\n  state.fixedViewportHeight = height || 300;\n  selection.append('div')\n    .classed('table', true)\n    .call(component.datagrid, state);\n  selection.datum(state);\n}\n\n\nfunction filterTable(selection, fields, records, rowFactory, height) {\n  const data = {\n    fields: fields,\n    records: records\n  };\n  const state = new DatagridState({}, data);\n  if (rowFactory) {\n    state.rowFactory = () => rowFactory(state.visibleFields);\n  }\n  state.fixedViewportHeight = height || 300;\n  selection.append('div')\n    .classed('search', true)\n    .call(rowf.setFilter, state);\n  selection.append('div')\n    .classed('table', true)\n    .call(component.datagrid, state);\n  selection.datum(state);\n}\n\n\nfunction filterSortTable(selection, fields, records, rowFactory, height) {\n  const data = {\n    fields: fields,\n    records: records\n  };\n  const state = new DatagridState({}, data);\n  if (rowFactory) {\n    state.rowFactory = () => rowFactory(state.visibleFields);\n  }\n  state.fixedViewportHeight = height || 300;\n  selection.append('div')\n    .classed('search', true)\n    .call(rowf.setFilter, state);\n  selection.append('div')\n    .classed('table', true)\n    .call(sort.setSort, state)\n    .call(component.datagrid, state);\n  selection.datum(state);\n}\n\n\nfunction update(selection, fields, records) {\n  const data = {\n    fields: fields,\n    records: records\n  };\n  const state = selection.datum();\n  state.rows = new Collection(data);\n  state.updateContentsNotifier();\n}\n\n\nfunction updateRecords(selection, records) {\n  const state = selection.datum();\n  state.rows.contents[0].records = records;\n  state.updateContentsNotifier();\n}\n\n\nfunction tableRecords(selection) {\n  const state = selection.datum();\n  return state.rows.records();\n}\n\n\nexport default {\n  table, filterTable, filterSortTable, update, updateRecords, tableRecords\n};\n","\n/** @module dashboardApp */\n\nimport d3 from 'd3';\n\nimport {default as client} from './common/client.js';\nimport Collection from './common/collection.js';\nimport {default as fetcher} from './common/fetcher.js';\nimport {default as hfile} from './common/file.js';\nimport {default as idb} from './common/idb.js';\nimport {default as specs} from './common/specs.js';\n\nimport {default as badge} from './component/badge.js';\nimport {default as button} from './component/button.js';\nimport {default as modal} from './component/modal.js';\nimport {default as tree} from './component/tree.js';\n\nimport {default as searchDialog} from './dialog/search.js';\nimport {default as structDialog} from './dialog/struct.js';\nimport {default as filterDialog} from './dialog/filter.js';\nimport {default as sdfDialog} from './dialog/sdf.js';\nimport {default as renameDialog} from './dialog/rename.js';\n\nimport {default as table} from './datagrid/table.js';\n\n\nfunction nodeFactory(selection, record) {\n  const iconv = {\n    'datagrid': 'table-darkorange', 'network': 'network-turquoise',\n    'tile': 'tiles-yellowgreen'\n  };\n  const icon = record.viewID ? iconv[record.viewType] : 'file-seagreen';\n  const storeID = record.storeID || record.parent;\n  const node = record.viewID\n    ? selection.append('a')\n      .attr(\n        'href',\n        `${record.viewType}.html?store=${storeID}&view=${record.viewID}`\n      )\n      .attr('target', '_blank')\n    : selection;\n  node.append('img')\n      .attr('src', icon ? `${button.iconBaseURL}${icon}.svg` : null)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  node.append('span')\n      .classed('mr-1', true)\n      .text(record.name);\n  const colors = {\n    done: 'green', running: 'darkorange',\n    ready: 'cornflowerblue', queued: 'cornflowerblue',\n    interrupted: 'salmon', aborted: 'salmon', failure: 'salmon',\n    rows: 'gray', items: 'gray',\n    nodes: 'gray', edges: 'gray'\n  };\n  const icons = {\n    done: 'check-green', running: 'running-darkorange',\n    ready: 'clock-cornflowerblue', queued: 'clock-cornflowerblue',\n    interrupted: 'caution-salmon', aborted: 'caution-salmon',\n    failure: 'caution-salmon',\n    rows: 'table-gray', items: 'tiles-gray',\n    nodes: 'nodes-gray', edges: 'edges-gray'\n  };\n    if (record.viewID) {\n    record.stats.forEach(stat => {\n      selection.append('img')\n          .attr('src', `${button.iconBaseURL}${icons[stat[0]]}.svg`)\n          .style('width', '1rem')\n          .style('height', '1rem');\n      selection.append('span')\n          .classed('pr-1', true)\n          .style('font-size', '0.8rem')\n          .style('color', colors[stat[0]])\n          .text(stat[1]);\n    });\n  } else {\n    selection.append('span')\n        .classed('pr-1', true)\n        .style('font-size', '0.7rem')\n        .style('color', '#999999')\n        .text(record.sessionStarted);\n  }\n  const action = selection.append('span')\n      .classed('p-1', true)\n      .style('border', '1px solid #999999')\n      .style('border-radius', '5px');\n  const actionIcon = (sel, icon) => sel.append('img')\n      .attr('src', `${button.iconBaseURL}${icon}.svg`)\n      .classed('mx-1', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  if (!record.viewID) {\n    action.append('a').call(actionIcon, 'menu-export')\n        .on('click', () => {\n          const data = JSON.parse(JSON.stringify(record));\n          delete data.storeID;\n          delete data.sessionStarted;\n          hfile.downloadJSON(data, data.name);\n        });\n  }\n  action.append('a')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', '#rename-dialog')\n      .call(actionIcon, 'menu-edittext')\n      .on('click', () =>{\n        d3.select('#rename-dialog')\n          .call(renameDialog.updateBody, record.name)\n          .on('submit', function () {\n            d3.select('#menubar .loading-circle')\n                .style('display', 'inline-block');\n            if (record.viewID) {\n              idb.updateView(record.parent, record.viewID, view => {\n                view.name = renameDialog.value(d3.select(this));\n              }).then(updateApp);\n            } else {\n              idb.updateItem(record.storeID, item => {\n                item.name = renameDialog.value(d3.select(this));\n              }).then(updateApp);\n            }\n          });\n      });\n  if (!record.ongoing) {\n    const recordType = record.viewID ? record.viewType : 'package';\n    const deleteType = record.alone ? 'package' : recordType;\n    const deleteName = record.alone ? record.parentName : record.name;\n    action.append('a')\n        .attr('data-toggle', 'modal')\n        .attr('data-target', '#delete-dialog')\n        .call(actionIcon, 'delete-gray')\n        .on('click', () =>{\n          d3.select('#delete-dialog')\n            .call(\n              modal.updateConfirmDialog,\n              `Are you sure you want to delete ${deleteType} ${deleteName} ?`\n            )\n            .on('submit', () => {\n              d3.select('#menubar .loading-circle')\n                  .style('display', 'inline-block');\n              if (record.viewID && !record.alone) {\n                idb.deleteView(record.parent, record.viewID)\n                  .then(updateApp);\n              } else {\n                idb.deleteItem(record.storeID || record.parent)\n                  .then(updateApp);\n              }\n            });\n        });\n  }\n  action.selectAll('img')\n    .on('mouseenter', function() {\n      d3.select(this).style('background-color', '#ffcccc');\n    })\n    .on('mouseleave', function() {\n      d3.select(this).style('background-color', null);\n    });\n}\n\n\nfunction app() {\n  // Menubar\n  const menubar = d3.select('#menubar')\n      .classed('my-1', true);\n  // Start\n  const startMenu = menubar.append('div')\n      .call(button.dropdownMenuButton, 'Start', 'primary', 'plus-white')\n      .select('.dropdown-menu');\n  startMenu.append('a').classed('online-command', true)\n      .call(searchDialog.menuLink);\n  startMenu.append('a').classed('online-command', true)\n      .call(structDialog.menuLink);\n  startMenu.append('a').classed('online-command', true)\n      .call(filterDialog.menuLink);\n  startMenu.append('a').classed('online-command', true)\n      .call(sdfDialog.menuLink);\n  startMenu.append('a')\n      .call(button.dropdownMenuFile, 'Open file',\n            '.apc,.apr,.ndc,.ndr,.gfc,.gfr,.json,.gz', 'menu-import')\n      .on('change', function () {\n        d3.select('#menubar .loading-circle').style('display', 'inline-block');\n        const file = button.dropdownMenuFileValue(d3.select(this));\n        return hfile.loadJSON(file)\n          .then(idb.importItem)\n          .then(updateApp);\n      });\n  // Refresh\n  menubar.append('a')\n      .classed('refresh', true)\n      .classed('online-command', true)\n      .call(button.menuButtonLink,\n            'Refresh all', 'outline-secondary', 'refresh-gray')\n      .on('click', () => {\n        d3.select('#menubar .loading-circle').style('display', 'inline-block');\n        return updateApp();\n      });\n  // Delete all\n  menubar.append('a')\n      .classed('reset', true)\n      .call(button.menuModalLink, 'reset-dialog',\n            'Reset local datastore', 'warning', 'delete-gray');\n  // Status\n  menubar.append('span')\n      .classed('loading-circle', true)\n      .call(badge.loadingCircle);\n\n  // Contents\n  const contents = d3.select('#contents')\n      .style('padding-left', '10%')\n      .style('padding-right', '10%');\n\n  // Stored analysis packages\n  contents.append('h5').classed('mt-5', true).text('Packages on local storage');\n  contents.append('div').classed('mb-5', true)\n      .classed('stored', true)\n      .style('border', '1px solid #333333')\n      .call(tree.tree)\n      .call(tree.setHeight, 300);\n\n  // Server calc jobs\n  // TODO: only for admin\n  const calcFields = [\n    {key: 'workflowID', name: 'WorkflowID', format: 'text'},\n    {key: 'name', name: 'Name', format: 'text'},\n    {key: 'size', name: 'File size', format: 'd3_format', d3_format: '.3s'},\n    {key: 'status', name: 'Status', format: 'text'},\n    {key: 'created', name: 'Created', format: 'date', height: 40}\n  ];\n  contents.append('h5').classed('mt-5', true).text('Server calculation job');\n  contents.append('div').classed('mb-5', true).classed('calc', true)\n  .call(table.table, calcFields, [], null, 300);\n\n  // Server status\n  const serverFields = [\n    {key: 'key', name: 'Key', format: 'text'},\n    {key: 'value', name: 'Value', format: 'text'}\n  ];\n  contents.append('h5').classed('mt-5', true).text('Server status');\n  contents.append('div').classed('mb-5', true).classed('server', true)\n  .call(table.table, serverFields, [], null, 300);\n\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n  dialogs.append('div')\n      .classed('searchd', true)\n      .call(searchDialog.body);\n  dialogs.append('div')\n      .classed('structd', true)\n      .call(structDialog.body);\n  dialogs.append('div')\n      .classed('filterd', true)\n      .call(filterDialog.body);\n  dialogs.append('div')\n      .classed('sdfd', true)\n      .call(sdfDialog.body);\n  dialogs.append('div')\n      .classed('renamed', true)\n      .call(renameDialog.body);\n  dialogs.append('div')\n      .call(modal.confirmDialog, 'reset-dialog')\n      .call(modal.updateConfirmDialog,\n            'Are you sure you want to delete all local tables and reset the datastore ?')\n      .on('submit', () => {\n        d3.select('#menubar .loading-circle').style('display', 'inline-block');\n        return idb.reset().then(updateApp);\n      });\n  dialogs.append('div')\n      .call(modal.confirmDialog, 'delete-dialog');\n\n  // Update\n  return updateApp();\n}\n\n\nfunction updateApp() {\n  const onLoading = d3.select('#menubar .loading-circle');\n  const dialogs = d3.select('#dialogs');\n\n  // Server bound tasks\n  return fetcher.serverStatus().then(response => {\n    // Update server status table\n    d3.select('#contents').select('.calc')\n      .call(table.updateRecords, response.server.calc.records);\n    const serverRecords = Object.entries(response.server)\n      .filter(e => e[0] !== 'calc')\n      .map(e => ({key: e[0], value: e[1]}));\n    d3.select('#contents').select('.server')\n      .call(table.updateRecords, serverRecords);\n\n    // Dialogs\n    const chemrsrc = response.schema.resources.filter(e => e.domain === 'chemical');\n    dialogs.select('.searchd')\n        .call(searchDialog.updateBody, chemrsrc)\n        .on('submit', function () {\n          return searchDialog.execute(d3.select(this), chemrsrc)\n            .then(idb.newDatagrid)\n            .then(r => {\n              onLoading.style('display', 'none');\n              window.open(\n                `datagrid.html?store=${r.storeID}&view=${r.viewID}`, '_blank');\n            });\n        });\n    dialogs.select('.structd')\n        .call(structDialog.updateBody, chemrsrc, response.server.rdkit)\n        .on('submit', function () {\n          return structDialog.execute(d3.select(this))\n            .then(idb.newDatagrid)\n            .then(r => {\n              onLoading.style('display', 'none');\n              window.open(\n                `datagrid.html?store=${r.storeID}&view=${r.viewID}`, '_blank');\n            });\n        });\n    dialogs.select('.filterd')\n        .call(filterDialog.updateBody, chemrsrc)\n        .on('submit', function () {\n          return filterDialog.execute(d3.select(this))\n            .then(idb.newDatagrid)\n            .then(r => {\n              onLoading.style('display', 'none');\n              window.open(\n                `datagrid.html?store=${r.storeID}&view=${r.viewID}`, '_blank');\n            });\n        });\n    dialogs.select('.sdfd')\n        .call(sdfDialog.updateBody, chemrsrc)\n        .on('submit', function () {\n          return sdfDialog.execute(d3.select(this))\n            .then(idb.newDatagrid)\n            .then(r => {\n              onLoading.style('display', 'none');\n              window.open(\n                `datagrid.html?store=${r.storeID}&view=${r.viewID}`, '_blank');\n            });\n        });\n\n    // Form auto-fill for debug (Ctrl+F)\n    client.registerCtrlCommand('f', () => {\n      const activeID = dialogs.select('.show').attr('id');\n      const modals = {\n        'search-dialog': searchDialog,\n        'struct-dialog': structDialog,\n        'filter-dialog': filterDialog\n      };\n      dialogs.select(`#${activeID}`).call(modals[activeID].fill);\n    });\n\n    // Fetch all ongoing tasks\n    return idb.getAllCollections()\n      .then(colls => {\n        const ongoings = colls.map(e => new Collection(e))\n          .filter(e => e.ongoing());\n        return Promise.all(ongoings.map(o => o.pull()));\n      });\n  })\n  .catch(err => {\n    console.info('Server did not respond');\n    console.error(err);\n    // disable on-line commands\n    d3.select('#menubar').selectAll('.online-command')\n      .attr('data-target', null)\n      .classed('disabled', true);\n    d3.select('#contents').select('.calc').text('Off-line');\n    d3.select('#contents').select('.server').text('Off-line');\n  })\n  .finally(() => {\n    // update stored package tree\n    return idb.getAllItems().then(items => {\n      const treeNodes = [{storeID: 'root'}];\n      const ogs = [];\n      items.forEach(pkg => {\n        pkg.parent = 'root';\n        pkg.ongoing = specs.isRunning(pkg);\n        ogs.push(pkg.ongoing);\n        treeNodes.push(pkg);\n        pkg.views.forEach(view => {\n          view.parent = pkg.storeID;\n          view.ongoing = pkg.ongoing;\n          view.alone = pkg.views.length <= 1;\n          view.parentName = pkg.name;\n          view.stats = ['nodes', 'edges', 'rows', 'items']\n            .filter(e => view.hasOwnProperty(e))\n            .map(e => [e,\n              d3.format(\".3~s\")(\n                pkg.dataset.find(d => d.collectionID === view[e])\n                  .contents.reduce((a, b) => a + b.records.length, 0))]);\n          const coll = new Collection(pkg.dataset\n            .find(d => d.collectionID === view[\n              ['edges', 'rows', 'items'].filter(e => view.hasOwnProperty(e))[0]\n            ]));\n          const statusText = coll.status() === 'done' ? '' : coll.status();\n          const progText = coll.ongoing() ? `${coll.progress()}%` : '';\n          view.stats.push([coll.status(), `${statusText}${progText}`]);\n          treeNodes.push(view);\n        });\n      });\n      d3.select('.reset')\n          .classed('disabled', ogs.some(e => e));\n      d3.select('.stored')\n          .call(tree.treeItems, treeNodes, d => d.storeID, nodeFactory);\n      onLoading.style('display', 'none');\n    });\n  });\n}\n\n\nfunction run() {\n  const err = client.compatibility();\n  if (err) {\n    d3.select('body')\n      .style('color', '#ff0000')\n      .text(err);\n    return;\n  }\n  // TODO: show browser status\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";  // TODO\n  const offLine = 'onLine' in navigator && !navigator.onLine;  // TODO\n  console.info(`Kiwiii version ${kwVersion}`)\n  client.registerServiceWorker();\n  app();\n}\n\n\nexport default {\n  run\n};\n"],"names":["URLQuery","pairs","window","location","search","substring","split","map","e","_","fromPairs","compatibility","registerServiceWorker","navigator","isDebugBuild","console","info","addEventListener","serviceWorker","register","registerCtrlCommand","key","callback","document","event","ctrlKey","sortType","fmt","includes","formatNum","value","d3format","Number","isNaN","parseFloat","d3","format","partialMatch","query","target","toString","toUpperCase","indexOf","uuidv4","replace","c","r","Math","random","statusConv","Queued","In progress","Aborting","Aborted","Completed","Failure","dataTypeConv","datatable","connection","v07_to_v08_nodes","json","fields","columns","sort","id","name","dataType","schemaVersion","revision","status","records","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v10_nodes","reference","convertNetwork","data","edges","hasOwnProperty","nodes","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","forEach","i","index","_structure","_index","source","v08_graph","nodeContentVisible","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","params","v10_edges","$schema","convertPackage","specs","now","Date","isNW","v08_nodes","width","height","convertTable","views","dataset","push","collectionID","contents","workflowID","workflow","viewID","viewType","rows","sortOrder","filterText","checkpoints","type","date","description","networkThresholdCutoff","filter","view","minConnThld","currentConnThld","edgeColor","color","edgeLabelColor","schema","items","idb","Dexie","getAllItems","orderBy","reverse","toArray","updateItem","storeID","updateFunc","where","equals","modify","catch","err","error","version","stores","reset","delete","then","getItem","first","deleteItem","getView","appendView","viewObj","item","pos","findIndex","splice","updateView","isFunction","deleteView","bin","Object","entries","entry","getAllCollections","flatten","coll","getCollection","collID","colls","updateCollection","collObj","importItem","legacy","misc","slice","sessionStarted","put","newDatagrid","response","toLocaleString","timeZone","newNetwork","nodesName","edgesID","baseURL","get","url","q","keys","length","JSON","stringify","fetch","credentials","res","Promise","reject","Error","statusText","resolve","blob","post","formdata","method","body","serverStatus","server","singleToMulti","mapping","newMapping","m","mappingToTable","mp","concat","rcd","f","tableToMapping","table","ignore","row","csvToMapping","csvString","lines","header","shift","headerIdx","h","line","values","k","Array","apply","fd","uniqBy","Collection","[object Object]","this","autoIndex","content","addField","fs","mapper","func","command","fetcher","all","sum","some","min","readFile","file","sizeLimit","reader","FileReader","truncated","onload","result","onerror","readAsArrayBuffer","readAsText","parseJSON","compressed","pako","inflate","to","parse","downloadDataFile","URL","createObjectURL","Blob","a","createElement","download","href","dispatchEvent","MouseEvent","bubbles","cancelable","loadJSON","endsWith","fetchJSON","decoded","decodeURIComponent","arrayBuffer","downloadJSON","compress","str","gzip","isRunning","assetBaseURL","iconBaseURL","badge","selection","classed","append","style","updateBadge","icon","select","attr","notify","transition","duration","ease","easeLinear","delay","on","loadingCircle","alert","updateAlert","invalidFeedback","updateInvalidMessage","msg","buttonBox","menuButton","menuButtonLink","menuModalLink","dropdownMenuButton","button","dropdownMenuItem","dropdownMenuModal","dropdownMenuFile","accept","node","click","dropdownMenuFileValue","files","dialogBase","confirmDialog","base","call","footer","dispatch","updateConfirmDialog","message","submitDialog","title","html","$","modal","nextLevel","nodeFactory","children","child","datum","arrow","childList","expanded","tree","treeItems","keyFunc","root","stratify","parentId","d","parent","remove","selectAll","setHeight","checkboxNode","checkboxValues","formValue","property","formValid","checkValidity","setValidity","valid","textareaValid","test","fileInputBox","fileInputValid","updateFormValue","textBox","readonlyBox","updateReadonlyValue","readonlyValue","textareaBox","placeholder","textareaBoxLines","numberBox","updateNumberRange","max","step","checkBox","box","updateCheckBox","checked","checkBoxValue","colorBox","stopPropagation","clearFileInput","fileInputValue","monocolorBar","colors","group","colorBar","monocolor","bicolor","grad","tricolor","categorical","sw","custom","setSize","checklistValues","anyChecked","setChecklistValidity","setSelectedColorScale","selected","shape","selectBox","updateSelectBoxOptions","options","exit","enter","selectedRecord","checklistBox","updateChecklistItems","listitems","form","checkRequired","updateChecklistValues","each","colorScaleBox","dropdown","colorScaleBoxItems","updateColorScaleBox","colorScaleBoxValue","colorScaleBoxItem","menuLink","mbody","lbox","updateBody","resources","def","execute","targets","fill","dropdownFormGroup","queryMolValues","textquery","areaquery","queryMolGroup","queryBox","ctabBox","popover","trigger","updateQueryMolResources","updateQueryMolValues","queryMolValid","textValid","ctabValid","simOptionGroup","collapse","timeoutBox","diamBox","updateSimOptionValues","ignoreHs","timeout","diameter","simOptionValues","diam","simOptionValid","timeoutValid","diamValid","dialogFormValid","qmolValid","thldValid","targetChecked","mcs","strMatch","rs","thldBox","rdk","methodList","measure","thld","checklistBoxValue","queryMol","queryMolGroupValue","numValid","textValueBox","numValueBox","operator","dialog","hfile","re","uniqCols","Set","arr","exec","add","from","getSDFPropList","fieldChecked","implh","recalc","formData","FormData","renameBox","updateHeader","state","visibleFields","headerCellRenderer","updateRows","recordsToShow","merge","rowHeight","rowIndex","viewportTop","rowPos","rowFactory","updateViewport","scrollPos","bodyHeight","setScrollPosition","scrollTop","resize","viewport","getBoundingClientRect","top","resizeViewport","innerHeight","viewportHeight","datagrid","floor","previousViewportTop","updateContentsNotifier","applyHeader","applyData","updateFilterNotifier","setFilterText","d3Format","record","d3_format","compound_id","image","checkbox","disabled","textField","cellFunc","numeric","raw","assay_id","list","plot","plotCell","vega","View","initialize","run","plotThumbnail","vegaSpec","toImageURL","binaryToDataURI","binary","readAsDataURL","text_field","control","svg","rowCell","cell","DatagridState","sortedRecords","filteredRecords","defaultColumnHeight","none","scrollBarSpace","numViewportRows","viewportBottom","fixedViewportHeight","component","factory","position","ceil","setViewportSize","setNumViewportRows","widthfSum","reduce","widthf","assign","b","applyOrder","order","orders","applyFilter","ki","obj","updateFields","joinFields","ci","export","vi","setFilter","searchBox","setSort","isAsc","setSortOrder","filterTable","rowf","filterSortTable","update","updateRecords","tableRecords","network","tile","done","running","ready","queued","interrupted","aborted","failure","icons","stats","stat","action","actionIcon","sel","renameDialog","updateApp","ongoing","recordType","deleteType","alone","deleteName","parentName","onLoading","dialogs","calc","serverRecords","chemrsrc","searchDialog","open","structDialog","rdkit","filterDialog","sdfDialog","client","activeID","modals","search-dialog","struct-dialog","filter-dialog","ongoings","o","pull","finally","treeNodes","ogs","pkg","progText","protocol","onLine","kwVersion","menubar","startMenu","app"],"mappings":"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"}