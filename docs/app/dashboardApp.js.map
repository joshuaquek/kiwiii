{"version":3,"file":"dashboardApp.js","sources":["../../src/common/client.js","../../src/common/misc.js","../../src/common/legacySchema.js","../../src/common/idb.js","../../src/common/fetcher.js","../../src/common/mapper.js","../../src/common/collection.js","../../src/common/file.js","../../src/common/specs.js","../../src/component/badge.js","../../src/component/button.js","../../src/component/modal.js","../../src/component/tree.js","../../src/component/formBox.js","../../src/component/shape.js","../../src/component/formListBox.js","../../src/dialog/search.js","../../src/dialog/formGroup.js","../../src/dialog/struct.js","../../src/dialog/filter.js","../../src/dialog/sdf.js","../../src/dialog/rename.js","../../src/datagrid/component.js","../../src/datagrid/rowFactory.js","../../src/common/image.js","../../src/datagrid/state.js","../../src/datagrid/rowFilter.js","../../src/datagrid/sort.js","../../src/datagrid/table.js","../../src/dashboardApp.js"],"sourcesContent":["\n/** @module common/client */\n\nimport _ from 'lodash';\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\nfunction compatibility() {\n  try {\n    () => {};\n  } catch (err) {\n    return 'Client compatibility error: Arrow function not supported';\n  }\n  try {\n    FormData;\n  } catch (err) {\n    return 'Client compatibility error: FormData not supported';\n  }\n  try {\n    fetch;\n  } catch (err) {\n    return 'Client compatibility error: fetch API not supported';\n  }\n}\n\n\nfunction registerServiceWorker() {\n  if ('serviceWorker' in navigator) {\n    if (!debug) {\n      window.addEventListener('load', () => {\n        navigator.serviceWorker.register('../sw.js');  // TODO: root path option\n      });\n    } else {\n      console.info('Service worker is disabled for debugging');\n    }\n  } else {\n    console.info('Service worker is not supported');\n  }\n}\n\nexport default {\n  URLQuery, compatibility, registerServiceWorker\n};\n","\n/** @module common/misc */\n\nimport d3 from 'd3';\n\n\n// TODO: re-define\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  if (['text_field', 'checkbox', 'html'].includes(fmt)) return 'html';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  sortType, formatNum, partialMatch, uuidv4\n};\n","\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: [\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ],\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  data.fields.forEach(e => {\n    if (e.key === 'structure') {\n      e.format = 'svg';\n    }\n    delete e.width;\n    delete e.height;\n  });\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nfunction convertPackage(json) {\n  let specs = {};\n  if (!json.hasOwnProperty('views')) {\n    const now = new Date();\n    const isNW = json.hasOwnProperty('edges');\n    const data = isNW ? convertNetwork(json) : convertTable(json);\n    const nodes = isNW ? data.nodes : data;\n    specs = {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n      name: data.edges.name,\n      views: [],\n      dataset: []\n    };\n    specs.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: nodes.id,\n      name: nodes.name,\n      contents: [{\n        $schema: nodes.$schema,\n        workflowID: nodes.reference.workflow,\n        name: nodes.name,\n        fields: nodes.fields,\n        records: nodes.records,\n        created: nodes.created,\n        status: nodes.status,\n        query: nodes.query,\n        execTime: nodes.execTime,\n        progress: nodes.progress\n      }]\n    });\n    specs.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n      viewID: nodes.id,\n      name: nodes.name,\n      viewType: \"datagrid\",\n      rows: nodes.id,\n      fields: nodes.fields,\n      sortOrder: null,\n      filterText: null,\n      checkpoints: [{\n        type: 'convert',\n        date: now.toString(),\n        description: 'converted from legacy format'\n      }]\n    });\n    if (isNW) {\n      specs.dataset.push({\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: data.edges.id,\n        name: data.edges.name,\n        contents: [{\n          $schema: data.edges.$schema,\n          workflowID: data.edges.reference.workflow,\n          name: data.edges.name,\n          fields: data.edges.fields,\n          records: data.edges.records,\n          created: data.edges.created,\n          status: data.edges.status,\n          query: data.edges.query,\n          execTime: data.edges.execTime,\n          progress: data.edges.progress\n        }]\n      });\n      specs.views.push({\n        $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n        viewID: data.edges.id,\n        name: data.edges.name,\n        viewType: \"network\",\n        nodes: nodes.id,\n        edges: data.edges.id,\n        nodeColor: data.edges.snapshot.nodeColor,\n        nodeSize: data.edges.snapshot.nodeSize,\n        nodeLabel: data.edges.snapshot.nodeLabel,\n        nodeLabelColor: data.edges.snapshot.nodeLabelColor,\n        edgeWidth: data.edges.snapshot.edgeWidth,\n        edgeLabel: data.edges.snapshot.edgeLabel,\n        networkThreshold: data.edges.snapshot.networkThreshold,\n        networkThresholdCutoff: data.edges.snapshot.networkThresholdCutoff,\n        fieldTransform: data.edges.snapshot.fieldTransform,\n        coords: data.edges.snapshot.coords,\n        checkpoints: [{\n          type: 'convert',\n          date: now.toString(),\n          description: 'converted from legacy format'\n        }]\n      });\n    }\n    specs.views.filter(e => e.viewType === 'network')\n      .forEach(view => {\n        view.minConnThld = view.networkThresholdCutoff;\n        view.currentConnThld = view.networkThreshold;\n        if (view.hasOwnProperty('nodeLabel')) {\n          view.nodeLabel.field = view.nodeLabel.text;\n        }\n        if (view.hasOwnProperty('edgeLabel')) {\n          view.edgeLabel.field = 'weight';\n        }\n        if (view.hasOwnProperty('edgeWidth')) {\n          view.edgeWidth.field = 'weight';\n        }\n      });\n  } else {\n    specs = json;\n  }\n  specs.views.filter(e => e.viewType === 'network')\n    .forEach(view => {\n      if (!view.nodeColor.field) { view.nodeColor.field = 'index' ;}\n      if (!view.nodeSize.field) { view.nodeSize.field = 'index' ;}\n      if (!view.nodeLabel.field) { view.nodeLabel.field = 'index' ;}\n      if (!view.nodeLabelColor.field) { view.nodeLabelColor.field = 'index' ;}\n      if (!view.edgeColor) {\n        view.edgeColor = {\n          field: 'weight', color: 'monogray',\n          scale: 'linear', domain: [0, 1],\n          range: ['#999999', '#999999'], unknown: '#cccccc'\n        };\n      } else if (!view.edgeColor.field) { view.edgeColor.field = 'weight' ;}\n      if (!view.edgeWidth.field) { view.edgeWidth.field = 'weight' ;}\n      if (!view.edgeLabel.field) { view.edgeLabel.field = 'weight' ;}\n      if (!view.edgeLabelColor) {\n        view.edgeLabelColor = {\n          field: 'weight', color: 'monoblack',\n          scale: 'linear', domain: [1, 1],\n          range: ['#333333', '#333333'], unknown: '#cccccc'\n        };\n      } else if (!view.edgeLabelColor.field) { view.edgeLabelColor.field = 'weight' ;}\n    });\n  return specs;\n}\n\n\nexport default {\n  convertPackage\n};\n","\n/** @module common/idb */\n\nimport _ from 'lodash';\nimport Dexie from 'Dexie';\n\nimport {default as misc} from './misc.js';\nimport {default as legacy} from './legacySchema.js';\n\n// TODO: need package, view and dataset tables?\nconst schema = {\n  items: 'storeID, sessionStarted'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\n/**\n * Delete all data store\n * Try this before dealing with local db issues\n */\nfunction reset() {\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\n\n/**\n * Returns all data store items\n * @return {array} data store objects\n */\nfunction getAllItems() {\n  return idb.items\n    .orderBy('sessionStarted')\n    .reverse()\n    .toArray();\n}\n\n\n/**\n * Get data store items by store ID\n * @param {string} storeID - store ID\n * @return {array} data store object\n */\nfunction getItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .first()\n    .catch(err => {\n      console.error(`IDBError: Unexpected table ID: ${storeID}`, err);\n    });\n}\n\n\n/**\n * Update data object in the store\n * @param {string} storeID - store ID\n * @param {function} updateFunc - update function\n * @return {integer} - number of updated items\n */\nfunction updateItem(storeID, updateFunc) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .modify(updateFunc)\n    .catch(err => {\n      console.error('IDBError: Update failed', err);\n    });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .delete();\n}\n\n\n/**\n * Returns a view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @return {array} view objects\n */\nfunction getView(storeID, viewID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).views)\n    .then(views => {\n      const view = views.find(e => e.viewID === viewID);\n      if (!view) return;\n      view.storeID = storeID;\n      return view;\n    });\n}\n\n\n/**\n * Append a view next to a specific view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object\n */\nfunction appendView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos + 1, 0, viewObj);\n  });\n}\n\n\n/**\n * Update view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object or update function\n */\nfunction updateView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    if (_.isFunction(viewObj)) {\n      viewObj(item.views[pos]);\n    } else {\n      item.views[pos] = viewObj;\n    }\n  });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteView(storeID, viewID) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos, 1);\n    // prune orphaned collections\n    const bin = {};\n    item.dataset.forEach(e => { bin[e.collectionID] = 0; });\n    item.views.forEach(view => {\n      ['rows', 'items', 'nodes', 'edges']\n        .filter(e => view.hasOwnProperty(e))\n        .forEach(e => { bin[view[e]] += 1; });\n    });\n    Object.entries(bin).forEach(entry => {\n      if (!entry[1]) {\n        const i = item.dataset.findIndex(e => e.collectionID === entry[0]);\n        item.dataset.splice(i, 1);\n      }\n    });\n  });\n}\n\n\n/**\n * Returns all collections in the store\n * @return {array} Collection objects\n */\nfunction getAllCollections() {\n  return getAllItems()\n    .then(items => _.flatten(\n      items.map(item => {\n        return item.dataset.map(coll => {\n          coll.storeID = item.storeID;\n          return coll;\n        });\n      })\n    ));\n}\n\n\n/**\n * Returns a collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @return {array} Collection objects\n */\nfunction getCollection(storeID, collID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).dataset)\n    .then(colls => {\n      const coll = colls.find(e => e.collectionID === collID);\n      if (!coll) return;\n      coll.storeID = storeID;\n      return coll;\n    });\n}\n\n\n/**\n * Update collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @param {object} collObj - Collection object or update function\n */\nfunction updateCollection(storeID, collID, collObj) {\n  return updateItem(storeID, item => {\n    const pos = item.dataset.findIndex(e => e.collectionID === collID);\n    if (_.isFunction(collObj)) {\n      collObj(item.dataset[pos]);\n    } else {\n      item.dataset[pos] = collObj;\n    }\n  });\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - storeID if sucessfully added\n */\nfunction importItem(data) {\n  // Legacy format converter\n  data = legacy.convertPackage(data);\n\n  const now = new Date();\n  data.storeID = misc.uuidv4().slice(0, 8);\n  data.sessionStarted = now.toString();\n  return idb.items.put(data);\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} response - response data\n * @return {string} - viewID if sucessfully added\n */\nfunction newDatagrid(response) {\n  const now = new Date();\n  const date = now.toLocaleString('en-GB', { timeZone: 'Asia/Tokyo'});\n  const storeID = misc.uuidv4().slice(0, 8);\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  const data = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    storeID: storeID,\n    name: response.name,\n    views: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n        viewID: viewID,\n        name: response.name,\n        viewType: \"datagrid\",\n        rows: collectionID,\n        checkpoints: [\n          {type: 'creation', date: date}\n        ]\n      }\n    ],\n    dataset: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: collectionID,\n        name: response.name,\n        contents: [response]\n      }\n    ],\n    sessionStarted: date\n  };\n  return idb.items.put(data)\n    .then(() => ({storeID: storeID, viewID:viewID}));\n}\n\n\n/**\n * Store new network view\n * @param {string} storeID - Store ID\n * @param {string} nodesID - ID of nodes collection\n * @param {string} nodesName - Name of nodes collection\n * @param {object} response - Response object\n */\nfunction newNetwork(storeID, nodesID, nodesName, response) {\n  const viewID = misc.uuidv4().slice(0, 8);\n  const edgesID = response.workflowID.slice(0, 8);\n  return updateItem(storeID, item => {\n    item.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n      viewID: viewID,\n      name: `${nodesName}_${response.name}`,\n      viewType: 'network',\n      nodes: nodesID,\n      edges: edgesID,\n      minConnThld: response.query.params.threshold\n    });\n    item.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: edgesID,\n      name: response.name,\n      contents: [response]\n    });\n  }).then(() => viewID);\n}\n\n\nexport default {\n  reset, getAllItems, getItem, updateItem, deleteItem,\n  getView, appendView, updateView, deleteView,\n  getAllCollections, getCollection, updateCollection,\n  importItem, newDatagrid, newNetwork\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '../req/';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\nfunction serverStatus() {\n  const response = {};\n  return get('server')\n    .then(json)\n    .then(res => {\n      response.server = res;\n    })\n    .then(() => get('schema'))\n    .then(json)\n    .then(res => {\n      response.schema = res;\n    })\n    .then(() => response);\n}\n\n\nexport default {\n  get, json, text, blob, post, error, serverStatus\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: [keyField].concat(mp.fields),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: table.fields.filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key)),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: fields,\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(mp.fields)\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module common/collection */\n\nimport _ from 'lodash';\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as mapper} from './mapper.js';\n\n\nexport default class Collection {\n  /**\n   * Create Collection from a flashflood response datatable\n   * If data is not specified, put datatables later by this.append(data)\n   * @param {object} coll - Collection or response object\n   */\n  constructor(coll) {\n    // Settings\n    this.autoIndex = 'index';  // enumerate records\n\n    this.collectionID = coll.collectionID || null;\n    this.storeID = coll.storeID || null;\n    this.name = coll.name || null;\n    if (coll.records) {\n      this.contents = [coll];\n      this.fields = [];\n    } else {\n      this.contents = coll.contents;\n      this.fields = coll.fields || [];\n    }\n    this.contents.forEach(content => {\n      content.fields.forEach(e => this.addField(e));\n    });\n  }\n\n  /**\n   * Add fields\n   * @param {array} fs - list of fields\n   */\n  addField(field) {\n    if (this.fields.find(e => e.key === field.key)) return;\n    if (!field.hasOwnProperty('name')) field.name = field.key;\n    if (!field.hasOwnProperty('visible')) field.visible = true;\n    if (field.hasOwnProperty('d3_format')) field.format = 'd3_format';\n    if (!field.hasOwnProperty('format')) field.format = 'raw';\n    this.fields.push(field);\n  }\n\n  /**\n   * Update fields properties\n   * @param {array} fs - list of fields\n   */\n  updateFields(fs) {\n    this.fields = [];\n    fs.forEach(e => this.addField(e));\n  }\n\n  /**\n   * Join fields\n   * @param {object} mapping - column mapper object\n   */\n  joinFields(mapping) {\n    this.contents.forEach(c => {\n      mapper.apply(c, mapping);\n    });\n    if (mapping.hasOwnProperty('fields')) {\n      mapping.fields.forEach(e => this.addField(e));\n    } else {\n      this.addField(mapping.field);\n    }\n  }\n\n  /**\n   * Apply function to the original data records\n   * new fields should be manually added by Collection.addField\n   * @param {function} func - function to be applied\n   */\n  apply(func) {\n    this.contents.forEach(content => {\n      content.records.forEach(rcd => {\n        func(rcd);\n      });\n    });\n  }\n\n  /**\n   * Return all records of the collection\n   * @return {array} records\n   */\n  records() {\n    return _.flatten(this.contents.map(e => e.records));\n  }\n\n  fetch(command) {\n    const fs = this.contents\n      .filter(e => ['running', 'ready', 'interrupted', 'queued'].includes(e.status))\n      .map(content => {\n        const query = {id: content.workflowID, command: command};\n        return fetcher.get('progress', query)\n          .then(fetcher.json)\n          .then(data => {\n            return idb.updateCollection(this.storeID, this.collectionID, coll => {\n              const i = coll.contents\n                .findIndex(e => e.workflowID === query.id);\n              if (data.status === 'failure') {  // No data found on server\n                coll.contents[i].status = 'failure';\n              } else {\n                coll.contents[i] = data;\n              }\n            });\n          });\n      });\n    return Promise.all(fs)\n      .then(() => idb.getCollection(this.storeID, this.collectionID))\n      .then(coll => {\n        this.contents = coll.contents;\n      });\n  }\n\n  /**\n   * Retrieve workflows and store it into a local store.\n   * @return {Promise}\n   */\n  pull() {\n    return this.fetch('pull');\n  }\n\n  /**\n   * Retrieve workflows, abort all ongoing workflow task\n   * and store it into a local store.\n   * @return {Promise}\n   */\n  abort() {\n    return this.fetch('abort');\n  }\n\n  /**\n   * Return total number of records\n   * @return {float} total number of records\n   */\n  size() {\n    return _.sum(this.contents.map(e => e.records.length));\n  }\n\n  /**\n   * Return status\n   * @return {string} status\n   */\n  status() {\n    if (this.contents.some(e => e.status === 'interrupted')) return 'interrupted';\n    if (this.contents.some(e => e.status === 'running')) return 'running';\n    if (this.contents.some(e => e.status === 'queued')) return 'queued';\n    if (this.contents.some(e => e.status === 'ready')) return 'ready';\n    if (this.contents.some(e => e.status === 'aborted')) return 'aborted';\n    if (this.contents.some(e => e.status === 'failure')) return 'failure';\n    return 'done';\n  }\n\n  /**\n   * Return ongoing or not\n   * @return {bool} ongoing or not\n   */\n  ongoing() {\n    const s = ['ready', 'queued', 'running', 'interrupted'];\n    return s.includes(this.status());\n  }\n\n  /**\n   * Return percentage of workflow progress\n   * @return {float} progress in percent\n   */\n  progress() {\n    return _.min(this.contents.map(e => e.progress));\n  }\n\n  /**\n   * Return total execution time\n   * @return {float} total time\n   */\n  execTime() {\n    return _.sum(this.contents.map(e => e.execTime));\n  }\n\n  /**\n   * Export collection object as JSON\n   * @return {object} collection JSON\n   */\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: this.collectionID,\n      name: this.name,\n      fields: this.fields,\n      contents: this.contents\n    };\n  }\n}\n","\n/** @module common/file */\n\nimport pako from 'pako';\n\n\nfunction readFile(file, sizeLimit, blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    const truncated = sizeLimit ? file.slice(0, sizeLimit) : file;\n    reader.onload = event => resolve(event.target.result);\n    reader.onerror = error => reject(error);\n    if (blob) {\n      reader.readAsArrayBuffer(truncated);\n    } else {\n      reader.readAsText(truncated);\n    }\n  });\n}\n\n\nfunction parseJSON(data, compressed) {\n  const text = compressed ? pako.inflate(data, {to: 'string'}) : data;\n  return JSON.parse(text);\n}\n\n\nfunction loadJSON(file) {\n  const compressed = file.name.endsWith('c') || file.name.endsWith('.gz');\n  return readFile(file, false, compressed)\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction fetchJSON(url) {\n  const decoded = decodeURIComponent(url);\n  const compressed = decoded.endsWith('c') || decoded.endsWith('.gz');\n  return fetch(decoded)\n    .then(res => compressed ? res.arrayBuffer() : res.json())\n    .then(data => parseJSON(data, compressed));\n}\n\n\nfunction downloadDataFile(data, name) {\n  try {\n    // cannot hundle large file with dataURI scheme\n    // url = 'data:application/json,' + encodeURIComponent(JSON.stringify(json))\n    const url = window.URL.createObjectURL(new Blob([data]));\n    const a = document.createElement('a');\n    a.download = name;\n    a.href = url;\n    // a.click() does not work on firefox\n    a.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': true,\n      'cancelable': false\n    }));\n    // window.URL.revokeObjectURL(url) does not work on firefox\n  } catch (e) {\n    // no DOM (unit testing)\n  }\n}\n\n\nfunction downloadJSON(json, name, compress=true) {\n  const str = JSON.stringify(json);\n  const data = compress ? pako.gzip(str) : str;\n  const ext = `.ap${compress ? 'c' : 'r'}`;\n  downloadDataFile(data, `${name}${ext}`);\n}\n\n\nexport default {\n  readFile, parseJSON, loadJSON, fetchJSON,\n  downloadDataFile, downloadJSON\n};\n","\n/** @module common/specs */\n\nimport _ from 'lodash';\n\n\n/**\n * Retern if the package has running tasks\n * @param {object} specs - package JSON\n * @return {bool} if there are any ongoing tasks\n */\nfunction isRunning(specs) {\n  return specs.dataset.some(coll => {\n    return coll.contents.some(e => {\n      return ['ready', 'queued', 'running', 'interrupted'].includes(e.status);\n    });\n  });\n}\n\n\nexport default {\n  isRunning\n};\n","\n/** @module component/badge */\n\nimport d3 from 'd3';\n\nconst assetBaseURL = '../assets/';\nconst iconBaseURL = '../assets/icon/';\n\n\nfunction icon(selection, icon) {\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1rem')\n      .style('height', '1rem');\n}\n\n\nfunction badge(selection) {\n  const body = selection\n      .classed('badge', true);\n  body.append('img')\n      .classed('icon', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  body.append('span')\n      .classed('text', true);\n}\n\n\nfunction updateBadge(selection, text, type, icon) {\n  selection.classed(`badge-${type}`, true);\n  selection.select('.icon')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null);\n  selection.select('.text')\n      .text(text);\n}\n\n\nfunction notify(selection) {\n  selection\n    .style('opacity', 0)\n    .style('display', 'inline')\n    .transition()\n      .duration(500)\n      .ease(d3.easeLinear)\n      .style(\"opacity\", 1.0)\n    .transition()\n      .delay(3000)\n      .duration(1000)\n      .ease(d3.easeLinear)\n      .style(\"opacity\", 0)\n      .on('end', function () {\n        selection.style('display', 'none');\n      });\n}\n\n\nfunction loadingCircle(selection) {\n  selection.append('img')\n      .attr('src', `${assetBaseURL}loading1.gif`)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.style('display', 'none');\n}\n\n\nfunction alert(selection) {\n  const body = selection\n      .classed('alert', true)\n      .classed('px-1', true)\n      .classed('py-0', true);\n  body.append('img')\n      .classed('icon', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  body.append('span')\n      .classed('text', true)\n      .style('font-size', '75%');\n}\n\n\nfunction updateAlert(selection, text, type, icon) {\n  selection.classed(`alert-${type}`, true);\n  selection.select('.icon')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null);\n  selection.select('.text')\n      .text(text);\n}\n\n\nexport default {\n  icon, badge, updateBadge, notify, loadingCircle,\n  alert, updateAlert\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\nconst iconBaseURL = '../assets/icon/';\n\n\nfunction buttonBox(selection, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .text(label);\n}\n\n\nfunction menuButton(selection, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, label, type, icon) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, target, label, type, icon) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('href', '#')\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('label', true)\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, label, type, icon) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  const button = selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  button.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  button.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, label, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, label, target, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', `${iconBaseURL}${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, label, accept, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#')\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      });\n  selection.append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n  selection.append('img')\n      .attr('src', `${iconBaseURL}${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  iconBaseURL, buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module component/modal */\n\nimport d3 from 'd3';\n\n\nfunction dialogBase(selection, id) {\n  selection\n      .classed('modal', true)\n      .attr('tabindex', -1)\n      .attr('role', 'dialog')\n      .attr('aria-labelledby', '')\n      .attr('aria-hidden', true)\n      .attr('id', id);\n  selection.append('div')\n      .classed('modal-dialog', true)\n      .attr('role', 'document')\n    .append('div')\n      .classed('modal-content', true);\n}\n\n\nfunction confirmDialog(selection, id) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // body\n  base.append('div')\n      .classed('modal-body', true)\n    .append('div')\n      .classed('message', true);\n  // footer\n  const footer = base.append('div')\n      .classed('modal-footer', true);\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-outline-secondary', true)\n      .classed('cancel', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Cancel');\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-warning', true)\n      .classed('ok', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('OK')\n      .on('click', () => {\n        selection.dispatch('submit');\n      });\n}\n\n\nfunction updateConfirmDialog(selection, message) {\n  selection.select('.message').text(message);\n}\n\n\nfunction submitDialog(selection, id, title) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // header\n  const header = base.append('div')\n      .classed('modal-header', true);\n  header.append('h4')\n      .classed('modal-title', true)\n      .text(title);\n  header.append('button')\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('aria-label', 'Close')\n      .classed('close', true)\n    .append('span')\n      .attr('aria-hidden', true)\n      .html('&times;');\n  // body\n  base.append('div')\n      .classed('modal-body', true);\n  // footer\n  base.append('div')\n      .classed('modal-footer', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-primary', true)\n      .classed('submit', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Submit')\n      .on('click', () => {\n        // Dismiss before submit\n        // Submit event can update the modal itself\n        // (ex. disable submit button before onSubmit call has completed)\n        $(`#${id}`).modal('hide');\n        selection.dispatch('submit');\n      });\n}\n\n\nexport default {\n  confirmDialog, updateConfirmDialog, submitDialog\n};\n","\n/** @module component/tree */\n\nimport d3 from 'd3';\n\n\nfunction nextLevel(selection, node, nodeFactory) {\n  node.children.forEach(child => {\n    const item = selection.append('li').datum(child.data);  // Bind data record\n    const content = item.append('span')\n      .style('display', 'inline-block');\n    const arrow = child.hasOwnProperty('children') ? '▼ ' : '';\n    content.append('span')\n        .classed('arrow', true)\n        .text(arrow);\n    content.call(nodeFactory, child.data);\n\n    // Collapse on click\n    content.select('.arrow')\n      .on('click', function () {\n        const childList = item.select('ul');\n        if (!childList.size()) return;\n        const expanded = childList.style('display') !== 'none';\n        content.select('.arrow').text(expanded ? '▶ ' : '▼ ');\n        childList.style('display', expanded ? 'none' : 'inherit');\n      });\n\n    // Search next level\n    if (!child.hasOwnProperty('children')) return;\n    item.append('ul')\n        .style('list-style-type', 'none')\n        .call(nextLevel, child, nodeFactory);\n  });\n}\n\n\n // Generate tree view\nfunction tree(selection) {\n  selection\n      .classed('viewport', true)\n      .style('overflow-y', 'scroll')\n      .style('height', '400px')\n    .append('div')\n      .classed('body', true);\n}\n\n\n// Generate tree view\nfunction setHeight(selection, height) {\n  selection.style('height', `${height}px`);\n}\n\n\n// Update tree data\nfunction treeItems(selection, items, keyFunc, nodeFactory) {\n  const root = d3.stratify()\n      .id(keyFunc)\n      .parentId(d => d.parent)(items);\n  selection.select('ul').remove();\n  if (!root.hasOwnProperty('children')) return;\n  selection.select('.body').append('ul')\n      .classed('root', true)\n      .style('padding-left', 0)\n      .style('list-style-type', 'none')\n      .call(nextLevel, root, nodeFactory);\n  selection.selectAll('ul.root > li')\n      .classed('my-2', true);\n}\n\n\n/**\n* Node content\n* @param {d3.selection} selection - selection of node content (span element)\n*/\nfunction checkboxNode(selection, item) {\n  selection.append('input')\n      .attr('type', 'checkbox');\n  selection.append('span')\n      .text(item.id);\n}\n\n\n/**\n * Return list of checkbox values\n * @param {d3.selection} selection - selection of node content (span element)\n */\nfunction checkboxValues(selection) {\n  return selection.select('.body')\n    .selectAll('input:checked').data().map(d => d.id);\n}\n\n\nexport default {\n  tree, treeItems, setHeight, checkboxNode, checkboxValues\n};\n","\n/** @module component/formBox */\n\n\nimport d3 from 'd3';\n\n\nfunction textBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text');\n}\n\nfunction updateTextBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction textBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction readonlyBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .attr('readonly', 'readonly');\n}\n\n\nfunction textareaBox(selection, label, rows) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows);\n}\n\nfunction updateTextareaBox(selection, value) {\n  selection.select('textarea').property('value', value);\n}\n\nfunction updateTextareaPlaceholder(selection, placeholder) {\n  selection.select('textarea').attr('placeholder', placeholder);\n}\n\nfunction textareaBoxValue(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value;  // TODO: 0 is falsy\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder;\n  return '';\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n').filter(e => e.length > 0);\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder.split('\\n').filter(e => e.length > 0);\n  return [];\n}\n\n\nfunction checkBox(selection, label) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox');\n  box.append('span')\n      .text(label);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, label, min, max, step) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'number')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step);\n}\n\nfunction updateNumberBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction numberIntValid(selection) {\n  const value = numberBoxIntValue(selection);\n  const min = parseInt(selection.select('input').attr('min'));\n  const max = parseInt(selection.select('input').attr('max'));\n  const valid = !isNaN(value) && value >= min && value <= max;\n  selection.select('input')\n      .style('background-color', valid ? '#ffffff' : '#ffcccc');\n  return valid;\n}\n\nfunction numberFloatValid(selection) {\n  const value = numberBoxFloatValue(selection);\n  const min = parseInt(selection.select('input').attr('min'));\n  const max = parseInt(selection.select('input').attr('max'));\n  const valid = !isNaN(value) && value >= min && value <= max;\n  selection.select('input')\n      .style('background-color', valid ? '#ffffff' : '#ffcccc');\n  return valid;\n}\n\nfunction numberBoxIntValue(selection) {\n  return parseInt(selection.select('input').property('value'));\n}\n\nfunction numberBoxFloatValue(selection) {\n  return parseFloat(selection.select('input').property('value'));\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n    .append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'color');\n}\n\n\nfunction updateColorBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\n\nfunction colorBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction fileInputBox(selection, label, accept) {\nselection\n    .classed('form-group', true)\n    .classed('form-row', true);\nselection.append('label')\n    .classed('col-form-label', true)\n    .classed('col-form-label-sm', true)\n    .classed('col-4', true)\n    .text(label);\nselection.append('input')\n    .classed('form-control', true)\n    .classed('form-control-sm', true)\n    .classed('form-control-file', true)\n    .classed('col-8', true)\n    .attr('type', 'file')\n    .attr('accept', accept);\n}\n\nfunction clearFileInput(selection) {\n  // TODO: FileList object (input.files) may be a readonly property\n  const accept = selection.select('input').attr();\n  selection.select('input').remove();\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('form-control-file', true)\n      .classed('col-8', true)\n      .attr('type', 'file')\n      .attr('accept', accept);\n}\n\nfunction fileInputBoxValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\n\nexport default {\n  textBox, updateTextBox, textBoxValue, readonlyBox,\n  textareaBox, updateTextareaBox, updateTextareaPlaceholder,\n  textareaBoxValue, textareaBoxLines,\n  checkBox, updateCheckBox, checkBoxValue,\n  numberBox, updateNumberBox, numberIntValid, numberFloatValid,\n  numberBoxIntValue, numberBoxFloatValue,\n  colorBox, updateColorBox, colorBoxValue,\n  fileInputBox, clearFileInput, fileInputBoxValue\n};\n","\n/** @module component/shape */\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction monocolorBar(selection, colors, text) {\n  selection.attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none');\n  const group = selection.append('g');\n  group.append('rect')\n      .attr('x', 0).attr('y', 0)\n      .attr('width', 100).attr('height', 10)\n      .attr('fill', colors[0]);\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 10)\n      .attr('font-size', 12)\n      .text(text);\n}\n\nfunction bicolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n      .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n      .attr('offset', 1).attr('stop-color', colors[1]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction tricolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n    .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n    .attr('offset', 0.5).attr('stop-color', colors[1]);\n  grad.append('stop')\n    .attr('offset', 1).attr('stop-color', colors[2]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction categoricalBar(selection, colors, text) {\n  selection.attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none');\n  const sw = 100 / colors.length;\n  const group = selection.append('g');\n  colors.forEach((e, i) => {\n    group.append('rect')\n        .attr('x', sw * i).attr('y', 0)\n        .attr('width', sw).attr('height', 20)\n        .attr('fill', colors[i]);\n  });\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 20)\n      .attr('font-size', 20)\n      .text(text);\n}\n\nfunction setSize(selection, width, height) {\n  selection.attr('width', width).attr('height', height);\n}\n\n\nconst colorBar = {\n  'monocolor': monocolorBar,\n  'bicolor': bicolorBar,\n  'tricolor': tricolorBar,\n  'categorical': categoricalBar,\n  'custom': monocolorBar\n};\n\n\nexport default {\n  colorBar, setSize\n};\n","\n/** @module component/formListBox */\n\nimport d3 from 'd3';\n\nimport {default as shape} from './shape.js';\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction selectBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('select')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n}\n\nfunction selectBoxItems(selection, items) {\n  const options = selection.select('select')\n    .selectAll('option')\n      .data(items, d => d.key);\n  options.exit().remove();\n  options.enter()\n    .append('option')\n      .attr('value', d => d.key)\n      .text(d => d.name);\n}\n\nfunction updateSelectBox(selection, value) {\n  selection.select('select').property('value', value);\n}\n\nfunction selectBoxValue(selection) {\n  return selection.select('select').property('value');\n}\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction checklistBox(selection, label) {\n  // TODO: scroll\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('ul')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n}\n\nfunction checklistBoxItems(selection, items) {\n  const listitems = selection.select('ul')\n    .selectAll('li')\n      .data(items, d => d.key);\n  listitems.exit().remove();\n  const form = listitems.enter()\n    .append('li')\n      .attr('class', 'form-check')\n    .append('label')\n      .attr('class', 'form-check-label');\n  form.append('input')\n      .attr('type', 'checkbox')\n      .attr('class', 'form-check-input')\n      .property('value', d => d.key);\n  form.append('span')\n      .text(d => d.name);\n}\n\nfunction updateChecklistBox(selection, values) {\n  if (!values) return;\n  selection.selectAll('input')\n    .each(function (d) {\n      d3.select(this).property('checked', values.includes(d.key));\n    });\n}\n\nfunction checklistBoxValue(selection) {\n  return selection.selectAll('input:checked').data().map(d => d.key);\n}\n\nfunction anyChecked(selection) {\n  return checklistBoxValue(selection).length > 0;\n}\n\n\nfunction colorScaleBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label || 'Colorscale');\n  const form = selection.append('div')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n  const dropdown = form.append('div')\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  dropdown.append('button')\n      .classed('btn', true)\n      .classed(`btn-light`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  dropdown.append('div')\n      .classed('dropdown-menu', true)\n      .classed('py-0', true);\n  form.append('span')\n      .classed('selected', true);\n}\n\nfunction colorScaleBoxItems(selection, items) {\n  const listitems = selection.select('.dropdown-menu')\n    .selectAll('a')\n      .data(items, d => d);\n  listitems.exit().remove();\n  listitems.enter()\n    .append('a')\n      .classed('dropdown-item', true)\n      .classed('py-0', true)\n      .attr('href', '#')\n      .attr('title', d => d.key)\n      .on('click', function (d) {\n        selection.call(setSelectedColorScale, d);\n        selection.dispatch('change', {bubbles: true});\n      })\n    .append('svg')\n      .each(function (d) {\n        d3.select(this)\n          .call(shape.colorBar[d.type], d.colors, d.text)\n          .call(shape.setSize, 100, 10);\n      });\n}\n\nfunction setSelectedColorScale(selection, item) {\n  const selected = selection.select('.selected');\n  selected.selectAll('svg').remove();\n  selected.datum(item);  // Bind selected item record\n  selected.append('svg')\n      .call(shape.colorBar[item.type], item.colors, item.text)\n      .call(shape.setSize, 100, 10);\n}\n\nfunction updateColorScaleBox(selection, key) {\n  const data = selection.select('.dropdown-menu')\n    .selectAll('a').data();\n  const item = data.find(e => e.key === key);\n  selection.call(setSelectedColorScale, item);\n}\n\nfunction colorScaleBoxValue(selection) {\n  return selection.select('.selected').datum().key;\n}\n\nfunction colorScaleBoxItem(selection) {\n  return selection.select('.selected').datum();\n}\n\n\nexport default {\n  selectBox, selectBoxItems, updateSelectBox, selectBoxValue,\n  checklistBox, checklistBoxItems, updateChecklistBox, checklistBoxValue,\n  anyChecked,\n  colorScaleBox, colorScaleBoxItems, updateColorScaleBox,\n  colorScaleBoxValue, colorScaleBoxItem\n};\n","\n/** @module dialog/search */\n\nimport d3 from 'd3';\nimport _ from 'lodash';\n\nimport {default as fetcher} from '../common/fetcher.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'search-dialog';\nconst title = 'Search by compound ID';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-searchtext');\n}\n\n\nfunction body(selection) {\n  const mbody = selection.call(modal.submitDialog, id, title)\n    .select('.modal-body');\n  mbody.append('div')\n      .classed('field', true)\n      .call(lbox.selectBox, 'Field');\n  mbody.append('div')\n      .classed('query', true)\n      .call(box.textareaBox, 'Query', 20);\n}\n\n\nfunction updateBody(selection, resources, placeholder) {\n  const fields = _(resources.map(e => e.fields))\n    .flatten()\n    .uniqBy('key')\n    .value()\n    .filter(e => e.hasOwnProperty('d3_format')\n                 || ['compound_id', 'numeric', 'text'].includes(e.format));\n  const def = fields.find(e => e.format === 'compound_id') || fields[0];\n  selection.select('.field')\n      .call(lbox.selectBoxItems, fields)\n      .call(lbox.updateSelectBox, def.key);\n  selection.select('.query')\n      .call(box.updateTextareaBox, '')\n      .call(box.updateTextareaPlaceholder, placeholder)\n      .on('input', function() {  // Validation\n        const values = box.textareaBoxLines(d3.select(this));\n        selection.select('.submit').property('disabled', !values.length);\n      });\n}\n\n\nfunction execute(selection, resources) {\n  const query = {\n    workflow: 'search',\n    targets: resources.map(e => e.id),  // All DBs\n    key: lbox.selectBoxValue(selection.select('.field')),\n    values: box.textareaBoxLines(selection.select('.query'))\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json);\n}\n\n\nexport default {\n  menuLink, body, updateBody, execute\n};\n","\n/** @module dialog/formGroup */\n\nimport d3 from 'd3';\n\nimport {default as fetcher} from '../common/fetcher.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\n\n\n/**\n * Render color range control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction queryMolGroup(selection) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('format', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Format')\n      .call(lbox.selectBoxItems,\n            [\n              {key: 'molfile', name: 'MDL Molfile'},\n              {key: 'dbid', name: 'Compound ID'}\n            ]);\n  selection.append('div')\n      .classed('source', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Source');\n  selection.append('div')\n      .classed('textquery', true)\n      .classed('mb-1', true)\n      .call(box.textBox, 'Query');\n  selection.append('div')\n      .classed('areaquery', true)\n      .classed('mb-1', true)\n      .call(box.textareaBox, 'Query', 6, null);\n  // Popover\n  $(function () {\n    $('[data-toggle=\"popover\"]')\n      .popover({html: true, trigger: 'focus'});\n  });\n  selection.append('div')\n      .classed('form-row', true)\n      .classed('justify-content-end', true)\n    .append('button')\n      .classed('preview', true)\n      .attr('data-toggle', 'popover')\n      .attr('data-html', 'true')\n      .attr('data-content', '<div id=\"previmg\"></div>')\n      .call(button.menuButton, 'Structure preview', 'primary');\n}\n\nfunction updateQueryMolGroup(selection, resources) {\n  selection.select('.format')\n      .call(lbox.updateSelectBox, 'molfile')\n      .on('change', function () {\n        const value = lbox.selectBoxValue(d3.select(this));\n        selection.select('.source')\n          .select('select')\n            .property('disabled', value !== 'dbid');\n        selection.select('.textquery')\n            .property('hidden', value !== 'dbid');\n        selection.select('.areaquery')\n            .property('hidden', value !== 'molfile');\n      })\n      .dispatch('change');\n  const res = resources.map(d => ({key: d.id, name: d.name}));\n  selection.select('.source')\n      .call(lbox.selectBoxItems, res)\n      .call(lbox.updateSelectBox, null);\n  selection.select('.preview')\n      .on('click', function () {\n        const query = queryMolGroupValue(selection);\n        return fetcher.get('strprev', query)\n          .then(fetcher.text)\n          .then(res => d3.select('#previmg').html(res), fetcher.error);\n      });\n  selection.select('.textquery')\n      .call(box.updateTextBox, '')\n      .on('input', function() {\n        selection.dispatch('validate');\n      });\n  selection.select('.areaquery')\n      .call(box.updateTextareaBox, '')\n      .on('input', function() {\n        selection.dispatch('validate');\n      });\n}\n\nfunction queryMolGroupValue(selection) {\n  const format = lbox.selectBoxValue(selection.select('.format'));\n  const source = lbox.selectBoxValue(selection.select('.source'));\n  const textquery = box.textBoxValue(selection.select('.textquery'));\n  const areaquery = box.textareaBoxLines(selection.select('.areaquery'));\n  return {\n    format: format,\n    source: format === 'dbid' ? source : null,\n    value: format === 'molfile' ? areaquery : textquery\n  };\n}\n\nfunction queryMolGroupValid(selection) {\n  const format = lbox.selectBoxValue(selection.select('.format'));\n  const textquery = box.textBoxValue(selection.select('.textquery'));\n  const areaquery = box.textareaBoxLines(selection.select('.areaquery'));\n  return format === 'molfile' ? areaquery.length : textquery !== '';\n}\n\n\nfunction simOptionGroup(selection) {\n  const id = misc.uuidv4().slice(0, 8);\n  selection\n      .classed('mb-3', true)\n    .append('p')\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-sm', true)\n      .classed('btn-outline-primary', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'collapse')\n      .attr('data-target', `#${id}-collapse`)\n      .attr('aria-expanded', 'false')\n      .attr('aria-controls', `${id}-collapse`)\n      .text('Optional parameters');\n  const collapse = selection.append('div')\n      .classed('collapse', true)\n      .attr('id', `${id}-collapse`)\n    .append('div')\n      .classed('card', true)\n      .classed('card-body', true);\n  collapse.append('div')\n      .classed('ignoreh', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Ignore explicit hydrogens');\n  collapse.append('div')\n      .classed('timeout', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Timeout', 1, 999, 1);\n  collapse.append('div')\n      .classed('diam', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Diameter (MCS-DR/GLS)', 4, 999, 1);\n  collapse.selectAll('label.col-form-label')\n      .classed('col-4', false)\n      .classed('col-6', true);\n  collapse.selectAll('input.form-control')\n      .classed('col-8', false)\n      .classed('col-6', true);\n}\n\n\nfunction updateSimOptionGroup(selection) {\n  selection.select('.ignoreh')\n      .call(box.updateCheckBox, true);\n  selection.select('.timeout')\n      .call(box.updateNumberBox, 2);\n  selection.select('.diam')\n      .call(box.updateNumberBox, 8);\n}\n\n\nfunction simOptionGroupValue(selection) {\n  const timeout = selection.select('.timeout');\n  const diam = selection.select('.diam');\n  const query = {\n    ignoreHs: box.checkBoxValue(selection.select('.ignoreh'))\n  };\n  if (!timeout.select('input').property('disabled')) {\n    query.timeout = box.numberBoxIntValue(timeout);\n  }\n  if (!diam.select('input').property('disabled')) {\n    query.diameter = box.numberBoxIntValue(diam);\n  }\n  return query;\n}\n\n\nexport default {\n  queryMolGroup, updateQueryMolGroup, queryMolGroupValue, queryMolGroupValid,\n  simOptionGroup, updateSimOptionGroup, simOptionGroupValue\n};\n","\n/** @module dialog/struct */\n\nimport d3 from 'd3';\n\nimport {default as fetcher} from '../common/fetcher.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\nimport {default as group} from './formGroup.js';\n\n\nconst id = 'struct-dialog';\nconst title = 'Search by structure';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-searchchem');\n}\n\n\nfunction body(selection) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n  // Query molecule\n  dialog.select('.modal-body').append('div')\n      .classed('qmol', true)\n      .call(group.queryMolGroup);\n  dialog.select('.modal-body').append('div')\n      .classed('method', true)\n      .call(lbox.selectBox, 'Method');\n  // Measure\n  dialog.select('.modal-body').append('div')\n      .classed('measure', true)\n      .call(lbox.selectBox, 'Measure')\n      .call(lbox.selectBoxItems, [\n              {key: 'sim', name: 'Similarity'},\n              {key: 'edge', name: 'Edge count'}\n            ]);\n  // Threshold\n  dialog.select('.modal-body').append('div')\n      .classed('thld', true)\n      .call(box.numberBox, 'Threshold', 0.5, 1, 0.01);\n  // Similarity search options\n  dialog.select('.modal-body').append('div')\n      .classed('option', true)\n      .call(group.simOptionGroup);\n  // Targets\n  dialog.select('.modal-body').append('div')\n      .classed('target', true)\n      .call(lbox.checklistBox, 'Target databases');\n}\n\n\nfunction updateBody(selection, resources, rdk) {\n  selection.select('.qmol')\n      .call(group.updateQueryMolGroup, resources);\n  // Search type\n  const methodList = [\n    {key: 'exact', name: 'Exact match'},\n    {key: 'substr', name: 'Substructure'},\n    {key: 'supstr', name: 'Superstructure'},\n    {key: 'gls', name: 'MCS-DR/GLS'}\n  ];\n  if (rdk) {\n    methodList.push({key: 'rdmorgan', name: 'RDKit Morgan similarity'});\n    methodList.push({key: 'rdfmcs', name: 'RDKit FMCS'});\n  }\n  selection.select('.method')\n      .call(lbox.selectBoxItems, methodList)\n      .call(lbox.updateSelectBox, 'exact')\n      .on('change', function () {\n        const value = lbox.selectBoxValue(d3.select(this));\n        const mcs = ['gls', 'rdfmcs'].includes(value);\n        selection.select('.measure')\n          .select('select')\n            .property('value', mcs ? undefined : 'sim')\n            .property('disabled', !mcs);\n        selection.selectAll('.thld')\n          .select('input')\n            .property('disabled', ['exact', 'substr', 'supstr'].includes(value));\n        selection.selectAll('.diam')\n          .select('input')\n            .property('disabled', value !== 'gls');\n        selection.select('.timeout')\n          .select('input')\n            .property('disabled', !mcs);\n      })\n      .dispatch('change');\n  selection.select('.measure')\n      .call(lbox.updateSelectBox, 'sim');\n  selection.select('.thld')\n      .call(box.updateNumberBox, 0.5);\n  selection.select('.option')\n      .call(group.updateSimOptionGroup, 'struct');\n  const res = resources.map(d => ({key: d.id, name: d.name}));\n  selection.select('.target')\n      .call(lbox.checklistBoxItems, res)\n      .call(lbox.updateChecklistBox, null)\n      .on('change', function() {\n        d3.select(this).dispatch('validate');\n      });\n  // Input validation\n  selection.selectAll('.qmol,.target')\n      .on('validate', function () {\n        const qmolValid = group.queryMolGroupValid(selection.select('.qmol'));\n        const targetChecked = lbox.anyChecked(selection.select('.target'));\n        selection.select('.submit')\n          .property('disabled', !(qmolValid && targetChecked));\n      })\n      .dispatch('validate');\n}\n\n\nfunction execute(selection) {\n  const params = group.simOptionGroupValue(selection.select('.option'));\n  const measure = selection.select('.measure');\n  const thld = selection.select('.thld');\n  if (!measure.select('select').property('disabled')) {\n    params.measure = lbox.selectBoxValue(measure);\n  }\n  if (!thld.select('input').property('disabled')) {\n    params.threshold = box.numberBoxFloatValue(thld);\n  }\n  const query = {\n    workflow: lbox.selectBoxValue(selection.select('.method')),\n    targets: lbox.checklistBoxValue(selection.select('.target')),\n    queryMol: group.queryMolGroupValue(selection.select('.qmol')),\n    params: params\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json);\n}\n\n\nexport default {\n  menuLink, body, updateBody, execute\n};\n","\n/** @module dialog/filter */\n\nimport _ from 'lodash';\nimport d3 from 'd3';\n\nimport {default as fetcher} from '../common/fetcher.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'filter-dialog';\nconst title = 'Search by properties';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-searchprop');\n}\n\n\nfunction body(selection) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n  dialog.select('.modal-body').append('div')\n      .classed('key', true)\n      .call(lbox.selectBox, 'Field');\n  dialog.select('.modal-body').append('div')\n      .classed('operator', true)\n      .call(lbox.selectBox, 'Operator')\n      .call(lbox.selectBoxItems, [\n              {key: 'eq', name: '='},\n              {key: 'gt', name: '>'},\n              {key: 'lt', name: '<'},\n              {key: 'ge', name: '>='},\n              {key: 'le', name: '>='},\n              {key: 'lk', name: 'LIKE'}\n            ]);\n  dialog.select('.modal-body').append('div')\n      .classed('value', true)\n      .call(box.textBox, 'Value');\n  // Targets\n  dialog.select('.modal-body').append('div')\n      .classed('target', true)\n      .call(lbox.checklistBox, 'Target databases');\n}\n\n\nfunction updateBody(selection, resources) {\n  const fields = _(resources.map(e => e.fields))\n    .flatten()\n    .uniqBy('key')\n    .value()\n    .filter(e => e.hasOwnProperty('d3_format')\n                 || ['compound_id', 'numeric', 'text'].includes(e.format));\n  selection.select('.key')\n      .call(lbox.selectBoxItems, fields)\n      .call(lbox.updateSelectBox, fields[0]);\n  selection.select('.operator')\n      .call(lbox.updateSelectBox, 'eq');\n  selection.select('.value')\n      .call(box.updateTextBox, '')\n      .on('input', function () {\n        d3.select(this).dispatch('validate');\n      });\n  const res = resources.map(d => ({key: d.id, name: d.name}));\n  selection.select('.target')\n      .call(lbox.checklistBoxItems, res)\n      .call(lbox.updateChecklistBox, null)\n      .on('change', function () {\n        d3.select(this).dispatch('validate');\n      });\n  // Input validation\n  selection.selectAll('.value,.target')\n      .on('validate', function () {\n        const textValid = box.textBoxValue(selection.select('.value')) !== '';\n        const targetChecked = lbox.anyChecked(selection.select('.target'));\n        selection.select('.submit')\n          .property('disabled', !(textValid && targetChecked));\n      })\n      .dispatch('validate');\n}\n\n\n\nfunction execute(selection) {\n  const query = {\n    workflow: 'filter',\n    targets: lbox.checklistBoxValue(selection.select('.target')),\n    key: lbox.selectBoxValue(selection.select('.key')),\n    value: box.textBoxValue(selection.select('.value')),\n    operator: lbox.selectBoxValue(selection.select('.operator'))\n  };\n  return fetcher.get(query.workflow, query)\n    .then(fetcher.json);\n}\n\n\nexport default {\n  menuLink, body, updateBody, execute\n};\n","\n/** @module dialog/sdf */\n\nimport d3 from 'd3';\n\nimport {default as fetcher} from '../common/fetcher.js';\nimport {default as hfile} from '../common/file.js';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nfunction getSDFPropList(str) {\n  const re = />.*?<(\\S+)>/g;\n  const uniqCols = new Set();\n  let arr;\n  while ((arr = re.exec(str)) !== null) {\n    uniqCols.add(arr[1]);\n  }\n  return Array.from(uniqCols);\n}\n\n\nconst id = 'sdf-dialog';\nconst title = 'Import SDFile';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-importsdf');\n}\n\n\nfunction body(selection) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n  dialog.select('.modal-body').append('div')\n      .classed('file', true)\n      .call(box.fileInputBox, 'File', '.mol,.sdf');\n  dialog.select('.modal-body').append('div')\n      .classed('field', true)\n      .call(lbox.checklistBox, 'Fields');\n  dialog.select('.modal-body').append('div')\n      .classed('implh', true)\n      .call(box.checkBox, 'Make hydrogens implicit');\n  dialog.select('.modal-body').append('div')\n      .classed('recalc', true)\n      .call(box.checkBox, 'Recalculate 2D coords');\n}\n\n\nfunction updateBody(selection) {\n  selection.select('.file')\n      .on('change', function () {\n        const file = box.fileInputBoxValue(d3.select(this));\n        d3.select(this).dispatch('validate');\n        // Scan only first 100mb of the file due to memory limit.\n        return hfile.readFile(file, 100 * 1024 * 1024, false)\n          .then(data => {\n            const fields = getSDFPropList(data)\n              .map(e => ({key: e, name: e}));\n            selection.select('.field')\n              .call(lbox.checklistBoxItems, fields);\n          });\n      });\n  selection.select('.field')\n      .call(lbox.checklistBoxItems, [])\n      .on('change', function () {\n        d3.select(this).dispatch('validate');\n      });\n  selection.select('.implh')\n      .call(box.updateCheckBox, true);\n  selection.select('.recalc')\n      .call(box.updateCheckBox, false);\n  // Input validation\n  selection.selectAll('.field,.file')\n      .on('validate', function () {\n        const fileSelected = box.fileInputBoxValue(selection.select('.file'));\n        const fieldChecked = lbox.anyChecked(selection.select('.field'));\n        selection.select('.submit')\n          .property('disabled', !(fileSelected && fieldChecked));\n      })\n      .dispatch('validate');\n}\n\n\nfunction execute(selection) {\n  const params = {\n    fields: lbox.checklistBoxValue(selection.select('.field')),\n    implh: box.checkBoxValue(selection.select('.implh')),\n    recalc: box.checkBoxValue(selection.select('.recalc'))\n  };\n  const formData = new FormData();\n  formData.append('contents', box.fileInputBoxValue(selection.select('.file')));\n  formData.append('params', JSON.stringify(params));\n  return fetcher.post('sdfin', formData)\n    .then(fetcher.json);\n}\n\n\n\nexport default {\n  menuLink, body, updateBody, execute\n};\n","\n/** @module dialog/rename */\n\nimport d3 from 'd3';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'rename-dialog';\nconst title = 'Rename';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-edittext');\n}\n\n\nfunction body(selection) {\n  selection.call(modal.submitDialog, id, title)\n    .select('.modal-body').append('div')\n      .classed('rename', true)\n      .call(box.textBox, 'New name');\n}\n\n\nfunction updateBody(selection, name) {\n  selection.select('.rename')\n      .call(box.updateTextBox, name)\n      .on('input', function () {  // Validation\n        const keyValid = box.textBoxValue(d3.select(this)) !== '';\n        selection.select('.submit').property('disabled', !keyValid);\n      })\n      .dispatch('input');\n}\n\n\nfunction value(selection) {\n  return box.textBoxValue(selection.select('.rename'));\n}\n\n\nexport default {\n  menuLink, body, updateBody, value\n};\n","\n/** @module datagrid/component */\n\nimport d3 from 'd3';\n\n\nfunction headerCellRenderer(header) {\n  header.style('display', 'inline-block')\n    .style('width', d => `${d.width}%`)\n    .text(d => d.name);\n}\n\n\nfunction updateHeader(selection, state) {\n  const header = selection.select('.dg-header');\n  header.selectAll('.dg-hcell').remove();\n  header.selectAll('.dg-hcell').data(state.visibleFields)\n    .enter().append('div')\n      .classed('dg-hcell', true)\n      .call(state.headerCellRenderer);\n}\n\n\nfunction updateRows(selection, state) {\n  const rows = selection.select('.dg-body')\n    .selectAll('.dg-row')\n      .data(state.recordsToShow(), state.keyFunc);\n  rows.exit().remove();\n  rows.selectAll('.dg-cell').remove();\n  rows.enter()\n    .append('div')\n      .attr('class', 'dg-row')\n      .style('position', 'absolute')\n      .style('width', '100%')\n    .merge(rows)\n      .style('height', `${state.rowHeight}px`)\n      .each(function (d, i) {\n        const rowIndex = state.viewportTop + i;\n        const rowPos = rowIndex * state.rowHeight;\n        d3.select(this)\n          .style('transform', `translate(0px, ${rowPos}px)`)\n          .classed('odd', (rowIndex) % 2 === 0)\n          .call(state.rowFactory(), d);\n      });\n}\n\n\nfunction updateViewport(selection, state, scrollPos) {\n  selection.select('.dg-body').style('height', `${state.bodyHeight}px`);\n  state.setScrollPosition(scrollPos);\n  selection.call(updateRows, state, scrollPos);\n  selection.select('.dg-viewport').node().scrollTop = scrollPos * state.rowHeight;\n}\n\n\nfunction resize(selection, state) {\n  const viewport = selection.select('.dg-viewport');\n  const viewportTop = viewport.node().getBoundingClientRect().top;\n  state.resizeViewport(window.innerHeight - viewportTop - 5);\n  viewport.style('height', `${state.viewportHeight}px`);\n}\n\n\nfunction datagrid(selection, state) {\n  selection.append('div')\n      .classed('dg-header', true);\n  selection.append('div')\n      .classed('dg-viewport', true)\n      .style('overflow-y', 'auto')\n      .on('scroll', function () {\n        const pos = Math.floor(this.scrollTop / state.rowHeight);\n        if (pos !== state.previousViewportTop) {\n          state.setScrollPosition(pos);\n          selection.call(updateRows, state, pos);\n        }\n      })\n    .append('div')\n      .classed('dg-body', true)\n      .style('position', 'relative');\n  state.updateContentsNotifier = () => {\n    state.applyHeader();\n    selection.call(updateHeader, state);\n    selection.call(resize, state);\n    state.applyData();\n    selection.call(updateViewport, state, state.viewportTop);\n  };\n  state.updateFilterNotifier = value => {\n    state.setFilterText(value);\n    selection.call(updateViewport, state, 0);\n  };\n}\n\n\n\nexport default {\n  headerCellRenderer, updateHeader, updateRows, updateViewport,\n  resize, datagrid\n};\n","\n/** @module datagrid/rowFactory */\n\nimport {default as misc} from '../common/misc.js';\nimport {default as img} from '../common/image.js';\n\n\nfunction d3Format(selection, record, field) {\n  selection.text(misc.formatNum(record[field.key], field.d3_format));\n}\n\n\nfunction text(selection, record, field) {\n  selection.text(record[field.key]);\n}\n\n\nfunction date(selection, record, field) {\n  // TODO; formatter\n  selection.text(record[field.key]);\n}\n\n\nfunction html(selection, record, field) {\n  // TODO: Check vulnerabilities\n  selection.html(record[field.key]);\n}\n\n\nfunction compound_id(selection, record, field) {\n  selection.append('a')\n      .attr('href',`profile.html?compound=${record[field.key]}`)\n      .attr('target', '_blank')\n      .text(record[field.key]);\n}\n\n\nfunction image(selection, record, field) {\n  selection.append('img')\n      .attr('width', 180)\n      .attr('height', 180)\n      .attr('src', record[field.key]);\n}\n\nfunction checkbox(selection, record, field) {\n  selection.append('input')\n      .attr('type', 'checkbox')\n      .property('checked', record[field.key])\n      .property('disabled', field.disabled ? record[field.disabled] : false)\n      .on('click', function () {\n        record[field.key] = this.checked;\n      });\n}\n\nfunction textField(selection, record, field) {\n  selection.append('input')\n      .attr('type', 'text')\n      .style('width', '90%')\n      .property('value', record[field.key])\n      .on('change', function () {\n        record[field.key] = this.value;\n      });\n}\n\nfunction call(selection, value) {\n  selection.call(value);\n}\n\n\nconst cellFunc = {\n  numeric: text,\n  text: text,\n  date: date,\n  raw: text,\n  d3_format: d3Format,\n  compound_id: compound_id,\n  assay_id: text,\n  list: text,\n  plot: img.plotCell,\n  image: image,\n  checkbox: checkbox,\n  text_field: textField,\n  control: call,\n  svg: html,\n  html: html\n};\n\n\nfunction rowCell(selection) {\n  selection.classed('dg-cell', true)\n    .classed('align-middle', true)\n    .classed('text-truncate', true)\n    .style('display', 'inline-block');\n}\n\n\nfunction rowFactory(fields) {\n  return (selection, record) => {\n    fields.forEach(field => {\n      const cell = selection.append('div')\n          .call(rowCell)\n          .style('width', `${field.width}%`);\n      if (!record.hasOwnProperty(field.key)) return;\n      cell.call(cellFunc[field.format], record, field);\n    });\n  };\n}\n\n\nexport default {\n  d3Format, text, html, compound_id, image, checkbox, textField, call,\n  rowCell, rowFactory\n};\n","\n/** @module common/image */\n\nimport vega from 'vega';\n\n\nfunction plotCell(selection, record, field) {\n  new vega.View(vega.parse(record[field.key]))\n    .initialize(selection.node())\n    .run();\n}\n\n\nfunction plotThumbnail(vegaSpec) {\n  const view = new vega.View(vega.parse(vegaSpec));\n  return view.toImageURL('png');  // Promise\n}\n\n\nfunction binaryToDataURI(binary) {\n  return new Promise(resolve => {\n    const reader = new FileReader();\n    reader.onload = event => {\n      resolve(event.target.result);\n    };\n    reader.readAsDataURL(binary);\n  });\n}\n\n\nexport default {\n  plotCell, plotThumbnail, binaryToDataURI\n};\n","\n/** @module datagrid/state */\n\nimport _ from 'lodash';\n\nimport Collection from '../common/collection.js';\nimport {default as idb} from '../common/idb.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as component} from './component.js';\nimport {default as factory} from './rowFactory.js';\n\n\nexport default class DatagridState {\n  constructor(view, coll) {\n    this.storeID = view.storeID || null;\n    this.viewID = view.viewID || null;\n    this.name = view.name || null;\n    this.sortOrder = view.sortOrder || [];\n    this.filterText = view.filterText || null;\n    this.rows = new Collection(coll);\n\n    this.visibleFields = null;\n    this.sortedRecords = null;\n    this.filteredRecords = null;\n\n    // TODO: auto adjust\n    this.defaultColumnHeight = {\n      numeric: 40,\n      text: 40,\n      html: 40,\n      none: 200\n    };\n    this.scrollBarSpace = 20;\n    this.keyFunc = d => d.index;\n\n    // Size\n    this.rowHeight = null;\n    this.bodyHeight = null;\n\n    // Viewport\n    this.viewportHeight = null;\n    this.numViewportRows = null;\n    this.viewportTop = 0;\n    this.previousViewportTop = null;\n    this.viewportBottom = null;\n\n    this.fixedViewportHeight = null;\n\n    // Event notifier\n    this.updateContentsNotifier = null;\n    this.updateFilterNotifier = null;\n\n    this.headerCellRenderer = component.headerCellRenderer;\n    this.rowFactory = () => factory.rowFactory(this.visibleFields);\n  }\n\n  /**\n   * Set viewport height and number of rows to show\n   * @param {int} height - viewport height\n   */\n  setViewportSize(height) {\n    this.viewportHeight = this.fixedViewportHeight || height;\n  }\n\n  /**\n   * Set range of the row indices to show\n   * @param {int} position - Index of the top row to show\n   */\n  setScrollPosition(position) {\n    this.previousViewportTop = this.viewportTop;\n    this.viewportTop = position;\n    this.viewportBottom = Math.min(\n      this.viewportTop + this.numViewportRows, this.filteredRecords.length);\n  }\n\n  setNumViewportRows() {\n    this.numViewportRows = Math.ceil(this.viewportHeight / this.rowHeight) + 1;\n  }\n\n  resizeViewport(height) {\n    this.setViewportSize(height);\n    this.setNumViewportRows();\n  }\n\n  /**\n   * Apply header data\n   */\n  applyHeader() {\n    this.visibleFields = this.rows.fields.filter(e => e.visible);\n    const widthfSum = this.visibleFields.reduce((a, c) => a + (c.widthf || 1), 0);\n    this.visibleFields = this.visibleFields.map(e => {\n      const field = {\n        width: (e.widthf || 1) / widthfSum * 100,\n        height: e.height || this.defaultColumnHeight[misc.sortType(e.format)]\n      };\n      return Object.assign(field, e);\n    });\n    this.rowHeight = this.visibleFields\n      .reduce((a, b) => a.height > b.height ? a : b, 0).height;\n  }\n\n  /**\n   * Apply row data\n   * 1. applyHeader: define fields and set rowHeight\n   * 2. resize: measure actual window size and calc viewportHeight\n   * 3. applyData: calc number of rows from rowHeight and viewportHeight\n   * 4. setScrollPosition: calc row index range\n   * 5. recordsToShow: slice rows to show\n   */\n  applyData() {\n    this.setNumViewportRows();\n    this.applyOrder();\n  }\n\n  applyOrder(key, order) {\n    if (key) {\n      this.sortedRecords = _.orderBy(this.rows.records().slice(), [key], [order]);\n    } else {\n      const keys = this.sortOrder.map(e => e.key);\n      const orders = this.sortOrder.map(e => e.order);\n      if (keys) {\n        this.sortedRecords = _.orderBy(this.rows.records().slice(), keys, orders);\n      }\n    }\n    this.applyFilter();\n  }\n\n  applyFilter() {\n    if (this.filterText === null) {\n      this.filteredRecords = this.sortedRecords.slice();\n    } else {\n      const fields = this.visibleFields\n        .filter(e => misc.sortType(e.format) !== 'none')\n        .map(e => e.key);\n      this.filteredRecords = this.sortedRecords.filter(row => {\n        return fields.some(f => misc.partialMatch(this.filterText, row[f]));\n      });\n    }\n    this.bodyHeight = this.filteredRecords.length * this.rowHeight;\n  }\n\n  setSortOrder(key, order) {\n    const ki  = this.sortOrder.findIndex(e => e.key);\n    const obj = {key: key, order: order};\n    if (ki !== -1) this.sortOrder.splice(ki, 1);\n    this.sortOrder.splice(0, 0, obj);\n    this.applyOrder(key, order);\n  }\n\n  setFilterText(text) {\n    this.filterText = text;\n    this.applyFilter();\n  }\n\n  updateFields(fs) {\n    this.rows.updateFields(fs);\n  }\n\n  joinFields(mapping) {\n    this.rows.joinFields(mapping);\n    this.applyData();\n  }\n\n  recordsToShow() {\n    return this.filteredRecords.slice(this.viewportTop, this.viewportBottom);\n  }\n\n  save() {\n    return idb.updateItem(this.storeID, item => {\n      const ci = item.dataset\n        .findIndex(e => e.collectionID === this.rows.collectionID);\n      item.dataset[ci] = this.rows.export();\n      const vi = item.views.findIndex(e => e.viewID === this.viewID);\n      item.views[vi] = this.export();\n    });\n  }\n\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n      viewID: this.viewID,\n      name: this.name,\n      viewType: \"datagrid\",\n      rows: this.rows.collectionID,\n      sortOrder: this.sortOrder,\n      filterText: this.filterText\n    };\n  }\n}\n","\n/** @module datagrid/rowFilter */\n\nimport {default as box} from '../component/formBox.js';\n\n\nfunction setFilter(selection, state) {\n  const searchBox = selection\n      .classed('row', true)\n      .classed('justify-content-end', true)\n    .append('div')\n      .classed('col-5', true)\n      .call(box.textBox, 'Search');\n  searchBox.select('label').classed('text-right', true);\n  searchBox.select('input')\n    .on('keyup', function () {\n      state.updateFilterNotifier(box.textBoxValue(searchBox));\n    });\n}\n\n\nexport default {\n  setFilter\n};\n","\n/** @module datagrid/sort */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as component} from './component.js';\n\n\nfunction setSort(selection, state) {\n  state.headerCellRenderer = header => {\n    header.style('display', 'inline-block')\n      .style('width', d => `${d.width}%`)\n      .text(d => d.name)\n      .filter(d => misc.sortType(d.format) !== 'none')\n      .append('span').append('a')\n        .attr('id', d => `sort-${d.key}`)\n        .text('^v')\n        .style('display', 'inline-block')\n        .style('width', '30px')\n        .style('text-align', 'center')\n      .on('click', d => {\n        const isAsc = d3.select(`#sort-${d.key}`).text() === 'v';\n        d3.select(`#sort-${d.key}`).text(isAsc ? '^' : 'v');\n        state.setSortOrder(d.key, isAsc ? 'desc' : 'asc');\n        selection.call(component.updateRows, state);\n      });\n  };\n}\n\n\nexport default {\n  setSort\n};\n","\n/** @module datagrid/table */\n\nimport Collection from '../common/collection.js';\n\nimport DatagridState from './state.js';\nimport {default as component} from './component.js';\nimport {default as rowf} from './rowFilter.js';\nimport {default as sort} from './sort.js';\n\n\nfunction table(selection, fields, records, rowFactory, height) {\n  const data = {\n    fields: fields,\n    records: records\n  };\n  const state = new DatagridState({}, data);\n  state.keyFunc = d => d;\n  if (rowFactory) {\n    state.rowFactory = () => rowFactory(state.visibleFields);\n  }\n  state.fixedViewportHeight = height || 300;\n  selection.append('div')\n    .classed('table', true)\n    .call(component.datagrid, state);\n  selection.datum(state);\n}\n\n\nfunction filterTable(selection, fields, records, rowFactory, height) {\n  const data = {\n    fields: fields,\n    records: records\n  };\n  const state = new DatagridState({}, data);\n  if (rowFactory) {\n    state.rowFactory = () => rowFactory(state.visibleFields);\n  }\n  state.fixedViewportHeight = height || 300;\n  selection.append('div')\n    .classed('search', true)\n    .call(rowf.setFilter, state);\n  selection.append('div')\n    .classed('table', true)\n    .call(component.datagrid, state);\n  selection.datum(state);\n}\n\n\nfunction filterSortTable(selection, fields, records, rowFactory, height) {\n  const data = {\n    fields: fields,\n    records: records\n  };\n  const state = new DatagridState({}, data);\n  if (rowFactory) {\n    state.rowFactory = () => rowFactory(state.visibleFields);\n  }\n  state.fixedViewportHeight = height || 300;\n  selection.append('div')\n    .classed('search', true)\n    .call(rowf.setFilter, state);\n  selection.append('div')\n    .classed('table', true)\n    .call(sort.setSort, state)\n    .call(component.datagrid, state);\n  selection.datum(state);\n}\n\n\nfunction update(selection, fields, records) {\n  const data = {\n    fields: fields,\n    records: records\n  };\n  const state = selection.datum();\n  state.rows = new Collection(data);\n  state.updateContentsNotifier();\n}\n\n\nfunction updateRecords(selection, records) {\n  const state = selection.datum();\n  state.rows.contents[0].records = records;\n  state.updateContentsNotifier();\n}\n\n\nfunction tableRecords(selection) {\n  const state = selection.datum();\n  return state.rows.records();\n}\n\n\nexport default {\n  table, filterTable, filterSortTable, update, updateRecords, tableRecords\n};\n","\n/** @module dashboardApp */\n\nimport d3 from 'd3';\n\nimport {default as client} from './common/client.js';\nimport Collection from './common/collection.js';\nimport {default as fetcher} from './common/fetcher.js';\nimport {default as hfile} from './common/file.js';\nimport {default as idb} from './common/idb.js';\nimport {default as specs} from './common/specs.js';\n\nimport {default as badge} from './component/badge.js';\nimport {default as button} from './component/button.js';\nimport {default as modal} from './component/modal.js';\nimport {default as tree} from './component/tree.js';\n\nimport {default as searchDialog} from './dialog/search.js';\nimport {default as structDialog} from './dialog/struct.js';\nimport {default as filterDialog} from './dialog/filter.js';\nimport {default as sdfDialog} from './dialog/sdf.js';\nimport {default as renameDialog} from './dialog/rename.js';\n\nimport {default as table} from './datagrid/table.js';\n\n\nfunction nodeFactory(selection, record) {\n  const iconv = {\n    'datagrid': 'table-darkorange', 'network': 'network-turquoise',\n    'tile': 'tiles-yellowgreen'\n  };\n  const icon = record.viewID ? iconv[record.viewType] : 'file-seagreen';\n  const storeID = record.storeID || record.parent;\n  const node = record.viewID\n    ? selection.append('a')\n      .attr(\n        'href',\n        `${record.viewType}.html?store=${storeID}&view=${record.viewID}`\n      )\n      .attr('target', '_blank')\n    : selection;\n  node.append('img')\n      .attr('src', icon ? `${button.iconBaseURL}${icon}.svg` : null)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  node.append('span')\n      .classed('mr-1', true)\n      .text(record.name);\n  const colors = {\n    done: 'green', running: 'darkorange',\n    ready: 'cornflowerblue', queued: 'cornflowerblue',\n    interrupted: 'salmon', aborted: 'salmon', failure: 'salmon',\n    rows: 'gray', items: 'gray',\n    nodes: 'gray', edges: 'gray'\n  };\n  const icons = {\n    done: 'check-green', running: 'running-darkorange',\n    ready: 'clock-cornflowerblue', queued: 'clock-cornflowerblue',\n    interrupted: 'caution-salmon', aborted: 'caution-salmon',\n    failure: 'caution-salmon',\n    rows: 'table-gray', items: 'tiles-gray',\n    nodes: 'nodes-gray', edges: 'edges-gray'\n  };\n    if (record.viewID) {\n    record.stats.forEach(stat => {\n      selection.append('img')\n          .attr('src', `${button.iconBaseURL}${icons[stat[0]]}.svg`)\n          .style('width', '1rem')\n          .style('height', '1rem');\n      selection.append('span')\n          .classed('pr-1', true)\n          .style('font-size', '0.8rem')\n          .style('color', colors[stat[0]])\n          .text(stat[1]);\n    });\n  } else {\n    selection.append('span')\n        .classed('pr-1', true)\n        .style('font-size', '0.7rem')\n        .style('color', '#999999')\n        .text(record.sessionStarted);\n  }\n  const action = selection.append('span')\n      .classed('p-1', true)\n      .style('border', '1px solid #999999')\n      .style('border-radius', '5px');\n  const actionIcon = (sel, icon) => sel.append('img')\n      .attr('src', `${button.iconBaseURL}${icon}.svg`)\n      .classed('mx-1', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  if (!record.viewID) {\n    action.append('a').call(actionIcon, 'menu-export')\n        .on('click', () => {\n          const data = JSON.parse(JSON.stringify(record));\n          delete data.storeID;\n          delete data.sessionStarted;\n          hfile.downloadJSON(data, data.name);\n        });\n  }\n  action.append('a')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', '#rename-dialog')\n      .call(actionIcon, 'menu-edittext')\n      .on('click', () =>{\n        d3.select('#rename-dialog')\n          .call(renameDialog.updateBody, record.name)\n          .on('submit', function () {\n            d3.select('#menubar .loading-circle')\n                .style('display', 'inline-block');\n            if (record.viewID) {\n              idb.updateView(record.parent, record.viewID, view => {\n                view.name = renameDialog.value(d3.select(this));\n              }).then(updateApp);\n            } else {\n              idb.updateItem(record.storeID, item => {\n                item.name = renameDialog.value(d3.select(this));\n              }).then(updateApp);\n            }\n          });\n      });\n  if (!record.ongoing) {\n    const recordType = record.viewID ? record.viewType : 'package';\n    const deleteType = record.alone ? 'package' : recordType;\n    const deleteName = record.alone ? record.parentName : record.name;\n    action.append('a')\n        .attr('data-toggle', 'modal')\n        .attr('data-target', '#delete-dialog')\n        .call(actionIcon, 'delete-gray')\n        .on('click', () =>{\n          d3.select('#delete-dialog')\n            .call(\n              modal.updateConfirmDialog,\n              `Are you sure you want to delete ${deleteType} ${deleteName} ?`\n            )\n            .on('submit', () => {\n              d3.select('#menubar .loading-circle')\n                  .style('display', 'inline-block');\n              if (record.viewID && !record.alone) {\n                idb.deleteView(record.parent, record.viewID)\n                  .then(updateApp);\n              } else {\n                idb.deleteItem(record.storeID || record.parent)\n                  .then(updateApp);\n              }\n            });\n        });\n  }\n  action.selectAll('img')\n    .on('mouseenter', function() {\n      d3.select(this).style('background-color', '#ffcccc');\n    })\n    .on('mouseleave', function() {\n      d3.select(this).style('background-color', null);\n    });\n}\n\n\nfunction app() {\n  // Menubar\n  const menubar = d3.select('#menubar')\n      .classed('my-1', true);\n  // Start\n  const startMenu = menubar.append('div')\n      .call(button.dropdownMenuButton, 'Start', 'primary', 'plus-white')\n      .select('.dropdown-menu');\n  startMenu.append('a').classed('online-command', true)\n      .call(searchDialog.menuLink);\n  startMenu.append('a').classed('online-command', true)\n      .call(structDialog.menuLink);\n  startMenu.append('a').classed('online-command', true)\n      .call(filterDialog.menuLink);\n  startMenu.append('a').classed('online-command', true)\n      .call(sdfDialog.menuLink);\n  startMenu.append('a')\n      .call(button.dropdownMenuFile, 'Open file',\n            '.apc,.apr,.ndc,.ndr,.gfc,.gfr,.json,.gz', 'menu-import')\n      .on('change', function () {\n        d3.select('#menubar .loading-circle').style('display', 'inline-block');\n        const file = button.dropdownMenuFileValue(d3.select(this));\n        return hfile.loadJSON(file)\n          .then(idb.importItem)\n          .then(updateApp);\n      });\n  // Refresh\n  menubar.append('a')\n      .classed('refresh', true)\n      .classed('online-command', true)\n      .call(button.menuButtonLink,\n            'Refresh all', 'outline-secondary', 'refresh-gray')\n      .on('click', () => {\n        d3.select('#menubar .loading-circle').style('display', 'inline-block');\n        return updateApp();\n      });\n  // Delete all\n  menubar.append('a')\n      .call(button.menuModalLink, 'reset-dialog',\n            'Reset local datastore', 'warning', 'delete-gray');\n  // Status\n  menubar.append('span')\n      .classed('loading-circle', true)\n      .call(badge.loadingCircle);\n\n  // Contents\n  const contents = d3.select('#contents')\n      .style('padding-left', '10%')\n      .style('padding-right', '10%');\n\n  // Stored analysis packages\n  contents.append('h5').classed('mt-5', true).text('Packages on local storage');\n  contents.append('div').classed('mb-5', true)\n      .classed('stored', true)\n      .style('border', '1px solid #333333')\n      .call(tree.tree)\n      .call(tree.setHeight, 300);\n\n  // Server calc jobs\n  // TODO: only for admin\n  const calcFields = [\n    {key: 'workflowID', name: 'WorkflowID', format: 'text'},\n    {key: 'name', name: 'Name', format: 'text'},\n    {key: 'size', name: 'File size', format: 'd3_format', d3_format: '.3s'},\n    {key: 'status', name: 'Status', format: 'text'},\n    {key: 'created', name: 'Created', format: 'date', height: 40}\n  ];\n  contents.append('h5').classed('mt-5', true).text('Server calculation job');\n  contents.append('div').classed('mb-5', true).classed('calc', true)\n  .call(table.table, calcFields, [], null, 300);\n\n  // Server status\n  const serverFields = [\n    {key: 'key', name: 'Key', format: 'text'},\n    {key: 'value', name: 'Value', format: 'text'}\n  ];\n  contents.append('h5').classed('mt-5', true).text('Server status');\n  contents.append('div').classed('mb-5', true).classed('server', true)\n  .call(table.table, serverFields, [], null, 300);\n\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n  dialogs.append('div')\n      .classed('searchd', true)\n      .call(searchDialog.body);\n  dialogs.append('div')\n      .classed('structd', true)\n      .call(structDialog.body);\n  dialogs.append('div')\n      .classed('filterd', true)\n      .call(filterDialog.body);\n  dialogs.append('div')\n      .classed('sdfd', true)\n      .call(sdfDialog.body);\n  dialogs.append('div')\n      .classed('renamed', true)\n      .call(renameDialog.body);\n  dialogs.append('div')\n      .call(modal.confirmDialog, 'reset-dialog')\n      .call(modal.updateConfirmDialog,\n            'Are you sure you want to delete all local tables and reset the datastore ?')\n      .on('submit', () => {\n        d3.select('#menubar .loading-circle').style('display', 'inline-block');\n        return idb.reset().then(updateApp);\n      });\n  dialogs.append('div')\n      .call(modal.confirmDialog, 'delete-dialog');\n\n  // Update\n  return updateApp();\n}\n\n\nfunction updateApp() {\n  const onLoading = d3.select('#menubar .loading-circle');\n  const dialogs = d3.select('#dialogs');\n\n  // Server bound tasks\n  return fetcher.serverStatus().then(response => {\n    // Update server status table\n    d3.select('#contents').select('.calc')\n      .call(table.updateRecords, response.server.calc.records);\n    const serverRecords = Object.entries(response.server)\n      .filter(e => e[0] !== 'calc')\n      .map(e => ({key: e[0], value: e[1]}));\n    d3.select('#contents').select('.server')\n      .call(table.updateRecords, serverRecords);\n\n    // Dialogs\n    const chemrsrc = response.schema.resources.filter(e => e.domain === 'chemical');\n    dialogs.select('.searchd')\n        .call(searchDialog.updateBody, chemrsrc, response.schema.compoundIDPlaceholder)\n        .on('submit', function () {\n          return searchDialog.execute(d3.select(this), chemrsrc)\n            .then(idb.newDatagrid)\n            .then(r => {\n              onLoading.style('display', 'none');\n              window.open(\n                `datagrid.html?store=${r.storeID}&view=${r.viewID}`, '_blank');\n            });\n        });\n    dialogs.select('.structd')\n        .call(structDialog.updateBody, chemrsrc, response.server.rdkit)\n        .on('submit', function () {\n          return structDialog.execute(d3.select(this))\n            .then(idb.newDatagrid)\n            .then(r => {\n              onLoading.style('display', 'none');\n              window.open(\n                `datagrid.html?store=${r.storeID}&view=${r.viewID}`, '_blank');\n            });\n        });\n    dialogs.select('.filterd')\n        .call(filterDialog.updateBody, chemrsrc)\n        .on('submit', function () {\n          return filterDialog.execute(d3.select(this))\n            .then(idb.newDatagrid)\n            .then(r => {\n              onLoading.style('display', 'none');\n              window.open(\n                `datagrid.html?store=${r.storeID}&view=${r.viewID}`, '_blank');\n            });\n        });\n    dialogs.select('.sdfd')\n        .call(sdfDialog.updateBody, chemrsrc)\n        .on('submit', function () {\n          return sdfDialog.execute(d3.select(this))\n            .then(idb.newDatagrid)\n            .then(r => {\n              onLoading.style('display', 'none');\n              window.open(\n                `datagrid.html?store=${r.storeID}&view=${r.viewID}`, '_blank');\n            });\n        });\n\n    // Fetch all ongoing tasks\n    return idb.getAllCollections()\n      .then(colls => {\n        const ongoings = colls.map(e => new Collection(e))\n          .filter(e => e.ongoing());\n        return Promise.all(ongoings.map(o => o.pull()));\n      });\n  })\n  .catch(err => {\n    console.info('Server did not respond');\n    console.error(err);\n    // disable on-line commands\n    d3.select('#menubar').selectAll('.online-command')\n      .attr('data-target', null)\n      .classed('disabled', true);\n    d3.select('#contents').select('.calc').text('Off-line');\n    d3.select('#contents').select('.server').text('Off-line');\n  })\n  .finally(() => {\n    // update stored package tree\n    return idb.getAllItems().then(items => {\n      const treeNodes = [{storeID: 'root'}];\n      items.forEach(pkg => {\n        pkg.parent = 'root';\n        pkg.ongoing = specs.isRunning(pkg);\n        treeNodes.push(pkg);\n        pkg.views.forEach(view => {\n          view.parent = pkg.storeID;\n          view.ongoing = pkg.ongoing;\n          view.alone = pkg.views.length <= 1;\n          view.parentName = pkg.name;\n          view.stats = ['nodes', 'edges', 'rows', 'items']\n            .filter(e => view.hasOwnProperty(e))\n            .map(e => [e,\n              d3.format(\".3~s\")(\n                pkg.dataset.find(d => d.collectionID === view[e])\n                  .contents.reduce((a, b) => a + b.records.length, 0))]);\n          const coll = new Collection(pkg.dataset\n            .find(d => d.collectionID === view[\n              ['edges', 'rows', 'items'].filter(e => view.hasOwnProperty(e))[0]\n            ]));\n          const statusText = coll.status() === 'done' ? '' : coll.status();\n          const progText = coll.ongoing() ? `${coll.progress()}%` : '';\n          view.stats.push([coll.status(), `${statusText}${progText}`]);\n          treeNodes.push(view);\n        });\n      });\n      d3.select('#contents').select('.stored')\n        .call(tree.treeItems, treeNodes, d => d.storeID, nodeFactory);\n      onLoading.style('display', 'none');\n    });\n  });\n}\n\n\nfunction run() {\n  const err = client.compatibility();\n  if (err) {\n    d3.select('body')\n      .style('color', '#ff0000')\n      .text(err);\n    return;\n  }\n  // TODO: show browser status\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";  // TODO\n  const offLine = 'onLine' in navigator && !navigator.onLine;  // TODO\n  client.registerServiceWorker();\n  app();\n}\n\n\nexport default {\n  run\n};\n"],"names":["URLQuery","pairs","window","location","search","substring","split","map","e","_","fromPairs","compatibility","registerServiceWorker","navigator","debug","console","info","addEventListener","serviceWorker","register","sortType","fmt","includes","formatNum","value","d3format","Number","isNaN","parseFloat","d3","format","partialMatch","query","target","toString","toUpperCase","indexOf","uuidv4","replace","c","r","Math","random","statusConv","Queued","In progress","Aborting","Aborted","Completed","Failure","dataTypeConv","datatable","connection","v07_to_v08_nodes","json","fields","columns","sort","id","name","dataType","schemaVersion","revision","status","records","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v10_nodes","reference","convertNetwork","data","edges","hasOwnProperty","nodes","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","key","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","forEach","i","index","_structure","_index","source","v08_graph","nodeContentVisible","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","params","v10_edges","$schema","convertPackage","specs","now","Date","isNW","v08_nodes","width","height","convertTable","views","dataset","push","collectionID","contents","workflowID","workflow","viewID","viewType","rows","sortOrder","filterText","checkpoints","type","date","description","networkThresholdCutoff","filter","view","minConnThld","currentConnThld","edgeColor","color","edgeLabelColor","schema","items","idb","Dexie","getAllItems","orderBy","reverse","toArray","updateItem","storeID","updateFunc","where","equals","modify","catch","err","error","version","stores","reset","delete","then","getItem","first","deleteItem","getView","appendView","viewObj","item","pos","findIndex","splice","updateView","isFunction","deleteView","bin","Object","entries","entry","getAllCollections","flatten","coll","getCollection","collID","colls","updateCollection","collObj","importItem","legacy","misc","slice","sessionStarted","put","newDatagrid","response","toLocaleString","timeZone","newNetwork","nodesName","edgesID","baseURL","get","url","q","keys","length","JSON","stringify","fetch","credentials","res","Promise","reject","Error","statusText","resolve","blob","post","formdata","method","body","serverStatus","server","singleToMulti","mapping","newMapping","m","mappingToTable","mp","concat","rcd","f","tableToMapping","table","ignore","row","csvToMapping","csvString","lines","header","shift","headerIdx","h","line","values","k","Array","apply","fd","uniqBy","Collection","[object Object]","this","autoIndex","content","addField","fs","mapper","func","command","fetcher","all","sum","some","min","readFile","file","sizeLimit","reader","FileReader","truncated","onload","event","result","onerror","readAsArrayBuffer","readAsText","parseJSON","compressed","pako","inflate","to","parse","downloadDataFile","URL","createObjectURL","Blob","a","document","createElement","download","href","dispatchEvent","MouseEvent","bubbles","cancelable","loadJSON","endsWith","fetchJSON","decoded","decodeURIComponent","arrayBuffer","downloadJSON","compress","str","gzip","isRunning","assetBaseURL","iconBaseURL","icon","selection","append","attr","style","badge","classed","updateBadge","select","notify","transition","duration","ease","easeLinear","delay","on","loadingCircle","alert","updateAlert","buttonBox","menuButton","menuButtonLink","menuModalLink","dropdownMenuButton","button","dropdownMenuItem","dropdownMenuModal","dropdownMenuFile","accept","node","click","dropdownMenuFileValue","files","dialogBase","confirmDialog","base","call","footer","dispatch","updateConfirmDialog","message","submitDialog","title","html","$","modal","nextLevel","nodeFactory","children","child","datum","arrow","childList","expanded","tree","treeItems","keyFunc","root","stratify","parentId","d","parent","remove","selectAll","setHeight","checkboxNode","checkboxValues","numberBoxIntValue","parseInt","property","numberBoxFloatValue","textBox","updateTextBox","textBoxValue","readonlyBox","textareaBox","updateTextareaBox","updateTextareaPlaceholder","placeholder","textareaBoxValue","textareaBoxLines","checkBox","box","updateCheckBox","checked","checkBoxValue","numberBox","max","step","updateNumberBox","numberIntValid","valid","numberFloatValid","colorBox","stopPropagation","updateColorBox","colorBoxValue","fileInputBox","clearFileInput","fileInputBoxValue","monocolorBar","colors","group","colorBar","monocolor","bicolor","grad","tricolor","categorical","sw","custom","setSize","checklistBoxValue","setSelectedColorScale","selected","shape","selectBox","selectBoxItems","options","exit","enter","updateSelectBox","selectBoxValue","checklistBox","checklistBoxItems","listitems","form","updateChecklistBox","each","anyChecked","colorScaleBox","dropdown","colorScaleBoxItems","updateColorScaleBox","colorScaleBoxValue","colorScaleBoxItem","menuLink","mbody","lbox","updateBody","resources","def","execute","targets","queryMolGroupValue","textquery","areaquery","queryMolGroup","popover","trigger","updateQueryMolGroup","queryMolGroupValid","simOptionGroup","collapse","updateSimOptionGroup","simOptionGroupValue","timeout","diam","ignoreHs","diameter","dialog","rdk","methodList","mcs","undefined","qmolValid","targetChecked","measure","thld","queryMol","textValid","operator","hfile","re","uniqCols","Set","arr","exec","add","from","getSDFPropList","fileSelected","fieldChecked","implh","recalc","formData","FormData","keyValid","updateHeader","state","visibleFields","headerCellRenderer","updateRows","recordsToShow","merge","rowHeight","rowIndex","viewportTop","rowPos","rowFactory","updateViewport","scrollPos","bodyHeight","setScrollPosition","scrollTop","resize","viewport","getBoundingClientRect","top","resizeViewport","innerHeight","viewportHeight","datagrid","floor","previousViewportTop","updateContentsNotifier","applyHeader","applyData","updateFilterNotifier","setFilterText","d3Format","record","d3_format","compound_id","image","checkbox","disabled","textField","cellFunc","numeric","raw","assay_id","list","plot","plotCell","vega","View","initialize","run","plotThumbnail","vegaSpec","toImageURL","binaryToDataURI","binary","readAsDataURL","text_field","control","svg","rowCell","cell","DatagridState","sortedRecords","filteredRecords","defaultColumnHeight","none","scrollBarSpace","numViewportRows","viewportBottom","fixedViewportHeight","component","factory","position","ceil","setViewportSize","setNumViewportRows","widthfSum","reduce","widthf","assign","b","applyOrder","order","orders","applyFilter","ki","obj","updateFields","joinFields","ci","export","vi","setFilter","searchBox","setSort","isAsc","setSortOrder","filterTable","rowf","filterSortTable","update","updateRecords","tableRecords","network","tile","done","running","ready","queued","interrupted","aborted","failure","icons","stats","stat","action","actionIcon","sel","renameDialog","updateApp","ongoing","recordType","deleteType","alone","deleteName","parentName","onLoading","dialogs","calc","serverRecords","chemrsrc","searchDialog","compoundIDPlaceholder","open","structDialog","rdkit","filterDialog","sdfDialog","ongoings","o","pull","finally","treeNodes","pkg","progText","client","protocol","onLine","menubar","startMenu","app"],"mappings":"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"}