{"version":3,"file":"tileApp.js","sources":["../../src/common/client.js","../../src/common/misc.js","../../src/common/legacySchema.js","../../src/common/idb.js","../../src/component/badge.js","../../src/component/button.js","../../src/component/transform.js","../../src/component/formBox.js","../../src/component/modal.js","../../src/dialog/rename.js","../../src/common/fetcher.js","../../src/common/mapper.js","../../src/common/collection.js","../../src/common/transform.js","../../src/tile/state.js","../../src/common/scale.js","../../src/tile/component.js","../../src/tile/interaction.js","../../src/component/shape.js","../../src/component/formListBox.js","../../src/component/formRangeBox.js","../../src/component/dropdown.js","../../src/component/formBoxGroup.js","../../src/component/controlBox.js","../../src/tile/controlBox.js","../../src/tileApp.js"],"sourcesContent":["\n/** @module common/client */\n\nimport _ from 'lodash';\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\nfunction compatibility() {\n  try {\n    () => {};\n  } catch (err) {\n    return 'Client compatibility error: Arrow function not supported';\n  }\n  try {\n    FormData;\n  } catch (err) {\n    return 'Client compatibility error: FormData not supported';\n  }\n  try {\n    fetch;\n  } catch (err) {\n    return 'Client compatibility error: fetch API not supported';\n  }\n}\n\n\nfunction registerServiceWorker() {\n  if ('serviceWorker' in navigator) {\n    if (!isDebugBuild) {  // Grobal isDebugBuild (see rollup.js)\n      window.addEventListener('load', () => {\n        navigator.serviceWorker.register('../sw.js');  // TODO: root path option\n      });\n    } else {\n      console.info('Service worker is disabled for debugging');\n    }\n  } else {\n    console.info('Service worker is not supported');\n  }\n}\n\n\nfunction registerCtrlCommand(key, callback) {\n  document.addEventListener('keydown', event => {\n    if (event.ctrlKey && event.key === key) {\n      callback();\n    }\n  });\n}\n\n\nexport default {\n  URLQuery, compatibility, registerServiceWorker, registerCtrlCommand\n};\n","\n/** @module common/misc */\n\nimport d3 from 'd3';\n\n\n// TODO: re-define\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  if (['text_field', 'checkbox', 'html'].includes(fmt)) return 'html';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  sortType, formatNum, partialMatch, uuidv4\n};\n","\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: [\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ],\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  data.fields.forEach(e => {\n    if (e.key === 'structure') {\n      e.format = 'svg';\n    }\n    delete e.width;\n    delete e.height;\n  });\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nfunction convertPackage(json) {\n  let specs = {};\n  if (!json.hasOwnProperty('views')) {\n    const now = new Date();\n    const isNW = json.hasOwnProperty('edges');\n    const data = isNW ? convertNetwork(json) : convertTable(json);\n    const nodes = isNW ? data.nodes : data;\n    specs = {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n      name: data.edges.name,\n      views: [],\n      dataset: []\n    };\n    specs.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: nodes.id,\n      name: nodes.name,\n      contents: [{\n        $schema: nodes.$schema,\n        workflowID: nodes.reference.workflow,\n        name: nodes.name,\n        fields: nodes.fields,\n        records: nodes.records,\n        created: nodes.created,\n        status: nodes.status,\n        query: nodes.query,\n        execTime: nodes.execTime,\n        progress: nodes.progress\n      }]\n    });\n    specs.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n      viewID: nodes.id,\n      name: nodes.name,\n      viewType: \"datagrid\",\n      rows: nodes.id,\n      fields: nodes.fields,\n      sortOrder: null,\n      filterText: null,\n      checkpoints: [{\n        type: 'convert',\n        date: now.toString(),\n        description: 'converted from legacy format'\n      }]\n    });\n    if (isNW) {\n      specs.dataset.push({\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: data.edges.id,\n        name: data.edges.name,\n        contents: [{\n          $schema: data.edges.$schema,\n          workflowID: data.edges.reference.workflow,\n          name: data.edges.name,\n          fields: data.edges.fields,\n          records: data.edges.records,\n          created: data.edges.created,\n          status: data.edges.status,\n          query: data.edges.query,\n          execTime: data.edges.execTime,\n          progress: data.edges.progress\n        }]\n      });\n      specs.views.push({\n        $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n        viewID: data.edges.id,\n        name: data.edges.name,\n        viewType: \"network\",\n        nodes: nodes.id,\n        edges: data.edges.id,\n        nodeColor: data.edges.snapshot.nodeColor,\n        nodeSize: data.edges.snapshot.nodeSize,\n        nodeLabel: data.edges.snapshot.nodeLabel,\n        nodeLabelColor: data.edges.snapshot.nodeLabelColor,\n        edgeWidth: data.edges.snapshot.edgeWidth,\n        edgeLabel: data.edges.snapshot.edgeLabel,\n        networkThreshold: data.edges.snapshot.networkThreshold,\n        networkThresholdCutoff: data.edges.snapshot.networkThresholdCutoff,\n        fieldTransform: data.edges.snapshot.fieldTransform,\n        coords: data.edges.snapshot.coords,\n        checkpoints: [{\n          type: 'convert',\n          date: now.toString(),\n          description: 'converted from legacy format'\n        }]\n      });\n    }\n    specs.views.filter(e => e.viewType === 'network')\n      .forEach(view => {\n        view.minConnThld = view.networkThresholdCutoff;\n        view.currentConnThld = view.networkThreshold;\n        if (view.hasOwnProperty('nodeLabel')) {\n          view.nodeLabel.field = view.nodeLabel.text;\n        }\n        if (view.hasOwnProperty('edgeLabel')) {\n          view.edgeLabel.field = 'weight';\n        }\n        if (view.hasOwnProperty('edgeWidth')) {\n          view.edgeWidth.field = 'weight';\n        }\n      });\n  } else {\n    specs = json;\n  }\n  specs.views.filter(e => e.viewType === 'network')\n    .forEach(view => {\n      if (!view.nodeColor.field) { view.nodeColor.field = 'index' ;}\n      if (!view.nodeSize.field) { view.nodeSize.field = 'index' ;}\n      if (!view.nodeLabel.field) { view.nodeLabel.field = 'index' ;}\n      if (!view.nodeLabelColor.field) { view.nodeLabelColor.field = 'index' ;}\n      if (!view.edgeColor) {\n        view.edgeColor = {\n          field: 'weight', color: 'monogray',\n          scale: 'linear', domain: [0, 1],\n          range: ['#999999', '#999999'], unknown: '#cccccc'\n        };\n      } else if (!view.edgeColor.field) { view.edgeColor.field = 'weight' ;}\n      if (!view.edgeWidth.field) { view.edgeWidth.field = 'weight' ;}\n      if (!view.edgeLabel.field) { view.edgeLabel.field = 'weight' ;}\n      if (!view.edgeLabelColor) {\n        view.edgeLabelColor = {\n          field: 'weight', color: 'monoblack',\n          scale: 'linear', domain: [1, 1],\n          range: ['#333333', '#333333'], unknown: '#cccccc'\n        };\n      } else if (!view.edgeLabelColor.field) { view.edgeLabelColor.field = 'weight' ;}\n    });\n  return specs;\n}\n\n\nexport default {\n  convertPackage\n};\n","\n/** @module common/idb */\n\nimport _ from 'lodash';\nimport Dexie from 'Dexie';\n\nimport {default as misc} from './misc.js';\nimport {default as legacy} from './legacySchema.js';\n\n// TODO: need package, view and dataset tables?\nconst schema = {\n  items: 'storeID, sessionStarted'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\n/**\n * Delete all data store\n * Try this before dealing with local db issues\n */\nfunction reset() {\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\n\n/**\n * Returns all data store items\n * @return {array} data store objects\n */\nfunction getAllItems() {\n  return idb.items\n    .orderBy('sessionStarted')\n    .reverse()\n    .toArray();\n}\n\n\n/**\n * Get data store items by store ID\n * @param {string} storeID - store ID\n * @return {array} data store object\n */\nfunction getItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .first()\n    .catch(err => {\n      console.error(`IDBError: Unexpected table ID: ${storeID}`, err);\n    });\n}\n\n\n/**\n * Update data object in the store\n * @param {string} storeID - store ID\n * @param {function} updateFunc - update function\n * @return {integer} - number of updated items\n */\nfunction updateItem(storeID, updateFunc) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .modify(updateFunc)\n    .catch(err => {\n      console.error('IDBError: Update failed', err);\n    });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .delete();\n}\n\n\n/**\n * Returns a view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @return {array} view objects\n */\nfunction getView(storeID, viewID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).views)\n    .then(views => {\n      const view = views.find(e => e.viewID === viewID);\n      if (!view) return;\n      view.storeID = storeID;\n      return view;\n    });\n}\n\n\n/**\n * Append a view next to a specific view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object\n */\nfunction appendView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos + 1, 0, viewObj);\n  });\n}\n\n\n/**\n * Update view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object or update function\n */\nfunction updateView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    if (_.isFunction(viewObj)) {\n      viewObj(item.views[pos]);\n    } else {\n      item.views[pos] = viewObj;\n    }\n  });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteView(storeID, viewID) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos, 1);\n    // prune orphaned collections\n    const bin = {};\n    item.dataset.forEach(e => { bin[e.collectionID] = 0; });\n    item.views.forEach(view => {\n      ['rows', 'items', 'nodes', 'edges']\n        .filter(e => view.hasOwnProperty(e))\n        .forEach(e => { bin[view[e]] += 1; });\n    });\n    Object.entries(bin).forEach(entry => {\n      if (!entry[1]) {\n        const i = item.dataset.findIndex(e => e.collectionID === entry[0]);\n        item.dataset.splice(i, 1);\n      }\n    });\n  });\n}\n\n\n/**\n * Returns all collections in the store\n * @return {array} Collection objects\n */\nfunction getAllCollections() {\n  return getAllItems()\n    .then(items => _.flatten(\n      items.map(item => {\n        return item.dataset.map(coll => {\n          coll.storeID = item.storeID;\n          return coll;\n        });\n      })\n    ));\n}\n\n\n/**\n * Returns a collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @return {array} Collection objects\n */\nfunction getCollection(storeID, collID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).dataset)\n    .then(colls => {\n      const coll = colls.find(e => e.collectionID === collID);\n      if (!coll) return;\n      coll.storeID = storeID;\n      return coll;\n    });\n}\n\n\n/**\n * Update collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @param {object} collObj - Collection object or update function\n */\nfunction updateCollection(storeID, collID, collObj) {\n  return updateItem(storeID, item => {\n    const pos = item.dataset.findIndex(e => e.collectionID === collID);\n    if (_.isFunction(collObj)) {\n      collObj(item.dataset[pos]);\n    } else {\n      item.dataset[pos] = collObj;\n    }\n  });\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - storeID if sucessfully added\n */\nfunction importItem(data) {\n  // Legacy format converter\n  data = legacy.convertPackage(data);\n\n  const now = new Date();\n  data.storeID = misc.uuidv4().slice(0, 8);\n  data.sessionStarted = now.toString();\n  return idb.items.put(data);\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} response - response data\n * @return {string} - viewID if sucessfully added\n */\nfunction newDatagrid(response) {\n  const now = new Date();\n  const date = now.toLocaleString('en-GB', { timeZone: 'Asia/Tokyo'});\n  const storeID = misc.uuidv4().slice(0, 8);\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  const data = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    storeID: storeID,\n    name: response.name,\n    views: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n        viewID: viewID,\n        name: response.name,\n        viewType: \"datagrid\",\n        rows: collectionID,\n        checkpoints: [\n          {type: 'creation', date: date}\n        ]\n      }\n    ],\n    dataset: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: collectionID,\n        name: response.name,\n        contents: [response]\n      }\n    ],\n    sessionStarted: date\n  };\n  return idb.items.put(data)\n    .then(() => ({storeID: storeID, viewID:viewID}));\n}\n\n\n/**\n * Store new network view\n * @param {string} storeID - Store ID\n * @param {string} nodesID - ID of nodes collection\n * @param {string} nodesName - Name of nodes collection\n * @param {object} response - Response object\n */\nfunction newNetwork(storeID, nodesID, nodesName, response) {\n  const viewID = misc.uuidv4().slice(0, 8);\n  const edgesID = response.workflowID.slice(0, 8);\n  return updateItem(storeID, item => {\n    item.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n      viewID: viewID,\n      name: `${nodesName}_${response.name}`,\n      viewType: 'network',\n      nodes: nodesID,\n      edges: edgesID,\n      minConnThld: response.query.params.threshold\n    });\n    item.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: edgesID,\n      name: response.name,\n      contents: [response]\n    });\n  }).then(() => viewID);\n}\n\n\nexport default {\n  reset, getAllItems, getItem, updateItem, deleteItem,\n  getView, appendView, updateView, deleteView,\n  getAllCollections, getCollection, updateCollection,\n  importItem, newDatagrid, newNetwork\n};\n","\n/** @module component/badge */\n\nimport d3 from 'd3';\n\nconst assetBaseURL = '../assets/';\nconst iconBaseURL = '../assets/icon/';\n\n\nfunction badge(selection) {\n  selection.classed('badge', true);\n  selection.append('img')\n      .classed('icon', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('text', true);\n}\n\n\nfunction updateBadge(selection, text, type, icon) {\n  selection.classed(`badge-${type}`, true);\n  selection.select('.icon')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null);\n  selection.select('.text')\n      .text(text);\n}\n\n\nfunction notify(selection) {\n  selection\n    .style('opacity', 0)\n    .style('display', 'inline')\n    .transition()\n      .duration(500)\n      .ease(d3.easeLinear)\n      .style(\"opacity\", 1.0)\n    .transition()\n      .delay(3000)\n      .duration(1000)\n      .ease(d3.easeLinear)\n      .style(\"opacity\", 0)\n      .on('end', function () {\n        selection.style('display', 'none');\n      });\n}\n\n\nfunction loadingCircle(selection) {\n  selection\n      .style('display', 'none')\n    .append('img')\n      .attr('src', `${assetBaseURL}loading1.gif`)\n      .style('width', '2rem')\n      .style('height', '2rem');\n}\n\n\nfunction alert(selection) {\n  selection.classed('alert', true)\n      .classed('px-1', true)\n      .classed('py-0', true);\n  selection.append('img')\n      .classed('icon', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('text', true)\n      .style('font-size', '75%');\n}\n\n\nfunction updateAlert(selection, text, type, icon) {\n  selection.classed(`alert-${type}`, true);\n  selection.select('.icon')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null);\n  selection.select('.text')\n      .text(text);\n}\n\n\nfunction invalidFeedback(selection) {\n  selection.classed('invalid-feedback', true)\n      .style('display', 'none');\n  selection.append('img')\n      .classed('icon', true)\n      .attr('src', `${iconBaseURL}caution-salmon.svg`)\n      .style('width', '1rem')\n      .style('height', '1rem');\n  selection.append('span')\n      .classed('invalid-msg', true);\n}\n\nfunction updateInvalidMessage(selection, msg) {\n  selection.select('.invalid-msg')\n      .text(msg);\n}\n\n\nexport default {\n  badge, updateBadge, notify, loadingCircle,\n  alert, updateAlert, invalidFeedback, updateInvalidMessage\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\nconst iconBaseURL = '../assets/icon/';\n\n\nfunction buttonBox(selection, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .text(label);\n}\n\n\nfunction menuButton(selection, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, label, type, icon) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, target, label, type, icon) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('href', '#')\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('label', true)\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, label, type, icon) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  const button = selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  button.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  button.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, label, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, label, target, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', `${iconBaseURL}${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, label, accept, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#')\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      });\n  selection.append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n  selection.append('img')\n      .attr('src', `${iconBaseURL}${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  iconBaseURL, buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module component/transform */\n\n\nfunction transform(selection, tx, ty, tk) {\n  selection.select('.field')\n    .attr('transform', `translate(${tx}, ${ty}) scale(${tk})`);\n}\n\n\nfunction resize(selection, state) {\n  const area = selection.node();\n  const width = area.offsetWidth;\n  const height = area.offsetHeight;\n  selection.select('.view')\n      .attr('viewBox', `0 0 ${width} ${height}`)\n    .select('.boundary')\n      .attr('width', width)\n      .attr('height', height);\n  state.setViewBox(width, height);\n  state.resizeNotifier();\n}\n\n\nfunction viewFrame(selection, state) {\n  selection\n    .style('width', '100%')\n    .style('height', '100%');\n  selection.select('.view').remove(); // Clean up\n  selection.append('svg')\n    .classed('view', true);\n  selection.call(resize, state);\n}\n\n\nfunction view(selection, state) {\n  selection\n    .attr('preserveAspectRatio', 'xMinYMin meet')\n    .attr('pointer-events', 'all')\n    .attr('viewBox', `0 0 ${state.viewBox.right} ${state.viewBox.bottom}`)\n    .style('width', '100%')\n    .style('height', '100%');\n\n  // Clean up\n  selection.select('.boundary').remove();\n  selection.select('.field').remove();\n\n  // Boundary\n  selection.append('rect')\n      .classed('boundary', true)\n      .attr('x', 0)\n      .attr('y', 0)\n      .attr('width', state.viewBox.right)\n      .attr('height', state.viewBox.bottom)\n      .attr('fill', '#ffffff')\n      .attr('stroke-width', 1)\n      .attr('stroke', '#cccccc');\n  // Field\n  selection.append('g')\n      .classed('field', true)\n      .style('opacity', 1e-6)\n    .transition()\n      .duration(1000)\n      .style('opacity', 1);\n}\n\n\nexport default {\n  transform, resize, viewFrame, view\n};\n","\n/** @module component/formBox */\n\nimport d3 from 'd3';\n\nimport {default as badge} from './badge.js';\n\n\nfunction updateFormValue(selection, value) {\n  selection.select('.form-control').property('value', value);\n  selection.call(setValidity, true);  // Clear validity state\n}\n\n\nfunction formValue(selection) {\n  return selection.select('.form-control').property('value');\n}\n\n\nfunction formValid(selection) {\n  return selection.select('.form-control').node().checkValidity();\n}\n\n\nfunction setValidity(selection, valid) {\n  selection.select('.invalid-feedback')\n      .style('display', valid ? 'none': 'inherit');\n  selection.select('.form-control')\n      .style('background-color', valid ? null : '#ffcccc');\n}\n\n\nfunction textBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .on('input', function () {\n        const valid = formValid(selection);\n        selection.call(setValidity, valid);\n      });\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\n\nfunction readonlyBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .attr('readonly', 'readonly');\n}\n\nfunction updateReadonlyValue(selection, value) {\n  selection.select('.form-control-plaintext').property('value', value);\n}\n\nfunction readonlyValue(selection) {\n  return selection.select('.form-control-plaintext').property('value');\n}\n\n\nfunction textareaBox(selection, label, rows, placeholder) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  const formLabel = selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  formLabel.append('div')\n      .call(badge.invalidFeedback);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows)\n      .attr('placeholder', placeholder)\n      .on('input', function () {\n        const valid = textareaValid(selection);\n        selection.call(setValidity, valid);\n      });\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n')\n    .map(e => e.replace(/^\\s+|\\s+$/g, ''))  // strip spaces\n    .filter(e => e.length > 0);\n  return [];\n}\n\nfunction textareaValid(selection) {\n  return /\\s*?\\w\\s*?/.test(formValue(selection));\n}\n\n\nfunction checkBox(selection, label) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox');\n  box.append('span')\n      .text(label);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'number')\n      .on('input', function () {\n        const valid = formValid(selection);\n        selection.call(setValidity, valid);\n      });\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\nfunction updateNumberRange(selection, min, max, step) {\n  selection.select('.form-control')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step)\n      .dispatch('input', {bubbles: true});\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n    .append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'color');\n}\n\n\nfunction fileInputBox(selection, label, accept) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('form-control-file', true)\n      .classed('col-8', true)\n      .attr('type', 'file')\n      .attr('accept', accept)\n      .on('change', function () {\n        const valid = fileInputValid(selection);\n        selection.call(setValidity, valid);\n      });\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\nfunction clearFileInput(selection) {\n  // TODO: FileList object (input.files) may be a readonly property\n  const label = selection.select('label').text();\n  const accept = selection.select('input').attr('accept');\n  selection.selectAll('*').remove();\n  selection.call(fileInputBox, label, accept);\n}\n\nfunction fileInputValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\nfunction fileInputValid(selection) {\n  // TODO: attribute 'require' does not work with input type=file\n  return selection.select('input').property('files').length > 0;\n}\n\n\nexport default {\n  updateFormValue, formValue, formValid, setValidity,\n  textBox, readonlyBox, updateReadonlyValue, readonlyValue,\n  textareaBox, textareaBoxLines, textareaValid,\n  numberBox, updateNumberRange,\n  checkBox, updateCheckBox, checkBoxValue,\n  colorBox,\n  fileInputBox, clearFileInput, fileInputValue, fileInputValid\n};\n","\n/** @module component/modal */\n\nimport d3 from 'd3';\n\n\nfunction dialogBase(selection, id) {\n  selection\n      .classed('modal', true)\n      .attr('tabindex', -1)\n      .attr('role', 'dialog')\n      .attr('aria-labelledby', '')\n      .attr('aria-hidden', true)\n      .attr('id', id);\n  selection.append('div')\n      .classed('modal-dialog', true)\n      .attr('role', 'document')\n    .append('div')\n      .classed('modal-content', true);\n}\n\n\nfunction confirmDialog(selection, id) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // body\n  base.append('div')\n      .classed('modal-body', true)\n    .append('div')\n      .classed('message', true);\n  // footer\n  const footer = base.append('div')\n      .classed('modal-footer', true);\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-outline-secondary', true)\n      .classed('cancel', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Cancel');\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-warning', true)\n      .classed('ok', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('OK')\n      .on('click', () => {\n        selection.dispatch('submit');\n      });\n}\n\n\nfunction updateConfirmDialog(selection, message) {\n  selection.select('.message').text(message);\n}\n\n\nfunction submitDialog(selection, id, title) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // header\n  const header = base.append('div')\n      .classed('modal-header', true);\n  header.append('h4')\n      .classed('modal-title', true)\n      .text(title);\n  header.append('button')\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('aria-label', 'Close')\n      .classed('close', true)\n    .append('span')\n      .attr('aria-hidden', true)\n      .html('&times;');\n  // body\n  base.append('div')\n      .classed('modal-body', true);\n  // footer\n  base.append('div')\n      .classed('modal-footer', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-primary', true)\n      .classed('submit', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Submit')\n      .on('click', () => {\n        // Dismiss before submit\n        // Submit event can update the modal itself\n        // (ex. disable submit button before onSubmit call has completed)\n        $(`#${id}`).modal('hide');\n        selection.dispatch('submit');\n      });\n}\n\n\nexport default {\n  confirmDialog, updateConfirmDialog, submitDialog\n};\n","\n/** @module dialog/rename */\n\nimport d3 from 'd3';\n\nimport {default as badge} from '../component/badge.js';\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'rename-dialog';\nconst title = 'Rename';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-edittext');\n}\n\n\nfunction body(selection) {\n  const renameBox = selection.call(modal.submitDialog, id, title)\n    .select('.modal-body').append('div')\n      .classed('rename', true)\n      .call(box.textBox, 'New name');\n  renameBox.select('.form-control')\n      .attr('required', 'required');\n  renameBox.select('.invalid-feedback')\n      .call(badge.updateInvalidMessage, 'Please provide a valid name');\n}\n\n\nfunction updateBody(selection, name) {\n  selection.select('.rename')\n      .call(box.formValue, name)\n      .on('input', function () {\n        const valid = box.formValid(d3.select(this));\n        selection.select('.submit').property('disabled', !valid);\n      })\n      .dispatch('input');\n}\n\n\nfunction value(selection) {\n  return box.formValue(selection.select('.rename'));\n}\n\n\nexport default {\n  menuLink, body, updateBody, value\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '../req/';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\nfunction serverStatus() {\n  const response = {};\n  return get('server')\n    .then(json)\n    .then(res => {\n      response.server = res;\n    })\n    .then(() => get('schema'))\n    .then(json)\n    .then(res => {\n      response.schema = res;\n    })\n    .then(() => response);\n}\n\n\nexport default {\n  get, json, text, blob, post, error, serverStatus\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: [keyField].concat(mp.fields),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: table.fields.filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key)),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: fields,\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(mp.fields)\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module common/collection */\n\nimport _ from 'lodash';\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as mapper} from './mapper.js';\n\n\nexport default class Collection {\n  /**\n   * Create Collection from a flashflood response datatable\n   * If data is not specified, put datatables later by this.append(data)\n   * @param {object} coll - Collection or response object\n   */\n  constructor(coll) {\n    // Settings\n    this.autoIndex = 'index';  // enumerate records\n\n    this.collectionID = coll.collectionID || null;\n    this.storeID = coll.storeID || null;\n    this.name = coll.name || null;\n    if (coll.records) {\n      this.contents = [coll];\n      this.fields = [];\n    } else {\n      this.contents = coll.contents;\n      this.fields = coll.fields || [];\n    }\n    this.contents.forEach(content => {\n      content.fields.forEach(e => this.addField(e));\n    });\n  }\n\n  /**\n   * Add fields\n   * @param {array} fs - list of fields\n   */\n  addField(field) {\n    if (this.fields.find(e => e.key === field.key)) return;\n    if (!field.hasOwnProperty('name')) field.name = field.key;\n    if (!field.hasOwnProperty('visible')) field.visible = true;\n    if (field.hasOwnProperty('d3_format')) field.format = 'd3_format';\n    if (!field.hasOwnProperty('format')) field.format = 'raw';\n    this.fields.push(field);\n  }\n\n  /**\n   * Update fields properties\n   * @param {array} fs - list of fields\n   */\n  updateFields(fs) {\n    this.fields = [];\n    fs.forEach(e => this.addField(e));\n  }\n\n  /**\n   * Join fields\n   * @param {object} mapping - column mapper object\n   */\n  joinFields(mapping) {\n    this.contents.forEach(c => {\n      mapper.apply(c, mapping);\n    });\n    if (mapping.hasOwnProperty('fields')) {\n      mapping.fields.forEach(e => this.addField(e));\n    } else {\n      this.addField(mapping.field);\n    }\n  }\n\n  /**\n   * Apply function to the original data records\n   * new fields should be manually added by Collection.addField\n   * @param {function} func - function to be applied\n   */\n  apply(func) {\n    this.contents.forEach(content => {\n      content.records.forEach(rcd => {\n        func(rcd);\n      });\n    });\n  }\n\n  /**\n   * Return all records of the collection\n   * @return {array} records\n   */\n  records() {\n    return _.flatten(this.contents.map(e => e.records));\n  }\n\n  fetch(command) {\n    const fs = this.contents\n      .filter(e => ['running', 'ready', 'interrupted', 'queued'].includes(e.status))\n      .map(content => {\n        const query = {id: content.workflowID, command: command};\n        return fetcher.get('progress', query)\n          .then(fetcher.json)\n          .then(data => {\n            return idb.updateCollection(this.storeID, this.collectionID, coll => {\n              const i = coll.contents\n                .findIndex(e => e.workflowID === query.id);\n              if (data.status === 'failure') {  // No data found on server\n                coll.contents[i].status = 'failure';\n              } else {\n                coll.contents[i] = data;\n              }\n            });\n          });\n      });\n    return Promise.all(fs)\n      .then(() => idb.getCollection(this.storeID, this.collectionID))\n      .then(coll => {\n        this.contents = coll.contents;\n      });\n  }\n\n  /**\n   * Retrieve workflows and store it into a local store.\n   * @return {Promise}\n   */\n  pull() {\n    return this.fetch('pull');\n  }\n\n  /**\n   * Retrieve workflows, abort all ongoing workflow task\n   * and store it into a local store.\n   * @return {Promise}\n   */\n  abort() {\n    return this.fetch('abort');\n  }\n\n  /**\n   * Return total number of records\n   * @return {float} total number of records\n   */\n  size() {\n    return _.sum(this.contents.map(e => e.records.length));\n  }\n\n  /**\n   * Return status\n   * @return {string} status\n   */\n  status() {\n    if (this.contents.some(e => e.status === 'interrupted')) return 'interrupted';\n    if (this.contents.some(e => e.status === 'running')) return 'running';\n    if (this.contents.some(e => e.status === 'queued')) return 'queued';\n    if (this.contents.some(e => e.status === 'ready')) return 'ready';\n    if (this.contents.some(e => e.status === 'aborted')) return 'aborted';\n    if (this.contents.some(e => e.status === 'failure')) return 'failure';\n    return 'done';\n  }\n\n  /**\n   * Return ongoing or not\n   * @return {bool} ongoing or not\n   */\n  ongoing() {\n    const s = ['ready', 'queued', 'running', 'interrupted'];\n    return s.includes(this.status());\n  }\n\n  /**\n   * Return percentage of workflow progress\n   * @return {float} progress in percent\n   */\n  progress() {\n    return _.min(this.contents.map(e => e.progress));\n  }\n\n  /**\n   * Return total execution time\n   * @return {float} total time\n   */\n  execTime() {\n    return _.sum(this.contents.map(e => e.execTime));\n  }\n\n  /**\n   * Export collection object as JSON\n   * @return {object} collection JSON\n   */\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: this.collectionID,\n      name: this.name,\n      fields: this.fields,\n      contents: this.contents\n    };\n  }\n}\n","\n/** @module common/transform */\n\nimport d3 from 'd3';\n\n\nexport default class TransformState {\n  constructor(width, height, transform) {\n    this.fieldWidth = width;\n    this.fieldHeight = height;\n\n    this.viewBox = {\n      top: 0,\n      right: this.fieldWidth,\n      bottom: this.fieldHeight,\n      left: 0\n    };\n\n    this.focusArea = {};\n    this.focusAreaMargin = 50;\n\n    this.boundary = {\n      top: 0,\n      right: this.fieldWidth,\n      bottom: this.fieldHeight,\n      left: 0\n    };\n\n    this.transform = transform || {x: 0, y: 0, k: 1};\n    this.prevTransform = {\n      x: this.transform.x,\n      y: this.transform.y,\n      k: this.transform.k\n    };\n\n    this.resizeNotifier = () => {};\n  }\n\n  setFocusArea() {\n    const tx = this.transform.x;\n    const ty = this.transform.y;\n    const tk = this.transform.k;\n    const margin = this.focusAreaMargin;\n    this.focusArea.top = (this.viewBox.top - ty) / tk - margin;\n    this.focusArea.left = (this.viewBox.left - tx) / tk - margin;\n    this.focusArea.bottom = (this.viewBox.bottom - ty) / tk + margin;\n    this.focusArea.right = (this.viewBox.right - tx) / tk + margin;\n    // this.showFocusArea();  // debug\n  }\n\n  setViewBox(width, height) {\n    this.viewBox.right = width;\n    this.viewBox.bottom = height;\n    // this.showViewBox();  // debug\n    this.setFocusArea();\n  }\n\n  setTransform(tx, ty, tk) {\n    this.transform.x = tx;\n    this.transform.y = ty;\n    this.transform.k = tk;\n    // this.showTransform(); // debug\n    this.setFocusArea();\n  }\n\n  fitTransform() {\n    const vh = this.viewBox.bottom;\n    const vw = this.viewBox.right;\n    const vr = vw / vh;\n    const bh = this.boundary.bottom - this.boundary.top;\n    const bw = this.boundary.right - this.boundary.left;\n    const br = bw / bh;\n    const isPortrait = vr >= br;\n    const tk = isPortrait ? vh / bh : vw / bw;\n    const adjustH = isPortrait ? (vw - bw * tk) / 2 : 0;\n    const adjustV = isPortrait ? 0 : (vh - bh * tk) / 2;\n    const tx = -(this.boundary.left) * tk + adjustH;\n    const ty = -(this.boundary.top) * tk + adjustV;\n    this.setTransform(tx, ty, tk);\n  }\n\n  showTransform() {\n    d3.select('#debug-transform')\n      .text(JSON.stringify(this.transform));\n  }\n\n  showFocusArea() {\n    d3.select('#debug-focusarea')\n      .text(JSON.stringify(this.focusArea));\n  }\n\n  showViewBox() {\n    d3.select('#debug-viewbox')\n      .text(JSON.stringify(this.viewBox));\n  }\n}\n","\n/** @module tile/state */\n\nimport _ from 'lodash';\n\nimport Collection from '../common/collection.js';\nimport TransformState from  '../common/transform.js';\nimport {default as idb} from '../common/idb.js';\n\n\nexport default class TileState extends TransformState {\n  constructor(view, items) {\n    super(1200, 800, view.fieldTransform);\n\n    /* Settings */\n\n    this.chunkMarginRatio = 0.05;\n\n    this.focusedViewThreshold = 200;\n    this.enableFocusedView = true;\n    this.focusedView = false;\n\n\n    /* Attributes */\n\n    this.viewID = view.viewID || null;\n    this.storeID = view.storeID || null;\n    this.name = view.name;\n\n    this.items = new Collection(items);\n    this.its = JSON.parse(JSON.stringify(this.items.records()));\n\n\n    /* Appearance */\n\n    this.rowCount = view.rowCount || 8;\n    this.columnCount = view.columnCount || 12;\n    this.groupField = view.groupField || null;\n    this.chunksPerRow = view.chunksPerRow || 1;\n    this.fixRowCount = view.fixRowCount || false;\n    this.fixColumnCount = view.fixColumnCount || false;\n    this.tileAspectRatio = 1;\n    this.showRowNumber = view.showRowNumber || false;\n    this.showColumnNumber = view.showColumnNumber || false;\n\n    /* Appearance */\n    const defaultTileField = this.items.fields[0].key || null;\n    const fillIfNull = (obj, updater) => {\n      Object.entries(updater).forEach(e => {\n        if (!obj.hasOwnProperty(e[0])) {\n          obj[e[0]] = e[1];\n        }\n      });\n    };\n\n    this.tileContent = {};\n    const defaultTileContent = {\n      field: null, visible: false\n    };\n    if (view.hasOwnProperty('tileContent')) {\n      this.tileContent = view.tileContent;\n    }\n    fillIfNull(this.tileContent, defaultTileContent);\n\n    this.tileColor = {};\n    const defaultTileColor = {\n      field: defaultTileField, color: 'monogray',\n      scale: 'linear', domain: [0, 1],\n      range: ['#7fffd4', '#7fffd4'], unknown: '#7fffd4'\n    };\n    if (view.hasOwnProperty('tileColor')) {\n      this.tileColor = view.tileColor;\n    }\n    fillIfNull(this.tileColor, defaultTileColor);\n\n    this.tileValue = {};\n    const defaultTileValue = {\n      field: null, size: 12, visible: false,\n      halign: 2, valign: 2\n    };\n    if (view.hasOwnProperty('tileValue')) {\n      this.tileValue = view.tileValue;\n    }\n    fillIfNull(this.tileValue, defaultTileValue);\n\n    this.tileValueColor = {};\n    const defaultTileValueColor = {\n      field: defaultTileField, color: 'monoblack',\n      scale: 'linear', domain: [0, 1],\n      range: ['#7fffd4', '#7fffd4'], unknown: '#7fffd4'\n    };\n    if (view.hasOwnProperty('tileValueColor')) {\n      this.tileValueColor = view.tileValueColor;\n    }\n    fillIfNull(this.tileValueColor, defaultTileValueColor);\n\n\n    // Drawing\n    this.scaleExtent = [1, Infinity];\n    this.translateExtent = [[0, 0], [this.fieldWidth, Infinity]];\n\n    this.chunkWidth = null;\n    this.chunkHeight = null;\n    this.chunkMarginH = null;\n    this.chunkMarginV = null;\n    this.columnWidth = null;\n    this.rowHeight = null;\n\n    // Event listener\n    this.zoomListener = null;\n\n    // Event notifiers\n    this.updateFieldNotifier = null;\n    this.updateItemNotifier = null;\n    this.updateItemAttrNotifier = null;\n  }\n\n  setViewBox(width, height) {\n    this.viewBox.right = width;\n    this.viewBox.bottom = height;\n    // this.showViewBox();  // debug\n    const vw = this.viewBox.right;\n    const bw = this.boundary.right - this.boundary.left;\n    this.scaleExtent = [vw / bw, Infinity];\n    this.translateExtent = [[0, 0], [bw, Infinity]];\n    this.setTransform(0, 0, vw / bw);\n    this.setFocusArea();\n  }\n\n  setCoords() {\n    this.its.forEach(item => {\n      const cRow = Math.floor(item.chunk / this.chunksPerRow);\n      const cCol = item.chunk % this.chunksPerRow;\n      item.x = this.chunkWidth * cCol + this.chunkMarginH * (cCol + 1) + this.columnWidth * item.col;\n      item.y = this.chunkHeight * cRow + this.chunkMarginV * (cRow + 1) + this.rowHeight * item.row;\n    });\n  }\n\n  setIndices() {\n    const tileCount = this.columnCount * this.rowCount;\n    let totalChunks = 0;\n    Object.entries(_.groupBy(this.its, this.groupBy))\n      .sort(group => group[0])\n      .forEach((group, i) => {\n        group[1].forEach((rcd, j) => {\n          const tileIdx = j % tileCount;\n          rcd.group = i;\n          rcd.chunk = Math.floor(j / tileCount) + totalChunks;\n          rcd.row = Math.floor(tileIdx / this.columnCount);\n          rcd.col = tileIdx % this.columnCount;\n        });\n        totalChunks += Math.ceil(group[1].length / tileCount);\n    });\n    this.setCoords();\n  }\n\n  setFieldSize() {\n    this.chunkWidth = this.fieldWidth /\n      (this.chunksPerRow + this.chunkMarginRatio * (this.chunksPerRow + 1));\n    this.chunkHeight = this.chunkWidth * this.tileAspectRatio;\n    this.chunkMarginH = this.chunkWidth * this.chunkMarginRatio;\n    this.chunkMarginV = this.chunkHeight * this.chunkMarginRatio;\n    this.columnWidth = this.chunkWidth / this.columnCount;\n    this.rowHeight = this.columnWidth * this.tileAspectRatio;\n    this.setIndices();\n  }\n\n  itemsToRender() {\n    return this.its.filter(\n      e => this.focusArea.top < e.y\n        && this.focusArea.left < e.x\n        && this.focusArea.bottom > e.y\n        && this.focusArea.right > e.x\n    );\n  }\n\n  save() {\n    return idb.updateItem(this.storeID, item => {\n      const i = item.items\n        .findIndex(e => e.collectionID === this.items.collectionID);\n      item.items[i] = this.items.export();\n      const vi = item.views.findIndex(e => e.viewID === this.viewID);\n      item.views[vi] = this.export();\n    });\n  }\n\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/tile_v1.0.json\",\n      viewID: this.viewID,\n      name: this.name,\n      viewType: \"tile\",\n      items: this.items.collectionID,\n      rowCount: this.rowCount,\n      columnCount: this.columnCount,\n      groupField: this.groupField,\n      chunksPerRow: this.chunksPerRow,\n      tileContent: this.tileContent,\n      tileColor: this.tileColor,\n      tileValue: this.tileValue,\n      tileValueColor: this.tileValueColor,\n      fieldTransform: this.transform\n    };\n  }\n}\n","\n/** @module common/scale */\n\nimport d3 from 'd3';\n\n\nconst colorScales = [\n  {key: 'monoblack', type: 'monocolor', colors: ['#333333'], unknown: '#333333'},\n  {key: 'monogray', type: 'monocolor', colors: ['#cccccc'], unknown: '#cccccc'},\n  {key: 'nodeDefault', type: 'monocolor', colors: ['#7fffd4'], unknown: '#7fffd4'},\n  {key: 'aquamarine', type: 'bicolor',\n   colors: ['#778899', '#7fffd4'], unknown: '#f0f0f0'},\n  {key: 'chartreuse', type: 'bicolor',\n   colors: ['#778899', '#7fff00'], unknown: '#f0f0f0'},\n  {key: 'salmon', type: 'bicolor',\n   colors: ['#778899', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'violet', type: 'bicolor',\n   colors: ['#778899', '#ee82ee'], unknown: '#f0f0f0'},\n  {key: 'temperature', type: 'tricolor',\n   colors: ['#87ceeb', '#fff5ee', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'spectrum', type: 'tricolor',\n   colors: ['#6495ed', '#ccff66', '#ffa500'], unknown: '#f0f0f0'},\n  {key: 'category10', type: 'categorical',\n   colors: ['#8dd3c7','#ffffb3','#bebada','#fb8072','#80b1d3','#fdb462',\n    '#b3de69','#fccde5','#bc80bd','#ccebc5'], unknown: '#f0f0f0'},\n  {key: 'cbsafe', type: 'categorical',\n   colors: ['#543005','#8c510a','#bf812d','#dfc27d','#f6e8c3','#c7eae5',\n   '#80cdc1','#35978f','#01665e','#003c30'], unknown: '#f0f0f0'},\n  {key: 'category20', type: 'categorical',\n   colors: d3.schemePaired.concat(d3.schemeSet2), unknown: '#f0f0f0'},\n  {key: 'category40', type: 'categorical',\n   colors: d3.schemePaired.concat(d3.schemePastel2, d3.schemeSet2, d3.schemeSet3),\n   unknown: '#f0f0f0'},\n  {key: 'custom', type: 'custom', colors: ['#ffffff'], text: 'custom'}\n];\n\n\nconst types = [\n  {key: 'linear', name: 'Linear', func: d3.scaleLinear},\n  {key: 'log', name: 'Log', func: d3.scaleLog},\n  {key: 'quantize', name: 'Quantize', func: d3.scaleQuantize},\n  {key: 'ordinal', name: 'Ordinal', func: d3.scaleOrdinal}\n];\n\n\nfunction scaleFunction(state) {\n  const cscale = colorScales.find(e => e.key === state.color);\n  let range;\n  let unknown;\n  if (cscale && cscale.key !== 'custom') {\n      range = cscale.colors;\n      unknown = cscale.unknown;\n  } else {\n    range = state.range;\n    unknown = state.unknown;\n  }\n  let domain = null;\n  if (range.length === 3) {\n    const mid = (parseFloat(state.domain[0]) + parseFloat(state.domain[1])) / 2;\n    domain = [state.domain[0], mid, state.domain[1]];\n  } else {\n    domain = state.domain;\n  }\n  // Build\n  let scaleFunc = types.find(e => e.key === state.scale).func();\n  scaleFunc = scaleFunc.domain(domain);\n  scaleFunc = scaleFunc.range(range);\n  if (['linear', 'log'].includes(state.scale)) {\n    scaleFunc = scaleFunc.clamp(true);\n  }\n\n  return d => {\n    // Sanitize\n    if (d === '' || typeof d === 'undefined' || d === null) {\n      return unknown;  // invalid values\n    }\n    if (['linear', 'log'].includes(state.scale) && parseFloat(d) != d) {\n      return unknown;  // texts\n    }\n    if (state.scale === 'log' && d <= 0) {\n      return unknown;  // negative values in log scale\n    }\n    // Apply function\n    const result = scaleFunc(d);\n    if (result === undefined) {\n      return unknown;  // TODO: specify unexpected behavior\n    }\n    return result;\n  };\n}\n\n\nfunction isD3Format(notation) {\n  try {\n    d3.format(notation);\n  } catch (err) {\n    return false;\n  }\n  return true;\n}\n\n\nexport default {\n  colorScales, types, scaleFunction, isD3Format\n};\n","\n/** @module tile/component */\n\nimport {default as scale} from '../common/scale.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as transform} from '../component/transform.js';\n\n\nfunction updateItems(selection, state) {\n  const itemsToRender = state.itemsToRender();\n  const items = selection.selectAll('.item')\n    .data(itemsToRender, d => d.index);\n  items.exit().remove();\n  const entered = items.enter()\n    .append('g')\n      .attr('class', 'item');\n  entered.append('rect')\n      .attr('class', 'tile')\n      .attr('x', 0)\n      .attr('y', 0)\n      .style('stroke-width', 1)\n      .style('stroke', '#cccccc');\n  entered.append('g')\n      .attr('class', 'tile-content');\n  entered.append('text')\n      .attr('class', 'tile-value');\n  const merged = entered.merge(items);\n  merged.select('.tile')\n      .attr('width', state.columnWidth)\n      .attr('height', state.rowHeight);\n  if (state.enableFocusedView) {\n    state.focusedView = itemsToRender.length < state.focusedViewThreshold;\n  }\n  if (state.focusedView && state.tileContent.visible) {\n    merged.select('.tile-content').html(d => d.structure);\n    merged.select('.tile-content')\n      .select('svg')\n        .attr('width', state.columnWidth)\n        .attr('height', state.rowHeight);\n  } else {\n    merged.select('.tile-content').select('svg').remove();\n  }\n  selection.call(updateItemAttrs, state);\n}\n\n\nfunction updateItemAttrs(selection, state) {\n  const colorConv = scale.scaleFunction(state.tileColor);\n  const valueColorConv = scale.scaleFunction(state.tileValueColor);\n  const items = selection.selectAll('.item')\n      .attr('transform', d => `translate(${d.x}, ${d.y})`);\n  items.select('.tile')\n      .style('fill', d => colorConv(d[state.tileColor.field]));\n  items.select('.tile-value')\n      .text(d => {\n        if (state.tileValue.field === null) return '';\n        const field = state.items.fields\n          .find(e => e.key === state.tileValue.field);\n        if (field.format === 'd3_format') {\n          return misc.formatNum(d[state.tileValue.field], field.d3_format);\n        }\n        return d[state.tileValue.field];\n      })\n      .attr('x', state.columnWidth * 0.05)\n      .attr('y', state.rowHeight * 0.75)\n      .attr('font-size', state.rowHeight * 0.5)\n      .attr('textLength', state.columnWidth * 0.9)\n      .attr('lengthAdjust', 'spacingAndGlyphs')\n      .attr('visibility', state.tileValue.visible ? 'inherit' : 'hidden')\n      .style('fill',\n        d => valueColorConv(d[state.tileValueColor.field]));\n}\n\n\nfunction tileView(selection, state) {\n  selection.call(transform.view, state);\n  const items = selection.select('.field')\n    .append('g').classed('tl-items', true);\n  state.updateFieldNotifier = () => {\n    state.setFieldSize();\n    items.call(updateItems, state);\n  };\n  state.updateItemNotifier = () => {\n    items.call(updateItems, state);\n  };\n  state.updateItemAttrNotifier = () => {\n    items.call(updateItemAttrs, state);\n  };\n  state.updateFieldNotifier();\n}\n\n\nexport default {\n  updateItems, updateItemAttrs, tileView\n};\n","\n/** @module tile/interaction */\n\nimport d3 from 'd3';\n\nimport {default as transform} from '../component/transform.js';\n\n\nfunction zoomListener(selection, state) {\n  return d3.zoom()\n    .scaleExtent(state.scaleExtent)\n    .translateExtent(state.translateExtent)\n    .on('zoom', function() {\n      const t = d3.event.transform;\n      selection.call(transform.transform, t.x, t.y, t.k);\n    })\n    .on('end', function() {\n      const t = d3.event.transform;\n      state.setTransform(t.x, t.y, t.k);\n      state.prevTransform = {x: t.x, y: t.y, k: t.k};\n      state.updateItemNotifier();\n    });\n}\n\n\nfunction setInteraction(selection, state) {\n  state.zoomListener = zoomListener(selection, state);\n  selection.call(state.zoomListener);\n  state.resizeNotifier = () => {\n    selection.call(setInteraction, state);\n    state.updateItemNotifier();\n  };\n  // Resume zoom event\n  const t = state.transform;\n  selection\n      .call(transform.transform, t.x, t.y, t.k)\n      .call(\n        d3.zoom().transform,\n        d3.zoomIdentity.translate(t.x, t.y).scale(t.k)\n      );\n}\n\n\nexport default {\n  zoomListener, setInteraction\n};\n","\n/** @module component/shape */\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction monocolorBar(selection, colors, text) {\n  selection.attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none');\n  const group = selection.append('g');\n  group.append('rect')\n      .attr('x', 0).attr('y', 0)\n      .attr('width', 100).attr('height', 10)\n      .attr('fill', colors[0]);\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 10)\n      .attr('font-size', 12)\n      .text(text);\n}\n\nfunction bicolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n      .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n      .attr('offset', 1).attr('stop-color', colors[1]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction tricolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n    .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n    .attr('offset', 0.5).attr('stop-color', colors[1]);\n  grad.append('stop')\n    .attr('offset', 1).attr('stop-color', colors[2]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction categoricalBar(selection, colors, text) {\n  selection.attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none');\n  const sw = 100 / colors.length;\n  const group = selection.append('g');\n  colors.forEach((e, i) => {\n    group.append('rect')\n        .attr('x', sw * i).attr('y', 0)\n        .attr('width', sw).attr('height', 20)\n        .attr('fill', colors[i]);\n  });\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 20)\n      .attr('font-size', 20)\n      .text(text);\n}\n\nfunction setSize(selection, width, height) {\n  selection.attr('width', width).attr('height', height);\n}\n\n\nconst colorBar = {\n  'monocolor': monocolorBar,\n  'bicolor': bicolorBar,\n  'tricolor': tricolorBar,\n  'categorical': categoricalBar,\n  'custom': monocolorBar\n};\n\n\nexport default {\n  colorBar, setSize\n};\n","\n/** @module component/formListBox */\n\nimport d3 from 'd3';\n\nimport {default as badge} from './badge.js';\nimport {default as box} from './formBox.js';\nimport {default as shape} from './shape.js';\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction selectBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('select')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .on('input', function () {\n        const valid = box.formValid(selection);\n        selection.call(box.setValidity, valid);\n      });\n}\n\nfunction updateSelectBoxOptions(selection, items) {\n  const options = selection.select('select')\n    .selectAll('option')\n      .data(items, d => d.key);\n  options.exit().remove();\n  options.enter()\n    .append('option')\n      .attr('value', d => d.key)\n      .text(d => d.name);\n}\n\nfunction selectedRecord(selection) {\n  const value = box.formValue(selection);\n  return selection.selectAll('select option').data()\n      .find(e => e.key === value);\n}\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction checklistBox(selection, label) {\n  // TODO: scroll\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  const formLabel = selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  formLabel.append('div')\n      .call(badge.invalidFeedback);\n  selection.append('ul')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n}\n\nfunction updateChecklistItems(selection, items) {\n  const listitems = selection.select('ul')\n    .selectAll('li')\n      .data(items, d => d.key);\n  listitems.exit().remove();\n  const form = listitems.enter()\n    .append('li')\n      .attr('class', 'form-check')\n    .append('label')\n      .attr('class', 'form-check-label');\n  form.append('input')\n      .attr('type', 'checkbox')\n      .attr('class', 'form-check-input')\n      .property('value', d => d.key);\n  form.append('span')\n      .text(d => d.name);\n}\n\nfunction checkRequired(selection) {\n  selection.selectAll('input')\n      .on('change', function () {\n        const valid = anyChecked(selection);\n        selection.call(setChecklistValidity, valid);\n      });\n}\n\nfunction updateChecklistValues(selection, values) {\n  selection.selectAll('input')\n    .each(function (d) {\n      d3.select(this).property('checked', values.includes(d.key));\n    });\n  selection.call(setChecklistValidity, true);  // Clear validity state\n}\n\nfunction checklistValues(selection) {\n  return selection.selectAll('input:checked').data().map(d => d.key);\n}\n\nfunction anyChecked(selection) {\n  return checklistValues(selection).length > 0;\n}\n\nfunction setChecklistValidity(selection, valid) {\n  selection.select('.invalid-feedback')\n      .style('display', valid ? 'none': 'inherit');\n  selection.select('.form-control')\n      .style('background-color', valid ? null : 'LightPink');\n}\n\n\nfunction colorScaleBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label || 'Colorscale');\n  const form = selection.append('div')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n  const dropdown = form.append('div')\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  dropdown.append('button')\n      .classed('btn', true)\n      .classed(`btn-light`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  dropdown.append('div')\n      .classed('dropdown-menu', true)\n      .classed('py-0', true);\n  form.append('span')\n      .classed('selected', true);\n}\n\nfunction colorScaleBoxItems(selection, items) {\n  const listitems = selection.select('.dropdown-menu')\n    .selectAll('a')\n      .data(items, d => d);\n  listitems.exit().remove();\n  listitems.enter()\n    .append('a')\n      .classed('dropdown-item', true)\n      .classed('py-0', true)\n      .attr('href', '#')\n      .attr('title', d => d.key)\n      .on('click', function (d) {\n        selection.call(setSelectedColorScale, d);\n        selection.dispatch('change', {bubbles: true});\n      })\n    .append('svg')\n      .each(function (d) {\n        d3.select(this)\n          .call(shape.colorBar[d.type], d.colors, d.text)\n          .call(shape.setSize, 100, 10);\n      });\n}\n\nfunction setSelectedColorScale(selection, item) {\n  const selected = selection.select('.selected');\n  selected.selectAll('svg').remove();\n  selected.datum(item);  // Bind selected item record\n  selected.append('svg')\n      .call(shape.colorBar[item.type], item.colors, item.text)\n      .call(shape.setSize, 100, 10);\n}\n\nfunction updateColorScaleBox(selection, key) {\n  const data = selection.select('.dropdown-menu')\n    .selectAll('a').data();\n  const item = data.find(e => e.key === key);\n  selection.call(setSelectedColorScale, item);\n}\n\nfunction colorScaleBoxValue(selection) {\n  return selection.select('.selected').datum().key;\n}\n\nfunction colorScaleBoxItem(selection) {\n  return selection.select('.selected').datum();\n}\n\n\nexport default {\n  selectBox, updateSelectBoxOptions, selectedRecord,\n  checklistBox, updateChecklistItems, checkRequired, updateChecklistValues,\n  checklistValues, anyChecked, setChecklistValidity,\n  colorScaleBox, colorScaleBoxItems, updateColorScaleBox,\n  colorScaleBoxValue, colorScaleBoxItem\n};\n","\n/** @module component/formRangeBox */\n\nimport d3 from 'd3';\n\nimport {default as badge} from './badge.js';\n\n\n/**\n * Render range box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction rangeBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('form-group', true)\n      .classed('align-items-center', true)\n    .append('div')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .text(label);\n\n  const minBox = selection.append('div');\n  minBox.append('label').text('min');\n  minBox.append('input').classed('min', true);\n\n  const maxBox = selection.append('div');\n  maxBox.append('label').text('max');\n  maxBox.append('input').classed('max', true);\n\n  selection.selectAll('div')\n      .classed('form-group', true)\n      .classed('col-4', true)\n      .classed('mb-0', true);\n\n  selection.selectAll('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true);\n\n  selection.selectAll('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'number');\n\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\n\nfunction linearRange(selection, min, max, step) {\n  selection.selectAll('.min, .max')\n      .attr('min', min || null)\n      .attr('max', max || null)\n      .attr('step', step || null)\n      .attr('required', 'required')\n      .on('input', function () {\n        const valid = linearValid(this, step);\n        d3.select(this)\n          .style('background-color', valid ? null : '#ffcccc');\n        selection.select('.invalid-feedback')\n          .style('display', linearRangeValid(selection) ? 'none': 'inherit');\n      })\n      .dispatch('input');\n}\n\n\nfunction logRange(selection) {\n  selection.selectAll('.min, .max')\n      .attr('required', 'required')\n      .on('input', function () {\n        const valid = logValid(this);\n        d3.select(this)\n          .style('background-color', valid ? null : '#ffcccc');\n        selection.select('.invalid-feedback')\n          .style('display', logRangeValid(selection) ? 'none': 'inherit');\n      })\n      .dispatch('input');\n}\n\n\nfunction updateRangeValues(selection, range) {\n  selection.select('.min').property('value', range[0]);\n  selection.select('.max').property('value', range[1]);\n  selection.selectAll('.min,.max')\n      .dispatch('input', {bubbles: true});\n}\n\n\nfunction linearValid(node, step) {\n  // If step is not specified, accept stepMismatch\n  const stepm = step ? false : node.validity.stepMismatch;\n  return  node.checkValidity() || stepm;\n}\n\n\nfunction linearRangeValid(selection) {\n  const step = selection.select('.min').attr('step');\n  const minValid = linearValid(selection.select('.min').node(), step);\n  const maxValid = linearValid(selection.select('.max').node(), step);\n  return minValid && maxValid;\n}\n\n\nfunction logValid(node) {\n  // Accept stepMismatch\n  const stepm = node.validity.stepMismatch;\n  return (node.checkValidity() || stepm) && node.value > 0;\n}\n\n\nfunction logRangeValid(selection) {\n  const minPos = logValid(selection.select('.min').node());\n  const maxPos = logValid(selection.select('.max').node());\n  return linearRangeValid(selection) && minPos && maxPos;\n}\n\n\nfunction rangeValues(selection) {\n  return [\n    selection.select('.min').property('value'),\n    selection.select('.max').property('value')\n  ];\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('form-group', true)\n      .classed('align-items-center', true);\n  selection.append('div')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .text(label);\n\n  const minBox = selection.append('div');\n  minBox.append('label').text('min');\n  minBox.append('input').classed('min', true);\n\n  const midBox = selection.append('div');\n  midBox.append('label').text('mid');\n  midBox.append('input').classed('mid', true);\n\n  const maxBox = selection.append('div');\n  maxBox.append('label').text('max');\n  maxBox.append('input').classed('max', true);\n\n  selection.on('change', () => {\n    // avoid update by mousemove on the colorpicker\n    d3.event.stopPropagation();\n  });\n\n  selection.selectAll('div')\n      .classed('form-group', true)\n      .classed('col-3', true)\n      .classed('mb-0', true);\n\n  selection.selectAll('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true);\n\n  selection.selectAll('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'color');\n}\n\n\nfunction updateColorRangeValues(selection, range) {\n  selection.select('.min').property('value', range[0]);\n  selection.select('.mid').property('value', range[1]);\n  selection.select('.max').property('value', range[2]);\n}\n\n\nfunction colorRangeValues(selection) {\n  return [\n    selection.select('.min').property('value'),\n    selection.select('.mid').property('value'),\n    selection.select('.max').property('value')\n  ];\n}\n\n\nexport default {\n  rangeBox, linearRange, logRange, updateRangeValues,\n  rangeValues, linearRangeValid, logRangeValid,\n  colorRangeBox, updateColorRangeValues, colorRangeValues\n};\n","\n/** @module component/dropdown */\n\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction dropdownFormGroup(selection, label) {\n  const id = misc.uuidv4().slice(0, 8);\n  selection.classed('mb-3', true)\n    .append('div')\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('justify-content-end', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-sm', true)\n      .classed('btn-outline-primary', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'collapse')\n      .attr('data-target', `#${id}-collapse`)\n      .attr('aria-expanded', 'false')\n      .attr('aria-controls', `${id}-collapse`)\n      .text(label);\n  selection.append('div')\n      .classed('collapse', true)\n      .attr('id', `${id}-collapse`)\n    .append('div')\n      .classed('card', true)\n      .classed('card-body', true);\n}\n\n\nexport default {\n  dropdownFormGroup\n};\n","\n/** @module component/formBoxGroup */\n\nimport d3 from 'd3';\n\nimport {default as badge} from './badge.js';\nimport {default as dropdown} from './dropdown.js';\nimport {default as box} from './formBox.js';\nimport {default as lbox} from './formListBox.js';\nimport {default as rbox} from './formRangeBox.js';\n\n\n/**\n * Render color range control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeGroup(selection, colorScales) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('colorscale', true)\n      .classed('mb-2', true)\n      .call(lbox.colorScaleBox, 'Colorscale')\n      .call(lbox.colorScaleBoxItems, colorScales);\n\n  // Custom colorscale\n  const collapse = selection.append('div')\n      .call(dropdown.dropdownFormGroup, 'Custom color')\n    .select('.card-body')\n      .classed('p-2', true);\n\n  const customColorRanges = [\n    {key: 'continuous', name: 'Continuous'},\n    {key: 'two-piece', name: 'Two-piece'}\n  ];\n  collapse.append('div')\n      .classed('rangetype', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Range type')\n      .call(lbox.updateSelectBoxOptions, customColorRanges);\n  collapse.append('div')\n      .classed('range', true)\n      .classed('mb-1', true)\n      .call(rbox.colorRangeBox, 'Range');\n  collapse.append('div')\n      .classed('unknown', true)\n      .classed('mb-1', true)\n      .call(box.colorBox, 'Unknown');\n}\n\n\nfunction updateColorRangeGroup(selection, cscale, range, unknown) {\n  const customRange = () => {\n    const cs = lbox.colorScaleBoxValue(selection.select('.colorscale'));\n    const rg = box.formValue(selection.select('.rangetype'));\n    const customScale = cs === 'custom';\n    selection.selectAll('.rangetype, .range, .unknown')\n        .selectAll('select, input')\n        .property('disabled', !customScale);\n    selection.select('.range').select('.mid')\n        .property('disabled', !customScale || rg === 'continuous');\n  };\n  selection.select('.colorscale')\n      .call(lbox.updateColorScaleBox, cscale)\n      .on('change', function () {\n        customRange();\n      });\n  const rtype = range.length === 2 ? 'continuous' : 'two-piece';\n  selection.select('.rangetype')\n      .call(box.updateFormValue, rtype)\n      .on('change', function () {\n        customRange();\n      })\n      .dispatch('change');\n  const rboxValues = range.length === 2  ? [range[0], null, range[1]] : range;\n  selection.select('.range')\n      .call(rbox.updateColorRangeValues, rboxValues)\n      .on('focusin', () => {\n        selection.dispatch('change', {bubbles: true});\n      });\n  selection.select('.unknown')\n      .call(box.updateFormValue, unknown)\n      .on('focusin', () => {\n        selection.dispatch('change', {bubbles: true});\n      });\n}\n\n\nfunction colorGroupValues(selection) {\n  const colorScale = lbox.colorScaleBoxItem(selection.select('.colorscale'));\n  const rtype = box.formValue(selection.select('.rangetype'));\n  const range = rbox.colorRangeValues(selection.select('.range'));\n  const unknown = box.formValue(selection.select('.unknown'));\n  return {\n    color: colorScale.key,\n    colorScaleType: colorScale.type,\n    range: rtype === 'continuous' ? [range[0], range[2]] : range,\n    unknown: unknown\n  };\n}\n\n\n/**\n * Render scale and domain control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction scaleBoxGroup(selection) {\n  selection.classed('mb-3', true);\n\n  // Scale type\n  const scaleOptions = [\n    {key: 'linear', name: 'Linear'},\n    {key: 'log', name: 'Log'}\n  ];\n  selection.append('div')\n      .classed('scale', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Scale')\n      .call(lbox.updateSelectBoxOptions, scaleOptions)\n      .on('change', function () {\n        const isLog = box.formValue(d3.select(this)) === 'log';\n        selection.select('.domain')\n          .call(isLog ? rbox.logRange : rbox.linearRange)\n          .call(badge.updateInvalidMessage,\n                isLog ? 'Please provide a valid range (larger than 0)'\n                : 'Please provide a valid number');\n      });\n  selection.append('div')\n      .classed('domain', true)\n      .classed('mb-1', true)\n      .call(rbox.rangeBox, 'Domain');\n}\n\n\nfunction updateScaleBoxGroup(selection, scale, domain) {\n  selection.select('.scale')\n      .call(box.updateFormValue, scale)\n      .dispatch('change');\n  selection.select('.domain')\n      .call(rbox.updateRangeValues, domain);\n}\n\n\nfunction scaleBoxGroupValid(selection) {\n  const isLog = box.formValue(selection.select('.scale')) === 'log';\n  const dm = selection.select('.domain');\n  return isLog ? rbox.logRangeValid(dm) : rbox.linearRangeValid(dm);\n}\n\n\nfunction scaleGroupValues(selection) {\n  const scale = box.formValue(selection.select('.scale'));\n  const domain = rbox.rangeValues(selection.select('.domain'));\n  return {\n    scale: scale || 'linear',\n    domain: domain\n  };\n}\n\n\nexport default {\n  colorRangeGroup, updateColorRangeGroup, colorGroupValues,\n  scaleBoxGroup, updateScaleBoxGroup, scaleGroupValues, scaleBoxGroupValid\n};\n","\n/** @module component/controlBox */\n\nimport d3 from 'd3';\n\nimport {default as badge} from '../component/badge.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as rbox} from '../component/formRangeBox.js';\nimport {default as group} from '../component/formBoxGroup.js';\n\n\nfunction colorControlBox(selection, colorScales, fieldName) {\n  // Color field\n  selection.append('div')\n      .classed('field', true)\n      .call(lbox.selectBox, fieldName || 'Field');\n\n  // Colorscale and custom range\n  selection.append('div')\n      .classed('range', true)\n      .call(group.colorRangeGroup, colorScales)\n      .on('change', function () {\n        const values = group.colorGroupValues(d3.select(this));\n        const noScale = ['categorical', 'monocolor']\n          .includes(values.colorScaleType);\n        selection.select('.scale').selectAll('select,input')\n            .property('disabled', noScale);\n      });\n\n  // Scale\n  selection.append('div')\n      .classed('scale', true)\n      .call(group.scaleBoxGroup);\n}\n\n\nfunction updateColorControl(selection, fieldOptions, colorState) {\n  selection.select('.field')\n      .call(lbox.updateSelectBoxOptions, fieldOptions)\n      .call(box.updateFormValue, colorState.field);\n  selection.select('.range')\n      .call(group.updateColorRangeGroup, colorState.color,\n            colorState.range, colorState.unknown);\n  selection.select('.scale')\n      .call(group.updateScaleBoxGroup, colorState.scale, colorState.domain)\n      .dispatch('change');\n}\n\n\nfunction colorControlValid(selection) {\n  return group.scaleBoxGroupValid(selection.select('.scale'));\n}\n\n\nfunction colorControlState(selection) {\n  const range = group.colorGroupValues(selection.select('.range'));\n  const scale = group.scaleGroupValues(selection.select('.scale'));\n  return {\n    field: box.formValue(selection.select('.field')),\n    color: range.color,\n    range: range.range,\n    unknown: range.unknown,\n    scale: range.colorScaleType === 'categorical' ? 'ordinal': scale.scale,\n    domain: scale.domain\n  };\n}\n\n\nfunction sizeControlBox(selection, fieldName) {\n  // Size field\n  selection.append('div')\n      .classed('field', true)\n      .call(lbox.selectBox, fieldName || 'Field');\n\n  // Size range\n  selection.append('div')\n      .classed('range', true)\n      .classed('mb-2', true)\n      .call(rbox.rangeBox, 'Range')\n      .call(rbox.linearRange, 0.1, 999, 0.1)\n      .call(badge.updateInvalidMessage,\n            'Please provide a valid range (0.1-999)');\n\n  // Size unknown\n  selection.append('div')\n      .classed('unknown', true)\n      .call(box.numberBox, 'Unknown')\n      .call(box.updateNumberRange, 0.1, 999, 0.1)\n      .call(badge.updateInvalidMessage,\n            'Please provide a valid number (0.1-999)')\n    .select('input')\n      .classed('col-8', false)\n      .classed('col-3', true);\n\n  // Size scale\n  selection.append('div')\n      .classed('scale', true)\n      .call(group.scaleBoxGroup);\n}\n\n\nfunction updateSizeControl(selection, fieldOptions, sizeState) {\n  selection.select('.field')\n      .call(lbox.updateSelectBoxOptions, fieldOptions)\n      .call(box.updateFormValue, sizeState.field);\n  selection.select('.range')\n      .call(rbox.updateRangeValues, sizeState.range);\n  selection.select('.unknown')\n      .call(box.updateFormValue, sizeState.unknown);\n  selection.select('.scale')\n      .call(group.updateScaleBoxGroup, sizeState.scale, sizeState.domain);\n}\n\n\nfunction sizeControlValid(selection) {\n  const rangeValid = rbox.linearRangeValid(selection.select('.range'));\n  const unkValid = box.formValid(selection.select('.unknown'));\n  const scaleValid = group.scaleBoxGroupValid(selection.select('.scale'));\n  return rangeValid && unkValid && scaleValid;\n}\n\n\nfunction sizeControlState(selection) {\n  const scale = group.scaleGroupValues(selection.select('.scale'));\n  return {\n    field: box.formValue(selection.select('.field')),\n    range: rbox.rangeValues(selection.select('.range')),\n    unknown: box.formValue(selection.select('.unknown')),\n    scale: scale.scale,\n    domain: scale.domain\n  };\n}\n\n\nfunction labelControlBox(selection, colorScales) {\n  // nodeLabel.visible\n  selection.append('div')\n    .append('div')\n      .classed('visible', true)\n      .call(box.checkBox, 'Show labels');\n\n  // nodeLabel\n  const labelGroup = selection.append('div')\n      .classed('mb-3', true);\n  labelGroup.append('div')\n      .classed('text', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Text field');\n  labelGroup.append('div')\n      .classed('size', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Font size')\n      .call(box.updateNumberRange, 0.1, 999, 0.1)\n      .call(badge.updateInvalidMessage,\n            'Please provide a valid number (0.1-999)')\n    .select('.form-control')\n      .attr('required', 'required');\n\n  // nodeLabelColor\n  selection.call(colorControlBox, colorScales, 'Color field');\n}\n\n\nfunction updateLabelControl(selection, fieldOptions,\n                               labelState, colorState) {\n  selection.select('.visible')\n      .call(box.updateCheckBox, labelState.visible);\n  selection.select('.text')\n      .call(lbox.updateSelectBoxOptions, fieldOptions)\n      .call(box.updateFormValue, labelState.field);\n  selection.select('.size')\n      .call(box.updateFormValue, labelState.size);\n  selection.call(updateColorControl, fieldOptions, colorState);\n}\n\n\nfunction labelControlValid(selection) {\n  const fontValid = box.formValid(selection.select('.size'));\n  return fontValid && colorControlValid(selection);\n}\n\n\nfunction labelControlState(selection) {\n  return {\n    label: {\n      field: box.formValue(selection.select('.text')),\n      size: box.formValue(selection.select('.size')),\n      visible: box.checkBoxValue(selection.select('.visible'))\n    },\n    labelColor: colorControlState(selection)\n  };\n}\n\n\nfunction controlBoxFrame(selection, navID, contentID) {\n  selection.append('nav')\n    .append('div')\n      .classed('nav', true)\n      .classed('nav-tabs', true)\n      .attr('id', navID)\n      .attr('role', 'tablist');\n  selection.append('div')\n      .classed('tab-content', true)\n      .classed('p-2', true)\n      .attr('id', contentID);\n}\n\n\nfunction controlBoxNav(selection, id, label) {\n  selection\n      .classed('nav-item', true)\n      .classed('nav-link', true)\n      .classed('py-1', true)\n      .attr('id', `${id}-tab`)\n      .attr('data-toggle', 'tab')\n      .attr('href', `#${id}`)\n      .attr('role', 'tab')\n      .attr('aria-controls', id)\n      .attr('aria-selected', 'false')\n      .text(label);\n}\n\n\nfunction controlBoxItem(selection, id) {\n  selection\n      .classed('tab-pane', true)\n      .classed('fade', true)\n      .classed('container', true)\n      .classed('px-0', true)\n      .attr('id', id)\n      .attr('role', 'tabpanel')\n      .attr('aria-labelledby', `${id}-tab`);\n}\n\n\nexport default {\n  colorControlBox, updateColorControl, colorControlValid, colorControlState,\n  sizeControlBox, updateSizeControl, sizeControlValid, sizeControlState,\n  labelControlBox, updateLabelControl, labelControlValid, labelControlState,\n  controlBoxFrame, controlBoxNav, controlBoxItem\n};\n","\n/** @module tile/controlBox */\n\nimport _ from 'lodash';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as cscale} from '../common/scale.js';\n\nimport {default as box} from '../component/formBox.js';\nimport {default as cbox} from '../component/controlBox.js';\nimport {default as lbox} from '../component/formListBox.js';\n\n\nfunction mainControlBox(selection) {\n  const chunkGroup = selection.append('div')\n      .classed('panel-group', true)\n      .classed('mb-3', true);\n  chunkGroup.append('div')\n      .classed('rowcnt', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Rows', 1, 9999, 1);\n  chunkGroup.append('div')\n      .classed('colcnt', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Columns', 1, 9999, 1);\n  chunkGroup.append('div')\n      .classed('groupby', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'GroupBy');\n  chunkGroup.append('div')\n      .classed('crow', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'ChunksPerRow', 1, 999, 1);\n  chunkGroup.append('div')\n      .classed('showcol', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Show column number');\n  chunkGroup.append('div')\n      .classed('showrow', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Show row number');\n}\n\n\nfunction updateMainControl(selection, state) {\n  // Network threshold\n  const chunkGroup = selection.select('.panel-group');\n  chunkGroup.select('.rowcnt')\n      .call(box.updateFormValue, state.rowCount);\n  chunkGroup.select('.colcnt')\n      .call(box.updateFormValue, state.columnCount);\n  chunkGroup.select('.groupby')\n    .call(lbox.updateSelectBoxOptions,\n          state.items.fields.filter(e => misc.sortType(e.format) !== 'none'))\n    .call(box.updateFormValue, state.groupField || '');\n  chunkGroup.select('.crow')\n      .call(box.updateFormValue, state.chunksPerRow);\n  chunkGroup.select('.showcol')\n      .call(box.updateCheckBox, state.showColumnNumber);\n  chunkGroup.select('.showrow')\n      .call(box.updateCheckBox, state.showRowNumber);\n  chunkGroup.selectAll('.rowcnt, .colcnt, .groupby, .crow, .showcol, .showrow')\n      .on('change', function () {\n        state.rowCount = box.numberBoxIntValue(chunkGroup.select('.rowcnt'));\n        state.columnCount = box.numberBoxIntValue(chunkGroup.select('.colcnt'));\n        state.groupField = box.formValue(chunkGroup.select('.groupby'));\n        state.chunksPerRow = box.numberBoxIntValue(chunkGroup.select('.crow'));\n        state.showColumnNumber = box.checkBoxValue(chunkGroup.select('.showcol'));\n        state.showRowNumber = box.checkBoxValue(chunkGroup.select('.showrow'));\n        state.updateFieldNotifier();\n      });\n}\n\n\nfunction updateTileColorControlBox(selection, state) {\n  const fieldOptions = state.items.fields\n    .filter(e => misc.sortType(e.format) !== 'none');\n  selection\n    .call(cbox.updateColorControl, fieldOptions, state.tileColor)\n    .on('change', function() {\n      state.tileColor = cbox.colorControlState(selection);\n      if (state.tileColor.scale === 'ordinal') {\n        const keys = state.items.records().map(e => e[state.tileColor.field]);\n        state.tileColor.domain = _.uniq(keys).sort();\n      }\n      state.updateItemAttrNotifier();\n    });\n}\n\n\nfunction updateTileValueControlBox(selection, state) {\n  const fieldOptions = state.items.fields\n    .filter(e => misc.sortType(e.format) !== 'none');\n  selection\n      .call(cbox.updateLabelControl, fieldOptions,\n            state.tileValue, state.tileValueColor)\n      .on('change', function() {\n        const values = cbox.labelControlState(selection);\n        state.tileValue = values.label;\n        state.tileValueColor = values.labelColor;\n        if (state.tileValueColor.scale === 'ordinal') {\n          const keys = state.items.records()\n            .map(e => e[state.tileValueColor.field]);\n          state.tileValueColor.domain = _.uniq(keys).sort();\n        }\n        state.updateItemAttrNotifier();\n      });\n}\n\n\nfunction controlBox(selection, state) {\n  // Clean up\n  selection.select('nav').remove();\n  selection.select('.tab-content').remove();\n\n  selection.call(\n    cbox.controlBoxFrame, 'control-frame-nav', 'control-frame-content');\n  const tabs = selection.select('.nav-tabs');\n  const content = selection.select('.tab-content');\n\n  // Main\n  tabs.append('a')\n      .classed('active', true)\n      .attr('aria-selected', 'true')\n      .call(cbox.controlBoxNav, 'control-main', 'Main');\n  content.append('div')\n      .classed('show', true)\n      .classed('active', true)\n      .classed('control-main', true)\n      .call(cbox.controlBoxItem, 'control-main')\n      .call(mainControlBox, state);\n\n  // Color\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-color', 'Color');\n  content.append('div')\n      .classed('control-color', true)\n      .call(cbox.controlBoxItem, 'control-color')\n      .call(cbox.colorControlBox, cscale.colorScales);\n\n  // Text\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-value', 'Value');\n  content.append('div')\n      .classed('control-value', true)\n      .call(cbox.controlBoxItem, 'control-value')\n      .call(cbox.labelControlBox, cscale.colorScales);\n\n  selection.call(updateControlBox, state);\n}\n\n\nfunction updateControlBox(selection, state) {\n  selection.select('.control-main')\n      .call(updateMainControl, state);\n  selection.select('.control-color')\n      .call(updateTileColorControlBox, state);\n  selection.select('.control-value')\n      .call(updateTileValueControlBox, state);\n}\n\n\nexport default {\n  controlBox, updateControlBox\n};\n","\n/** @module tileApp */\n\nimport d3 from 'd3';\n\nimport {default as client} from './common/client.js';\nimport {default as idb} from './common/idb.js';\n\nimport {default as badge} from './component/badge.js';\nimport {default as button} from './component/button.js';\nimport {default as transform} from './component/transform.js';\n\nimport {default as renameDialog} from './dialog/rename.js';\n\nimport TileState from './tile/state.js';\nimport {default as component} from './tile/component.js';\nimport {default as interaction} from './tile/interaction.js';\nimport {default as control} from './tile/controlBox.js';\n\n\nfunction app(view, coll) {\n  const menubar = d3.select('#menubar')\n      .classed('my-1', true);\n  menubar.selectAll('div,span,a').remove();  // Clean up\n  const dialogs = d3.select('#dialogs');\n  dialogs.selectAll('div').remove();  // Clean up\n\n  const state = new TileState(view, coll);\n\n  // Tile view control\n  const menu = menubar.append('div')\n      .call(button.dropdownMenuButton, 'Menu', 'primary', 'tiles-white')\n      .select('.dropdown-menu');\n  menu.append('a').call(renameDialog.menuLink);\n  menu.append('a')\n      .call(button.dropdownMenuItem, 'Save', 'menu-save')\n      .on('click', function () {\n        return state.save()\n          .then(() => menubar.select('.notify-saved').call(badge.notify));\n      });\n\n  // Dashboard link\n  menubar.append('a')\n      .call(button.menuButtonLink, 'Dashboard',\n            'outline-secondary', 'status-gray')\n      .attr('href', 'dashboard.html')\n      .attr('target', '_blank');\n\n  // Status\n  menubar.append('span')\n      .classed('loading-circle', true)\n      .call(badge.loadingCircle);\n  menubar.append('span')\n      .classed('notify-saved', true)\n      .call(badge.alert)\n      .call(badge.updateAlert, 'State saved', 'success', 'check-green')\n      .style('display', 'none');\n  menubar.append('span')\n      .classed('name', true);\n  menubar.append('span')\n      .classed('items-count', true)\n      .call(badge.badge);\n  menubar.append('span')\n      .classed('fetch-status', true)\n      .call(badge.badge);\n  menubar.append('span')\n      .classed('exec-time', true)\n      .call(badge.badge);\n\n  // Dialogs\n  dialogs.append('div')\n      .classed('renamed', true)\n      .call(renameDialog.body);\n\n  // Contents\n  const frame = d3.select('#tl-frame')\n      .call(transform.viewFrame, state);\n  frame.select('.view')\n      .call(component.tileView, state)\n      .call(interaction.setInteraction, state);\n  d3.select('#tl-control')\n      .call(control.controlBox, state);\n\n  // Resize window\n  window.onresize = () =>\n    d3.select('#tl-frame').call(transform.resize, state);\n\n  // Update\n  updateApp(state);\n}\n\n\nfunction updateApp(state) {\n  // Title\n  d3.select('title').text(state.name);\n\n  // Status\n  d3.select('#menubar .name').text(state.name);\n\n  const onLoading = d3.select('#menubar .loading-circle');\n  const colors = {\n    done: 'green', running: 'darkorange',\n    ready: 'cornflowerblue', queued: 'cornflowerblue',\n    interrupted: 'salmon', aborted: 'salmon', failure: 'salmon'\n  };\n  const icons = {\n    done: 'check-green', running: 'running-darkorange',\n    ready: 'clock-cornflowerblue', queued: 'clock-cornflowerblue',\n    interrupted: 'caution-salmon', aborted: 'caution-salmon',\n    failure: 'caution-salmon'\n  };\n  const fstatus = state.items.status();\n  const fstext = fstatus === 'done' ?\n    fstatus : `${fstatus} ${state.items.progress()}%`;\n  d3.select('#menubar .items-count')\n      .call(badge.updateBadge, `${state.items.size()} items`,\n            'light', 'tiles-gray')\n    .select('.text')\n      .style('color', 'gray');\n  d3.select('#menubar .fetch-status')\n      .call(badge.updateBadge, fstext, 'light', icons[fstatus])\n    .select('.text')\n      .style('color', colors[fstatus]);\n  d3.select('#menubar .exec-time')\n      .call(badge.updateBadge, `${state.items.execTime()} seconds`,\n            'light', 'clock-cornflowerblue')\n    .select('.text')\n      .style('color', 'cornflowerblue');\n\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n\n  // Rename dialog\n  dialogs.select('.renamed')\n      .call(renameDialog.updateBody, state.name)\n      .on('submit', function () {\n        onLoading.style('display', 'inline-block');\n        state.name = renameDialog.value(d3.select(this));\n        updateApp(state);\n  });\n\n  onLoading.style('display', 'none');\n}\n\n\nfunction run() {\n  const err = client.compatibility();\n  if (err) {\n    d3.select('body')\n      .style('color', '#ff0000')\n      .text(err);\n    return;\n  }\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";  // TODO\n  const offLine = 'onLine' in navigator && !navigator.onLine;  // TODO\n  client.registerServiceWorker();\n  const storeID = client.URLQuery().store || null;\n  const viewID = client.URLQuery().view || null;\n  return idb.getView(storeID, viewID)\n    .then(view => {\n      if (!view) throw('ERROR: invalid URL');\n      view.storeID = storeID;\n      return idb.getCollection(storeID, view.items)\n        .then(coll => app(view, coll));\n    })\n    .catch(err => {\n      console.error(err);\n      d3.select('#tileview')\n        .style('color', 'red')\n        .text(err);\n    });\n}\n\n\nexport default {\n  run\n};\n"],"names":["URLQuery","pairs","window","location","search","substring","split","map","e","_","fromPairs","compatibility","registerServiceWorker","navigator","isDebugBuild","console","info","addEventListener","serviceWorker","register","registerCtrlCommand","key","callback","document","event","ctrlKey","sortType","fmt","includes","formatNum","value","d3format","Number","isNaN","parseFloat","d3","format","partialMatch","query","target","toString","toUpperCase","indexOf","uuidv4","replace","c","r","Math","random","statusConv","Queued","In progress","Aborting","Aborted","Completed","Failure","dataTypeConv","datatable","connection","v07_to_v08_nodes","json","fields","columns","sort","id","name","dataType","schemaVersion","revision","status","records","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v10_nodes","reference","convertNetwork","data","edges","hasOwnProperty","nodes","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","forEach","i","index","_structure","_index","source","v08_graph","nodeContentVisible","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","params","v10_edges","$schema","convertPackage","specs","now","Date","isNW","v08_nodes","width","height","convertTable","views","dataset","push","collectionID","contents","workflowID","workflow","viewID","viewType","rows","sortOrder","filterText","checkpoints","type","date","description","networkThresholdCutoff","filter","view","minConnThld","currentConnThld","edgeColor","color","edgeLabelColor","schema","items","idb","Dexie","getAllItems","orderBy","reverse","toArray","updateItem","storeID","updateFunc","where","equals","modify","catch","err","error","version","stores","reset","delete","then","getItem","first","deleteItem","getView","appendView","viewObj","item","pos","findIndex","splice","updateView","isFunction","deleteView","bin","Object","entries","entry","getAllCollections","flatten","coll","getCollection","collID","colls","updateCollection","collObj","importItem","legacy","misc","slice","sessionStarted","put","newDatagrid","response","toLocaleString","timeZone","newNetwork","nodesName","edgesID","assetBaseURL","iconBaseURL","badge","selection","classed","append","style","updateBadge","icon","select","attr","notify","transition","duration","ease","easeLinear","delay","on","loadingCircle","alert","updateAlert","invalidFeedback","updateInvalidMessage","msg","buttonBox","menuButton","menuButtonLink","menuModalLink","dropdownMenuButton","button","dropdownMenuItem","dropdownMenuModal","dropdownMenuFile","accept","this","node","click","dropdownMenuFileValue","files","resize","state","area","offsetWidth","offsetHeight","setViewBox","resizeNotifier","transform","tx","ty","tk","viewFrame","remove","call","viewBox","right","bottom","formValue","property","formValid","checkValidity","setValidity","valid","textareaValid","test","fileInputBox","fileInputValid","length","updateFormValue","textBox","readonlyBox","updateReadonlyValue","readonlyValue","textareaBox","placeholder","textareaBoxLines","numberBox","updateNumberRange","min","max","step","dispatch","bubbles","checkBox","box","updateCheckBox","checked","checkBoxValue","colorBox","stopPropagation","clearFileInput","selectAll","fileInputValue","dialogBase","confirmDialog","base","footer","updateConfirmDialog","message","submitDialog","title","header","html","$","modal","menuLink","body","renameBox","updateBody","baseURL","get","url","q","keys","JSON","stringify","fetch","credentials","res","Promise","reject","Error","statusText","resolve","blob","post","formdata","method","serverStatus","server","singleToMulti","mapping","newMapping","m","mappingToTable","mp","concat","rcd","f","tableToMapping","table","ignore","row","csvToMapping","csvString","lines","shift","headerIdx","h","line","values","k","Array","apply","fd","uniqBy","Collection","[object Object]","autoIndex","content","addField","fs","mapper","func","command","fetcher","all","sum","some","TransformState","fieldWidth","fieldHeight","top","left","focusArea","focusAreaMargin","boundary","x","y","prevTransform","margin","setFocusArea","vh","vw","vr","bh","bw","isPortrait","adjustH","adjustV","setTransform","TileState","super","chunkMarginRatio","focusedViewThreshold","enableFocusedView","focusedView","its","parse","rowCount","columnCount","groupField","chunksPerRow","fixRowCount","fixColumnCount","tileAspectRatio","showRowNumber","showColumnNumber","defaultTileField","fillIfNull","obj","updater","tileContent","tileColor","defaultTileColor","tileValue","halign","valign","tileValueColor","defaultTileValueColor","scaleExtent","Infinity","translateExtent","chunkWidth","chunkHeight","chunkMarginH","chunkMarginV","columnWidth","rowHeight","zoomListener","updateFieldNotifier","updateItemNotifier","updateItemAttrNotifier","cRow","floor","chunk","cCol","col","tileCount","totalChunks","groupBy","group","j","tileIdx","ceil","setCoords","setIndices","export","vi","colorScales","colors","schemePaired","schemeSet2","schemePastel2","schemeSet3","types","scaleLinear","scaleLog","scaleQuantize","scaleOrdinal","scaleFunction","cscale","mid","scaleFunc","clamp","d","result","undefined","isD3Format","notation","updateItems","itemsToRender","exit","entered","enter","merged","merge","updateItemAttrs","colorConv","valueColorConv","d3_format","tileView","setFieldSize","zoom","t","setInteraction","zoomIdentity","translate","monocolorBar","colorBar","monocolor","bicolor","grad","tricolor","categorical","sw","custom","setSize","checklistValues","anyChecked","setChecklistValidity","setSelectedColorScale","selected","datum","shape","selectBox","updateSelectBoxOptions","options","selectedRecord","checklistBox","updateChecklistItems","listitems","form","checkRequired","updateChecklistValues","each","colorScaleBox","dropdown","colorScaleBoxItems","updateColorScaleBox","colorScaleBoxValue","colorScaleBoxItem","linearValid","stepm","validity","stepMismatch","linearRangeValid","minValid","maxValid","logValid","logRangeValid","minPos","maxPos","rangeBox","minBox","maxBox","linearRange","logRange","updateRangeValues","rangeValues","colorRangeBox","midBox","updateColorRangeValues","colorRangeValues","dropdownFormGroup","colorRangeGroup","lbox","collapse","rbox","updateColorRangeGroup","customRange","cs","rg","customScale","rtype","rboxValues","colorGroupValues","colorScale","colorScaleType","scaleBoxGroup","isLog","updateScaleBoxGroup","scaleGroupValues","scaleBoxGroupValid","dm","colorControlBox","fieldName","noScale","updateColorControl","fieldOptions","colorState","colorControlValid","colorControlState","sizeControlBox","updateSizeControl","sizeState","sizeControlValid","rangeValid","unkValid","scaleValid","sizeControlState","labelControlBox","labelGroup","updateLabelControl","labelState","labelControlValid","labelControlState","labelColor","controlBoxFrame","navID","contentID","controlBoxNav","controlBoxItem","mainControlBox","chunkGroup","updateMainControl","numberBoxIntValue","updateTileColorControlBox","cbox","uniq","updateTileValueControlBox","updateControlBox","controlBox","tabs","app","menubar","dialogs","menu","renameDialog","save","component","interaction","control","onresize","updateApp","onLoading","fstatus","fstext","done","running","ready","queued","interrupted","aborted","failure","run","client","protocol","onLine","store"],"mappings":"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"}