{"version":3,"file":"tileApp.js","sources":["../../src/common/client.js","../../src/common/misc.js","../../src/common/legacySchema.js","../../src/common/idb.js","../../src/component/badge.js","../../src/component/button.js","../../src/component/transform.js","../../src/component/formBox.js","../../src/component/modal.js","../../src/dialog/rename.js","../../src/common/fetcher.js","../../src/common/mapper.js","../../src/common/collection.js","../../src/common/transform.js","../../src/tile/state.js","../../src/common/scale.js","../../src/tile/component.js","../../src/tile/interaction.js","../../src/component/shape.js","../../src/component/formListBox.js","../../src/component/formRangeBox.js","../../src/component/formBoxGroup.js","../../src/component/controlBox.js","../../src/tile/controlBox.js","../../src/tileApp.js"],"sourcesContent":["\n/** @module common/client */\n\nimport _ from 'lodash';\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\nfunction compatibility() {\n  try {\n    () => {};\n  } catch (err) {\n    return 'Client compatibility error: Arrow function not supported';\n  }\n  try {\n    FormData;\n  } catch (err) {\n    return 'Client compatibility error: FormData not supported';\n  }\n  try {\n    fetch;\n  } catch (err) {\n    return 'Client compatibility error: fetch API not supported';\n  }\n}\n\n\nfunction registerServiceWorker() {\n  if ('serviceWorker' in navigator) {\n    if (!debug) {\n      window.addEventListener('load', () => {\n        navigator.serviceWorker.register('../sw.js');  // TODO: root path option\n      });\n    } else {\n      console.info('Service worker is disabled for debugging');\n    }\n  } else {\n    console.info('Service worker is not supported');\n  }\n}\n\nexport default {\n  URLQuery, compatibility, registerServiceWorker\n};\n","\n/** @module common/misc */\n\nimport d3 from 'd3';\n\n\n// TODO: re-define\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  if (['text_field', 'checkbox', 'html'].includes(fmt)) return 'html';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  sortType, formatNum, partialMatch, uuidv4\n};\n","\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: [\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ],\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  data.fields.forEach(e => {\n    if (e.key === 'structure') {\n      e.format = 'svg';\n    }\n    delete e.width;\n    delete e.height;\n  });\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nfunction convertPackage(json) {\n  let specs = {};\n  if (!json.hasOwnProperty('views')) {\n    const now = new Date();\n    const isNW = json.hasOwnProperty('edges');\n    const data = isNW ? convertNetwork(json) : convertTable(json);\n    const nodes = isNW ? data.nodes : data;\n    specs = {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n      name: data.edges.name,\n      views: [],\n      dataset: []\n    };\n    specs.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: nodes.id,\n      name: nodes.name,\n      contents: [{\n        $schema: nodes.$schema,\n        workflowID: nodes.reference.workflow,\n        name: nodes.name,\n        fields: nodes.fields,\n        records: nodes.records,\n        created: nodes.created,\n        status: nodes.status,\n        query: nodes.query,\n        execTime: nodes.execTime,\n        progress: nodes.progress\n      }]\n    });\n    specs.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n      viewID: nodes.id,\n      name: nodes.name,\n      viewType: \"datagrid\",\n      rows: nodes.id,\n      fields: nodes.fields,\n      sortOrder: null,\n      filterText: null,\n      checkpoints: [{\n        type: 'convert',\n        date: now.toString(),\n        description: 'converted from legacy format'\n      }]\n    });\n    if (isNW) {\n      specs.dataset.push({\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: data.edges.id,\n        name: data.edges.name,\n        contents: [{\n          $schema: data.edges.$schema,\n          workflowID: data.edges.reference.workflow,\n          name: data.edges.name,\n          fields: data.edges.fields,\n          records: data.edges.records,\n          created: data.edges.created,\n          status: data.edges.status,\n          query: data.edges.query,\n          execTime: data.edges.execTime,\n          progress: data.edges.progress\n        }]\n      });\n      specs.views.push({\n        $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n        viewID: data.edges.id,\n        name: data.edges.name,\n        viewType: \"network\",\n        nodes: nodes.id,\n        edges: data.edges.id,\n        nodeColor: data.edges.snapshot.nodeColor,\n        nodeSize: data.edges.snapshot.nodeSize,\n        nodeLabel: data.edges.snapshot.nodeLabel,\n        nodeLabelColor: data.edges.snapshot.nodeLabelColor,\n        edgeWidth: data.edges.snapshot.edgeWidth,\n        edgeLabel: data.edges.snapshot.edgeLabel,\n        networkThreshold: data.edges.snapshot.networkThreshold,\n        networkThresholdCutoff: data.edges.snapshot.networkThresholdCutoff,\n        fieldTransform: data.edges.snapshot.fieldTransform,\n        coords: data.edges.snapshot.coords,\n        checkpoints: [{\n          type: 'convert',\n          date: now.toString(),\n          description: 'converted from legacy format'\n        }]\n      });\n    }\n    specs.views.filter(e => e.viewType === 'network')\n      .forEach(view => {\n        view.minConnThld = view.networkThresholdCutoff;\n        view.currentConnThld = view.networkThreshold;\n        if (view.hasOwnProperty('nodeLabel')) {\n          view.nodeLabel.field = view.nodeLabel.text;\n        }\n        if (view.hasOwnProperty('edgeLabel')) {\n          view.edgeLabel.field = 'weight';\n        }\n        if (view.hasOwnProperty('edgeWidth')) {\n          view.edgeWidth.field = 'weight';\n        }\n      });\n  } else {\n    specs = json;\n  }\n  specs.views.filter(e => e.viewType === 'network')\n    .forEach(view => {\n      if (!view.nodeColor.field) { view.nodeColor.field = 'index' ;}\n      if (!view.nodeSize.field) { view.nodeSize.field = 'index' ;}\n      if (!view.nodeLabel.field) { view.nodeLabel.field = 'index' ;}\n      if (!view.nodeLabelColor.field) { view.nodeLabelColor.field = 'index' ;}\n      if (!view.edgeColor) {\n        view.edgeColor = {\n          field: 'weight', color: 'monogray',\n          scale: 'linear', domain: [0, 1],\n          range: ['#999999', '#999999'], unknown: '#cccccc'\n        };\n      } else if (!view.edgeColor.field) { view.edgeColor.field = 'weight' ;}\n      if (!view.edgeWidth.field) { view.edgeWidth.field = 'weight' ;}\n      if (!view.edgeLabel.field) { view.edgeLabel.field = 'weight' ;}\n      if (!view.edgeLabelColor) {\n        view.edgeLabelColor = {\n          field: 'weight', color: 'monoblack',\n          scale: 'linear', domain: [1, 1],\n          range: ['#333333', '#333333'], unknown: '#cccccc'\n        };\n      } else if (!view.edgeLabelColor.field) { view.edgeLabelColor.field = 'weight' ;}\n    });\n  return specs;\n}\n\n\nexport default {\n  convertPackage\n};\n","\n/** @module common/idb */\n\nimport _ from 'lodash';\nimport Dexie from 'Dexie';\n\nimport {default as misc} from './misc.js';\nimport {default as legacy} from './legacySchema.js';\n\n// TODO: need package, view and dataset tables?\nconst schema = {\n  items: 'storeID, sessionStarted'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\n/**\n * Delete all data store\n * Try this before dealing with local db issues\n */\nfunction reset() {\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\n\n/**\n * Returns all data store items\n * @return {array} data store objects\n */\nfunction getAllItems() {\n  return idb.items\n    .orderBy('sessionStarted')\n    .reverse()\n    .toArray();\n}\n\n\n/**\n * Get data store items by store ID\n * @param {string} storeID - store ID\n * @return {array} data store object\n */\nfunction getItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .first()\n    .catch(err => {\n      console.error(`IDBError: Unexpected table ID: ${storeID}`, err);\n    });\n}\n\n\n/**\n * Update data object in the store\n * @param {string} storeID - store ID\n * @param {function} updateFunc - update function\n * @return {integer} - number of updated items\n */\nfunction updateItem(storeID, updateFunc) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .modify(updateFunc)\n    .catch(err => {\n      console.error('IDBError: Update failed', err);\n    });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .delete();\n}\n\n\n/**\n * Returns a view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @return {array} view objects\n */\nfunction getView(storeID, viewID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).views)\n    .then(views => {\n      const view = views.find(e => e.viewID === viewID);\n      if (!view) return;\n      view.storeID = storeID;\n      return view;\n    });\n}\n\n\n/**\n * Append a view next to a specific view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object\n */\nfunction appendView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos + 1, 0, viewObj);\n  });\n}\n\n\n/**\n * Update view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object or update function\n */\nfunction updateView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    if (_.isFunction(viewObj)) {\n      viewObj(item.views[pos]);\n    } else {\n      item.views[pos] = viewObj;\n    }\n  });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteView(storeID, viewID) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos, 1);\n    // prune orphaned collections\n    const bin = {};\n    item.dataset.forEach(e => { bin[e.collectionID] = 0; });\n    item.views.forEach(view => {\n      ['rows', 'items', 'nodes', 'edges']\n        .filter(e => view.hasOwnProperty(e))\n        .forEach(e => { bin[view[e]] += 1; });\n    });\n    Object.entries(bin).forEach(entry => {\n      if (!entry[1]) {\n        const i = item.dataset.findIndex(e => e.collectionID === entry[0]);\n        item.dataset.splice(i, 1);\n      }\n    });\n  });\n}\n\n\n/**\n * Returns all collections in the store\n * @return {array} Collection objects\n */\nfunction getAllCollections() {\n  return getAllItems()\n    .then(items => _.flatten(\n      items.map(item => {\n        return item.dataset.map(coll => {\n          coll.storeID = item.storeID;\n          return coll;\n        });\n      })\n    ));\n}\n\n\n/**\n * Returns a collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @return {array} Collection objects\n */\nfunction getCollection(storeID, collID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).dataset)\n    .then(colls => {\n      const coll = colls.find(e => e.collectionID === collID);\n      if (!coll) return;\n      coll.storeID = storeID;\n      return coll;\n    });\n}\n\n\n/**\n * Update collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @param {object} collObj - Collection object or update function\n */\nfunction updateCollection(storeID, collID, collObj) {\n  return updateItem(storeID, item => {\n    const pos = item.dataset.findIndex(e => e.collectionID === collID);\n    if (_.isFunction(collObj)) {\n      collObj(item.dataset[pos]);\n    } else {\n      item.dataset[pos] = collObj;\n    }\n  });\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - storeID if sucessfully added\n */\nfunction importItem(data) {\n  // Legacy format converter\n  data = legacy.convertPackage(data);\n\n  const now = new Date();\n  data.storeID = misc.uuidv4().slice(0, 8);\n  data.sessionStarted = now.toString();\n  return idb.items.put(data);\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} response - response data\n * @return {string} - viewID if sucessfully added\n */\nfunction newDatagrid(response) {\n  const now = new Date();\n  const date = now.toLocaleString('en-GB', { timeZone: 'Asia/Tokyo'});\n  const storeID = misc.uuidv4().slice(0, 8);\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  const data = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    storeID: storeID,\n    name: response.name,\n    views: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n        viewID: viewID,\n        name: response.name,\n        viewType: \"datagrid\",\n        rows: collectionID,\n        checkpoints: [\n          {type: 'creation', date: date}\n        ]\n      }\n    ],\n    dataset: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: collectionID,\n        name: response.name,\n        contents: [response]\n      }\n    ],\n    sessionStarted: date\n  };\n  return idb.items.put(data)\n    .then(() => ({storeID: storeID, viewID:viewID}));\n}\n\n\n/**\n * Store new network view\n * @param {string} storeID - Store ID\n * @param {string} nodesID - ID of nodes collection\n * @param {string} nodesName - Name of nodes collection\n * @param {object} response - Response object\n */\nfunction newNetwork(storeID, nodesID, nodesName, response) {\n  const viewID = misc.uuidv4().slice(0, 8);\n  const edgesID = response.workflowID.slice(0, 8);\n  return updateItem(storeID, item => {\n    item.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n      viewID: viewID,\n      name: `${nodesName}_${response.name}`,\n      viewType: 'network',\n      nodes: nodesID,\n      edges: edgesID,\n      minConnThld: response.query.params.threshold\n    });\n    item.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: edgesID,\n      name: response.name,\n      contents: [response]\n    });\n  }).then(() => viewID);\n}\n\n\nexport default {\n  reset, getAllItems, getItem, updateItem, deleteItem,\n  getView, appendView, updateView, deleteView,\n  getAllCollections, getCollection, updateCollection,\n  importItem, newDatagrid, newNetwork\n};\n","\n/** @module component/badge */\n\nimport d3 from 'd3';\n\nconst assetBaseURL = '../assets/';\nconst iconBaseURL = '../assets/icon/';\n\n\nfunction icon(selection, icon) {\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1rem')\n      .style('height', '1rem');\n}\n\n\nfunction badge(selection) {\n  const body = selection\n      .classed('badge', true);\n  body.append('img')\n      .classed('icon', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  body.append('span')\n      .classed('text', true);\n}\n\n\nfunction updateBadge(selection, text, type, icon) {\n  selection.classed(`badge-${type}`, true);\n  selection.select('.icon')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null);\n  selection.select('.text')\n      .text(text);\n}\n\n\nfunction notify(selection) {\n  selection\n    .style('opacity', 0)\n    .style('display', 'inline')\n    .transition()\n      .duration(500)\n      .ease(d3.easeLinear)\n      .style(\"opacity\", 1.0)\n    .transition()\n      .delay(3000)\n      .duration(1000)\n      .ease(d3.easeLinear)\n      .style(\"opacity\", 0)\n      .on('end', function () {\n        selection.style('display', 'none');\n      });\n}\n\n\nfunction loadingCircle(selection) {\n  selection.append('img')\n      .attr('src', `${assetBaseURL}loading1.gif`)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.style('display', 'none');\n}\n\n\nfunction alert(selection) {\n  const body = selection\n      .classed('alert', true)\n      .classed('px-1', true)\n      .classed('py-0', true);\n  body.append('img')\n      .classed('icon', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  body.append('span')\n      .classed('text', true)\n      .style('font-size', '75%');\n}\n\n\nfunction updateAlert(selection, text, type, icon) {\n  selection.classed(`alert-${type}`, true);\n  selection.select('.icon')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null);\n  selection.select('.text')\n      .text(text);\n}\n\n\nexport default {\n  icon, badge, updateBadge, notify, loadingCircle,\n  alert, updateAlert\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\nconst iconBaseURL = '../assets/icon/';\n\n\nfunction buttonBox(selection, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .text(label);\n}\n\n\nfunction menuButton(selection, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, label, type, icon) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, target, label, type, icon) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('href', '#')\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('label', true)\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, label, type, icon) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  const button = selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  button.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  button.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, label, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, label, target, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', `${iconBaseURL}${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, label, accept, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#')\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      });\n  selection.append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n  selection.append('img')\n      .attr('src', `${iconBaseURL}${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  iconBaseURL, buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module component/transform */\n\n\nfunction transform(selection, tx, ty, tk) {\n  selection.select('.field')\n    .attr('transform', `translate(${tx}, ${ty}) scale(${tk})`);\n}\n\n\nfunction resize(selection, state) {\n  const area = selection.node();\n  const width = area.offsetWidth;\n  const height = area.offsetHeight;\n  selection.select('.view')\n      .attr('viewBox', `0 0 ${width} ${height}`)\n    .select('.boundary')\n      .attr('width', width)\n      .attr('height', height);\n  state.setViewBox(width, height);\n  state.resizeNotifier();\n}\n\n\nfunction viewFrame(selection, state) {\n  selection\n    .style('width', '100%')\n    .style('height', '100%');\n  selection.select('.view').remove(); // Clean up\n  selection.append('svg')\n    .classed('view', true);\n  selection.call(resize, state);\n}\n\n\nfunction view(selection, state) {\n  selection\n    .attr('preserveAspectRatio', 'xMinYMin meet')\n    .attr('pointer-events', 'all')\n    .attr('viewBox', `0 0 ${state.viewBox.right} ${state.viewBox.bottom}`)\n    .style('width', '100%')\n    .style('height', '100%');\n\n  // Clean up\n  selection.select('.boundary').remove();\n  selection.select('.field').remove();\n\n  // Boundary\n  selection.append('rect')\n      .classed('boundary', true)\n      .attr('x', 0)\n      .attr('y', 0)\n      .attr('width', state.viewBox.right)\n      .attr('height', state.viewBox.bottom)\n      .attr('fill', '#ffffff')\n      .attr('stroke-width', 1)\n      .attr('stroke', '#cccccc');\n  // Field\n  selection.append('g')\n      .classed('field', true)\n      .style('opacity', 1e-6)\n    .transition()\n      .duration(1000)\n      .style('opacity', 1);\n}\n\n\nexport default {\n  transform, resize, viewFrame, view\n};\n","\n/** @module component/formBox */\n\n\nimport d3 from 'd3';\n\n\nfunction textBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text');\n}\n\nfunction updateTextBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction textBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction readonlyBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .attr('readonly', 'readonly');\n}\n\n\nfunction textareaBox(selection, label, rows) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows);\n}\n\nfunction updateTextareaBox(selection, value) {\n  selection.select('textarea').property('value', value);\n}\n\nfunction updateTextareaPlaceholder(selection, placeholder) {\n  selection.select('textarea').attr('placeholder', placeholder);\n}\n\nfunction textareaBoxValue(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value;  // TODO: 0 is falsy\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder;\n  return '';\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n').filter(e => e.length > 0);\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder.split('\\n').filter(e => e.length > 0);\n  return [];\n}\n\n\nfunction checkBox(selection, label) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox');\n  box.append('span')\n      .text(label);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, label, min, max, step) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'number')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step);\n}\n\nfunction updateNumberBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction numberIntValid(selection) {\n  const value = numberBoxIntValue(selection);\n  const min = parseInt(selection.select('input').attr('min'));\n  const max = parseInt(selection.select('input').attr('max'));\n  const valid = !isNaN(value) && value >= min && value <= max;\n  selection.select('input')\n      .style('background-color', valid ? '#ffffff' : '#ffcccc');\n  return valid;\n}\n\nfunction numberFloatValid(selection) {\n  const value = numberBoxFloatValue(selection);\n  const min = parseInt(selection.select('input').attr('min'));\n  const max = parseInt(selection.select('input').attr('max'));\n  const valid = !isNaN(value) && value >= min && value <= max;\n  selection.select('input')\n      .style('background-color', valid ? '#ffffff' : '#ffcccc');\n  return valid;\n}\n\nfunction numberBoxIntValue(selection) {\n  return parseInt(selection.select('input').property('value'));\n}\n\nfunction numberBoxFloatValue(selection) {\n  return parseFloat(selection.select('input').property('value'));\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n    .append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'color');\n}\n\n\nfunction updateColorBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\n\nfunction colorBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction fileInputBox(selection, label, accept) {\nselection\n    .classed('form-group', true)\n    .classed('form-row', true);\nselection.append('label')\n    .classed('col-form-label', true)\n    .classed('col-form-label-sm', true)\n    .classed('col-4', true)\n    .text(label);\nselection.append('input')\n    .classed('form-control', true)\n    .classed('form-control-sm', true)\n    .classed('form-control-file', true)\n    .classed('col-8', true)\n    .attr('type', 'file')\n    .attr('accept', accept);\n}\n\nfunction clearFileInput(selection) {\n  // TODO: FileList object (input.files) may be a readonly property\n  const accept = selection.select('input').attr();\n  selection.select('input').remove();\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('form-control-file', true)\n      .classed('col-8', true)\n      .attr('type', 'file')\n      .attr('accept', accept);\n}\n\nfunction fileInputBoxValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\n\nexport default {\n  textBox, updateTextBox, textBoxValue, readonlyBox,\n  textareaBox, updateTextareaBox, updateTextareaPlaceholder,\n  textareaBoxValue, textareaBoxLines,\n  checkBox, updateCheckBox, checkBoxValue,\n  numberBox, updateNumberBox, numberIntValid, numberFloatValid,\n  numberBoxIntValue, numberBoxFloatValue,\n  colorBox, updateColorBox, colorBoxValue,\n  fileInputBox, clearFileInput, fileInputBoxValue\n};\n","\n/** @module component/modal */\n\nimport d3 from 'd3';\n\n\nfunction dialogBase(selection, id) {\n  selection\n      .classed('modal', true)\n      .attr('tabindex', -1)\n      .attr('role', 'dialog')\n      .attr('aria-labelledby', '')\n      .attr('aria-hidden', true)\n      .attr('id', id);\n  selection.append('div')\n      .classed('modal-dialog', true)\n      .attr('role', 'document')\n    .append('div')\n      .classed('modal-content', true);\n}\n\n\nfunction confirmDialog(selection, id) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // body\n  base.append('div')\n      .classed('modal-body', true)\n    .append('div')\n      .classed('message', true);\n  // footer\n  const footer = base.append('div')\n      .classed('modal-footer', true);\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-outline-secondary', true)\n      .classed('cancel', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Cancel');\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-warning', true)\n      .classed('ok', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('OK')\n      .on('click', () => {\n        selection.dispatch('submit');\n      });\n}\n\n\nfunction updateConfirmDialog(selection, message) {\n  selection.select('.message').text(message);\n}\n\n\nfunction submitDialog(selection, id, title) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // header\n  const header = base.append('div')\n      .classed('modal-header', true);\n  header.append('h4')\n      .classed('modal-title', true)\n      .text(title);\n  header.append('button')\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('aria-label', 'Close')\n      .classed('close', true)\n    .append('span')\n      .attr('aria-hidden', true)\n      .html('&times;');\n  // body\n  base.append('div')\n      .classed('modal-body', true);\n  // footer\n  base.append('div')\n      .classed('modal-footer', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-primary', true)\n      .classed('submit', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Submit')\n      .on('click', () => {\n        // Dismiss before submit\n        // Submit event can update the modal itself\n        // (ex. disable submit button before onSubmit call has completed)\n        $(`#${id}`).modal('hide');\n        selection.dispatch('submit');\n      });\n}\n\n\nexport default {\n  confirmDialog, updateConfirmDialog, submitDialog\n};\n","\n/** @module dialog/rename */\n\nimport d3 from 'd3';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'rename-dialog';\nconst title = 'Rename';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-edittext');\n}\n\n\nfunction body(selection) {\n  selection.call(modal.submitDialog, id, title)\n    .select('.modal-body').append('div')\n      .classed('rename', true)\n      .call(box.textBox, 'New name');\n}\n\n\nfunction updateBody(selection, name) {\n  selection.select('.rename')\n      .call(box.updateTextBox, name)\n      .on('input', function () {  // Validation\n        const keyValid = box.textBoxValue(d3.select(this)) !== '';\n        selection.select('.submit').property('disabled', !keyValid);\n      })\n      .dispatch('input');\n}\n\n\nfunction value(selection) {\n  return box.textBoxValue(selection.select('.rename'));\n}\n\n\nexport default {\n  menuLink, body, updateBody, value\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '../req/';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\nfunction serverStatus() {\n  const response = {};\n  return get('server')\n    .then(json)\n    .then(res => {\n      response.server = res;\n    })\n    .then(() => get('schema'))\n    .then(json)\n    .then(res => {\n      response.schema = res;\n    })\n    .then(() => response);\n}\n\n\nexport default {\n  get, json, text, blob, post, error, serverStatus\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: [keyField].concat(mp.fields),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: table.fields.filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key)),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: fields,\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(mp.fields)\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module common/collection */\n\nimport _ from 'lodash';\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as mapper} from './mapper.js';\n\n\nexport default class Collection {\n  /**\n   * Create Collection from a flashflood response datatable\n   * If data is not specified, put datatables later by this.append(data)\n   * @param {object} coll - Collection or response object\n   */\n  constructor(coll) {\n    // Settings\n    this.autoIndex = 'index';  // enumerate records\n\n    this.collectionID = coll.collectionID || null;\n    this.storeID = coll.storeID || null;\n    this.name = coll.name || null;\n    if (coll.records) {\n      this.contents = [coll];\n      this.fields = [];\n    } else {\n      this.contents = coll.contents;\n      this.fields = coll.fields || [];\n    }\n    this.contents.forEach(content => {\n      content.fields.forEach(e => this.addField(e));\n    });\n  }\n\n  /**\n   * Add fields\n   * @param {array} fs - list of fields\n   */\n  addField(field) {\n    if (this.fields.find(e => e.key === field.key)) return;\n    if (!field.hasOwnProperty('name')) field.name = field.key;\n    if (!field.hasOwnProperty('visible')) field.visible = true;\n    if (field.hasOwnProperty('d3_format')) field.format = 'd3_format';\n    if (!field.hasOwnProperty('format')) field.format = 'raw';\n    this.fields.push(field);\n  }\n\n  /**\n   * Update fields properties\n   * @param {array} fs - list of fields\n   */\n  updateFields(fs) {\n    this.fields = [];\n    fs.forEach(e => this.addField(e));\n  }\n\n  /**\n   * Join fields\n   * @param {object} mapping - column mapper object\n   */\n  joinFields(mapping) {\n    this.contents.forEach(c => {\n      mapper.apply(c, mapping);\n    });\n    if (mapping.hasOwnProperty('fields')) {\n      mapping.fields.forEach(e => this.addField(e));\n    } else {\n      this.addField(mapping.field);\n    }\n  }\n\n  /**\n   * Apply function to the original data records\n   * new fields should be manually added by Collection.addField\n   * @param {function} func - function to be applied\n   */\n  apply(func) {\n    this.contents.forEach(content => {\n      content.records.forEach(rcd => {\n        func(rcd);\n      });\n    });\n  }\n\n  /**\n   * Return all records of the collection\n   * @return {array} records\n   */\n  records() {\n    return _.flatten(this.contents.map(e => e.records));\n  }\n\n  fetch(command) {\n    const fs = this.contents\n      .filter(e => ['running', 'ready', 'interrupted', 'queued'].includes(e.status))\n      .map(content => {\n        const query = {id: content.workflowID, command: command};\n        return fetcher.get('progress', query)\n          .then(fetcher.json)\n          .then(data => {\n            return idb.updateCollection(this.storeID, this.collectionID, coll => {\n              const i = coll.contents\n                .findIndex(e => e.workflowID === query.id);\n              if (data.status === 'failure') {  // No data found on server\n                coll.contents[i].status = 'failure';\n              } else {\n                coll.contents[i] = data;\n              }\n            });\n          });\n      });\n    return Promise.all(fs)\n      .then(() => idb.getCollection(this.storeID, this.collectionID))\n      .then(coll => {\n        this.contents = coll.contents;\n      });\n  }\n\n  /**\n   * Retrieve workflows and store it into a local store.\n   * @return {Promise}\n   */\n  pull() {\n    return this.fetch('pull');\n  }\n\n  /**\n   * Retrieve workflows, abort all ongoing workflow task\n   * and store it into a local store.\n   * @return {Promise}\n   */\n  abort() {\n    return this.fetch('abort');\n  }\n\n  /**\n   * Return total number of records\n   * @return {float} total number of records\n   */\n  size() {\n    return _.sum(this.contents.map(e => e.records.length));\n  }\n\n  /**\n   * Return status\n   * @return {string} status\n   */\n  status() {\n    if (this.contents.some(e => e.status === 'interrupted')) return 'interrupted';\n    if (this.contents.some(e => e.status === 'running')) return 'running';\n    if (this.contents.some(e => e.status === 'queued')) return 'queued';\n    if (this.contents.some(e => e.status === 'ready')) return 'ready';\n    if (this.contents.some(e => e.status === 'aborted')) return 'aborted';\n    if (this.contents.some(e => e.status === 'failure')) return 'failure';\n    return 'done';\n  }\n\n  /**\n   * Return ongoing or not\n   * @return {bool} ongoing or not\n   */\n  ongoing() {\n    const s = ['ready', 'queued', 'running', 'interrupted'];\n    return s.includes(this.status());\n  }\n\n  /**\n   * Return percentage of workflow progress\n   * @return {float} progress in percent\n   */\n  progress() {\n    return _.min(this.contents.map(e => e.progress));\n  }\n\n  /**\n   * Return total execution time\n   * @return {float} total time\n   */\n  execTime() {\n    return _.sum(this.contents.map(e => e.execTime));\n  }\n\n  /**\n   * Export collection object as JSON\n   * @return {object} collection JSON\n   */\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: this.collectionID,\n      name: this.name,\n      fields: this.fields,\n      contents: this.contents\n    };\n  }\n}\n","\n/** @module common/transform */\n\nimport d3 from 'd3';\n\n\nexport default class TransformState {\n  constructor(width, height, transform) {\n    this.fieldWidth = width;\n    this.fieldHeight = height;\n\n    this.viewBox = {\n      top: 0,\n      right: this.fieldWidth,\n      bottom: this.fieldHeight,\n      left: 0\n    };\n\n    this.focusArea = {};\n    this.focusAreaMargin = 50;\n\n    this.boundary = {\n      top: 0,\n      right: this.fieldWidth,\n      bottom: this.fieldHeight,\n      left: 0\n    };\n\n    this.transform = transform || {x: 0, y: 0, k: 1};\n    this.prevTransform = {\n      x: this.transform.x,\n      y: this.transform.y,\n      k: this.transform.k\n    };\n\n    this.resizeNotifier = () => {};\n  }\n\n  setFocusArea() {\n    const tx = this.transform.x;\n    const ty = this.transform.y;\n    const tk = this.transform.k;\n    const margin = this.focusAreaMargin;\n    this.focusArea.top = (this.viewBox.top - ty) / tk - margin;\n    this.focusArea.left = (this.viewBox.left - tx) / tk - margin;\n    this.focusArea.bottom = (this.viewBox.bottom - ty) / tk + margin;\n    this.focusArea.right = (this.viewBox.right - tx) / tk + margin;\n    // this.showFocusArea();  // debug\n  }\n\n  setViewBox(width, height) {\n    this.viewBox.right = width;\n    this.viewBox.bottom = height;\n    // this.showViewBox();  // debug\n    this.setFocusArea();\n  }\n\n  setTransform(tx, ty, tk) {\n    this.transform.x = tx;\n    this.transform.y = ty;\n    this.transform.k = tk;\n    // this.showTransform(); // debug\n    this.setFocusArea();\n  }\n\n  fitTransform() {\n    const vh = this.viewBox.bottom;\n    const vw = this.viewBox.right;\n    const vr = vw / vh;\n    const bh = this.boundary.bottom - this.boundary.top;\n    const bw = this.boundary.right - this.boundary.left;\n    const br = bw / bh;\n    const isPortrait = vr >= br;\n    const tk = isPortrait ? vh / bh : vw / bw;\n    const adjustH = isPortrait ? (vw - bw * tk) / 2 : 0;\n    const adjustV = isPortrait ? 0 : (vh - bh * tk) / 2;\n    const tx = -(this.boundary.left) * tk + adjustH;\n    const ty = -(this.boundary.top) * tk + adjustV;\n    this.setTransform(tx, ty, tk);\n  }\n\n  showTransform() {\n    d3.select('#debug-transform')\n      .text(JSON.stringify(this.transform));\n  }\n\n  showFocusArea() {\n    d3.select('#debug-focusarea')\n      .text(JSON.stringify(this.focusArea));\n  }\n\n  showViewBox() {\n    d3.select('#debug-viewbox')\n      .text(JSON.stringify(this.viewBox));\n  }\n}\n","\n/** @module tile/state */\n\nimport _ from 'lodash';\n\nimport Collection from '../common/collection.js';\nimport TransformState from  '../common/transform.js';\nimport {default as idb} from '../common/idb.js';\n\n\nexport default class TileState extends TransformState {\n  constructor(view, items) {\n    super(1200, 800, view.fieldTransform);\n\n    /* Settings */\n\n    this.chunkMarginRatio = 0.05;\n\n    this.focusedViewThreshold = 200;\n    this.enableFocusedView = true;\n    this.focusedView = false;\n\n\n    /* Attributes */\n\n    this.viewID = view.viewID || null;\n    this.storeID = view.storeID || null;\n    this.name = view.name;\n\n    this.items = new Collection(items);\n    this.its = JSON.parse(JSON.stringify(this.items.records()));\n\n\n    /* Appearance */\n\n    this.rowCount = view.rowCount || 8;\n    this.columnCount = view.columnCount || 12;\n    this.groupField = view.groupField || null;\n    this.chunksPerRow = view.chunksPerRow || 1;\n    this.fixRowCount = view.fixRowCount || false;\n    this.fixColumnCount = view.fixColumnCount || false;\n    this.tileAspectRatio = 1;\n    this.showRowNumber = view.showRowNumber || false;\n    this.showColumnNumber = view.showColumnNumber || false;\n\n    /* Appearance */\n    const defaultTileField = this.items.fields[0].key || null;\n    const fillIfNull = (obj, updater) => {\n      Object.entries(updater).forEach(e => {\n        if (!obj.hasOwnProperty(e[0])) {\n          obj[e[0]] = e[1];\n        }\n      });\n    };\n\n    this.tileContent = {};\n    const defaultTileContent = {\n      field: null, visible: false\n    };\n    if (view.hasOwnProperty('tileContent')) {\n      this.tileContent = view.tileContent;\n    }\n    fillIfNull(this.tileContent, defaultTileContent);\n\n    this.tileColor = {};\n    const defaultTileColor = {\n      field: defaultTileField, color: 'monogray',\n      scale: 'linear', domain: [0, 1],\n      range: ['#7fffd4', '#7fffd4'], unknown: '#7fffd4'\n    };\n    if (view.hasOwnProperty('tileColor')) {\n      this.tileColor = view.tileColor;\n    }\n    fillIfNull(this.tileColor, defaultTileColor);\n\n    this.tileValue = {};\n    const defaultTileValue = {\n      field: null, size: 12, visible: false,\n      halign: 2, valign: 2\n    };\n    if (view.hasOwnProperty('tileValue')) {\n      this.tileValue = view.tileValue;\n    }\n    fillIfNull(this.tileValue, defaultTileValue);\n\n    this.tileValueColor = {};\n    const defaultTileValueColor = {\n      field: defaultTileField, color: 'monoblack',\n      scale: 'linear', domain: [0, 1],\n      range: ['#7fffd4', '#7fffd4'], unknown: '#7fffd4'\n    };\n    if (view.hasOwnProperty('tileValueColor')) {\n      this.tileValueColor = view.tileValueColor;\n    }\n    fillIfNull(this.tileValueColor, defaultTileValueColor);\n\n\n    // Drawing\n    this.scaleExtent = [1, Infinity];\n    this.translateExtent = [[0, 0], [this.fieldWidth, Infinity]];\n\n    this.chunkWidth = null;\n    this.chunkHeight = null;\n    this.chunkMarginH = null;\n    this.chunkMarginV = null;\n    this.columnWidth = null;\n    this.rowHeight = null;\n\n    // Event listener\n    this.zoomListener = null;\n\n    // Event notifiers\n    this.updateFieldNotifier = null;\n    this.updateItemNotifier = null;\n    this.updateItemAttrNotifier = null;\n  }\n\n  setViewBox(width, height) {\n    this.viewBox.right = width;\n    this.viewBox.bottom = height;\n    // this.showViewBox();  // debug\n    const vw = this.viewBox.right;\n    const bw = this.boundary.right - this.boundary.left;\n    this.scaleExtent = [vw / bw, Infinity];\n    this.translateExtent = [[0, 0], [bw, Infinity]];\n    this.setTransform(0, 0, vw / bw);\n    this.setFocusArea();\n  }\n\n  setCoords() {\n    this.its.forEach(item => {\n      const cRow = Math.floor(item.chunk / this.chunksPerRow);\n      const cCol = item.chunk % this.chunksPerRow;\n      item.x = this.chunkWidth * cCol + this.chunkMarginH * (cCol + 1) + this.columnWidth * item.col;\n      item.y = this.chunkHeight * cRow + this.chunkMarginV * (cRow + 1) + this.rowHeight * item.row;\n    });\n  }\n\n  setIndices() {\n    const tileCount = this.columnCount * this.rowCount;\n    let totalChunks = 0;\n    Object.entries(_.groupBy(this.its, this.groupBy))\n      .sort(group => group[0])\n      .forEach((group, i) => {\n        group[1].forEach((rcd, j) => {\n          const tileIdx = j % tileCount;\n          rcd.group = i;\n          rcd.chunk = Math.floor(j / tileCount) + totalChunks;\n          rcd.row = Math.floor(tileIdx / this.columnCount);\n          rcd.col = tileIdx % this.columnCount;\n        });\n        totalChunks += Math.ceil(group[1].length / tileCount);\n    });\n    this.setCoords();\n  }\n\n  setFieldSize() {\n    this.chunkWidth = this.fieldWidth /\n      (this.chunksPerRow + this.chunkMarginRatio * (this.chunksPerRow + 1));\n    this.chunkHeight = this.chunkWidth * this.tileAspectRatio;\n    this.chunkMarginH = this.chunkWidth * this.chunkMarginRatio;\n    this.chunkMarginV = this.chunkHeight * this.chunkMarginRatio;\n    this.columnWidth = this.chunkWidth / this.columnCount;\n    this.rowHeight = this.columnWidth * this.tileAspectRatio;\n    this.setIndices();\n  }\n\n  itemsToRender() {\n    return this.its.filter(\n      e => this.focusArea.top < e.y\n        && this.focusArea.left < e.x\n        && this.focusArea.bottom > e.y\n        && this.focusArea.right > e.x\n    );\n  }\n\n  save() {\n    return idb.updateItem(this.storeID, item => {\n      const i = item.items\n        .findIndex(e => e.collectionID === this.items.collectionID);\n      item.items[i] = this.items.export();\n      const vi = item.views.findIndex(e => e.viewID === this.viewID);\n      item.views[vi] = this.export();\n    });\n  }\n\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/tile_v1.0.json\",\n      viewID: this.viewID,\n      name: this.name,\n      viewType: \"tile\",\n      items: this.items.collectionID,\n      rowCount: this.rowCount,\n      columnCount: this.columnCount,\n      groupField: this.groupField,\n      chunksPerRow: this.chunksPerRow,\n      tileContent: this.tileContent,\n      tileColor: this.tileColor,\n      tileValue: this.tileValue,\n      tileValueColor: this.tileValueColor,\n      fieldTransform: this.transform\n    };\n  }\n}\n","\n/** @module common/scale */\n\nimport d3 from 'd3';\n\n\nconst colorScales = [\n  {key: 'monoblack', type: 'monocolor', colors: ['#333333'], unknown: '#333333'},\n  {key: 'monogray', type: 'monocolor', colors: ['#cccccc'], unknown: '#cccccc'},\n  {key: 'nodeDefault', type: 'monocolor', colors: ['#7fffd4'], unknown: '#7fffd4'},\n  {key: 'aquamarine', type: 'bicolor',\n   colors: ['#778899', '#7fffd4'], unknown: '#f0f0f0'},\n  {key: 'chartreuse', type: 'bicolor',\n   colors: ['#778899', '#7fff00'], unknown: '#f0f0f0'},\n  {key: 'salmon', type: 'bicolor',\n   colors: ['#778899', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'violet', type: 'bicolor',\n   colors: ['#778899', '#ee82ee'], unknown: '#f0f0f0'},\n  {key: 'temperature', type: 'tricolor',\n   colors: ['#87ceeb', '#fff5ee', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'spectrum', type: 'tricolor',\n   colors: ['#6495ed', '#ccff66', '#ffa500'], unknown: '#f0f0f0'},\n  {key: 'category10', type: 'categorical',\n   colors: ['#8dd3c7','#ffffb3','#bebada','#fb8072','#80b1d3','#fdb462',\n    '#b3de69','#fccde5','#bc80bd','#ccebc5'], unknown: '#f0f0f0'},\n  {key: 'cbsafe', type: 'categorical',\n   colors: ['#543005','#8c510a','#bf812d','#dfc27d','#f6e8c3','#c7eae5',\n   '#80cdc1','#35978f','#01665e','#003c30'], unknown: '#f0f0f0'},\n  {key: 'category20', type: 'categorical',\n   colors: d3.schemePaired.concat(d3.schemeSet2), unknown: '#f0f0f0'},\n  {key: 'category40', type: 'categorical',\n   colors: d3.schemePaired.concat(d3.schemePastel2, d3.schemeSet2, d3.schemeSet3),\n   unknown: '#f0f0f0'},\n  {key: 'custom', type: 'custom', colors: ['#ffffff'], text: 'custom'}\n];\n\n\nconst types = [\n  {key: 'linear', name: 'Linear', func: d3.scaleLinear},\n  {key: 'log', name: 'Log', func: d3.scaleLog},\n  {key: 'quantize', name: 'Quantize', func: d3.scaleQuantize},\n  {key: 'ordinal', name: 'Ordinal', func: d3.scaleOrdinal}\n];\n\n\nfunction scaleFunction(state) {\n  const cscale = colorScales.find(e => e.key === state.color);\n  let range;\n  let unknown;\n  if (cscale && cscale.key !== 'custom') {\n      range = cscale.colors;\n      unknown = cscale.unknown;\n  } else {\n    range = state.range;\n    unknown = state.unknown;\n  }\n  let domain = null;\n  if (range.length === 3) {\n    const mid = (parseFloat(state.domain[0]) + parseFloat(state.domain[1])) / 2;\n    domain = [state.domain[0], mid, state.domain[1]];\n  } else {\n    domain = state.domain;\n  }\n  // Build\n  let scaleFunc = types.find(e => e.key === state.scale).func();\n  scaleFunc = scaleFunc.domain(domain);\n  scaleFunc = scaleFunc.range(range);\n  if (['linear', 'log'].includes(state.scale)) {\n    scaleFunc = scaleFunc.clamp(true);\n  }\n\n  return d => {\n    // Sanitize\n    if (d === '' || typeof d === 'undefined' || d === null) {\n      return unknown;  // invalid values\n    }\n    if (['linear', 'log'].includes(state.scale) && parseFloat(d) != d) {\n      return unknown;  // texts\n    }\n    if (state.scale === 'log' && d <= 0) {\n      return unknown;  // negative values in log scale\n    }\n    // Apply function\n    const result = scaleFunc(d);\n    if (result === undefined) {\n      return unknown;  // TODO: specify unexpected behavior\n    }\n    return result;\n  };\n}\n\n\nfunction isD3Format(notation) {\n  try {\n    d3.format(notation);\n  } catch (err) {\n    return false;\n  }\n  return true;\n}\n\n\nexport default {\n  colorScales, types, scaleFunction, isD3Format\n};\n","\n/** @module tile/component */\n\nimport {default as scale} from '../common/scale.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as transform} from '../component/transform.js';\n\n\nfunction updateItems(selection, state) {\n  const itemsToRender = state.itemsToRender();\n  const items = selection.selectAll('.item')\n    .data(itemsToRender, d => d.index);\n  items.exit().remove();\n  const entered = items.enter()\n    .append('g')\n      .attr('class', 'item');\n  entered.append('rect')\n      .attr('class', 'tile')\n      .attr('x', 0)\n      .attr('y', 0)\n      .style('stroke-width', 1)\n      .style('stroke', '#cccccc');\n  entered.append('g')\n      .attr('class', 'tile-content');\n  entered.append('text')\n      .attr('class', 'tile-value');\n  const merged = entered.merge(items);\n  merged.select('.tile')\n      .attr('width', state.columnWidth)\n      .attr('height', state.rowHeight);\n  if (state.enableFocusedView) {\n    state.focusedView = itemsToRender.length < state.focusedViewThreshold;\n  }\n  if (state.focusedView && state.tileContent.visible) {\n    merged.select('.tile-content').html(d => d.structure);\n    merged.select('.tile-content')\n      .select('svg')\n        .attr('width', state.columnWidth)\n        .attr('height', state.rowHeight);\n  } else {\n    merged.select('.tile-content').select('svg').remove();\n  }\n  selection.call(updateItemAttrs, state);\n}\n\n\nfunction updateItemAttrs(selection, state) {\n  const colorConv = scale.scaleFunction(state.tileColor);\n  const valueColorConv = scale.scaleFunction(state.tileValueColor);\n  const items = selection.selectAll('.item')\n      .attr('transform', d => `translate(${d.x}, ${d.y})`);\n  items.select('.tile')\n      .style('fill', d => colorConv(d[state.tileColor.field]));\n  items.select('.tile-value')\n      .text(d => {\n        if (state.tileValue.field === null) return '';\n        const field = state.items.fields\n          .find(e => e.key === state.tileValue.field);\n        if (field.format === 'd3_format') {\n          return misc.formatNum(d[state.tileValue.field], field.d3_format);\n        }\n        return d[state.tileValue.field];\n      })\n      .attr('x', state.columnWidth * 0.05)\n      .attr('y', state.rowHeight * 0.75)\n      .attr('font-size', state.rowHeight * 0.5)\n      .attr('textLength', state.columnWidth * 0.9)\n      .attr('lengthAdjust', 'spacingAndGlyphs')\n      .attr('visibility', state.tileValue.visible ? 'inherit' : 'hidden')\n      .style('fill',\n        d => valueColorConv(d[state.tileValueColor.field]));\n}\n\n\nfunction tileView(selection, state) {\n  selection.call(transform.view, state);\n  const items = selection.select('.field')\n    .append('g').classed('tl-items', true);\n  state.updateFieldNotifier = () => {\n    state.setFieldSize();\n    items.call(updateItems, state);\n  };\n  state.updateItemNotifier = () => {\n    items.call(updateItems, state);\n  };\n  state.updateItemAttrNotifier = () => {\n    items.call(updateItemAttrs, state);\n  };\n  state.updateFieldNotifier();\n}\n\n\nexport default {\n  updateItems, updateItemAttrs, tileView\n};\n","\n/** @module tile/interaction */\n\nimport d3 from 'd3';\n\nimport {default as transform} from '../component/transform.js';\n\n\nfunction zoomListener(selection, state) {\n  return d3.zoom()\n    .scaleExtent(state.scaleExtent)\n    .translateExtent(state.translateExtent)\n    .on('zoom', function() {\n      const t = d3.event.transform;\n      selection.call(transform.transform, t.x, t.y, t.k);\n    })\n    .on('end', function() {\n      const t = d3.event.transform;\n      state.setTransform(t.x, t.y, t.k);\n      state.prevTransform = {x: t.x, y: t.y, k: t.k};\n      state.updateItemNotifier();\n    });\n}\n\n\nfunction setInteraction(selection, state) {\n  state.zoomListener = zoomListener(selection, state);\n  selection.call(state.zoomListener);\n  state.resizeNotifier = () => {\n    selection.call(setInteraction, state);\n    state.updateItemNotifier();\n  };\n  // Resume zoom event\n  const t = state.transform;\n  selection\n      .call(transform.transform, t.x, t.y, t.k)\n      .call(\n        d3.zoom().transform,\n        d3.zoomIdentity.translate(t.x, t.y).scale(t.k)\n      );\n}\n\n\nexport default {\n  zoomListener, setInteraction\n};\n","\n/** @module component/shape */\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction monocolorBar(selection, colors, text) {\n  selection.attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none');\n  const group = selection.append('g');\n  group.append('rect')\n      .attr('x', 0).attr('y', 0)\n      .attr('width', 100).attr('height', 10)\n      .attr('fill', colors[0]);\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 10)\n      .attr('font-size', 12)\n      .text(text);\n}\n\nfunction bicolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n      .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n      .attr('offset', 1).attr('stop-color', colors[1]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction tricolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n    .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n    .attr('offset', 0.5).attr('stop-color', colors[1]);\n  grad.append('stop')\n    .attr('offset', 1).attr('stop-color', colors[2]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction categoricalBar(selection, colors, text) {\n  selection.attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none');\n  const sw = 100 / colors.length;\n  const group = selection.append('g');\n  colors.forEach((e, i) => {\n    group.append('rect')\n        .attr('x', sw * i).attr('y', 0)\n        .attr('width', sw).attr('height', 20)\n        .attr('fill', colors[i]);\n  });\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 20)\n      .attr('font-size', 20)\n      .text(text);\n}\n\nfunction setSize(selection, width, height) {\n  selection.attr('width', width).attr('height', height);\n}\n\n\nconst colorBar = {\n  'monocolor': monocolorBar,\n  'bicolor': bicolorBar,\n  'tricolor': tricolorBar,\n  'categorical': categoricalBar,\n  'custom': monocolorBar\n};\n\n\nexport default {\n  colorBar, setSize\n};\n","\n/** @module component/formListBox */\n\nimport d3 from 'd3';\n\nimport {default as shape} from './shape.js';\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction selectBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('select')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n}\n\nfunction selectBoxItems(selection, items) {\n  const options = selection.select('select')\n    .selectAll('option')\n      .data(items, d => d.key);\n  options.exit().remove();\n  options.enter()\n    .append('option')\n      .attr('value', d => d.key)\n      .text(d => d.name);\n}\n\nfunction updateSelectBox(selection, value) {\n  selection.select('select').property('value', value);\n}\n\nfunction selectBoxValue(selection) {\n  return selection.select('select').property('value');\n}\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction checklistBox(selection, label) {\n  // TODO: scroll\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('ul')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n}\n\nfunction checklistBoxItems(selection, items) {\n  const listitems = selection.select('ul')\n    .selectAll('li')\n      .data(items, d => d.key);\n  listitems.exit().remove();\n  const form = listitems.enter()\n    .append('li')\n      .attr('class', 'form-check')\n    .append('label')\n      .attr('class', 'form-check-label');\n  form.append('input')\n      .attr('type', 'checkbox')\n      .attr('class', 'form-check-input')\n      .property('value', d => d.key);\n  form.append('span')\n      .text(d => d.name);\n}\n\nfunction updateChecklistBox(selection, values) {\n  if (!values) return;\n  selection.selectAll('input')\n    .each(function (d) {\n      d3.select(this).property('checked', values.includes(d.key));\n    });\n}\n\nfunction checklistBoxValue(selection) {\n  return selection.selectAll('input:checked').data().map(d => d.key);\n}\n\nfunction anyChecked(selection) {\n  return checklistBoxValue(selection).length > 0;\n}\n\n\nfunction colorScaleBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label || 'Colorscale');\n  const form = selection.append('div')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n  const dropdown = form.append('div')\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  dropdown.append('button')\n      .classed('btn', true)\n      .classed(`btn-light`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  dropdown.append('div')\n      .classed('dropdown-menu', true)\n      .classed('py-0', true);\n  form.append('span')\n      .classed('selected', true);\n}\n\nfunction colorScaleBoxItems(selection, items) {\n  const listitems = selection.select('.dropdown-menu')\n    .selectAll('a')\n      .data(items, d => d);\n  listitems.exit().remove();\n  listitems.enter()\n    .append('a')\n      .classed('dropdown-item', true)\n      .classed('py-0', true)\n      .attr('href', '#')\n      .attr('title', d => d.key)\n      .on('click', function (d) {\n        selection.call(setSelectedColorScale, d);\n        selection.dispatch('change', {bubbles: true});\n      })\n    .append('svg')\n      .each(function (d) {\n        d3.select(this)\n          .call(shape.colorBar[d.type], d.colors, d.text)\n          .call(shape.setSize, 100, 10);\n      });\n}\n\nfunction setSelectedColorScale(selection, item) {\n  const selected = selection.select('.selected');\n  selected.selectAll('svg').remove();\n  selected.datum(item);  // Bind selected item record\n  selected.append('svg')\n      .call(shape.colorBar[item.type], item.colors, item.text)\n      .call(shape.setSize, 100, 10);\n}\n\nfunction updateColorScaleBox(selection, key) {\n  const data = selection.select('.dropdown-menu')\n    .selectAll('a').data();\n  const item = data.find(e => e.key === key);\n  selection.call(setSelectedColorScale, item);\n}\n\nfunction colorScaleBoxValue(selection) {\n  return selection.select('.selected').datum().key;\n}\n\nfunction colorScaleBoxItem(selection) {\n  return selection.select('.selected').datum();\n}\n\n\nexport default {\n  selectBox, selectBoxItems, updateSelectBox, selectBoxValue,\n  checklistBox, checklistBoxItems, updateChecklistBox, checklistBoxValue,\n  anyChecked,\n  colorScaleBox, colorScaleBoxItems, updateColorScaleBox,\n  colorScaleBoxValue, colorScaleBoxItem\n};\n","\n/** @module component/formRangeBox */\n\nimport d3 from 'd3';\n\n\n/**\n * Render range box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction rangeBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  const f = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true);\n  f.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('min');\n  f.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('min', true)\n      .attr('type', 'text');\n  const t = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-4', true)\n      .classed('mb-1', true);\n  t.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('max');\n  t.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('max', true)\n      .attr('type', 'text');\n}\n\n\nfunction updateRangeBox(selection, range) {\n  selection.select('.min').property('value', range[0]);\n  selection.select('.max').property('value', range[1]);\n  selection.selectAll('.min,.max')\n    .on('input', function () {\n      if (!rangeBoxValid(selection)) {\n        d3.event.stopPropagation();\n      }\n    })\n    .dispatch('input', {bubbles: true});\n}\n\n\nfunction rangeBoxValid(selection) {\n  const min = selection.select('.min').property('value');\n  const max = selection.select('.max').property('value');\n  const valid = v => v !== '' && !isNaN(v);\n  selection.select('.min')\n      .style('background-color', valid(min) ? '#ffffff' : '#ffcccc');\n  selection.select('.max')\n      .style('background-color', valid(max) ? '#ffffff' : '#ffcccc');\n  return valid(min) && valid(max);\n}\n\n\nfunction rangeBoxValues(selection) {\n  return [\n    parseFloat(selection.select('.min').property('value')),\n    parseFloat(selection.select('.max').property('value'))\n  ];\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true)\n      .text(label);\n  const f = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  f.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('min');\n  f.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('min', true)\n      .attr('type', 'color');\n  const m = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  m.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('mid');\n  m.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('mid', true)\n      .attr('type', 'color');\n  const t = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  t.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('max');\n  t.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('max', true)\n      .attr('type', 'color');\n  selection\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n}\n\n\nfunction updateColorRangeBox(selection, range) {\n  selection.select('.min').property('value', range[0]);\n  selection.select('.mid').property('value', range[1]);\n  selection.select('.max').property('value', range[2]);\n}\n\n\nfunction colorRangeBoxValues(selection) {\n  return [\n    selection.select('.min').property('value'),\n    selection.select('.mid').property('value'),\n    selection.select('.max').property('value')\n  ];\n}\n\n\nexport default {\n  rangeBox, updateRangeBox, rangeBoxValues, rangeBoxValid,\n  colorRangeBox, updateColorRangeBox, colorRangeBoxValues\n};\n","\n/** @module component/formBoxGroup */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\n\nimport {default as box} from './formBox.js';\nimport {default as lbox} from './formListBox.js';\nimport {default as rbox} from './formRangeBox.js';\n\n\n/**\n * Render color range control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeGroup(selection, colorScales) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('colorscale', true)\n      .classed('mb-2', true)\n      .call(lbox.colorScaleBox, 'Colorscale')\n      .call(lbox.colorScaleBoxItems, colorScales);\n\n  // Custom colorscale\n  const id = misc.uuidv4().slice(0, 8);\n  selection.append('div')\n      .classed('form-row', true)\n      .classed('justify-content-end', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-sm', true)\n      .classed('btn-outline-primary', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'collapse')\n      .attr('data-target', `#${id}-collapse`)\n      .attr('aria-expanded', 'false')\n      .attr('aria-controls', `${id}-collapse`)\n      .text('Custom colorscale');\n  const collapse = selection.append('div')\n      .classed('collapse', true)\n      .attr('id', `${id}-collapse`)\n    .append('div')\n      .classed('card', true)\n      .classed('card-body', true)\n      .classed('p-2', true);\n  const customColorRanges = [\n    {key: 'continuous', name: 'Continuous'},\n    {key: 'two-piece', name: 'Two-piece'}\n  ];\n  collapse.append('div')\n      .classed('rangetype', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Range type')\n      .call(lbox.selectBoxItems, customColorRanges);\n  collapse.append('div')\n      .classed('range', true)\n      .classed('mb-1', true)\n      .call(rbox.colorRangeBox, 'Range');\n  collapse.append('div')\n      .classed('unknown', true)\n      .classed('mb-1', true)\n      .call(box.colorBox, 'Unknown');\n}\n\n\nfunction updateColorRangeGroup(selection, cscale, range, unknown) {\n  const customRange = () => {\n    const cs = lbox.colorScaleBoxValue(selection.select('.colorscale'));\n    const rg = lbox.selectBoxValue(selection.select('.rangetype'));\n    const customScale = cs === 'custom';\n    selection.selectAll('.rangetype, .range, .unknown')\n        .selectAll('select, input')\n        .property('disabled', !customScale)\n        .style('opacity',  customScale ? null : 0.3);\n    selection.select('.range').select('.mid')\n        .property('disabled', !customScale || rg === 'continuous')\n        .style('opacity', customScale && rg !== 'continuous' ? null : 0.3);\n  };\n  selection.select('.colorscale')\n      .call(lbox.updateColorScaleBox, cscale)\n      .on('change', function () {\n        customRange();\n      });\n  const rtype = range.length === 2 ? 'continuous' : 'two-piece';\n  selection.select('.rangetype')\n      .call(lbox.updateSelectBox, rtype)\n      .on('change', function () {\n        customRange();\n      })\n      .dispatch('change');\n  const rboxValues = range.length === 2  ? [range[0], null, range[1]] : range;\n  selection.select('.range')\n      .call(rbox.updateColorRangeBox, rboxValues)\n      .on('focusin', () => {\n        selection.dispatch('change', {bubbles: true});\n      });\n  selection.select('.unknown')\n      .call(box.updateColorBox, unknown)\n      .on('focusin', () => {\n        selection.dispatch('change', {bubbles: true});\n      });\n}\n\n\nfunction colorRangeGroupValue(selection) {\n  const colorScale = lbox.colorScaleBoxItem(selection.select('.colorscale'));\n  const rtype = lbox.selectBoxValue(selection.select('.rangetype'));\n  const range = rbox.colorRangeBoxValues(selection.select('.range'));\n  const unknown = box.colorBoxValue(selection.select('.unknown'));\n  return {\n    color: colorScale.key,\n    colorScaleType: colorScale.type,\n    range: rtype === 'continuous' ? [range[0], range[2]] : range,\n    unknown: unknown\n  };\n}\n\n\n/**\n * Render scale and domain control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction scaleBoxGroup(selection) {\n  const scaleOptions = [\n    {key: 'linear', name: 'Linear'},\n    {key: 'log', name: 'Log'}\n  ];\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('scale', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Scale')\n      .call(lbox.selectBoxItems, scaleOptions);\n  selection.append('div')\n      .classed('domain', true)\n      .classed('mb-1', true)\n      .call(rbox.rangeBox, 'Domain');\n}\n\n\nfunction updateScaleBoxGroup(selection, scale, domain) {\n  selection.select('.scale')\n      .call(lbox.updateSelectBox, scale);\n  selection.select('.domain')\n      .call(rbox.updateRangeBox, domain)\n      .on('input', function () {\n        scaleBoxGroupValid(selection);\n      });\n  selection.selectAll('.scale, .domain')\n      .on('change', function () {\n        if (!scaleBoxGroupValid(selection)) {\n          d3.event.stopPropagation();\n        }\n      });\n}\n\n\nfunction scaleBoxGroupValid(selection) {\n  if (!rbox.rangeBoxValid(selection.select('.domain'))) return false;\n  if (lbox.selectBoxValue(selection.select('.scale')) === 'linear') return true;\n  const values = rbox.rangeBoxValues(selection.select('.domain'));\n  selection.select('.domain').select('.min')\n      .style('background-color', values[0] > 0 ? '#ffffff' : '#ffcccc');\n  selection.select('.domain').select('.max')\n      .style('background-color', values[1] > 0 ? '#ffffff' : '#ffcccc');\n  const validScale = lbox.selectBoxValue(selection.select('.scale')) !== '';\n    selection.select('.scale').select('select')\n        .style('background-color', validScale ? '#ffffff' : '#ffcccc');\n  return values[0] > 0 && values[1] > 0 && validScale;\n}\n\n\nfunction scaleBoxGroupValue(selection) {\n  const scale = lbox.selectBoxValue(selection.select('.scale'));\n  const domain = rbox.rangeBoxValues(selection.select('.domain'));\n  return {\n    scale: scale || 'linear', \n    domain: domain\n  };\n}\n\n\nexport default {\n  colorRangeGroup, updateColorRangeGroup, colorRangeGroupValue,\n  scaleBoxGroup, updateScaleBoxGroup, scaleBoxGroupValue, scaleBoxGroupValid\n};\n","\n/** @module component/controlBox */\n\nimport d3 from 'd3';\n\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as rbox} from '../component/formRangeBox.js';\nimport {default as group} from '../component/formBoxGroup.js';\n\n\nfunction colorControlBox(selection, colorScales, fieldName) {\n  selection.append('div')\n      .classed('field', true)\n      .call(lbox.selectBox, fieldName || 'Field');\n  selection.append('div')\n      .classed('range', true)\n      .call(group.colorRangeGroup, colorScales);\n  selection.append('div')\n      .classed('scale', true)\n      .call(group.scaleBoxGroup);\n}\n\n\nfunction updateColorControlBox(selection, fieldOptions, colorState) {\n  selection.select('.field')\n      .call(lbox.selectBoxItems, fieldOptions)\n      .call(lbox.updateSelectBox, colorState.field);\n  selection.select('.range')\n      .call(group.updateColorRangeGroup, colorState.color,\n            colorState.range, colorState.unknown);\n  selection.select('.scale')\n      .call(group.updateScaleBoxGroup, colorState.scale, colorState.domain);\n  selection.selectAll('.field, .range, .scale')\n      .on('change', function () {\n        if (!colorControlValid(selection)) {\n          d3.event.stopPropagation();\n        }\n      })\n      .dispatch('change');\n}\n\n\nfunction colorControlValid(selection) {\n  const values = group.colorRangeGroupValue(selection.select('.range'));\n  const noScale = ['categorical', 'monocolor'].includes(values.colorScaleType);\n  selection.select('.scale').selectAll('select,input')\n    .property('disabled', noScale)\n    .style('opacity', noScale ? 0.3 : null);\n  const scaleValid = group.scaleBoxGroupValid(selection.select('.scale'));\n  return noScale || scaleValid;\n}\n\n\nfunction colorControlBoxState(selection) {\n  const range = group.colorRangeGroupValue(selection.select('.range'));\n  const scale = group.scaleBoxGroupValue(selection.select('.scale'));\n  return {\n    field: lbox.selectBoxValue(selection.select('.field')),\n    color: range.color,\n    range: range.range,\n    unknown: range.unknown,\n    scale: range.colorScaleType === 'categorical' ? 'ordinal': scale.scale,\n    domain: scale.domain\n  };\n}\n\n\nfunction sizeControlBox(selection, fieldName) {\n  selection.append('div')\n      .classed('field', true)\n      .call(lbox.selectBox, fieldName || 'Field');\n  selection.append('div')\n      .classed('range', true)\n      .call(rbox.rangeBox, 'Range');\n  selection.append('div')\n      .classed('unknown', true)\n      .classed('mb-3', true)\n      .call(box.textBox, 'Unknown', 0, 1000, 1)\n    .select('input')\n      .classed('col-8', false)\n      .classed('col-3', true);\n  selection.append('div')\n      .classed('scale', true)\n      .call(group.scaleBoxGroup);\n}\n\n\nfunction updateSizeControlBox(selection, fieldOptions, sizeState) {\n  selection.select('.field')\n      .call(lbox.selectBoxItems, fieldOptions)\n      .call(lbox.updateSelectBox, sizeState.field);\n  selection.select('.range')\n      .call(rbox.updateRangeBox, sizeState.range);\n  selection.select('.unknown')\n      .call(box.updateTextBox, sizeState.unknown);\n  selection.select('.scale')\n      .call(group.updateScaleBoxGroup, sizeState.scale, sizeState.domain);\n  selection.selectAll('.range, .unknown')\n      .on('input', function () {\n        sizeRangeValid(selection);\n      });\n  selection.selectAll('.field, .range, .unknown, .scale')\n      .on('change', function () {\n        if (!sizeControlValid(selection)) {\n          d3.event.stopPropagation();\n        }\n      });\n}\n\nfunction sizeRangeValid(selection) {\n  if (!rbox.rangeBoxValid(selection.select('.range'))) return false;\n  const range = rbox.rangeBoxValues(selection.select('.range'));\n  const unk = box.textBoxValue(selection.select('.unknown'));\n  const validUnk = unk !== '' && !isNaN(unk) && unk > 0;\n  selection.select('.range').select('.min')\n      .style('background-color', range[0] > 0 ? '#ffffff' : '#ffcccc');\n  selection.select('.range').select('.max')\n      .style('background-color', range[1] > 0 ? '#ffffff' : '#ffcccc');\n  selection.select('.unknown').select('input')\n      .style('background-color', validUnk ? '#ffffff' : '#ffcccc');\n  return range[0] > 0 && range[1] > 0 && validUnk;\n}\n\n\nfunction sizeControlValid(selection) {\n  if (!group.scaleBoxGroupValid(selection.select('.scale'))) return false;\n  return sizeRangeValid(selection);\n}\n\n\nfunction sizeControlBoxState(selection) {\n  const scale = group.scaleBoxGroupValue(selection.select('.scale'));\n  return {\n    field: lbox.selectBoxValue(selection.select('.field')),\n    range: rbox.rangeBoxValues(selection.select('.range')),\n    unknown: box.textBoxValue(selection.select('.unknown')),\n    scale: scale.scale,\n    domain: scale.domain\n  };\n}\n\n\nfunction labelControlBox(selection, colorScales) {\n  // nodeLabel.visible\n  selection.append('div')\n    .append('div')\n      .classed('visible', true)\n      .call(box.checkBox, 'Show labels');\n  // nodeLabel\n  const labelGroup = selection.append('div')\n      .classed('mb-3', true);\n  labelGroup.append('div')\n      .classed('text', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Text field');\n  labelGroup.append('div')\n      .classed('size', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Font size', 4, 100, 1);\n  // nodeLabelColor\n  selection.call(colorControlBox, colorScales, 'Color field');\n}\n\n\nfunction updateLabelControlBox(selection, fieldOptions,\n                               labelState, colorState) {\n  // nodeLabel.visible\n  selection.select('.visible')\n      .call(box.updateCheckBox, labelState.visible);\n  // nodeLabel.field\n  selection.select('.text')\n      .call(lbox.selectBoxItems, fieldOptions)\n      .call(lbox.updateSelectBox, labelState.field);\n  // nodeLabel.size\n  selection.select('.size')\n      .call(box.updateNumberBox, labelState.size)\n      .on('input', function () {\n        box.numberFloatValid(d3.select(this));\n      });\n  // nodeLabelColor\n  selection.call(updateColorControlBox, fieldOptions, colorState)\n      .selectAll('.visible, .text, .size, .field, .range, .scale')\n      .on('change', function () {\n        if (!labelControlValid(selection)) {\n          d3.event.stopPropagation();\n        }\n      })\n      .dispatch('change');\n}\n\n\nfunction labelControlValid(selection) {\n  if (!box.numberFloatValid(selection.select('.size'))) return false;\n  return colorControlValid(selection);\n}\n\n\nfunction labelControlBoxState(selection) {\n  return {\n    label: {\n      field: lbox.selectBoxValue(selection.select('.text')),\n      size: box.numberBoxFloatValue(selection.select('.size')),\n      visible: box.checkBoxValue(selection.select('.visible'))\n    },\n    labelColor: colorControlBoxState(selection)\n  };\n}\n\n\nfunction controlBoxFrame(selection, navID, contentID) {\n  selection.append('nav')\n    .append('div')\n      .classed('nav', true)\n      .classed('nav-tabs', true)\n      .attr('id', navID)\n      .attr('role', 'tablist');\n  selection.append('div')\n      .classed('tab-content', true)\n      .classed('p-2', true)\n      .attr('id', contentID);\n}\n\n\nfunction controlBoxNav(selection, id, label) {\n  selection\n      .classed('nav-item', true)\n      .classed('nav-link', true)\n      .classed('py-1', true)\n      .attr('id', `${id}-tab`)\n      .attr('data-toggle', 'tab')\n      .attr('href', `#${id}`)\n      .attr('role', 'tab')\n      .attr('aria-controls', id)\n      .attr('aria-selected', 'false')\n      .text(label);\n}\n\n\nfunction controlBoxItem(selection, id) {\n  selection\n      .classed('tab-pane', true)\n      .classed('fade', true)\n      .classed('container', true)\n      .classed('px-0', true)\n      .attr('id', id)\n      .attr('role', 'tabpanel')\n      .attr('aria-labelledby', `${id}-tab`);\n}\n\n\nexport default {\n  colorControlBox, updateColorControlBox, colorControlValid, colorControlBoxState,\n  sizeControlBox, updateSizeControlBox, sizeControlValid, sizeControlBoxState,\n  labelControlBox, updateLabelControlBox, labelControlValid, labelControlBoxState,\n  controlBoxFrame, controlBoxNav, controlBoxItem\n};\n","\n/** @module tile/controlBox */\n\nimport _ from 'lodash';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as cscale} from '../common/scale.js';\n\nimport {default as box} from '../component/formBox.js';\nimport {default as cbox} from '../component/controlBox.js';\nimport {default as lbox} from '../component/formListBox.js';\n\n\nfunction mainControlBox(selection) {\n  const chunkGroup = selection.append('div')\n      .classed('panel-group', true)\n      .classed('mb-3', true);\n  chunkGroup.append('div')\n      .classed('rowcnt', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Rows', 1, 9999, 1);\n  chunkGroup.append('div')\n      .classed('colcnt', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Columns', 1, 9999, 1);\n  chunkGroup.append('div')\n      .classed('groupby', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'GroupBy');\n  chunkGroup.append('div')\n      .classed('crow', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'ChunksPerRow', 1, 999, 1);\n  chunkGroup.append('div')\n      .classed('showcol', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Show column number');\n  chunkGroup.append('div')\n      .classed('showrow', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Show row number');\n}\n\n\nfunction updateMainControlBox(selection, state) {\n  // Network threshold\n  const chunkGroup = selection.select('.panel-group');\n  chunkGroup.select('.rowcnt')\n      .call(box.updateNumberBox, state.rowCount);\n  chunkGroup.select('.colcnt')\n      .call(box.updateNumberBox, state.columnCount);\n  chunkGroup.select('.groupby')\n    .call(lbox.selectBoxItems,\n          state.items.fields.filter(e => misc.sortType(e.format) !== 'none'))\n    .call(lbox.updateSelectBox, state.groupField || '');\n  chunkGroup.select('.crow')\n      .call(box.updateNumberBox, state.chunksPerRow);\n  chunkGroup.select('.showcol')\n      .call(box.updateCheckBox, state.showColumnNumber);\n  chunkGroup.select('.showrow')\n      .call(box.updateCheckBox, state.showRowNumber);\n  chunkGroup.selectAll('.rowcnt, .colcnt, .groupby, .crow, .showcol, .showrow')\n      .on('change', function () {\n        state.rowCount = box.numberBoxIntValue(chunkGroup.select('.rowcnt'));\n        state.columnCount = box.numberBoxIntValue(chunkGroup.select('.colcnt'));\n        state.groupField = lbox.selectBoxValue(chunkGroup.select('.groupby'));\n        state.chunksPerRow = box.numberBoxIntValue(chunkGroup.select('.crow'));\n        state.showColumnNumber = box.checkBoxValue(chunkGroup.select('.showcol'));\n        state.showRowNumber = box.checkBoxValue(chunkGroup.select('.showrow'));\n        state.updateFieldNotifier();\n      });\n}\n\n\nfunction updateTileColorControlBox(selection, state) {\n  const fieldOptions = state.items.fields\n    .filter(e => misc.sortType(e.format) !== 'none');\n  selection\n    .call(cbox.updateColorControlBox, fieldOptions, state.tileColor)\n    .on('change', function() {\n      state.tileColor = cbox.colorControlBoxState(selection);\n      if (state.tileColor.scale === 'ordinal') {\n        const keys = state.items.records().map(e => e[state.tileColor.field]);\n        state.tileColor.domain = _.uniq(keys).sort();\n      }\n      state.updateItemAttrNotifier();\n    });\n}\n\n\nfunction updateTileValueControlBox(selection, state) {\n  const fieldOptions = state.items.fields\n    .filter(e => misc.sortType(e.format) !== 'none');\n  selection\n      .call(cbox.updateLabelControlBox, fieldOptions,\n            state.tileValue, state.tileValueColor)\n      .on('change', function() {\n        const values = cbox.labelControlBoxState(selection);\n        state.tileValue = values.label;\n        state.tileValueColor = values.labelColor;\n        if (state.tileValueColor.scale === 'ordinal') {\n          const keys = state.items.records()\n            .map(e => e[state.tileValueColor.field]);\n          state.tileValueColor.domain = _.uniq(keys).sort();\n        }\n        state.updateItemAttrNotifier();\n      });\n}\n\n\nfunction controlBox(selection, state) {\n  // Clean up\n  selection.select('nav').remove();\n  selection.select('.tab-content').remove();\n\n  selection.call(\n    cbox.controlBoxFrame, 'control-frame-nav', 'control-frame-content');\n  const tabs = selection.select('.nav-tabs');\n  const content = selection.select('.tab-content');\n\n  // Main\n  tabs.append('a')\n      .classed('active', true)\n      .attr('aria-selected', 'true')\n      .call(cbox.controlBoxNav, 'control-main', 'Main');\n  content.append('div')\n      .classed('show', true)\n      .classed('active', true)\n      .classed('control-main', true)\n      .call(cbox.controlBoxItem, 'control-main')\n      .call(mainControlBox, state);\n\n  // Color\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-color', 'Color');\n  content.append('div')\n      .classed('control-color', true)\n      .call(cbox.controlBoxItem, 'control-color')\n      .call(cbox.colorControlBox, cscale.colorScales);\n\n  // Text\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-value', 'Value');\n  content.append('div')\n      .classed('control-value', true)\n      .call(cbox.controlBoxItem, 'control-value')\n      .call(cbox.labelControlBox, cscale.colorScales);\n\n  selection.call(updateControlBox, state);\n}\n\n\nfunction updateControlBox(selection, state) {\n  selection.select('.control-main')\n      .call(updateMainControlBox, state);\n  selection.select('.control-color')\n      .call(updateTileColorControlBox, state);\n  selection.select('.control-value')\n      .call(updateTileValueControlBox, state);\n}\n\n\nexport default {\n  controlBox, updateControlBox\n};\n","\n/** @module tileApp */\n\nimport d3 from 'd3';\n\nimport {default as client} from './common/client.js';\nimport {default as idb} from './common/idb.js';\n\nimport {default as badge} from './component/badge.js';\nimport {default as button} from './component/button.js';\nimport {default as transform} from './component/transform.js';\n\nimport {default as renameDialog} from './dialog/rename.js';\n\nimport TileState from './tile/state.js';\nimport {default as component} from './tile/component.js';\nimport {default as interaction} from './tile/interaction.js';\nimport {default as control} from './tile/controlBox.js';\n\n\nfunction app(view, coll) {\n  const menubar = d3.select('#menubar')\n      .classed('my-1', true);\n  menubar.selectAll('div,span,a').remove();  // Clean up\n  const dialogs = d3.select('#dialogs');\n  dialogs.selectAll('div').remove();  // Clean up\n\n  const state = new TileState(view, coll);\n\n  // Tile view control\n  const menu = menubar.append('div')\n      .call(button.dropdownMenuButton, 'Menu', 'primary', 'tiles-white')\n      .select('.dropdown-menu');\n  menu.append('a').call(renameDialog.menuLink);\n  menu.append('a')\n      .call(button.dropdownMenuItem, 'Save', 'menu-save')\n      .on('click', function () {\n        return state.save()\n          .then(() => menubar.select('.notify-saved').call(badge.notify));\n      });\n\n  // Dashboard link\n  menubar.append('a')\n      .call(button.menuButtonLink, 'Dashboard',\n            'outline-secondary', 'status-gray')\n      .attr('href', 'dashboard.html')\n      .attr('target', '_blank');\n\n  // Status\n  menubar.append('span')\n      .classed('loading-circle', true)\n      .call(badge.loadingCircle);\n  menubar.append('span')\n      .classed('notify-saved', true)\n      .call(badge.alert)\n      .call(badge.updateAlert, 'State saved', 'success', 'check-green')\n      .style('display', 'none');\n  menubar.append('span')\n      .classed('name', true);\n  menubar.append('span')\n      .classed('items-count', true)\n      .call(badge.badge);\n  menubar.append('span')\n      .classed('fetch-status', true)\n      .call(badge.badge);\n  menubar.append('span')\n      .classed('exec-time', true)\n      .call(badge.badge);\n\n  // Dialogs\n  dialogs.append('div')\n      .classed('renamed', true)\n      .call(renameDialog.body);\n\n  // Contents\n  const frame = d3.select('#tl-frame')\n      .call(transform.viewFrame, state);\n  frame.select('.view')\n      .call(component.tileView, state)\n      .call(interaction.setInteraction, state);\n  d3.select('#tl-control')\n      .call(control.controlBox, state);\n\n  // Resize window\n  window.onresize = () =>\n    d3.select('#tl-frame').call(transform.resize, state);\n\n  // Update\n  updateApp(state);\n}\n\n\nfunction updateApp(state) {\n  // Title\n  d3.select('title').text(state.name);\n\n  // Status\n  d3.select('#menubar .name').text(state.name);\n\n  const onLoading = d3.select('#menubar .loading-circle');\n  const colors = {\n    done: 'green', running: 'darkorange',\n    ready: 'cornflowerblue', queued: 'cornflowerblue',\n    interrupted: 'salmon', aborted: 'salmon', failure: 'salmon'\n  };\n  const icons = {\n    done: 'check-green', running: 'running-darkorange',\n    ready: 'clock-cornflowerblue', queued: 'clock-cornflowerblue',\n    interrupted: 'caution-salmon', aborted: 'caution-salmon',\n    failure: 'caution-salmon'\n  };\n  const fstatus = state.items.status();\n  const fstext = fstatus === 'done' ?\n    fstatus : `${fstatus} ${state.items.progress()}%`;\n  d3.select('#menubar .items-count')\n      .call(badge.updateBadge, `${state.items.size()} items`,\n            'light', 'tiles-gray')\n    .select('.text')\n      .style('color', 'gray');\n  d3.select('#menubar .fetch-status')\n      .call(badge.updateBadge, fstext, 'light', icons[fstatus])\n    .select('.text')\n      .style('color', colors[fstatus]);\n  d3.select('#menubar .exec-time')\n      .call(badge.updateBadge, `${state.items.execTime()} seconds`,\n            'light', 'clock-cornflowerblue')\n    .select('.text')\n      .style('color', 'cornflowerblue');\n\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n\n  // Rename dialog\n  dialogs.select('.renamed')\n      .call(renameDialog.updateBody, state.name)\n      .on('submit', function () {\n        onLoading.style('display', 'inline-block');\n        state.name = renameDialog.value(d3.select(this));\n        updateApp(state);\n  });\n\n  onLoading.style('display', 'none');\n}\n\n\nfunction run() {\n  const err = client.compatibility();\n  if (err) {\n    d3.select('body')\n      .style('color', '#ff0000')\n      .text(err);\n    return;\n  }\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";  // TODO\n  const offLine = 'onLine' in navigator && !navigator.onLine;  // TODO\n  client.registerServiceWorker();\n  const storeID = client.URLQuery().store || null;\n  const viewID = client.URLQuery().view || null;\n  return idb.getView(storeID, viewID)\n    .then(view => {\n      if (!view) throw('ERROR: invalid URL');\n      view.storeID = storeID;\n      return idb.getCollection(storeID, view.items)\n        .then(coll => app(view, coll));\n    })\n    .catch(err => {\n      console.error(err);\n      d3.select('#tileview')\n        .style('color', 'red')\n        .text(err);\n    });\n}\n\n\nexport default {\n  run\n};\n"],"names":["URLQuery","pairs","window","location","search","substring","split","map","e","_","fromPairs","compatibility","registerServiceWorker","navigator","debug","console","info","addEventListener","serviceWorker","register","sortType","fmt","includes","formatNum","value","d3format","Number","isNaN","parseFloat","d3","format","partialMatch","query","target","toString","toUpperCase","indexOf","uuidv4","replace","c","r","Math","random","statusConv","Queued","In progress","Aborting","Aborted","Completed","Failure","dataTypeConv","datatable","connection","v07_to_v08_nodes","json","fields","columns","sort","id","name","dataType","schemaVersion","revision","status","records","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v10_nodes","reference","convertNetwork","data","edges","hasOwnProperty","nodes","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","key","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","forEach","i","index","_structure","_index","source","v08_graph","nodeContentVisible","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","params","v10_edges","$schema","convertPackage","specs","now","Date","isNW","v08_nodes","width","height","convertTable","views","dataset","push","collectionID","contents","workflowID","workflow","viewID","viewType","rows","sortOrder","filterText","checkpoints","type","date","description","networkThresholdCutoff","filter","view","minConnThld","currentConnThld","edgeColor","color","edgeLabelColor","schema","items","idb","Dexie","getAllItems","orderBy","reverse","toArray","updateItem","storeID","updateFunc","where","equals","modify","catch","err","error","version","stores","reset","delete","then","getItem","first","deleteItem","getView","appendView","viewObj","item","pos","findIndex","splice","updateView","isFunction","deleteView","bin","Object","entries","entry","getAllCollections","flatten","coll","getCollection","collID","colls","updateCollection","collObj","importItem","legacy","misc","slice","sessionStarted","put","newDatagrid","response","toLocaleString","timeZone","newNetwork","nodesName","edgesID","assetBaseURL","iconBaseURL","icon","selection","append","attr","style","badge","body","classed","updateBadge","select","notify","transition","duration","ease","easeLinear","delay","on","loadingCircle","alert","updateAlert","buttonBox","menuButton","menuButtonLink","menuModalLink","dropdownMenuButton","button","dropdownMenuItem","dropdownMenuModal","dropdownMenuFile","accept","this","node","click","dropdownMenuFileValue","files","resize","state","area","offsetWidth","offsetHeight","setViewBox","resizeNotifier","transform","tx","ty","tk","viewFrame","remove","call","viewBox","right","bottom","numberBoxIntValue","parseInt","property","numberBoxFloatValue","textBox","updateTextBox","textBoxValue","readonlyBox","textareaBox","updateTextareaBox","updateTextareaPlaceholder","placeholder","textareaBoxValue","textareaBoxLines","length","checkBox","box","updateCheckBox","checked","checkBoxValue","numberBox","min","max","step","updateNumberBox","numberIntValid","valid","numberFloatValid","colorBox","event","stopPropagation","updateColorBox","colorBoxValue","fileInputBox","clearFileInput","fileInputBoxValue","dialogBase","confirmDialog","base","footer","dispatch","updateConfirmDialog","message","submitDialog","title","header","html","$","modal","menuLink","updateBody","keyValid","baseURL","get","url","q","keys","JSON","stringify","fetch","credentials","res","Promise","reject","Error","statusText","resolve","blob","post","formdata","method","serverStatus","server","singleToMulti","mapping","newMapping","m","mappingToTable","mp","concat","rcd","f","tableToMapping","table","ignore","row","csvToMapping","csvString","lines","shift","headerIdx","h","line","values","k","Array","apply","fd","uniqBy","Collection","[object Object]","autoIndex","content","addField","fs","mapper","func","command","fetcher","all","sum","some","TransformState","fieldWidth","fieldHeight","top","left","focusArea","focusAreaMargin","boundary","x","y","prevTransform","margin","setFocusArea","vh","vw","vr","bh","bw","isPortrait","adjustH","adjustV","setTransform","TileState","super","chunkMarginRatio","focusedViewThreshold","enableFocusedView","focusedView","its","parse","rowCount","columnCount","groupField","chunksPerRow","fixRowCount","fixColumnCount","tileAspectRatio","showRowNumber","showColumnNumber","defaultTileField","fillIfNull","obj","updater","tileContent","tileColor","defaultTileColor","tileValue","halign","valign","tileValueColor","defaultTileValueColor","scaleExtent","Infinity","translateExtent","chunkWidth","chunkHeight","chunkMarginH","chunkMarginV","columnWidth","rowHeight","zoomListener","updateFieldNotifier","updateItemNotifier","updateItemAttrNotifier","cRow","floor","chunk","cCol","col","tileCount","totalChunks","groupBy","group","j","tileIdx","ceil","setCoords","setIndices","export","vi","colorScales","colors","schemePaired","schemeSet2","schemePastel2","schemeSet3","types","scaleLinear","scaleLog","scaleQuantize","scaleOrdinal","scaleFunction","cscale","mid","scaleFunc","clamp","d","result","undefined","isD3Format","notation","updateItems","itemsToRender","selectAll","exit","entered","enter","merged","merge","updateItemAttrs","colorConv","valueColorConv","d3_format","tileView","setFieldSize","zoom","t","setInteraction","zoomIdentity","translate","monocolorBar","colorBar","monocolor","bicolor","grad","tricolor","categorical","sw","custom","setSize","checklistBoxValue","setSelectedColorScale","selected","datum","shape","selectBox","selectBoxItems","options","updateSelectBox","selectBoxValue","checklistBox","checklistBoxItems","listitems","form","updateChecklistBox","each","anyChecked","colorScaleBox","dropdown","colorScaleBoxItems","bubbles","updateColorScaleBox","colorScaleBoxValue","colorScaleBoxItem","rangeBoxValid","v","rangeBox","updateRangeBox","rangeBoxValues","colorRangeBox","updateColorRangeBox","colorRangeBoxValues","scaleBoxGroupValid","rbox","lbox","validScale","colorRangeGroup","collapse","updateColorRangeGroup","customRange","cs","rg","customScale","rtype","rboxValues","colorRangeGroupValue","colorScale","colorScaleType","scaleBoxGroup","updateScaleBoxGroup","scaleBoxGroupValue","colorControlBox","fieldName","updateColorControlBox","fieldOptions","colorState","colorControlValid","noScale","scaleValid","colorControlBoxState","sizeRangeValid","unk","validUnk","sizeControlValid","labelControlValid","sizeControlBox","updateSizeControlBox","sizeState","sizeControlBoxState","labelControlBox","labelGroup","updateLabelControlBox","labelState","labelControlBoxState","labelColor","controlBoxFrame","navID","contentID","controlBoxNav","controlBoxItem","mainControlBox","chunkGroup","updateMainControlBox","updateTileColorControlBox","cbox","uniq","updateTileValueControlBox","updateControlBox","controlBox","tabs","app","menubar","dialogs","menu","renameDialog","save","component","interaction","control","onresize","updateApp","onLoading","fstatus","fstext","done","running","ready","queued","interrupted","aborted","failure","run","client","document","protocol","onLine","store"],"mappings":"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"}