{"version":3,"file":"networkApp.js","sources":["../../src/common/client.js","../../src/common/misc.js","../../src/common/legacySchema.js","../../src/common/idb.js","../../src/component/button.js","../../src/component/modal.js","../../src/component/transform.js","../../src/component/formBox.js","../../src/dialog/community.js","../../src/dialog/rename.js","../../src/common/fetcher.js","../../src/common/mapper.js","../../src/common/collection.js","../../src/common/transform.js","../../src/network/state.js","../../src/network/communityDetection.js","../../src/common/scale.js","../../src/component/shape.js","../../src/component/formListBox.js","../../src/component/formRangeBox.js","../../src/component/formBoxGroup.js","../../src/component/controlBox.js","../../src/network/controlBox.js","../../src/network/component.js","../../src/network/interaction.js","../../src/network/force.js","../../src/networkApp.js"],"sourcesContent":["\n/** @module common/client */\n\nimport _ from 'lodash';\n\n\nfunction URLQuery() {\n  const pairs = window.location.search.substring(1).split(\"&\")\n    .map(e => e.split('='));\n  return _.fromPairs(pairs);\n}\n\n\nfunction compatibility() {\n  try {\n    () => {};\n  } catch (err) {\n    return 'Client compatibility error: Arrow function not supported';\n  }\n  try {\n    FormData;\n  } catch (err) {\n    return 'Client compatibility error: FormData not supported';\n  }\n  try {\n    fetch;\n  } catch (err) {\n    return 'Client compatibility error: fetch API not supported';\n  }\n}\n\n\nfunction registerServiceWorker() {\n  if ('serviceWorker' in navigator) {\n    window.addEventListener('load', () => {\n      navigator.serviceWorker.register('../sw.js');  // TODO: root path option\n    });\n  } else {\n    console.info('Service worker is not supported');\n  }\n}\n\nexport default {\n  URLQuery, compatibility, registerServiceWorker\n};\n","\n/** @module common/misc */\n\nimport d3 from 'd3';\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  sortType, formatNum, partialMatch, uuidv4\n};\n","\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: [\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ],\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  data.fields.forEach(e => {\n    if (e.key === 'structure') {\n      e.format = 'svg';\n    }\n    delete e.width;\n    delete e.height;\n  });\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nfunction convertPackage(json) {\n  if (json.hasOwnProperty('views')) return json;\n  const now = new Date();\n  const isNW = json.hasOwnProperty('edges');\n  const data = isNW ? convertNetwork(json) : convertTable(json);\n  const nodes = isNW ? data.nodes : data;\n  const specs = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    name: data.edges.name,\n    views: [],\n    dataset: []\n  };\n  specs.dataset.push({\n    $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n    collectionID: nodes.id,\n    name: nodes.name,\n    contents: [{\n      $schema: nodes.$schema,\n      workflowID: nodes.reference.workflow,\n      name: nodes.name,\n      fields: nodes.fields,\n      records: nodes.records,\n      created: nodes.created,\n      status: nodes.status,\n      query: nodes.query,\n      execTime: nodes.execTime,\n      progress: nodes.progress\n    }]\n  });\n  specs.views.push({\n    $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n    viewID: nodes.id,\n    name: nodes.name,\n    viewType: \"datagrid\",\n    rows: nodes.id,\n    fields: nodes.fields,\n    sortOrder: null,\n    filterText: null,\n    checkpoints: [{\n      type: 'convert',\n      date: now.toString(),\n      description: 'converted from legacy format'\n    }]\n  });\n  if (isNW) {\n    specs.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: data.edges.id,\n      name: data.edges.name,\n      contents: [{\n        $schema: data.edges.$schema,\n        workflowID: data.edges.reference.workflow,\n        name: data.edges.name,\n        fields: data.edges.fields,\n        records: data.edges.records,\n        created: data.edges.created,\n        status: data.edges.status,\n        query: data.edges.query,\n        execTime: data.edges.execTime,\n        progress: data.edges.progress\n      }]\n    });\n    specs.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n      viewID: data.edges.id,\n      name: data.edges.name,\n      viewType: \"network\",\n      nodes: nodes.id,\n      edges: data.edges.id,\n      nodeColor: data.edges.snapshot.nodeColor,\n      nodeSize: data.edges.snapshot.nodeSize,\n      nodeLabel: data.edges.snapshot.nodeLabel,\n      nodeLabelColor: data.edges.snapshot.nodeLabelColor,\n      edgeWidth: data.edges.snapshot.edgeWidth,\n      edgeLabel: data.edges.snapshot.edgeLabel,\n      networkThreshold: data.edges.snapshot.networkThreshold,\n      networkThresholdCutoff: data.edges.snapshot.networkThresholdCutoff,\n      fieldTransform: data.edges.snapshot.fieldTransform,\n      coords: data.edges.snapshot.coords,\n      checkpoints: [{\n        type: 'convert',\n        date: now.toString(),\n        description: 'converted from legacy format'\n      }]\n    });\n  }\n  specs.views.filter(e => e.viewType === 'network')\n    .forEach(view => {\n      view.minConnThld = view.networkThresholdCutoff;\n      view.currentConnThld = view.networkThreshold;\n      if (view.hasOwnProperty('nodeLabel')) {\n        view.nodeLabel.field = view.nodeLabel.text;\n      }\n      if (view.hasOwnProperty('edgeLabel')) {\n        view.edgeLabel.field = 'weight';\n      }\n      if (view.hasOwnProperty('edgeWidth')) {\n        view.edgeWidth.field = 'weight';\n      }\n    });\n  return specs;\n}\n\n\nexport default {\n  convertPackage\n};\n","\n/** @module common/idb */\n\nimport _ from 'lodash';\nimport Dexie from 'Dexie';\n\nimport {default as misc} from './misc.js';\nimport {default as legacy} from './legacySchema.js';\n\n// TODO: need package, view and dataset tables?\nconst schema = {\n  items: 'storeID, sessionStarted'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\n/**\n * Delete all data store\n * Try this before dealing with local db issues\n */\nfunction reset() {\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\n\n/**\n * Returns all data store items\n * @return {array} data store objects\n */\nfunction getAllItems() {\n  return idb.items\n    .orderBy('sessionStarted')\n    .reverse()\n    .toArray();\n}\n\n\n/**\n * Get data store items by store ID\n * @param {string} storeID - store ID\n * @return {array} data store object\n */\nfunction getItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .first()\n    .catch(err => {\n      console.error(`IDBError: Unexpected table ID: ${storeID}`, err);\n    });\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - storeID if sucessfully added\n */\nfunction importItem(data) {\n  // Legacy format converter\n  if (!data.hasOwnProperty('views')) {\n    data = legacy.convertPackage(data);\n  }\n  const now = new Date();\n  data.storeID = misc.uuidv4().slice(0, 8);\n  data.sessionStarted = now.toString();\n  return idb.items.put(data);\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} response - response data\n * @return {string} - viewID if sucessfully added\n */\nfunction newDatagrid(response) {\n  const now = new Date();\n  const date = now.toLocaleString('en-GB', { timeZone: 'Asia/Tokyo'});\n  const storeID = misc.uuidv4().slice(0, 8);\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  const data = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    storeID: storeID,\n    name: viewID,  // TODO: generate from response.query\n    views: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n        viewID: viewID,\n        name: viewID,  // TODO: generate from response.query\n        viewType: \"datagrid\",\n        rows: collectionID,\n        checkpoints: [\n          {type: 'creation', date: date}\n        ]\n      }\n    ],\n    dataset: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: collectionID,\n        contents: [response]\n      }\n    ],\n    sessionStarted: date\n  };\n  return idb.items.put(data)\n    .then(() => ({storeID: storeID, viewID:viewID}));\n}\n\n\n/**\n * Update data object in the store\n * @param {string} storeID - store ID\n * @param {function} updateFunc - update function\n * @return {integer} - number of updated items\n */\nfunction updateItem(storeID, updateFunc) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .modify(updateFunc)\n    .catch(err => {\n      console.error('IDBError: Update failed', err);\n    });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .delete();\n}\n\n\n/**\n * Returns a view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @return {array} view objects\n */\nfunction getView(storeID, viewID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).views)\n    .then(views => {\n      const view = views.find(e => e.viewID === viewID);\n      if (!view) return;\n      view.storeID = storeID;\n      return view;\n    });\n}\n\n\n/**\n * Append a view next to a specific view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object\n */\nfunction appendView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos + 1, 0, viewObj);\n  });\n}\n\n\n/**\n * Update view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object or update function\n */\nfunction updateView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    if (_.isFunction(viewObj)) {\n      viewObj(item.views[pos]);\n    } else {\n      item.views[pos] = viewObj;\n    }\n  });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteView(storeID, viewID) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos, 1);\n    // prune orphaned collections\n    const bin = {};\n    item.dataset.forEach(e => { bin[e.collectionID] = 0; });\n    item.views.forEach(view => {\n      ['rows', 'items', 'nodes', 'edges']\n        .filter(e => view.hasOwnProperty(e))\n        .forEach(e => { bin[view[e]] += 1; });\n    });\n    Object.entries(bin).forEach(entry => {\n      if (!entry[1]) {\n        const i = item.dataset.findIndex(e => e.collectionID === entry[0]);\n        item.dataset.splice(i, 1);\n      }\n    });\n  });\n}\n\n\n/**\n * Returns a collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @return {array} Collection objects\n */\nfunction getCollection(storeID, collID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).dataset)\n    .then(colls => {\n      const coll = colls.find(e => e.collectionID === collID);\n      if (!coll) return;\n      coll.storeID = storeID;\n      return coll;\n    });\n}\n\n\n/**\n * Append a view next to a specific view\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @param {object} collObj - Collection object\n */\nfunction appendCollection(storeID, collID, collObj) {\n  return updateItem(storeID, item => {\n    const pos = item.dataset.findIndex(e => e.collectionID === collID);\n    item.dataset.splice(pos + 1, 0, collObj);\n  });\n}\n\n\n/**\n * Update collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @param {object} collObj - Collection object or update function\n */\nfunction updateCollection(storeID, collID, collObj) {\n  return updateItem(storeID, item => {\n    const pos = item.dataset.findIndex(e => e.collectionID === collID);\n    if (_.isFunction(collObj)) {\n      collObj(item.dataset[pos]);\n    } else {\n      item.dataset[pos] = collObj;\n    }\n  });\n}\n\n\nexport default {\n  reset, getAllItems, getItem, importItem, newDatagrid, updateItem, deleteItem,\n  getView, appendView, updateView, deleteView,\n  getCollection, appendCollection, updateCollection\n};\n","\n/** @module component/button */\n\nimport d3 from 'd3';\n\nconst iconBaseURL = '../assets/icon/';\n\n\nfunction buttonBox(selection, label, type) {\n  selection\n      .classed('form-group', true)\n      .classed('mb-1', true)\n    .append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .text(label);\n}\n\n\nfunction menuButton(selection, label, type) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .text(label);\n}\n\n\nfunction menuButtonLink(selection, label, type, icon) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('role', 'button')\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction menuModalLink(selection, target, label, type, icon) {\n  selection\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed(`btn-sm`, true)\n      .classed('mr-1', true)\n      .attr('href', '#')\n      .attr('role', 'button')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('label', true)\n      .style('vertical-align', 'middle')\n      .text(label);\n}\n\n\nfunction dropdownMenuButton(selection, label, type, icon) {\n  selection\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  const button = selection.append('button')\n      .classed('btn', true)\n      .classed(`btn-${type}`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  button.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  button.append('span')\n      .style('vertical-align', 'middle')\n      .text(label);\n  selection.append('div')\n      .classed('dropdown-menu', true);\n}\n\n\nfunction dropdownMenuItem(selection, label, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#');\n  selection.append('img')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\nfunction dropdownMenuModal(selection, label, target, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', `#${target}`);\n  selection.append('img')\n      .attr('src', `${iconBaseURL}${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFile(selection, label, accept, icon) {\n  selection.classed('dropdown-item', true)\n      .attr('href', '#')\n      .on('click', function () {\n        d3.select(this).select('input').node().click();\n      });\n  selection.append('form')\n      .style('display', 'none')\n    .append('input')\n      .attr('type', 'file')\n      .attr('accept', accept);\n  selection.append('img')\n      .attr('src', `${iconBaseURL}${icon}.svg`)\n      .classed('mr-1', true)\n      .style('width', '2rem')\n      .style('height', '2rem');\n  selection.append('span')\n      .text(label);\n}\n\n\nfunction dropdownMenuFileValue(selection) {\n  return selection.select('input').node().files[0];\n}\n\n\nexport default {\n  iconBaseURL, buttonBox, menuButton, menuButtonLink, menuModalLink,\n  dropdownMenuButton, dropdownMenuItem, dropdownMenuModal,\n  dropdownMenuFile, dropdownMenuFileValue\n};\n","\n/** @module component/modal */\n\nimport d3 from 'd3';\n\n\nfunction dialogBase(selection, id) {\n  selection\n      .classed('modal', true)\n      .attr('tabindex', -1)\n      .attr('role', 'dialog')\n      .attr('aria-labelledby', '')\n      .attr('aria-hidden', true)\n      .attr('id', id);\n  selection.append('div')\n      .classed('modal-dialog', true)\n      .attr('role', 'document')\n    .append('div')\n      .classed('modal-content', true);\n}\n\n\nfunction confirmDialog(selection, id) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // body\n  base.append('div')\n      .classed('modal-body', true)\n    .append('div')\n      .classed('message', true);\n  // footer\n  const footer = base.append('div')\n      .classed('modal-footer', true);\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-outline-secondary', true)\n      .classed('cancel', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .text('Cancel');\n  footer.append('button')\n      .classed('btn', true)\n      .classed('btn-warning', true)\n      .classed('ok', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('data-target', `${id}-submit`)\n      .text('OK')\n      .on('click', () => {\n        d3.select('#loading-icon').style('display', 'inline');\n        selection.dispatch('submit');\n      });\n}\n\n\nfunction updateConfirmDialog(selection, message) {\n  selection.select('.message').text(message);\n}\n\n\nfunction submitDialog(selection, id, title) {\n  const base = selection.call(dialogBase, id)\n      .select('.modal-content');\n  // header\n  const header = base.append('div')\n      .classed('modal-header', true);\n  header.append('h4')\n      .classed('modal-title', true)\n      .text(title);\n  header.append('button')\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('aria-label', 'Close')\n      .classed('close', true)\n    .append('span')\n      .attr('aria-hidden', true)\n      .html('&times;');\n  // body\n  base.append('div')\n      .classed('modal-body', true);\n  // footer\n  base.append('div')\n      .classed('modal-footer', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-primary', true)\n      .classed('submit', true)\n      .attr('type', 'button')\n      .attr('data-dismiss', 'modal')\n      .attr('data-target', `${id}-submit`)\n      .text('Submit')\n      .on('click', () => {\n        d3.select('#loading-icon').style('display', 'inline');\n        selection.dispatch('submit');\n      });\n}\n\n\nexport default {\n  confirmDialog, updateConfirmDialog, submitDialog\n};\n","\n/** @module component/transform */\n\n\nfunction transform(selection, tx, ty, tk) {\n  selection.select('.field')\n    .attr('transform', `translate(${tx}, ${ty}) scale(${tk})`);\n}\n\n\nfunction resize(selection, state) {\n  const area = selection.node();\n  const width = area.offsetWidth;\n  const height = area.offsetHeight;\n  selection.select('.view')\n      .attr('viewBox', `0 0 ${width} ${height}`)\n    .select('.boundary')\n      .attr('width', width)\n      .attr('height', height);\n  state.setViewBox(width, height);\n  state.resizeNotifier();\n}\n\n\nfunction viewFrame(selection, state) {\n  selection\n    .style('width', '100%')\n    .style('height', '100%');\n  selection.select('.view').remove(); // Clean up\n  selection.append('svg')\n    .classed('view', true);\n  selection.call(resize, state);\n}\n\n\nfunction view(selection, state) {\n  selection\n    .attr('preserveAspectRatio', 'xMinYMin meet')\n    .attr('pointer-events', 'all')\n    .attr('viewBox', `0 0 ${state.viewBox.right} ${state.viewBox.bottom}`)\n    .style('width', '100%')\n    .style('height', '100%');\n\n  // Clean up\n  selection.select('.boundary').remove();\n  selection.select('.field').remove();\n\n  // Boundary\n  selection.append('rect')\n      .classed('boundary', true)\n      .attr('x', 0)\n      .attr('y', 0)\n      .attr('width', state.viewBox.right)\n      .attr('height', state.viewBox.bottom)\n      .attr('fill', '#ffffff')\n      .attr('stroke-width', 1)\n      .attr('stroke', '#cccccc');\n  // Field\n  selection.append('g')\n      .classed('field', true)\n      .style('opacity', 1e-6)\n    .transition()\n      .duration(1000)\n      .style('opacity', 1);\n}\n\n\nexport default {\n  transform, resize, viewFrame, view\n};\n","\n/** @module component/formBox */\n\n\nimport d3 from 'd3';\n\n\nfunction textBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text');\n}\n\nfunction updateTextBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction textBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction readonlyBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .property('readonly', true);\n}\n\n\nfunction textareaBox(selection, label, rows) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows);\n}\n\nfunction updateTextareaBox(selection, value) {\n  selection.select('textarea').property('value', value);\n}\n\nfunction updateTextareaPlaceholder(selection, placeholder) {\n  selection.select('textarea').attr('placeholder', placeholder);\n}\n\nfunction textareaBoxValue(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value;  // TODO: 0 is falsy\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder;\n  return '';\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n').filter(e => e.length > 0);\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder.split('\\n').filter(e => e.length > 0);\n  return [];\n}\n\n\nfunction checkBox(selection, label) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox');\n  box.append('span')\n      .text(label);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, label, min, max, step) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'number')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step);\n}\n\nfunction updateNumberBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction numberFloatValid(selection) {\n  const value = numberBoxFloatValue(selection);\n  const min = parseInt(selection.select('input').attr('min'));\n  const max = parseInt(selection.select('input').attr('max'));\n  const valid = !isNaN(value) && value >= min && value <= max;\n  selection.select('input')\n      .style('background-color', valid ? '#ffffff' : '#ffcccc');\n  return valid;\n}\n\nfunction numberBoxIntValue(selection) {\n  return parseInt(selection.select('input').property('value'));\n}\n\nfunction numberBoxFloatValue(selection) {\n  return parseFloat(selection.select('input').property('value'));\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n    .append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'color');\n}\n\n\nfunction updateColorBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\n\nfunction colorBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction fileInputBox(selection, label, accept) {\nselection\n    .classed('form-group', true)\n    .classed('form-row', true);\nselection.append('label')\n    .classed('col-form-label', true)\n    .classed('col-form-label-sm', true)\n    .classed('col-4', true)\n    .text(label);\nselection.append('input')\n    .classed('form-control', true)\n    .classed('form-control-sm', true)\n    .classed('form-control-file', true)\n    .classed('col-8', true)\n    .attr('type', 'file')\n    .attr('accept', accept);\n}\n\nfunction clearFileInput(selection) {\n  // TODO: FileList object (input.files) may be a readonly property\n  const accept = selection.select('input').attr();\n  selection.select('input').remove();\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('form-control-file', true)\n      .classed('col-8', true)\n      .attr('type', 'file')\n      .attr('accept', accept);\n}\n\nfunction fileInputBoxValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\n\nexport default {\n  textBox, updateTextBox, textBoxValue, readonlyBox,\n  textareaBox, updateTextareaBox, updateTextareaPlaceholder,\n  textareaBoxValue, textareaBoxLines,\n  checkBox, updateCheckBox, checkBoxValue,\n  numberBox, updateNumberBox, numberFloatValid,\n  numberBoxIntValue, numberBoxFloatValue,\n  colorBox, updateColorBox, colorBoxValue,\n  fileInputBox, clearFileInput, fileInputBoxValue\n};\n","\n/** @module dialog/community */\n\nimport d3 from 'd3';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'community-dialog';\nconst title = 'Comunity detection';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-painting');\n}\n\n\nfunction body(selection) {\n  const dialog = selection.call(modal.submitDialog, id, title);\n  // Name\n  dialog.select('.modal-body').append('div')\n      .classed('name', true)\n      .call(box.textBox, 'New name');\n  // Assign null to isolated nodes\n  dialog.select('.modal-body').append('div')\n      .classed('nulliso', true)\n      .call(box.checkBox, 'Assign null to isolated nodes');\n}\n\n\nfunction updateBody(selection) {\n  selection.select('.name')\n      .call(box.updateTextBox, null)\n      .on('input', function () {  // Validation\n        const keyValid = box.textBoxValue(d3.select(this)) !== '';\n        selection.select('.submit').property('disabled', !keyValid);\n      })\n      .dispatch('input');\n  selection.select('.nulliso')\n      .call(box.updateCheckBox, true);\n}\n\n\nfunction value(selection) {\n  return {\n    name: box.textBoxValue(selection.select('.name')),\n    nulliso: box.checkBoxValue(selection.select('.nulliso'))\n  };\n}\n\n\nexport default {\n  menuLink, body, updateBody, value\n};\n","\n/** @module dialog/rename */\n\nimport d3 from 'd3';\n\nimport {default as button} from '../component/button.js';\nimport {default as box} from '../component/formBox.js';\nimport {default as modal} from '../component/modal.js';\n\n\nconst id = 'rename-dialog';\nconst title = 'Rename';\n\n\nfunction menuLink(selection) {\n  selection.call(button.dropdownMenuModal, title, id, 'menu-edittext');\n}\n\n\nfunction body(selection) {\n  selection.call(modal.submitDialog, id, title)\n    .select('.modal-body').append('div')\n      .classed('rename', true)\n      .call(box.textBox, 'New name');\n}\n\n\nfunction updateBody(selection, name) {\n  selection.select('.rename')\n      .call(box.updateTextBox, name)\n      .on('input', function () {  // Validation\n        const keyValid = box.textBoxValue(d3.select(this)) !== '';\n        selection.select('.submit').property('disabled', !keyValid);\n      })\n      .dispatch('input');\n}\n\n\nfunction value(selection) {\n  return box.textBoxValue(selection.select('.rename'));\n}\n\n\nexport default {\n  menuLink, body, updateBody, value\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '../req/';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\nfunction serverStatus() {\n  const response = {};\n  return get('server')\n    .then(json)\n    .then(res => {\n      response.server = res;\n    })\n    .then(() => get('schema'))\n    .then(json)\n    .then(res => {\n      response.schema = res;\n    })\n    .then(() => response);\n}\n\n\nexport default {\n  get, json, text, blob, post, error, serverStatus\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: [keyField].concat(mp.fields),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: table.fields.filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key)),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: fields,\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(mp.fields)\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module common/collection */\n\nimport _ from 'lodash';\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as mapper} from './mapper.js';\n\n\nexport default class Collection {\n  /**\n   * Create Collection from a flashflood response datatable\n   * If data is not specified, put datatables later by this.append(data)\n   * @param {object} coll - Collection or response object\n   */\n  constructor(coll) {\n    // Settings\n    this.autoIndex = 'index';  // enumerate records\n\n    this.collectionID = coll.collectionID || null;\n    this.storeID = coll.storeID || null;\n    this.name = coll.name || null;\n    this.contents = coll.contents || [coll];\n    this.fields = [];\n    this.contents.forEach(content => {\n      content.fields.forEach(e => this.addField(e));\n    });\n  }\n\n  /**\n   * Add fields\n   * @param {array} fs - list of fields\n   */\n  addField(field) {\n    if (this.fields.find(e => e.key === field.key)) return;\n    if (!field.hasOwnProperty('name')) field.name = field.key;\n    if (!field.hasOwnProperty('visible')) field.visible = true;\n    if (field.hasOwnProperty('d3_format')) field.format = 'd3_format';\n    if (!field.hasOwnProperty('format')) field.format = 'raw';\n    this.fields.push(field);\n  }\n\n  /**\n   * Update fields properties\n   * @param {array} fs - list of fields\n   */\n  updateFields(fs) {\n    this.fields = [];\n    fs.forEach(e => this.addField(e));\n  }\n\n  /**\n   * Join fields\n   * @param {object} mapping - column mapper object\n   */\n  joinFields(mapping) {\n    this.contents.forEach(c => {\n      mapper.apply(c, mapping);\n    });\n    if (mapping.hasOwnProperty('fields')) {\n      mapping.fields.forEach(e => this.addField(e));\n    } else {\n      this.addField(mapping.field);\n    }\n  }\n\n  /**\n   * Return all records of the collection\n   * @return {array} records\n   */\n  records() {\n    return _.flatten(this.contents.map(e => e.records));\n  }\n\n  fetch(command) {\n    const fs = this.contents\n      .filter(e => ['running', 'ready', 'interrupted', 'queued'].includes(e.status))\n      .map(content => {\n        const query = {id: content.workflowID, command: command};\n        return fetcher.get('progress', query)\n          .then(fetcher.json)\n          .then(data => {\n            return idb.updateCollection(this.storeID, this.collectionID, coll => {\n              const i = coll.contents\n                .findIndex(e => e.workflowID === query.id);\n              if (data.status === 'failure') {  // No data found on server\n                coll.contents[i].status = 'failure';\n              } else {\n                coll.contents[i] = data;\n              }\n            });\n          });\n      });\n    return Promise.all(fs)\n      .then(() => idb.getCollection(this.storeID, this.collectionID))\n      .then(coll => {\n        this.contents = coll.contents;\n      });\n  }\n\n  /**\n   * Retrieve workflows and store it into a local store.\n   * @return {Promise}\n   */\n  pull() {\n    return this.fetch('pull');\n  }\n\n  /**\n   * Retrieve workflows, abort all ongoing workflow task\n   * and store it into a local store.\n   * @return {Promise}\n   */\n  abort() {\n    return this.fetch('abort');\n  }\n\n  /**\n   * Return total number of records\n   * @return {float} total number of records\n   */\n  size() {\n    return _.sum(this.contents.map(e => e.records.length));\n  }\n\n  /**\n   * Return status\n   * @return {string} status\n   */\n  status() {\n    if (this.contents.some(e => e.status === 'interrupted')) return 'interrupted';\n    if (this.contents.some(e => e.status === 'running')) return 'running';\n    if (this.contents.some(e => e.status === 'queued')) return 'queued';\n    if (this.contents.some(e => e.status === 'ready')) return 'ready';\n    if (this.contents.some(e => e.status === 'aborted')) return 'aborted';\n    if (this.contents.some(e => e.status === 'failure')) return 'failure';\n    return 'done';\n  }\n\n  /**\n   * Return ongoing or not\n   * @return {bool} ongoing or not\n   */\n  ongoing() {\n    const s = ['ready', 'queued', 'running', 'interrupted'];\n    return s.includes(this.status());\n  }\n\n  /**\n   * Return percentage of workflow progress\n   * @return {float} progress in percent\n   */\n  progress() {\n    return _.min(this.contents.map(e => e.progress));\n  }\n\n  /**\n   * Return total execution time\n   * @return {float} total time\n   */\n  execTime() {\n    return _.sum(this.contents.map(e => e.execTime));\n  }\n\n  /**\n   * Export collection object as JSON\n   * @return {object} collection JSON\n   */\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: this.collectionID,\n      name: this.name,\n      fields: this.fields,\n      contents: this.contents\n    };\n  }\n}\n","\n/** @module common/transform */\n\nimport d3 from 'd3';\n\n\nexport default class TransformState {\n  constructor(width, height, transform) {\n    this.fieldWidth = width;\n    this.fieldHeight = height;\n\n    this.viewBox = {\n      top: 0,\n      right: this.fieldWidth,\n      bottom: this.fieldHeight,\n      left: 0\n    };\n\n    this.focusArea = {};\n    this.focusAreaMargin = 50;\n\n    this.boundary = {\n      top: 0,\n      right: this.fieldWidth,\n      bottom: this.fieldHeight,\n      left: 0\n    };\n\n    this.transform = transform || {x: 0, y: 0, k: 1};\n    this.prevTransform = {\n      x: this.transform.x,\n      y: this.transform.y,\n      k: this.transform.k\n    };\n\n    this.resizeNotifier = () => {};\n  }\n\n  setFocusArea() {\n    const tx = this.transform.x;\n    const ty = this.transform.y;\n    const tk = this.transform.k;\n    const margin = this.focusAreaMargin;\n    this.focusArea.top = (this.viewBox.top - ty) / tk - margin;\n    this.focusArea.left = (this.viewBox.left - tx) / tk - margin;\n    this.focusArea.bottom = (this.viewBox.bottom - ty) / tk + margin;\n    this.focusArea.right = (this.viewBox.right - tx) / tk + margin;\n    // this.showFocusArea();  // debug\n  }\n\n  setViewBox(width, height) {\n    this.viewBox.right = width;\n    this.viewBox.bottom = height;\n    // this.showViewBox();  // debug\n    this.setFocusArea();\n  }\n\n  setTransform(tx, ty, tk) {\n    this.transform.x = tx;\n    this.transform.y = ty;\n    this.transform.k = tk;\n    // this.showTransform(); // debug\n    this.setFocusArea();\n  }\n\n  fitTransform() {\n    const vh = this.viewBox.bottom;\n    const vw = this.viewBox.right;\n    const vr = vw / vh;\n    const bh = this.boundary.bottom - this.boundary.top;\n    const bw = this.boundary.right - this.boundary.left;\n    const br = bw / bh;\n    const isPortrait = vr >= br;\n    const tk = isPortrait ? vh / bh : vw / bw;\n    const adjustH = isPortrait ? (vw - bw) / 2 : 0;\n    const adjustV = isPortrait ? 0 : (vh - bh) / 2;\n    const tx = -(this.boundary.left + adjustH) * tk;\n    const ty = -(this.boundary.top + adjustV) * tk;\n    this.setTransform(tx, ty, tk);\n  }\n\n  showTransform() {\n    d3.select('#debug-transform')\n      .text(JSON.stringify(this.transform));\n  }\n\n  showFocusArea() {\n    d3.select('#debug-focusarea')\n      .text(JSON.stringify(this.focusArea));\n  }\n\n  showViewBox() {\n    d3.select('#debug-viewbox')\n      .text(JSON.stringify(this.viewBox));\n  }\n}\n","\n/** @module network/state */\n\nimport Collection from '../common/collection.js';\nimport TransformState from  '../common/transform.js';\nimport {default as idb} from '../common/idb.js';\n\n\nexport default class NetworkState extends TransformState {\n  constructor(view, nodes, edges) {\n    super(1200, 1200, view.fieldTransform);\n\n    /* Settings */\n\n    // Focused view mode (num of nodes displayed are less than the thld)\n    // Show node contents\n    // Disable smooth transition\n    this.focusedViewThreshold = 100;\n    this.enableFocusedView = true;\n    this.focusedView = false;\n    // Overlook view mode (num of nodes displayed are less than the thld)\n    // Hide edges\n    this.overlookViewThreshold = 500;\n    this.enableOverlookView = true;\n    this.overlookView = false;\n\n    /* Attributes */\n\n    this.viewID = view.viewID || null;\n    this.storeID = view.storeID || null;\n    this.name = view.name;\n\n    this.nodes = new Collection(nodes);\n    this.edges = new Collection(edges);\n\n    /* Appearance */\n    const defaultNodeField = this.nodes.fields[0].key || null;\n    const fillIfNull = (obj, updater) => {\n      Object.entries(updater).forEach(e => {\n        if (!obj.hasOwnProperty(e[0])) {\n          obj[e[0]] = e[1];\n        }\n      });\n    };\n\n    this.nodeColor = {};\n    const defaultNodeColor = {\n      field: defaultNodeField, color: 'nodeDefault',\n      scale: 'linear', domain: [0, 1],\n      range: ['#7fffd4', '#7fffd4'], unknown: '#7fffd4'\n    };\n    if (view.hasOwnProperty('nodeColor')) {\n      this.nodeColor = view.nodeColor;\n    }\n    fillIfNull(this.nodeColor, defaultNodeColor);\n\n    this.nodeSize = {};\n    const defaultNodeSize = {\n      field: defaultNodeField, scale: 'linear', domain: [1, 1],\n      range: [40, 40], unknown: 40\n    };\n    if (view.hasOwnProperty('nodeSize')) {\n      this.nodeSize = view.nodeSize;\n    }\n    fillIfNull(this.nodeSize, defaultNodeSize);\n\n    this.nodeLabel = {};\n    const defaultNodeLabel = {\n      field: defaultNodeField, size: 20, visible: false\n    };\n    if (view.hasOwnProperty('nodeLabel')) {\n      this.nodeLabel = view.nodeLabel;\n    }\n    fillIfNull(this.nodeLabel, defaultNodeLabel);\n\n    this.nodeLabelColor = {};\n    const defaultNodeLabelColor = {\n      field: defaultNodeField, color: 'monoblack',\n      scale: 'linear', domain: [1, 1],\n      range: ['#333333', '#333333'], unknown: '#cccccc'\n    };\n    if (view.hasOwnProperty('nodeLabelColor')) {\n      this.nodeLabelColor = view.nodeLabelColor;\n    }\n    fillIfNull(this.nodeLabelColor, defaultNodeLabelColor);\n\n    this.edgeColor = {};\n    const defaultEdgeColor = {\n      field: 'weight', color: 'monogray',\n      scale: 'linear', domain: [0, 1],\n      range: ['#999999', '#999999'], unknown: '#cccccc'\n    };\n    if (view.hasOwnProperty('edgeColor')) {\n      this.edgeColor = view.edgeColor;\n    }\n    fillIfNull(this.edgeColor, defaultEdgeColor);\n\n    this.edgeWidth = {};\n    const defaultEdgeWidth = {\n      field: 'weight', scale: 'linear', domain: [0.5, 1],\n      range: [10, 10], unknown: 1\n    };\n    if (view.hasOwnProperty('edgeWidth')) {\n      this.edgeWidth = view.edgeWidth;\n    }\n    fillIfNull(this.edgeWidth, defaultEdgeWidth);\n\n    this.edgeLabel = {};\n    const defaultEdgeLabel = {\n      field: 'weight', size: 12, visible: false\n    };\n    if (view.hasOwnProperty('edgeLabel')) {\n      this.edgeLabel = view.edgeLabel;\n    }\n    fillIfNull(this.edgeLabel, defaultEdgeLabel);\n\n    this.edgeLabelColor = {};\n    const defaultEdgeLabelColor = {\n      field: 'weight', color: 'monoblack',\n      scale: 'linear', domain: [1, 1],\n      range: ['#333333', '#333333'], unknown: '#cccccc'\n    };\n    if (view.hasOwnProperty('edgeLabelColor')) {\n      this.edgeLabelColor = view.edgeLabelColor;\n    }\n    fillIfNull(this.edgeLabelColor, defaultEdgeLabelColor);\n\n    // Connection threshold\n    this.connThldField = view.connThldField || 'weight';\n    this.minConnThld = view.minConnThld;\n    this.currentConnThld = view.currentConnThld || view.minConnThld;\n\n    // Force\n    this.simulationOnLoad = true;\n    this.forcePreset = view.forcePreset || 'aggregate';\n\n    // Event listeners\n    this.zoomListener = null;\n    this.dragListener = null;\n\n    // Event notifiers\n    this.updateAllNotifier = null;\n    this.updateComponentNotifier = null;\n    this.updateNodeNotifier = null;\n    this.updateEdgeNotifier = null;\n    this.updateNodeAttrNotifier = null;\n    this.updateEdgeAttrNotifier = null;\n    this.updateControlBoxNotifier = () => {};\n    this.fitNotifier = () => {};\n    this.setForceNotifier = () => {};\n    this.stickNotifier = () => {};\n    this.relaxNotifier = () => {};\n    this.restartNotifier = () => {};\n    this.tickCallback = () => {};\n\n    // Working copies\n    // D3.force does some destructive operations\n    this.ns = null;\n    this.es = null;\n    this.coords = view.coords;\n\n    // Init\n    this.updateWorkingCopy();\n  }\n\n  updateWorkingCopy() {\n    this.ns = JSON.parse(JSON.stringify(this.nodes.records()));\n    this.ns.forEach(n => { n.adjacency = []; });\n    this.es = JSON.parse(JSON.stringify(this.edges.records()));\n    this.es.forEach((e, i) => {\n      e.num = i;  // e.index will be overwritten by d3-force\n      this.ns[e.source].adjacency.push([e.target, i]);\n      this.ns[e.target].adjacency.push([e.source, i]);\n    });\n    if (this.coords) {\n      this.setAllCoords(this.coords);\n    }\n  }\n\n  setBoundary() {\n    const xs = this.ns.map(e => e.x);\n    const ys = this.ns.map(e => e.y);\n    this.boundary.top = Math.min.apply(null, ys);\n    this.boundary.left = Math.min.apply(null, xs);\n    this.boundary.bottom = Math.max.apply(null, ys);\n    this.boundary.right = Math.max.apply(null, xs);\n    // this.showBoundary(); // debug\n  }\n\n  setAllCoords(coordsList) {\n    this.ns.forEach(n => {\n      n.x = coordsList[n.index].x;\n      n.y = coordsList[n.index].y;\n      // this.es can be changed by forceSimulation so use adjacency\n      n.adjacency.forEach(e => {\n        const nbr = e[0];\n        const edge = e[1];\n        if (n.index < nbr) {\n          this.es[edge].sx = coordsList[n.index].x;\n          this.es[edge].sy = coordsList[n.index].y;\n        } else {\n          this.es[edge].tx = coordsList[n.index].x;\n          this.es[edge].ty = coordsList[n.index].y;\n        }\n      });\n    });\n    this.simulationOnLoad = false;\n    this.setBoundary();\n  }\n\n  setCoords(n, x, y) {\n    this.ns[n].x = x;\n    this.ns[n].y = y;\n    this.ns[n].adjacency.forEach(e => {\n      const nbr = e[0];\n      const edge = e[1];\n      if (n < nbr) {\n        this.es[edge].sx = x;\n        this.es[edge].sy = y;\n      } else {\n        this.es[edge].tx = x;\n        this.es[edge].ty = y;\n      }\n    });\n    this.setBoundary();\n  }\n\n  nodesToRender() {\n    return this.ns.filter(\n      e => e.y > this.focusArea.top && e.x > this.focusArea.left\n        && e.y < this.focusArea.bottom && e.x < this.focusArea.right\n    );\n  }\n\n  currentEdges() {\n    return this.es.filter(e => e[this.connThldField] >= this.currentConnThld);\n  }\n\n  edgesToRender() {\n    return this.currentEdges().filter(\n      e => this.focusArea.top < Math.max(e.sy, e.ty)\n        && this.focusArea.left < Math.max(e.sx, e.tx)\n        && this.focusArea.bottom > Math.min(e.sy, e.ty)\n        && this.focusArea.right > Math.min(e.sx, e.tx)\n    );\n  }\n\n  save() {\n    return idb.updateItem(this.storeID, item => {\n      const ni = item.dataset\n        .findIndex(e => e.collectionID === this.nodes.collectionID);\n      item.dataset[ni] = this.nodes.export();\n      const ei = item.dataset\n        .findIndex(e => e.collectionID === this.edges.collectionID);\n      item.dataset[ei] = this.edges.export();\n      const vi = item.views\n        .findIndex(e => e.viewID === this.viewID);\n      item.views[vi] = this.export();\n    });\n  }\n\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n      viewID: this.viewID,\n      name: this.name,\n      viewType: \"network\",\n      nodes: this.nodes.collectionID,\n      edges: this.edges.collectionID,\n      nodeColor: this.nodeColor,\n      nodeSize: this.nodeSize,\n      nodeLabel: this.nodeLabel,\n      nodeLabelColor: this.nodeLabelColor,\n      edgeColor: this.edgeColor,\n      edgeWidth: this.edgeWidth,\n      edgeLabel: this.edgeLabel,\n      edgeLabelColor: this.edgeLabelColor,\n      connThldField: this.connThldField,\n      currentConnThld: this.currentConnThld,\n      minConnThld: this.minConnThld,\n      fieldTransform: this.transform,\n      coords: this.ns.map(e => ({x: e.x, y: e.y}))\n    };\n  }\n}\n","\n/** @module network/communityDetection */\n\nimport jLouvain from 'jLouvain';\n\n\nexport function communityDetection(nodes, edges, option) {\n  const nodeField = option.nodeField || 'index';\n  const weightField = option.weightField || 'weight';\n  if (!edges.length) {\n    const community = {};\n    nodes.forEach(e => { community[e] = option.nulliso ? null : e; });\n    return community;\n  }\n  const ns = nodes.map(e => e[nodeField]);\n  const es = edges.map(e => ({\n    source: e.source[nodeField], target: e.target[nodeField],\n    weight: e[weightField]\n  }));\n  const clusters = {};\n  const community = jLouvain().nodes(ns).edges(es)();\n  Object.entries(community).forEach(e => {\n    if (!clusters.hasOwnProperty(e[1])) {\n      clusters[e[1]] = [];\n    }\n    clusters[e[1]].push(e[0]);\n  });\n  // Sort by cluster size\n  Object.entries(clusters)\n    .sort((a, b) => a[1].length < b[1].length)\n    .forEach((cluster, i) => {\n      if (cluster[1].length === 1) {\n        community[cluster[1][0]] = option.nulliso ? null : i;\n      } else {\n        cluster[1].forEach(e => {\n          community[e] = i;\n        });\n      }\n    });\n  return community;\n}\n\n\nexport default {\n  communityDetection\n};\n","\n/** @module common/scale */\n\nimport d3 from 'd3';\n\n\nconst colorScales = [\n  {key: 'monoblack', type: 'monocolor', colors: ['#333333'], unknown: '#333333'},\n  {key: 'monogray', type: 'monocolor', colors: ['#cccccc'], unknown: '#cccccc'},\n  {key: 'nodeDefault', type: 'monocolor', colors: ['#7fffd4'], unknown: '#7fffd4'},\n  {key: 'aquamarine', type: 'bicolor',\n   colors: ['#778899', '#7fffd4'], unknown: '#f0f0f0'},\n  {key: 'chartreuse', type: 'bicolor',\n   colors: ['#778899', '#7fff00'], unknown: '#f0f0f0'},\n  {key: 'salmon', type: 'bicolor',\n   colors: ['#778899', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'violet', type: 'bicolor',\n   colors: ['#778899', '#ee82ee'], unknown: '#f0f0f0'},\n  {key: 'temperature', type: 'tricolor',\n   colors: ['#87ceeb', '#fff5ee', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'spectrum', type: 'tricolor',\n   colors: ['#6495ed', '#ccff66', '#ffa500'], unknown: '#f0f0f0'},\n  {key: 'category10', type: 'categorical',\n   colors: ['#8dd3c7','#ffffb3','#bebada','#fb8072','#80b1d3','#fdb462',\n    '#b3de69','#fccde5','#bc80bd','#ccebc5'], unknown: '#f0f0f0'},\n  {key: 'cbsafe', type: 'categorical',\n   colors: ['#543005','#8c510a','#bf812d','#dfc27d','#f6e8c3','#c7eae5',\n   '#80cdc1','#35978f','#01665e','#003c30'], unknown: '#f0f0f0'},\n  {key: 'category20', type: 'categorical',\n   colors: d3.schemePaired.concat(d3.schemeSet2), unknown: '#f0f0f0'},\n  {key: 'category40', type: 'categorical',\n   colors: d3.schemePaired.concat(d3.schemePastel2, d3.schemeSet2, d3.schemeSet3),\n   unknown: '#f0f0f0'},\n  {key: 'custom', type: 'custom', colors: ['#ffffff'], text: 'custom'}\n];\n\n\nconst types = [\n  {key: 'linear', name: 'Linear', func: d3.scaleLinear},\n  {key: 'log', name: 'Log', func: d3.scaleLog},\n  {key: 'quantize', name: 'Quantize', func: d3.scaleQuantize},\n  {key: 'ordinal', name: 'Ordinal', func: d3.scaleOrdinal}\n];\n\n\nfunction scaleFunction(state) {\n  const cscale = colorScales.find(e => e.key === state.color);\n  let range;\n  let unknown;\n  if (cscale && cscale.key !== 'custom') {\n      range = cscale.colors;\n      unknown = cscale.unknown;\n  } else {\n    range = state.range;\n    unknown = state.unknown;\n  }\n  let domain = null;\n  if (range.length === 3) {\n    const mid = (parseFloat(state.domain[0]) + parseFloat(state.domain[1])) / 2;\n    domain = [state.domain[0], mid, state.domain[1]];\n  } else {\n    domain = state.domain;\n  }\n  // Build\n  let scaleFunc = types.find(e => e.key === state.scale).func();\n  scaleFunc = scaleFunc.domain(domain);\n  scaleFunc = scaleFunc.range(range);\n  if (['linear', 'log'].includes(state.scale)) {\n    scaleFunc = scaleFunc.clamp(true);\n  }\n\n  return d => {\n    // Sanitize\n    if (d === '' || typeof d === 'undefined' || d === null) {\n      return unknown;  // invalid values\n    }\n    if (['linear', 'log'].includes(state.scale) && parseFloat(d) != d) {\n      return unknown;  // texts\n    }\n    if (state.scale === 'log' && d <= 0) {\n      return unknown;  // negative values in log scale\n    }\n    // Apply function\n    const result = scaleFunc(d);\n    if (result === undefined) {\n      return unknown;  // TODO: specify unexpected behavior\n    }\n    return result;\n  };\n}\n\n\nexport default {\n  colorScales, types, scaleFunction\n};\n","\n/** @module component/shape */\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction monocolorBar(selection, colors, text) {\n  selection.attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none');\n  const group = selection.append('g');\n  group.append('rect')\n      .attr('x', 0).attr('y', 0)\n      .attr('width', 100).attr('height', 10)\n      .attr('fill', colors[0]);\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 10)\n      .attr('font-size', 12)\n      .text(text);\n}\n\nfunction bicolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n      .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n      .attr('offset', 1).attr('stop-color', colors[1]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction tricolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n    .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n    .attr('offset', 0.5).attr('stop-color', colors[1]);\n  grad.append('stop')\n    .attr('offset', 1).attr('stop-color', colors[2]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction categoricalBar(selection, colors, text) {\n  selection.attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none');\n  const sw = 100 / colors.length;\n  const group = selection.append('g');\n  colors.forEach((e, i) => {\n    group.append('rect')\n        .attr('x', sw * i).attr('y', 0)\n        .attr('width', sw).attr('height', 20)\n        .attr('fill', colors[i]);\n  });\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 20)\n      .attr('font-size', 20)\n      .text(text);\n}\n\nfunction setSize(selection, width, height) {\n  selection.attr('width', width).attr('height', height);\n}\n\n\nconst colorBar = {\n  'monocolor': monocolorBar,\n  'bicolor': bicolorBar,\n  'tricolor': tricolorBar,\n  'categorical': categoricalBar,\n  'custom': monocolorBar\n};\n\n\nexport default {\n  colorBar, setSize\n};\n","\n/** @module component/formListBox */\n\nimport d3 from 'd3';\n\nimport {default as shape} from './shape.js';\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction selectBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('select')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n}\n\nfunction selectBoxItems(selection, items) {\n  const options = selection.select('select')\n    .selectAll('option')\n      .data(items, d => d.key);\n  options.exit().remove();\n  options.enter()\n    .append('option')\n      .attr('value', d => d.key)\n      .text(d => d.name);\n}\n\nfunction updateSelectBox(selection, value) {\n  selection.select('select').property('value', value);\n}\n\nfunction selectBoxValue(selection) {\n  return selection.select('select').property('value');\n}\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction checklistBox(selection, label) {\n  // TODO: scroll\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('ul')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n}\n\nfunction checklistBoxItems(selection, items) {\n  const listitems = selection.select('ul')\n    .selectAll('li')\n      .data(items, d => d.key);\n  listitems.exit().remove();\n  const form = listitems.enter()\n    .append('li')\n      .attr('class', 'form-check')\n    .append('label')\n      .attr('class', 'form-check-label');\n  form.append('input')\n      .attr('type', 'checkbox')\n      .attr('class', 'form-check-input')\n      .property('value', d => d.key);\n  form.append('span')\n      .text(d => d.name);\n}\n\nfunction updateChecklistBox(selection, values) {\n  if (!values) return;\n  selection.selectAll('input')\n    .each(function (d) {\n      d3.select(this).property('checked', values.includes(d.key));\n    });\n}\n\nfunction checklistBoxValue(selection) {\n  return selection.selectAll('input:checked').data().map(d => d.key);\n}\n\nfunction anyChecked(selection) {\n  return checklistBoxValue(selection).length > 0;\n}\n\n\nfunction colorScaleBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label || 'Colorscale');\n  const form = selection.append('div')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n  const dropdown = form.append('div')\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  dropdown.append('button')\n      .classed('btn', true)\n      .classed(`btn-light`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  dropdown.append('div')\n      .classed('dropdown-menu', true)\n      .classed('py-0', true);\n  form.append('span')\n      .classed('selected', true);\n}\n\nfunction colorScaleBoxItems(selection, items) {\n  const listitems = selection.select('.dropdown-menu')\n    .selectAll('a')\n      .data(items, d => d);\n  listitems.exit().remove();\n  listitems.enter()\n    .append('a')\n      .classed('dropdown-item', true)\n      .classed('py-0', true)\n      .attr('href', '#')\n      .attr('title', d => d.key)\n      .on('click', function (d) {\n        selection.call(setSelectedColorScale, d);\n        selection.dispatch('change', {bubbles: true});\n      })\n    .append('svg')\n      .each(function (d) {\n        d3.select(this)\n          .call(shape.colorBar[d.type], d.colors, d.text)\n          .call(shape.setSize, 100, 10);\n      });\n}\n\nfunction setSelectedColorScale(selection, item) {\n  const selected = selection.select('.selected');\n  selected.selectAll('svg').remove();\n  selected.datum(item);  // Bind selected item record\n  selected.append('svg')\n      .call(shape.colorBar[item.type], item.colors, item.text)\n      .call(shape.setSize, 100, 10);\n}\n\nfunction updateColorScaleBox(selection, key) {\n  const data = selection.select('.dropdown-menu')\n    .selectAll('a').data();\n  const item = data.find(e => e.key === key);\n  selection.call(setSelectedColorScale, item);\n}\n\nfunction colorScaleBoxValue(selection) {\n  return selection.select('.selected').datum().key;\n}\n\nfunction colorScaleBoxItem(selection) {\n  return selection.select('.selected').datum();\n}\n\n\nexport default {\n  selectBox, selectBoxItems, updateSelectBox, selectBoxValue,\n  checklistBox, checklistBoxItems, updateChecklistBox, checklistBoxValue,\n  anyChecked,\n  colorScaleBox, colorScaleBoxItems, updateColorScaleBox,\n  colorScaleBoxValue, colorScaleBoxItem\n};\n","\n/** @module component/formRangeBox */\n\nimport d3 from 'd3';\n\n\n/**\n * Render range box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction rangeBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  const f = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true);\n  f.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('min');\n  f.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('min', true)\n      .attr('type', 'text');\n  const t = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-4', true)\n      .classed('mb-1', true);\n  t.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('max');\n  t.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('max', true)\n      .attr('type', 'text');\n}\n\n\nfunction updateRangeBox(selection, range) {\n  selection.select('.min').property('value', range[0]);\n  selection.select('.max').property('value', range[1]);\n  selection.selectAll('.min,.max')\n    .on('input', function () {\n      if (!rangeBoxValid(selection)) {\n        d3.event.stopPropagation();\n      }\n    })\n    .dispatch('input', {bubbles: true});\n}\n\n\nfunction rangeBoxValid(selection) {\n  const min = selection.select('.min').property('value');\n  const max = selection.select('.max').property('value');\n  const valid = v => v !== '' && !isNaN(v);\n  selection.select('.min')\n      .style('background-color', valid(min) ? '#ffffff' : '#ffcccc');\n  selection.select('.max')\n      .style('background-color', valid(max) ? '#ffffff' : '#ffcccc');\n  return valid(min) && valid(max);\n}\n\n\nfunction rangeBoxValues(selection) {\n  return [\n    parseFloat(selection.select('.min').property('value')),\n    parseFloat(selection.select('.max').property('value'))\n  ];\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true)\n      .text(label);\n  const f = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  f.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('min');\n  f.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('min', true)\n      .attr('type', 'color');\n  const m = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  m.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('mid');\n  m.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('mid', true)\n      .attr('type', 'color');\n  const t = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  t.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('max');\n  t.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('max', true)\n      .attr('type', 'color');\n  selection\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n}\n\n\nfunction updateColorRangeBox(selection, range) {\n  selection.select('.min').property('value', range[0]);\n  selection.select('.mid').property('value', range[1]);\n  selection.select('.max').property('value', range[2]);\n}\n\n\nfunction colorRangeBoxValues(selection) {\n  return [\n    selection.select('.min').property('value'),\n    selection.select('.mid').property('value'),\n    selection.select('.max').property('value')\n  ];\n}\n\n\nexport default {\n  rangeBox, updateRangeBox, rangeBoxValues, rangeBoxValid,\n  colorRangeBox, updateColorRangeBox, colorRangeBoxValues\n};\n","\n/** @module component/formBoxGroup */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\n\nimport {default as box} from './formBox.js';\nimport {default as lbox} from './formListBox.js';\nimport {default as rbox} from './formRangeBox.js';\n\n\n/**\n * Render color range control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeGroup(selection, colorScales) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('colorscale', true)\n      .classed('mb-2', true)\n      .call(lbox.colorScaleBox, 'Colorscale')\n      .call(lbox.colorScaleBoxItems, colorScales);\n\n  // Custom colorscale\n  const id = misc.uuidv4().slice(0, 8);\n  selection.append('div')\n      .classed('form-row', true)\n      .classed('justify-content-end', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-sm', true)\n      .classed('btn-outline-primary', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'collapse')\n      .attr('data-target', `#${id}-collapse`)\n      .attr('aria-expanded', 'false')\n      .attr('aria-controls', `${id}-collapse`)\n      .text('Custom colorscale');\n  const collapse = selection.append('div')\n      .classed('collapse', true)\n      .attr('id', `${id}-collapse`)\n    .append('div')\n      .classed('card', true)\n      .classed('card-body', true)\n      .classed('p-2', true);\n  const customColorRanges = [\n    {key: 'continuous', name: 'Continuous'},\n    {key: 'two-piece', name: 'Two-piece'}\n  ];\n  collapse.append('div')\n      .classed('rangetype', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Range type')\n      .call(lbox.selectBoxItems, customColorRanges);\n  collapse.append('div')\n      .classed('range', true)\n      .classed('mb-1', true)\n      .call(rbox.colorRangeBox, 'Range');\n  collapse.append('div')\n      .classed('unknown', true)\n      .classed('mb-1', true)\n      .call(box.colorBox, 'Unknown');\n}\n\n\nfunction updateColorRangeGroup(selection, cscale, range, unknown) {\n  const customRange = () => {\n    const cs = lbox.colorScaleBoxValue(selection.select('.colorscale'));\n    const rg = lbox.selectBoxValue(selection.select('.rangetype'));\n    const customScale = cs === 'custom';\n    selection.selectAll('.rangetype, .range, .unknown')\n        .selectAll('select, input')\n        .property('disabled', !customScale)\n        .style('opacity',  customScale ? null : 0.3);\n    selection.select('.range').select('.mid')\n        .property('disabled', !customScale || rg === 'continuous')\n        .style('opacity', customScale && rg !== 'continuous' ? null : 0.3);\n  };\n  selection.select('.colorscale')\n      .call(lbox.updateColorScaleBox, cscale)\n      .on('change', function () {\n        customRange();\n      });\n  const rtype = range.length === 2 ? 'continuous' : 'two-piece';\n  selection.select('.rangetype')\n      .call(lbox.updateSelectBox, rtype)\n      .on('change', function () {\n        customRange();\n      })\n      .dispatch('change');\n  const rboxValues = range.length === 2  ? [range[0], null, range[1]] : range;\n  selection.select('.range')\n      .call(rbox.updateColorRangeBox, rboxValues)\n      .on('focusin', () => {\n        selection.dispatch('change', {bubbles: true});\n      });\n  selection.select('.unknown')\n      .call(box.updateColorBox, unknown)\n      .on('focusin', () => {\n        selection.dispatch('change', {bubbles: true});\n      });\n}\n\n\nfunction colorRangeGroupValue(selection) {\n  const colorScale = lbox.colorScaleBoxItem(selection.select('.colorscale'));\n  const rtype = lbox.selectBoxValue(selection.select('.rangetype'));\n  const range = rbox.colorRangeBoxValues(selection.select('.range'));\n  const unknown = box.colorBoxValue(selection.select('.unknown'));\n  return {\n    color: colorScale.key,\n    colorScaleType: colorScale.type,\n    range: rtype === 'continuous' ? [range[0], range[2]] : range,\n    unknown: unknown\n  };\n}\n\n\n/**\n * Render scale and domain control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction scaleBoxGroup(selection) {\n  const scaleOptions = [\n    {key: 'linear', name: 'Linear'},\n    {key: 'log', name: 'Log'}\n  ];\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('scale', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Scale')\n      .call(lbox.selectBoxItems, scaleOptions);\n  selection.append('div')\n      .classed('domain', true)\n      .classed('mb-1', true)\n      .call(rbox.rangeBox, 'Domain');\n}\n\n\nfunction updateScaleBoxGroup(selection, scale, domain) {\n  selection.select('.scale')\n      .call(lbox.updateSelectBox, scale);\n  selection.select('.domain')\n      .call(rbox.updateRangeBox, domain)\n      .on('input', function () {\n        scaleBoxGroupValid(selection);\n      });\n  selection.selectAll('.scale, .domain')\n      .on('change', function () {\n        if (!scaleBoxGroupValid(selection)) {\n          d3.event.stopPropagation();\n        }\n      });\n}\n\n\nfunction scaleBoxGroupValid(selection) {\n  if (!rbox.rangeBoxValid(selection.select('.domain'))) return false;\n  if (lbox.selectBoxValue(selection.select('.scale')) === 'linear') return true;\n  const values = rbox.rangeBoxValues(selection.select('.domain'));\n  selection.select('.domain').select('.min')\n      .style('background-color', values[0] > 0 ? '#ffffff' : '#ffcccc');\n  selection.select('.domain').select('.max')\n      .style('background-color', values[1] > 0 ? '#ffffff' : '#ffcccc');\n  const validScale = lbox.selectBoxValue(selection.select('.scale')) !== '';\n    selection.select('.scale').select('select')\n        .style('background-color', validScale ? '#ffffff' : '#ffcccc');\n  return values[0] > 0 && values[1] > 0 && validScale;\n}\n\n\nfunction scaleBoxGroupValue(selection) {\n  const scale = lbox.selectBoxValue(selection.select('.scale'));\n  const domain = rbox.rangeBoxValues(selection.select('.domain'));\n  return {\n    scale: scale || 'linear', \n    domain: domain\n  };\n}\n\n\nexport default {\n  colorRangeGroup, updateColorRangeGroup, colorRangeGroupValue,\n  scaleBoxGroup, updateScaleBoxGroup, scaleBoxGroupValue, scaleBoxGroupValid\n};\n","\n/** @module component/controlBox */\n\nimport d3 from 'd3';\n\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as rbox} from '../component/formRangeBox.js';\nimport {default as group} from '../component/formBoxGroup.js';\n\n\nfunction colorControlBox(selection, colorScales, fieldName) {\n  selection.append('div')\n      .classed('field', true)\n      .call(lbox.selectBox, fieldName || 'Field');\n  selection.append('div')\n      .classed('range', true)\n      .call(group.colorRangeGroup, colorScales);\n  selection.append('div')\n      .classed('scale', true)\n      .call(group.scaleBoxGroup);\n}\n\n\nfunction updateColorControlBox(selection, fieldOptions, colorState) {\n  selection.select('.field')\n      .call(lbox.selectBoxItems, fieldOptions)\n      .call(lbox.updateSelectBox, colorState.field);\n  selection.select('.range')\n      .call(group.updateColorRangeGroup, colorState.color,\n            colorState.range, colorState.unknown);\n  selection.select('.scale')\n      .call(group.updateScaleBoxGroup, colorState.scale, colorState.domain);\n  selection.selectAll('.field, .range, .scale')\n      .on('change', function () {\n        if (!colorControlValid(selection)) {\n          d3.event.stopPropagation();\n        }\n      })\n      .dispatch('change');\n}\n\n\nfunction colorControlValid(selection) {\n  const values = group.colorRangeGroupValue(selection.select('.range'));\n  const noScale = ['categorical', 'monocolor'].includes(values.colorScaleType);\n  selection.select('.scale').selectAll('select,input')\n    .property('disabled', noScale)\n    .style('opacity', noScale ? 0.3 : null);\n  const scaleValid = group.scaleBoxGroupValid(selection.select('.scale'));\n  return noScale || scaleValid;\n}\n\n\nfunction colorControlBoxState(selection) {\n  const range = group.colorRangeGroupValue(selection.select('.range'));\n  const scale = group.scaleBoxGroupValue(selection.select('.scale'));\n  return {\n    field: lbox.selectBoxValue(selection.select('.field')),\n    color: range.color,\n    range: range.range,\n    unknown: range.unknown,\n    scale: range.colorScaleType === 'categorical' ? 'ordinal': scale.scale,\n    domain: scale.domain\n  };\n}\n\n\nfunction sizeControlBox(selection, fieldName) {\n  selection.append('div')\n      .classed('field', true)\n      .call(lbox.selectBox, fieldName || 'Field');\n  selection.append('div')\n      .classed('range', true)\n      .call(rbox.rangeBox, 'Range');\n  selection.append('div')\n      .classed('unknown', true)\n      .classed('mb-3', true)\n      .call(box.textBox, 'Unknown', 0, 1000, 1)\n    .select('input')\n      .classed('col-8', false)\n      .classed('col-3', true);\n  selection.append('div')\n      .classed('scale', true)\n      .call(group.scaleBoxGroup);\n}\n\n\nfunction updateSizeControlBox(selection, fieldOptions, sizeState) {\n  selection.select('.field')\n      .call(lbox.selectBoxItems, fieldOptions)\n      .call(lbox.updateSelectBox, sizeState.field);\n  selection.select('.range')\n      .call(rbox.updateRangeBox, sizeState.range);\n  selection.select('.unknown')\n      .call(box.updateTextBox, sizeState.unknown);\n  selection.select('.scale')\n      .call(group.updateScaleBoxGroup, sizeState.scale, sizeState.domain);\n  selection.selectAll('.range, .unknown')\n      .on('input', function () {\n        sizeRangeValid(selection);\n      });\n  selection.selectAll('.field, .range, .unknown, .scale')\n      .on('change', function () {\n        if (!sizeControlValid(selection)) {\n          d3.event.stopPropagation();\n        }\n      });\n}\n\nfunction sizeRangeValid(selection) {\n  if (!rbox.rangeBoxValid(selection.select('.range'))) return false;\n  const range = rbox.rangeBoxValues(selection.select('.range'));\n  const unk = box.textBoxValue(selection.select('.unknown'));\n  const validUnk = unk !== '' && !isNaN(unk) && unk > 0;\n  selection.select('.range').select('.min')\n      .style('background-color', range[0] > 0 ? '#ffffff' : '#ffcccc');\n  selection.select('.range').select('.max')\n      .style('background-color', range[1] > 0 ? '#ffffff' : '#ffcccc');\n  selection.select('.unknown').select('input')\n      .style('background-color', validUnk ? '#ffffff' : '#ffcccc');\n  return range[0] > 0 && range[1] > 0 && validUnk;\n}\n\n\nfunction sizeControlValid(selection) {\n  if (!group.scaleBoxGroupValid(selection.select('.scale'))) return false;\n  return sizeRangeValid(selection);\n}\n\n\nfunction sizeControlBoxState(selection) {\n  const scale = group.scaleBoxGroupValue(selection.select('.scale'));\n  return {\n    field: lbox.selectBoxValue(selection.select('.field')),\n    range: rbox.rangeBoxValues(selection.select('.range')),\n    unknown: box.textBoxValue(selection.select('.unknown')),\n    scale: scale.scale,\n    domain: scale.domain\n  };\n}\n\n\nfunction labelControlBox(selection, colorScales) {\n  // nodeLabel.visible\n  selection.append('div')\n    .append('div')\n      .classed('visible', true)\n      .call(box.checkBox, 'Show labels');\n  // nodeLabel\n  const labelGroup = selection.append('div')\n      .classed('mb-3', true);\n  labelGroup.append('div')\n      .classed('text', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Text field');\n  labelGroup.append('div')\n      .classed('size', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Font size', 4, 100, 1);\n  // nodeLabelColor\n  selection.call(colorControlBox, colorScales, 'Color field');\n}\n\n\nfunction updateLabelControlBox(selection, fieldOptions,\n                               labelState, colorState) {\n  // nodeLabel.visible\n  selection.select('.visible')\n      .call(box.updateCheckBox, labelState.visible);\n  // nodeLabel.field\n  selection.select('.text')\n      .call(lbox.selectBoxItems, fieldOptions)\n      .call(lbox.updateSelectBox, labelState.field);\n  // nodeLabel.size\n  selection.select('.size')\n      .call(box.updateNumberBox, labelState.size)\n      .on('input', function () {\n        box.numberFloatValid(d3.select(this));\n      });\n  // nodeLabelColor\n  selection.call(updateColorControlBox, fieldOptions, colorState)\n      .selectAll('.visible, .text, .size, .field, .range, .scale')\n      .on('change', function () {\n        if (!labelControlValid(selection)) {\n          d3.event.stopPropagation();\n        }\n      })\n      .dispatch('change');\n}\n\n\nfunction labelControlValid(selection) {\n  if (!box.numberFloatValid(selection.select('.size'))) return false;\n  return colorControlValid(selection);\n}\n\n\nfunction labelControlBoxState(selection) {\n  return {\n    label: {\n      field: lbox.selectBoxValue(selection.select('.text')),\n      size: box.numberBoxFloatValue(selection.select('.size')),\n      visible: box.checkBoxValue(selection.select('.visible'))\n    },\n    labelColor: colorControlBoxState(selection)\n  };\n}\n\n\nfunction controlBoxFrame(selection, navID, contentID) {\n  selection.append('nav')\n    .append('div')\n      .classed('nav', true)\n      .classed('nav-tabs', true)\n      .attr('id', navID)\n      .attr('role', 'tablist');\n  selection.append('div')\n      .classed('tab-content', true)\n      .classed('p-2', true)\n      .attr('id', contentID);\n}\n\n\nfunction controlBoxNav(selection, id, label) {\n  selection\n      .classed('nav-item', true)\n      .classed('nav-link', true)\n      .classed('py-1', true)\n      .attr('id', `${id}-tab`)\n      .attr('data-toggle', 'tab')\n      .attr('href', `#${id}`)\n      .attr('role', 'tab')\n      .attr('aria-controls', id)\n      .attr('aria-selected', 'false')\n      .text(label);\n}\n\n\nfunction controlBoxItem(selection, id) {\n  selection\n      .classed('tab-pane', true)\n      .classed('fade', true)\n      .classed('container', true)\n      .classed('px-0', true)\n      .attr('id', id)\n      .attr('role', 'tabpanel')\n      .attr('aria-labelledby', `${id}-tab`);\n}\n\n\nexport default {\n  colorControlBox, updateColorControlBox, colorControlValid, colorControlBoxState,\n  sizeControlBox, updateSizeControlBox, sizeControlValid, sizeControlBoxState,\n  labelControlBox, updateLabelControlBox, labelControlValid, labelControlBoxState,\n  controlBoxFrame, controlBoxNav, controlBoxItem\n};\n","\n/** @module network/controlBox */\n\nimport _ from 'lodash';\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as cscale} from '../common/scale.js';\n\nimport {default as box} from '../component/formBox.js';\nimport {default as cbox} from '../component/controlBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as button} from '../component/button.js';\n\n\nfunction mainControlBox(selection, state) {\n  // Zoom\n  selection.append('div')\n      .classed('mb-3', true)\n    .append('div')\n      .classed('fit', true)\n      .call(button.buttonBox, 'Fit to screen', 'primary');\n  // View modes\n  const viewModes = selection.append('div')\n      .classed('mb-3', true);\n    viewModes.append('div')\n      .classed('focused', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Enable focused view');\n    viewModes.append('div')\n      .classed('overlook', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Enable overlook view');\n  // Network threshold\n  const thldGroup = selection.append('div')\n      .classed('thld-group', true)\n      .classed('mb-3', true);\n  thldGroup.append('div')\n      .classed('field', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Connection');\n  thldGroup.append('div')\n      .classed('thld', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Threshold', state.minConnThld, 1.000, 0.01);\n  thldGroup.append('div')\n      .classed('logd', true)\n      .classed('mb-1', true)\n      .call(box.readonlyBox, 'logD');\n  // Force layout\n  const forceBox = selection.append('div')\n      .classed('form-group', true)\n      .classed('form-row', true);\n  forceBox.append('div')\n      .classed('col-6', true)\n    .append('span')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('mb-1', true)\n      .text('Temperature');\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('temperature', true)\n      .classed('progress', true)\n    .append('div')\n      .classed('progress-bar', true)\n      .classed('w-30', true)\n      .attr('id', 'temperature')\n      .attr('role', 'progressbar')\n      .attr('aria-valuemin', 0)\n      .attr('aria-valuemax', 100);\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('stick', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Stick nodes');\n  forceBox.append('div')\n      .classed('col-12', true)\n    .append('div')\n      .classed('restart', true)\n      .classed('mb-1', true)\n      .call(button.buttonBox, 'Activate', 'warning');\n}\n\n\nfunction updateMainControlBox(selection, state) {\n  // Zoom\n  selection.select('.fit')\n      .on('click', function () { state.fitNotifier(); });\n  // Focused view\n  selection.select('.focused')\n      .call(box.updateCheckBox, state.enableFocusedView)\n      .on('change', function () {\n        state.enableFocusedView = box.checkBoxValue(d3.select(this));\n        state.focusedView = box.checkBoxValue(d3.select(this));\n        state.updateComponentNotifier();\n      });\n  // Overlook view\n  selection.select('.overlook')\n      .call(box.updateCheckBox, state.enableOverlookView)\n      .on('change', function () {\n        state.enableOverlookView = box.checkBoxValue(d3.select(this));\n        state.overlookView = box.checkBoxValue(d3.select(this));\n        state.updateComponentNotifier();\n      });\n  // Network threshold\n  const thldGroup = selection.select('.thld-group');\n  const thldFields = state.edges.fields\n    .filter(e => misc.sortType(e.format) !== 'none')\n    .filter(e => !['source', 'target'].includes(e.key));\n  thldGroup.select('.field')\n      .call(lbox.selectBoxItems, thldFields)\n      .call(lbox.updateSelectBox, state.connThldField);\n  thldGroup.select('.thld')\n      .call(box.updateNumberBox, state.currentConnThld);\n  thldGroup.selectAll('.field, .thld')\n      .on('change', function () {\n        const field = lbox.selectBoxValue(thldGroup.select('.field'));\n        const thld = box.numberBoxFloatValue(thldGroup.select('.thld'));\n        state.connThldField = field;\n        state.currentConnThld = thld;\n        thldGroup.select('.logd').dispatch('update');\n        state.updateComponentNotifier();\n        state.setForceNotifier();\n      });\n  thldGroup.select('.logd')\n      .on('update', function () {\n        // Calculate edge density\n        const field = state.connThldField;\n        const thld = state.currentConnThld;\n        const numEdges = state.es.filter(e => e[field] >= thld).length;\n        const n = state.ns.length;\n        const combinations = n * (n - 1) / 2;\n        const logD = d3.format('.2f')(Math.log10(numEdges / combinations));\n        d3.select(this).call(box.updateTextBox, logD);\n      })\n      .dispatch('update');\n\n  // Force layout\n  state.tickCallback = (simulation) => {\n    const alpha = simulation.alpha();\n    const isStopped = alpha <= simulation.alphaMin();\n    const progress = parseInt(isStopped ? 0 : alpha * 100);\n    selection.select('.temperature')\n      .select('.progress-bar')\n        .classed('bg-success', isStopped)\n        .classed('bg-warning', !isStopped)\n        .style('width', `${progress}%`)\n        .attr('aria-valuenow', progress);\n  };\n  selection.select('.stick')\n      .call(box.updateCheckBox, !state.simulationOnLoad)\n      .on('change', function () {\n        const value = box.checkBoxValue(d3.select(this));\n        selection.select('.temperature')\n            .style('background-color', value ? '#a3e4d7' : '#e9ecef')\n          .select('.progress-bar')\n            .style('width', `0%`)\n            .attr('aria-valuenow', 0);\n        value ? state.stickNotifier() : state.relaxNotifier();\n      });\n  selection.select('.restart')\n      .on('click', function () {\n        selection.select('.stick')\n            .call(box.updateCheckBox, false)\n            .dispatch('change');\n        state.restartNotifier();\n      });\n}\n\n\nfunction updateNodeColorControlBox(selection, state) {\n  const fieldOptions = state.nodes.fields\n    .filter(e => misc.sortType(e.format) !== 'none');\n  selection\n    .call(cbox.updateColorControlBox, fieldOptions, state.nodeColor)\n    .on('change', function() {\n      state.nodeColor = cbox.colorControlBoxState(selection);\n      if (state.nodeColor.scale === 'ordinal') {\n        const keys = state.nodes.records().map(e => e[state.nodeColor.field]);\n        state.nodeColor.domain = _.uniq(keys).sort();\n      }\n      state.updateNodeAttrNotifier();\n    });\n}\n\n\nfunction updateEdgeColorControlBox(selection, state) {\n  const fieldOptions = state.edges.fields\n    .filter(e => misc.sortType(e.format) !== 'none')\n    .filter(e => !['source', 'target'].includes(e.key));\n  selection\n      .call(cbox.updateColorControlBox, fieldOptions, state.edgeColor)\n      .on('change', function() {\n        state.edgeColor = cbox.colorControlBoxState(selection);\n        if (state.edgeColor.scale === 'ordinal') {\n          const keys = state.edges.records().map(e => e[state.edgeColor.field]);\n          state.edgeColor.domain = _.uniq(keys).sort();\n        }\n        state.updateEdgeAttrNotifier();\n      });\n}\n\n\nfunction updateNodeSizeControlBox(selection, state) {\n  const fieldOptions = state.nodes.fields\n    .filter(e => misc.sortType(e.format) !== 'none');\n  selection\n      .call(cbox.updateSizeControlBox, fieldOptions, state.nodeSize)\n      .on('change', function() {\n        state.nodeSize = cbox.sizeControlBoxState(selection);\n        state.updateNodeAttrNotifier();\n      });\n}\n\n\nfunction updateEdgeWidthControlBox(selection, state) {\n  const fieldOptions = state.edges.fields\n    .filter(e => misc.sortType(e.format) !== 'none')\n    .filter(e => !['source', 'target'].includes(e.key));\n  selection\n      .call(cbox.updateSizeControlBox, fieldOptions, state.edgeWidth)\n      .on('change', function() {\n        state.edgeWidth = cbox.sizeControlBoxState(selection);\n        state.updateEdgeAttrNotifier();\n      });\n}\n\n\nfunction updateNodeLabelControlBox(selection, state) {\n  const fieldOptions = state.nodes.fields\n    .filter(e => misc.sortType(e.format) !== 'none');\n  selection\n      .call(cbox.updateLabelControlBox, fieldOptions,\n            state.nodeLabel, state.nodeLabelColor)\n      .on('change', function() {\n        const values = cbox.labelControlBoxState(selection);\n        state.nodeLabel = values.label;\n        state.nodeLabelColor = values.labelColor;\n        if (state.nodeLabelColor.scale === 'ordinal') {\n          const keys = state.nodes.records()\n            .map(e => e[state.nodeLabelColor.field]);\n          state.nodeLabelColor.domain = _.uniq(keys).sort();\n        }\n        state.updateNodeAttrNotifier();\n      });\n}\n\n\nfunction updateEdgeLabelControlBox(selection, state) {\n  const fieldOptions = state.edges.fields\n    .filter(e => misc.sortType(e.format) !== 'none')\n    .filter(e => !['source', 'target'].includes(e.key));\n  selection\n      .call(cbox.updateLabelControlBox, fieldOptions,\n            state.nodeLabel, state.nodeLabelColor)\n      .on('change', function() {\n        const values = cbox.labelControlBoxState(selection);\n        state.edgeLabel = values.label;\n        state.edgeLabelColor = values.labelColor;\n        if (state.edgeLabelColor.scale === 'ordinal') {\n          const keys = state.edges.records()\n            .map(e => e[state.edgeLabelColor.field]);\n          state.edgeLabelColor.domain = _.uniq(keys).sort();\n        }\n        state.updateEdgeAttrNotifier();\n      });\n}\n\n\nfunction controlBox(selection, state) {\n  // Clean up\n  selection.select('nav').remove();\n  selection.select('.tab-content').remove();\n\n  selection.call(\n    cbox.controlBoxFrame, 'control-frame-nav', 'control-frame-content');\n  const tabs = selection.select('.nav-tabs');\n  const content = selection.select('.tab-content');\n\n  // Main\n  tabs.append('a')\n      .classed('active', true)\n      .attr('aria-selected', 'true')\n      .call(cbox.controlBoxNav, 'control-main', 'Main');\n  content.append('div')\n      .classed('show', true)\n      .classed('active', true)\n      .classed('control-main', true)\n      .call(cbox.controlBoxItem, 'control-main')\n      .call(mainControlBox, state);\n\n  // Color\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-color', 'Color');\n  content.append('div')\n      .classed('control-color', true)\n      .call(cbox.controlBoxItem, 'control-color')\n      .call(cbox.colorControlBox, cscale.colorScales);\n\n  // Size\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-size', 'Size');\n  content.append('div')\n      .classed('control-size', true)\n      .call(cbox.controlBoxItem, 'control-size')\n      .call(cbox.sizeControlBox);\n\n  // Label\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-label', 'Label');\n  content.append('div')\n      .classed('control-label', true)\n      .call(cbox.controlBoxItem, 'control-label')\n      .call(cbox.labelControlBox, cscale.colorScales);\n\n  // Edge color\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-edgecolor', 'eColor');\n  content.append('div')\n      .classed('control-edgecolor', true)\n      .call(cbox.controlBoxItem, 'control-edgecolor')\n      .call(cbox.colorControlBox, cscale.colorScales);\n\n  // Edge width\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-edgewidth', 'eWidth');\n  content.append('div')\n      .classed('control-edgewidth', true)\n      .call(cbox.controlBoxItem, 'control-edgewidth')\n      .call(cbox.sizeControlBox);\n\n  // Edge label\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-edgelabel', 'eLabel');\n  content.append('div')\n      .classed('control-edgelabel', true)\n      .call(cbox.controlBoxItem, 'control-edgelabel')\n      .call(cbox.labelControlBox, cscale.colorScales);\n\n  state.updateControlBoxNotifier = () => {\n    selection.call(updateControlBox, state);\n  };\n}\n\n\nfunction updateControlBox(selection, state) {\n  selection.select('.control-main')\n      .call(updateMainControlBox, state);\n  selection.select('.control-color')\n      .call(updateNodeColorControlBox, state);\n  selection.select('.control-size')\n      .call(updateNodeSizeControlBox, state);\n  selection.select('.control-label')\n      .call(updateNodeLabelControlBox, state);\n  selection.select('.control-edgecolor')\n      .call(updateEdgeColorControlBox, state);\n  selection.select('.control-edgewidth')\n      .call(updateEdgeWidthControlBox, state);\n  selection.select('.control-edgelabel')\n      .call(updateEdgeLabelControlBox, state);\n}\n\n\nexport default {\n  controlBox, updateControlBox\n};\n","\n/** @module network/component */\n\nimport d3 from 'd3';\n\nimport {default as scale} from '../common/scale.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as transform} from '../component/transform.js';\n\n\nconst svgWidth = 180;  //TODO\nconst svgHeight = 180;  //TODO\n\n\nfunction updateNodes(selection, records, showStruct) {\n  const nodes = selection.selectAll('.node')\n    .data(records, d => d.index);\n  nodes.exit().remove();\n  const entered = nodes.enter()\n    .append('g')\n      .attr('class', 'node')\n      .call(updateNodeCoords);\n  entered.append('circle')\n      .attr('class', 'node-symbol');\n  entered.append('g')\n      .attr('class', 'node-content')\n      .attr('transform', `translate(${-svgWidth / 2},${-svgHeight / 2})`);\n  entered.append('text')\n      .attr('class', 'node-label')\n      .attr('x', 0)\n      .attr('text-anchor', 'middle');\n  const merged = entered.merge(nodes);\n  if (showStruct) {\n    merged.select('.node-content').html(d => d.structure);\n  } else {\n    merged.select('.node-content').select('svg').remove();\n  }\n}\n\n\nfunction updateEdges(selection, records) {\n  const edges = selection.selectAll('.link')\n    .data(records, d => `${d.source}_${d.target}`);\n  edges.exit().remove();\n  const entered = edges.enter()\n    .append('g')\n      .attr('class', 'link');\n  entered.append('line')\n      .attr('class', 'edge-line')\n      .style('stroke-opacity', 0.6);\n  entered.append('text')\n      .attr('class', 'edge-label')\n      .attr('text-anchor', 'middle');\n  // draw all components and then\n  entered.call(updateEdgeCoords);\n}\n\n\nfunction updateNodeAttrs(selection, state) {\n  const colorConv = scale.scaleFunction(state.nodeColor);\n  const sizeConv = scale.scaleFunction(state.nodeSize);\n  const labelColorConv = scale.scaleFunction(state.nodeLabelColor);\n  const textConv = value => {\n    if (state.nodeLabel.field === null) return '';\n    const field = state.nodes.fields\n      .find(e => e.key === state.nodeLabel.field);\n    if (field.format === 'd3_format') {\n      return misc.formatNum(value, field.d3_format);\n    }\n    return value;\n  };\n  selection.selectAll('.node').select('.node-symbol')\n      .attr('r', d => sizeConv(d[state.nodeSize.field]))\n      .style('fill', d => colorConv(d[state.nodeColor.field]));\n  selection.selectAll('.node').select('.node-label')\n      .attr('font-size', state.nodeLabel.size)\n      .attr('y', d => parseFloat(sizeConv(d[state.nodeSize.field]))\n             + parseInt(state.nodeLabel.size))\n      .attr('visibility', state.nodeLabel.visible ? 'inherit' : 'hidden')\n      .style('fill', d => labelColorConv(d[state.nodeLabelColor.field]))\n      .text(d => textConv(d[state.nodeLabel.field]));\n}\n\n\nfunction updateEdgeAttrs(selection, state) {\n  const colorConv = scale.scaleFunction(state.edgeColor);\n  const widthConv = scale.scaleFunction(state.edgeWidth);\n  const labelColorConv = scale.scaleFunction(state.edgeLabelColor);\n  selection.selectAll('.link').select('.edge-line')\n    .style('stroke', d => colorConv(d[state.edgeColor.field]))\n    .style('stroke-width', d => widthConv(d[state.edgeWidth.field]));\n  selection.selectAll('.link').select('.edge-label')\n    .attr('font-size', state.edgeLabel.size)\n    .attr('visibility', state.edgeLabel.visible ? 'inherit' : 'hidden')\n    .style('fill', d => labelColorConv(d[state.edgeLabelColor.field]))\n    .text(d => d[state.edgeLabel.field]);\n}\n\n\nfunction updateNodeCoords(selection) {\n  selection.attr('transform', d => `translate(${d.x}, ${d.y})`);\n}\n\n\nfunction updateEdgeCoords(selection) {\n  selection.attr('transform', d => `translate(${d.sx}, ${d.sy})`);\n  selection.select('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', d => d.tx - d.sx)\n    .attr('y2', d => d.ty - d.sy);\n  selection.select('.edge-label')\n    .attr('x', d => (d.tx - d.sx) / 2)\n    .attr('y', d => (d.ty - d.sy) / 2);\n}\n\n\nfunction updateAttrs(selection, state) {\n  selection.select('.nw-nodes').call(updateNodeAttrs, state);\n  selection.select('.nw-edges').call(updateEdgeAttrs, state);\n}\n\n\nfunction updateComponents(selection, state) {\n  const nodesToRender = state.nodesToRender();\n  const numNodes = nodesToRender.length;\n  if (state.enableFocusedView) {\n    state.focusedView = numNodes < state.focusedViewThreshold;\n  }\n  if (state.enableOverlookView) {\n    state.overlookView = numNodes > state.overlookViewThreshold;\n  }\n  const edgesToRender = state.overlookView ? [] : state.edgesToRender();\n  selection.select('.nw-nodes')\n    .call(updateNodes, nodesToRender, state.focusedView);\n  selection.select('.nw-edges')\n    .call(updateEdges, edgesToRender);\n  selection.call(updateAttrs, state);\n  // Rebind event listeners\n  if (state.zoomListener) {\n    selection.call(state.zoomListener);\n  }\n  if (state.dragListener) {\n    selection.select('.nw-nodes').selectAll('.node')\n      .call(state.dragListener);\n  }\n}\n\n\nfunction moveNode(selection, x, y) {\n  selection.attr('transform', `translate(${x}, ${y})`);\n}\n\n\nfunction moveEdge(selection, sx, sy, tx, ty) {\n  selection.attr('transform', `translate(${sx}, ${sy})`);\n  selection.select('.edge-line')\n    .attr('x1', 0)\n    .attr('y1', 0)\n    .attr('x2', tx - sx)\n    .attr('y2', ty - sy);\n  selection.select('.edge-label')\n    .attr('x', (tx - sx) / 2)\n    .attr('y', (ty - sy) / 2);\n}\n\n\nfunction move(selection, node, x, y) {\n  const n = d3.select(node).call(moveNode, x, y).datum();\n  selection.select('.nw-edges')\n    .selectAll(\".link\")\n    .filter(d => n.adjacency.map(e => e[1]).includes(d.num))\n    .each(function (d) {\n      if (n.index === d.source.index || n.index === d.source) {\n        d3.select(this).call(moveEdge, x, y, d.tx, d.ty);\n      } else if (n.index === d.target.index || n.index === d.target) {\n        d3.select(this).call(moveEdge, d.sx, d.sy, x, y);\n      }\n    });\n}\n\n\nfunction networkView(selection, state) {\n  selection.call(transform.view, state);\n  const field = selection.select('.field');\n  const edges = field.append('g').classed('nw-edges', true);\n  const nodes = field.append('g').classed('nw-nodes', true);\n\n  state.updateAllNotifier = () => {\n    state.updateWorkingCopy();\n    selection.call(updateComponents, state);\n  };\n  state.updateComponentNotifier = () => {\n    selection.call(updateComponents, state);\n  };\n  state.updateNodeNotifier = () => {\n    nodes.call(updateNodes, state.nodesToRender());\n  };\n  state.updateEdgeNotifier = () => {\n    edges.call(updateEdges, state.edgesToRender());\n  };\n  state.updateNodeAttrNotifier = () => {\n    nodes.call(updateNodeAttrs, state);\n  };\n  state.updateEdgeAttrNotifier = () => {\n    edges.call(updateEdgeAttrs, state);\n  };\n}\n\n\nexport default {\n  updateNodes, updateEdges, updateNodeCoords, updateEdgeCoords,\n  updateNodeAttrs, updateEdgeAttrs, updateAttrs, updateComponents,\n  move, networkView\n};\n","\n/** @module network/interaction */\n\nimport d3 from 'd3';\n\nimport {default as transform} from '../component/transform.js';\n\nimport {default as component} from './component.js';\n\n\nfunction dragListener(selection, state) {\n  return d3.drag()\n    .on('drag', function () {\n      selection.call(component.move, this, d3.event.x, d3.event.y);\n    })\n    .on('end', function (d) {\n      state.setCoords(d.index, d3.event.x, d3.event.y);\n    });\n}\n\n\nfunction zoomListener(selection, state) {\n  return d3.zoom()\n    .on('zoom', function() {\n      const t = d3.event.transform;\n      selection.call(transform.transform, t.x, t.y, t.k);\n      // Smooth transition\n      if (!state.focusedView) {\n        const p = state.prevTransform;\n        const xMoved = t.x > p.x + 20 || t.x < p.x - 20;\n        const yMoved = t.y > p.y + 20 || t.y < p.y - 20;\n        const zoomIn = t.k > p.k;\n        if (xMoved || yMoved && !zoomIn) {\n          state.setTransform(t.x, t.y, t.k);\n          state.prevTransform = {x: t.x, y: t.y, k: t.k};\n          selection\n            .call(component.updateComponents, state);\n        }\n      }\n    })\n    .on('end', function() {\n      const t = d3.event.transform;\n      state.setTransform(t.x, t.y, t.k);\n      state.prevTransform = {x: t.x, y: t.y, k: t.k};\n      selection\n        .call(component.updateComponents, state);\n    });\n}\n\n\nfunction setInteraction(selection, state) {\n  state.zoomListener = zoomListener(selection, state);\n  state.dragListener = dragListener(selection, state);\n  selection.call(state.zoomListener);\n  selection.select('.nw-nodes')\n    .selectAll('.node')\n      .call(state.dragListener);\n  state.fitNotifier = () => {\n    selection.call(fit, state);\n  };\n  // Resume zoom event\n  const t = state.transform;\n  selection\n      .call(transform.transform, t.x, t.y, t.k)\n      .call(\n        d3.zoom().transform,\n        d3.zoomIdentity.translate(t.x, t.y).scale(t.k)\n      );\n\n}\n\n\nfunction fit(selection, state) {\n  state.fitTransform();\n  const t = state.transform;\n  selection\n      .call(component.updateComponents, state)\n      .call(transform.transform, t.x, t.y, t.k)\n      .call(\n        d3.zoom().transform,\n        d3.zoomIdentity.translate(t.x, t.y).scale(t.k)\n      );\n}\n\n\nexport default {\n  dragListener, zoomListener, setInteraction, fit\n};\n","\n/** @module network/force */\n\nimport d3 from 'd3';\n\nimport {default as component} from './component.js';\nimport {default as interaction} from './interaction.js';\n\n\nconst forcePresets = {\n  aggregate: d3.forceSimulation()\n    .force('link', d3.forceLink().id(d => d.index).distance(60).strength(1))\n    .force('charge',\n      d3.forceManyBody().strength(-600).distanceMin(15).distanceMax(720))\n    .force('collide', d3.forceCollide().radius(90))\n    .force('x', d3.forceX().strength(0.002))\n    .force('y', d3.forceY().strength(0.002)),\n  tree: d3.forceSimulation()\n    .force('link', d3.forceLink().id(d => d.index).distance(60).strength(2))\n    .force('charge',\n      d3.forceManyBody().strength(-6000).distanceMin(15).distanceMax(720))\n    .force('collide', d3.forceCollide().radius(90))\n    .force('x', d3.forceX().strength(0.0002))\n    .force('y', d3.forceY().strength(0.0002))\n};\n\n\nfunction forceSimulation(preset, width, height) {\n  return forcePresets[preset]\n    .force('center', d3.forceCenter(width / 2, height / 2))\n    .stop();\n}\n\n\nfunction forceDragListener(selection, simulation, state) {\n  return d3.drag()\n    .on('start', () => {\n      if (!d3.event.active) selection.call(relax, simulation, state);\n    })\n    .on('drag', d => {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    })\n    .on('end', d => {\n      if (!d3.event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    });\n}\n\n\nfunction end(selection, simulation, state) {\n  const coords = state.ns.map(e => ({x: e.x, y: e.y}));\n  state.setAllCoords(coords);\n  selection\n    .call(component.updateComponents, state);\n}\n\n\nfunction stick(selection, simulation, state) {\n  simulation.alpha(0).stop();\n  selection.select('.nw-nodes').selectAll('.node')\n    .each(d => {\n      d.fx = d.x;\n      d.fy = d.y;\n    });\n  state.dragListener = interaction.dragListener(selection, state);\n  selection.call(end, simulation, state);\n}\n\n\nfunction unstick(selection, simulation, state) {\n  selection.select('.nw-nodes').selectAll('.node')\n    .each(d => {\n      d.fx = null;\n      d.fy = null;\n    });\n  state.dragListener = forceDragListener(selection, simulation, state);\n  // Render all nodes and do not render edges\n  // TODO: edge rendering behavior should be changed by data size or setting\n  const coords = state.ns.map(e => ({x: e.x, y: e.y}));\n  state.setAllCoords(coords);\n  selection\n    .call(component.updateComponents, state);\n}\n\n\nfunction relax(selection, simulation, state) {\n  selection.call(unstick, simulation, state);\n  simulation.alpha(0.1).restart();\n}\n\n\nfunction restart(selection, simulation, state) {\n  selection.call(unstick, simulation, state);\n  simulation.alpha(1).restart();\n}\n\n\nfunction setForce(selection, simulation, state) {\n  simulation.nodes(state.ns)\n    .force('link').links(state.currentEdges());\n}\n\n\nfunction activate(selection, simulation, state) {\n  simulation\n    .on('tick', () => {\n      selection.select('.nw-nodes').selectAll(\".node\")\n        .call(component.updateNodeCoords);\n      const coords = state.ns.map(e => ({x: e.x, y: e.y}));\n      state.setAllCoords(coords);\n      selection.select('.nw-edges').selectAll(\".link\")\n        .call(component.updateEdgeCoords);\n      state.tickCallback(simulation);\n    })\n    .on('end', () => {\n      selection.call(end, simulation, state);\n      state.tickCallback(simulation);\n    });\n  state.setForceNotifier = () => {\n    selection.call(setForce, simulation, state);\n  };\n  state.stickNotifier = () => {\n    selection.call(stick, simulation, state);\n  };\n  state.relaxNotifier = () => {\n    selection.call(relax, simulation, state);\n  };\n  state.restartNotifier = () => {\n    selection.call(restart, simulation, state);\n  };\n  state.setForceNotifier();\n  if (state.simulationOnLoad) {\n    selection.call(restart, simulation, state);\n  } else {\n    selection.call(stick, simulation, state);\n  }\n}\n\n\nexport default {\n  forceSimulation, activate, stick, relax, restart\n};\n","\n/** @module networkApp */\n\nimport _ from 'lodash';\nimport d3 from 'd3';\n\nimport {default as client} from './common/client.js';\nimport {default as idb} from './common/idb.js';\n\nimport {default as button} from './component/button.js';\nimport {default as modal} from './component/modal.js';\nimport {default as transform} from './component/transform.js';\n\nimport {default as communityDialog} from './dialog/community.js';\nimport {default as renameDialog} from './dialog/rename.js';\n\nimport NetworkState from './network/state.js';\nimport {default as community} from './network/communityDetection.js';\nimport {default as control} from './network/controlBox.js';\nimport {default as component} from './network/component.js';\nimport {default as force} from './network/force.js';\nimport {default as interaction} from './network/interaction.js';\n\n\nfunction app(view, nodes, edges) {\n  const menubar = d3.select('#menubar');\n  menubar.selectAll('div,span,a').remove();  // Clean up\n  const dialogs = d3.select('#dialogs');\n  dialogs.selectAll('div').remove();  // Clean up\n\n  const state = new NetworkState(view, nodes, edges);\n  // TODO: define field size according to the data size\n  state.fieldWidth = 1200;\n  state.fieldHeight = 1200;\n\n  // Network view control\n  const menu = menubar.append('div')\n      .call(button.dropdownMenuButton, 'Network', 'primary', 'network-white')\n      .select('.dropdown-menu');\n  menu.append('a').call(communityDialog.menuLink);\n  menu.append('a').call(renameDialog.menuLink);\n  menu.append('a')\n      .call(button.dropdownMenuItem, 'Save', 'menu-save')\n      .on('click', function () {\n        state.save().then(() => console.info('Snapshot saved'));\n      });\n  // Dashboard link\n  menubar.append('a')\n      .call(button.menuButtonLink, 'Dashboard',\n            'outline-secondary', 'status-gray')\n      .attr('href', 'dashboard.html')\n      .attr('target', '_blank');\n  // Fetch control\n  menubar.append('a')\n      .classed('refresh', true)\n      .call(button.menuButtonLink,\n            'Refresh', 'outline-secondary', 'refresh-gray')\n      .on('click', function () {\n        return state.edges.pull().then(() => {\n          state.updateAllNotifier();\n          updateApp(state);\n        });\n      });\n  menubar.append('a')\n      .classed('abort', true)\n      .call(button.menuButtonLink,\n            'Abort server job', 'warning', 'delete-gray')\n      .attr('data-toggle', 'modal')\n      .attr('data-target', '#abort-dialog');\n  menubar.append('span').classed('progress', true)\n    .append('progress')\n      .attr('max', 100);\n  menubar.append('span').classed('title', true);\n  menubar.append('span').classed('status', true);\n\n  // Dialogs\n  dialogs.append('div')\n      .classed('communityd', true)\n      .call(communityDialog.body);\n  dialogs.append('div')\n      .classed('renamed', true)\n      .call(renameDialog.body);\n  dialogs.append('div')\n      .classed('abortd', true)\n      .call(modal.confirmDialog, 'abort-dialog');\n\n  // Force simulation\n  const simulation = force.forceSimulation(\n    state.forcePreset, state.fieldWidth, state.fieldHeight);\n  // Contents\n  const frame = d3.select('#nw-frame')\n      .call(transform.viewFrame, state);\n  const nwview = frame.select('.view')\n      .call(component.networkView, state);\n  const controlBox = d3.select('#nw-control')\n      .call(control.controlBox, state);\n\n  state.updateAllNotifier = () => {\n    state.updateWorkingCopy();\n    nwview\n      .call(component.updateComponents, state)\n      .call(interaction.setInteraction, state)\n      .call(force.activate, simulation, state);\n    controlBox\n      .call(control.updateControlBox, state);\n  };\n  // Resize window\n  window.onresize = () =>\n    d3.select('#nw-frame').call(transform.resize, state);\n\n  // Update\n  state.updateAllNotifier();\n  updateApp(state);\n}\n\n\nfunction updateApp(state) {\n  d3.select('#loading-icon').style('display', 'none');\n\n  // Title\n  d3.select('title').text(state.name);\n  d3.select('#menubar').select('.title').text(state.name);\n\n  // Menubar\n  const menubar = d3.select('#menubar');\n  const fstatus = state.edges.status();\n  const fsize = state.edges.size();\n  const ftime = state.edges.execTime();\n  const fprog = state.edges.progress();\n  const ongoing = state.edges.ongoing();\n  menubar.select('.title').text(state.name);\n  menubar.select('.status')\n      .text(`(${fstatus} - ${fsize} connections created in ${ftime} sec.)`);\n  menubar.select('.progress').select('progress')\n      .attr('value', fprog)\n      .text(`${fprog}%`);\n  // hide fetch commands\n  menubar.selectAll('.progress, .refresh, .abort')\n    .style('display', ongoing ? null : 'none');\n\n  // Dialogs\n  const dialogs = d3.select('#dialogs');\n\n  // Community detection dialog\n  dialogs.select('.communityd')\n      .call(communityDialog.updateBody)\n      .on('submit', function () {\n        const value = communityDialog.value(d3.select(this));\n        const ns = state.nodes.records();\n        const es = state.currentEdges();\n        const ops = {\n          nodeField: 'index',\n          weightField: state.connThldField,\n          nulliso: value.nulliso\n        };\n        const comm = community.communityDetection(ns, es, ops);\n        const mapping = {\n          key: 'index',\n          field: {key: value.name, name: value.name,\n                  format: 'd3_format', d3_format: 'd'},\n          mapping: comm\n        };\n        state.nodes.joinFields(mapping);\n        const catKeys = state.nodes.records().map(e => e[value.name]);\n        state.nodeColor = {\n          field: value.name, color: 'category40',\n          scale: 'ordinal', domain: _.uniq(catKeys).sort(),\n          range: ['#7fffd4', '#7fffd4'], unknown: '#7fffd4'\n        };\n        state.updateAllNotifier();\n        updateApp(state);\n      });\n\n  // Rename dialog\n  dialogs.select('.renamed')\n      .call(renameDialog.updateBody, state.name)\n      .on('submit', function () {\n        state.name = renameDialog.value(d3.select(this));\n        updateApp(state);\n      });\n\n  // Abort dialog\n  dialogs.select('.abortd')\n      .call(modal.updateConfirmDialog,\n            'Are you sure you want to abort this calculation job?')\n      .on('submit', function () {\n        state.edges.abort().then(() => {\n          state.updateAllNotifier();\n          updateApp(state);\n        });\n      });\n}\n\n\nfunction run() {\n  const err = client.compatibility();\n  if (err) {\n    d3.select('body')\n      .style('color', '#ff0000')\n      .text(err);\n    return;\n  }\n  // TODO: offline mode flags\n  const localFile = document.location.protocol !== \"file:\";  // TODO\n  const offLine = 'onLine' in navigator && !navigator.onLine;  // TODO\n  client.registerServiceWorker();\n  const storeID = client.URLQuery().store || null;\n  const viewID = client.URLQuery().view || null;\n  return idb.getView(storeID, viewID)\n    .then(view => {\n      if (!view) throw('ERROR: invalid URL');\n      view.storeID = storeID;\n      return Promise.all([\n        idb.getCollection(storeID, view.nodes),\n        idb.getCollection(storeID, view.edges)\n      ])\n      .then(colls => app(view, colls[0], colls[1]));\n    })\n    .catch(err => {\n      console.error(err);\n      d3.select('#nw-frame')\n        .style('color', 'red')\n        .text(err);\n    });\n}\n\n\nexport default {\n  run\n};\n"],"names":["URLQuery","pairs","window","location","search","substring","split","map","e","_","fromPairs","compatibility","registerServiceWorker","navigator","addEventListener","serviceWorker","register","console","info","sortType","fmt","includes","formatNum","value","d3format","Number","isNaN","parseFloat","d3","format","partialMatch","query","target","toString","toUpperCase","indexOf","uuidv4","replace","c","r","Math","random","statusConv","Queued","In progress","Aborting","Aborted","Completed","Failure","dataTypeConv","datatable","connection","v07_to_v08_nodes","json","fields","columns","sort","id","name","dataType","schemaVersion","revision","status","records","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v10_nodes","reference","convertNetwork","data","edges","hasOwnProperty","nodes","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","key","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","forEach","i","index","_structure","_index","source","v08_graph","nodeContentVisible","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","params","v10_edges","$schema","convertPackage","now","Date","isNW","v08_nodes","width","height","convertTable","specs","views","dataset","push","collectionID","contents","workflowID","workflow","viewID","viewType","rows","sortOrder","filterText","checkpoints","type","date","description","networkThresholdCutoff","filter","view","minConnThld","currentConnThld","schema","items","idb","Dexie","getAllItems","orderBy","reverse","toArray","updateItem","storeID","updateFunc","where","equals","modify","catch","err","error","version","stores","reset","delete","then","getItem","first","importItem","legacy","misc","slice","sessionStarted","put","newDatagrid","response","toLocaleString","timeZone","deleteItem","getView","appendView","viewObj","item","pos","findIndex","splice","updateView","isFunction","deleteView","bin","Object","entries","entry","getCollection","collID","colls","coll","appendCollection","collObj","updateCollection","iconBaseURL","buttonBox","selection","classed","append","menuButton","menuButtonLink","icon","attr","style","menuModalLink","dropdownMenuButton","button","dropdownMenuItem","dropdownMenuModal","dropdownMenuFile","accept","on","select","this","node","click","dropdownMenuFileValue","files","dialogBase","confirmDialog","base","call","footer","dispatch","updateConfirmDialog","message","submitDialog","title","header","html","resize","state","area","offsetWidth","offsetHeight","setViewBox","resizeNotifier","transform","tx","ty","tk","viewFrame","remove","viewBox","right","bottom","transition","duration","numberBoxFloatValue","property","textBox","updateTextBox","textBoxValue","readonlyBox","textareaBox","updateTextareaBox","updateTextareaPlaceholder","placeholder","textareaBoxValue","textareaBoxLines","length","checkBox","box","updateCheckBox","checked","checkBoxValue","numberBox","min","max","step","updateNumberBox","numberFloatValid","parseInt","valid","numberBoxIntValue","colorBox","event","stopPropagation","updateColorBox","colorBoxValue","fileInputBox","clearFileInput","fileInputBoxValue","menuLink","body","dialog","modal","updateBody","keyValid","nulliso","baseURL","get","url","q","keys","JSON","stringify","fetch","credentials","res","Promise","reject","Error","statusText","resolve","blob","post","formdata","method","serverStatus","server","singleToMulti","mapping","newMapping","m","mappingToTable","mp","concat","rcd","f","tableToMapping","table","ignore","row","csvToMapping","csvString","lines","shift","headerIdx","h","line","values","k","Array","apply","fd","uniqBy","Collection","[object Object]","autoIndex","content","addField","fs","mapper","flatten","command","fetcher","all","sum","some","TransformState","fieldWidth","fieldHeight","top","left","focusArea","focusAreaMargin","boundary","x","y","prevTransform","margin","setFocusArea","vh","vw","vr","bh","bw","isPortrait","adjustH","adjustV","setTransform","NetworkState","super","focusedViewThreshold","enableFocusedView","focusedView","overlookViewThreshold","enableOverlookView","overlookView","defaultNodeField","fillIfNull","obj","updater","defaultNodeColor","color","defaultNodeSize","defaultNodeLabel","defaultNodeLabelColor","edgeColor","edgeLabelColor","connThldField","simulationOnLoad","forcePreset","zoomListener","dragListener","updateAllNotifier","updateComponentNotifier","updateNodeNotifier","updateEdgeNotifier","updateNodeAttrNotifier","updateEdgeAttrNotifier","updateControlBoxNotifier","fitNotifier","setForceNotifier","stickNotifier","relaxNotifier","restartNotifier","tickCallback","ns","es","updateWorkingCopy","parse","n","adjacency","num","setAllCoords","xs","ys","coordsList","nbr","sx","sy","setBoundary","currentEdges","ni","export","ei","vi","communityDetection","option","nodeField","weightField","community","weight","clusters","jLouvain","a","b","cluster","colorScales","colors","schemePaired","schemeSet2","schemePastel2","schemeSet3","types","func","scaleLinear","scaleLog","scaleQuantize","scaleOrdinal","scaleFunction","cscale","mid","scaleFunc","clamp","d","result","undefined","monocolorBar","group","colorBar","monocolor","bicolor","grad","tricolor","categorical","sw","custom","setSize","checklistBoxValue","selectAll","setSelectedColorScale","selected","datum","shape","selectBox","selectBoxItems","options","exit","enter","updateSelectBox","selectBoxValue","checklistBox","checklistBoxItems","listitems","form","updateChecklistBox","each","anyChecked","colorScaleBox","dropdown","colorScaleBoxItems","bubbles","updateColorScaleBox","colorScaleBoxValue","colorScaleBoxItem","rangeBoxValid","v","rangeBox","t","updateRangeBox","rangeBoxValues","colorRangeBox","updateColorRangeBox","colorRangeBoxValues","scaleBoxGroupValid","rbox","lbox","validScale","colorRangeGroup","collapse","updateColorRangeGroup","customRange","cs","rg","customScale","rtype","rboxValues","colorRangeGroupValue","colorScale","colorScaleType","scaleBoxGroup","updateScaleBoxGroup","scaleBoxGroupValue","colorControlBox","fieldName","updateColorControlBox","fieldOptions","colorState","colorControlValid","noScale","scaleValid","colorControlBoxState","sizeRangeValid","unk","validUnk","sizeControlValid","labelControlValid","sizeControlBox","updateSizeControlBox","sizeState","sizeControlBoxState","labelControlBox","labelGroup","updateLabelControlBox","labelState","labelControlBoxState","labelColor","controlBoxFrame","navID","contentID","controlBoxNav","controlBoxItem","mainControlBox","viewModes","thldGroup","forceBox","updateMainControlBox","thldFields","thld","numEdges","combinations","logD","log10","simulation","alpha","isStopped","alphaMin","updateNodeColorControlBox","cbox","uniq","updateEdgeColorControlBox","updateNodeSizeControlBox","updateEdgeWidthControlBox","updateNodeLabelControlBox","updateEdgeLabelControlBox","updateControlBox","controlBox","tabs","svgWidth","svgHeight","updateNodes","showStruct","entered","updateNodeCoords","merged","merge","updateEdges","updateEdgeCoords","updateNodeAttrs","colorConv","sizeConv","labelColorConv","d3_format","textConv","updateEdgeAttrs","widthConv","updateAttrs","updateComponents","nodesToRender","numNodes","edgesToRender","moveNode","moveEdge","move","networkView","drag","component","setCoords","zoom","p","xMoved","yMoved","zoomIn","fit","fitTransform","zoomIdentity","translate","setInteraction","forcePresets","aggregate","forceSimulation","force","forceLink","distance","strength","forceManyBody","distanceMin","distanceMax","forceCollide","radius","forceX","forceY","tree","end","stick","stop","fx","fy","interaction","unstick","active","relax","alphaTarget","forceDragListener","restart","setForce","links","preset","forceCenter","activate","updateApp","menubar","fstatus","fsize","ftime","fprog","ongoing","dialogs","communityDialog","ops","comm","joinFields","catKeys","renameDialog","abort","run","client","document","protocol","onLine","store","menu","save","pull","nwview","control","onresize","app"],"mappings":"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"}