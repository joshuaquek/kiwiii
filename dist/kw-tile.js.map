{"version":3,"file":"kw-tile.js","sources":["../src/common/misc.js","../src/common/legacySchema.js","../src/common/idb.js","../src/common/fetcher.js","../src/common/mapper.js","../src/common/collection.js","../src/common/transform.js","../src/common/scale.js","../src/component/formBox.js","../src/component/shape.js","../src/component/formListBox.js","../src/component/formRangeBox.js","../src/component/formBoxGroup.js","../src/component/controlBox.js","../src/tile/controlBox.js","../src/component/transform.js","../src/tile/component.js","../src/tile/interaction.js","../src/tile.js","../src/tile/state.js"],"sourcesContent":["\n/** @module common/misc */\n\nimport d3 from 'd3';\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  sortType, formatNum, partialMatch, uuidv4\n};\n","\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: [\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ],\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  data.fields.forEach(e => {\n    if (e.key === 'structure') {\n      e.format = 'svg';\n    }\n    delete e.width;\n    delete e.height;\n  });\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nfunction convertPackage(json) {\n  if (json.hasOwnProperty('views')) return json;\n  const now = new Date();\n  const isNW = json.hasOwnProperty('edges');\n  const data = isNW ? convertNetwork(json) : convertTable(json);\n  const nodes = isNW ? data.nodes : data;\n  const specs = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    name: data.edges.name,\n    views: [],\n    dataset: []\n  };\n  specs.dataset.push({\n    $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n    collectionID: nodes.id,\n    name: nodes.name,\n    contents: [{\n      $schema: nodes.$schema,\n      workflowID: nodes.reference.workflow,\n      name: nodes.name,\n      fields: nodes.fields,\n      records: nodes.records,\n      created: nodes.created,\n      status: nodes.status,\n      query: nodes.query,\n      execTime: nodes.execTime,\n      progress: nodes.progress\n    }]\n  });\n  specs.views.push({\n    $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n    viewID: nodes.id,\n    name: nodes.name,\n    viewType: \"datagrid\",\n    rows: nodes.id,\n    fields: nodes.fields,\n    sortOrder: null,\n    filterText: null,\n    checkpoints: [{\n      type: 'convert',\n      date: now.toString(),\n      description: 'converted from legacy format'\n    }]\n  });\n  if (isNW) {\n    specs.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: data.edges.id,\n      name: data.edges.name,\n      contents: [{\n        $schema: data.edges.$schema,\n        workflowID: data.edges.reference.workflow,\n        name: data.edges.name,\n        fields: data.edges.fields,\n        records: data.edges.records,\n        created: data.edges.created,\n        status: data.edges.status,\n        query: data.edges.query,\n        execTime: data.edges.execTime,\n        progress: data.edges.progress\n      }]\n    });\n    specs.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n      viewID: data.edges.id,\n      name: data.edges.name,\n      viewType: \"network\",\n      nodes: nodes.id,\n      edges: data.edges.id,\n      nodeColor: data.edges.snapshot.nodeColor,\n      nodeSize: data.edges.snapshot.nodeSize,\n      nodeLabel: data.edges.snapshot.nodeLabel,\n      nodeLabelColor: data.edges.snapshot.nodeLabelColor,\n      edgeWidth: data.edges.snapshot.edgeWidth,\n      edgeLabel: data.edges.snapshot.edgeLabel,\n      networkThreshold: data.edges.snapshot.networkThreshold,\n      networkThresholdCutoff: data.edges.snapshot.networkThresholdCutoff,\n      fieldTransform: data.edges.snapshot.fieldTransform,\n      coords: data.edges.snapshot.coords,\n      checkpoints: [{\n        type: 'convert',\n        date: now.toString(),\n        description: 'converted from legacy format'\n      }]\n    });\n  }\n  specs.views.filter(e => e.viewType === 'network')\n    .forEach(view => {\n      view.minConnThld = view.networkThresholdCutoff;\n      view.currentConnThld = view.networkThreshold;\n      if (view.hasOwnProperty('nodeLabel')) {\n        view.nodeLabel.field = view.nodeLabel.text;\n      }\n      if (view.hasOwnProperty('edgeLabel')) {\n        view.edgeLabel.field = 'weight';\n      }\n      if (view.hasOwnProperty('edgeWidth')) {\n        view.edgeWidth.field = 'weight';\n      }\n    });\n  return specs;\n}\n\n\nexport default {\n  convertPackage\n};\n","\n/** @module common/idb */\n\nimport _ from 'lodash';\nimport Dexie from 'Dexie';\n\nimport {default as misc} from './misc.js';\nimport {default as legacy} from './legacySchema.js';\n\n// TODO: need package, view and dataset tables?\nconst schema = {\n  items: 'storeID, sessionStarted'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\n/**\n * Delete all data store\n * Try this before dealing with local db issues\n */\nfunction reset() {\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\n\n/**\n * Returns all data store items\n * @return {array} data store objects\n */\nfunction getAllItems() {\n  return idb.items\n    .orderBy('sessionStarted')\n    .reverse()\n    .toArray();\n}\n\n\n/**\n * Get data store items by store ID\n * @param {string} storeID - store ID\n * @return {array} data store object\n */\nfunction getItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .first()\n    .catch(err => {\n      console.error(`IDBError: Unexpected table ID: ${storeID}`, err);\n    });\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - storeID if sucessfully added\n */\nfunction importItem(data) {\n  // Legacy format converter\n  if (!data.hasOwnProperty('views')) {\n    data = legacy.convertPackage(data);\n  }\n  const now = new Date();\n  data.storeID = misc.uuidv4().slice(0, 8);\n  data.sessionStarted = now.toString();\n  return idb.items.put(data);\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} response - response data\n * @return {string} - viewID if sucessfully added\n */\nfunction newDatagrid(response) {\n  const now = new Date();\n  const date = now.toLocaleString('en-GB', { timeZone: 'Asia/Tokyo'});\n  const storeID = misc.uuidv4().slice(0, 8);\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  const data = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    storeID: storeID,\n    name: viewID,  // TODO: generate from response.query\n    views: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n        viewID: viewID,\n        name: viewID,  // TODO: generate from response.query\n        viewType: \"datagrid\",\n        rows: collectionID,\n        checkpoints: [\n          {type: 'creation', date: date}\n        ]\n      }\n    ],\n    dataset: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: collectionID,\n        contents: [response]\n      }\n    ],\n    sessionStarted: date\n  };\n  return idb.items.put(data)\n    .then(() => ({storeID: storeID, viewID:viewID}));\n}\n\n\n/**\n * Update data object in the store\n * @param {string} storeID - store ID\n * @param {function} updateFunc - update function\n * @return {integer} - number of updated items\n */\nfunction updateItem(storeID, updateFunc) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .modify(updateFunc)\n    .catch(err => {\n      console.error('IDBError: Update failed', err);\n    });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .delete();\n}\n\n\n/**\n * Returns a view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @return {array} view objects\n */\nfunction getView(storeID, viewID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).views)\n    .then(views => {\n      const view = views.find(e => e.viewID === viewID);\n      if (!view) return;\n      view.storeID = storeID;\n      return view;\n    });\n}\n\n\n/**\n * Append a view next to a specific view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object\n */\nfunction appendView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos + 1, 0, viewObj);\n  });\n}\n\n\n/**\n * Update view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object or update function\n */\nfunction updateView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    if (_.isFunction(viewObj)) {\n      viewObj(item.views[pos]);\n    } else {\n      item.views[pos] = viewObj;\n    }\n  });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteView(storeID, viewID) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos, 1);\n    // prune orphaned collections\n    const bin = {};\n    item.dataset.forEach(e => { bin[e.collectionID] = 0; });\n    item.views.forEach(view => {\n      ['rows', 'items', 'nodes', 'edges']\n        .filter(e => view.hasOwnProperty(e))\n        .forEach(e => { bin[view[e]] += 1; });\n    });\n    Object.entries(bin).forEach(entry => {\n      if (!entry[1]) {\n        const i = item.dataset.findIndex(e => e.collectionID === entry[0]);\n        item.dataset.splice(i, 1);\n      }\n    });\n  });\n}\n\n\n/**\n * Returns a collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @return {array} Collection objects\n */\nfunction getCollection(storeID, collID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).dataset)\n    .then(colls => {\n      const coll = colls.find(e => e.collectionID === collID);\n      if (!coll) return;\n      coll.storeID = storeID;\n      return coll;\n    });\n}\n\n\n/**\n * Append a view next to a specific view\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @param {object} collObj - Collection object\n */\nfunction appendCollection(storeID, collID, collObj) {\n  return updateItem(storeID, item => {\n    const pos = item.dataset.findIndex(e => e.collectionID === collID);\n    item.dataset.splice(pos + 1, 0, collObj);\n  });\n}\n\n\n/**\n * Update collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @param {object} collObj - Collection object or update function\n */\nfunction updateCollection(storeID, collID, collObj) {\n  return updateItem(storeID, item => {\n    const pos = item.dataset.findIndex(e => e.collectionID === collID);\n    if (_.isFunction(collObj)) {\n      collObj(item.dataset[pos]);\n    } else {\n      item.dataset[pos] = collObj;\n    }\n  });\n}\n\n\nexport default {\n  reset, getAllItems, getItem, importItem, newDatagrid, updateItem, deleteItem,\n  getView, appendView, updateView, deleteView,\n  getCollection, appendCollection, updateCollection\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '../req/';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\nfunction serverStatus() {\n  const response = {};\n  return get('server')\n    .then(json)\n    .then(res => {\n      response.server = res;\n    })\n    .then(() => get('schema'))\n    .then(json)\n    .then(res => {\n      response.schema = res;\n    })\n    .then(() => response);\n}\n\n\nexport default {\n  get, json, text, blob, post, error, serverStatus\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: [keyField].concat(mp.fields),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: table.fields.filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key)),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: fields,\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(mp.fields)\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module common/collection */\n\nimport _ from 'lodash';\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as mapper} from './mapper.js';\n\n\nexport default class Collection {\n  /**\n   * Create Collection from a flashflood response datatable\n   * If data is not specified, put datatables later by this.append(data)\n   * @param {object} coll - Collection or response object\n   */\n  constructor(coll) {\n    // Settings\n    this.autoIndex = 'index';  // enumerate records\n\n    this.collectionID = coll.collectionID || null;\n    this.storeID = coll.storeID || null;\n    this.name = coll.name || null;\n    this.contents = coll.contents || [coll];\n    this.fields = [];\n    this.contents.forEach(content => {\n      content.fields.forEach(e => this.addField(e));\n    });\n  }\n\n  /**\n   * Add fields\n   * @param {array} fs - list of fields\n   */\n  addField(field) {\n    if (this.fields.find(e => e.key === field.key)) return;\n    if (!field.hasOwnProperty('name')) field.name = field.key;\n    if (!field.hasOwnProperty('visible')) field.visible = true;\n    if (field.hasOwnProperty('d3_format')) field.format = 'd3_format';\n    if (!field.hasOwnProperty('format')) field.format = 'raw';\n    this.fields.push(field);\n  }\n\n  /**\n   * Update fields properties\n   * @param {array} fs - list of fields\n   */\n  updateFields(fs) {\n    this.fields = [];\n    fs.forEach(e => this.addField(e));\n  }\n\n  /**\n   * Join fields\n   * @param {object} mapping - column mapper object\n   */\n  joinFields(mapping) {\n    this.contents.forEach(c => {\n      mapper.apply(c, mapping);\n    });\n    if (mapping.hasOwnProperty('fields')) {\n      mapping.fields.forEach(e => this.addField(e));\n    } else {\n      this.addField(mapping.field);\n    }\n  }\n\n  /**\n   * Return all records of the collection\n   * @return {array} records\n   */\n  records() {\n    return _.flatten(this.contents.map(e => e.records));\n  }\n\n  fetch(command) {\n    const fs = this.contents\n      .filter(e => ['running', 'ready', 'interrupted', 'queued'].includes(e.status))\n      .map(content => {\n        const query = {id: content.workflowID, command: command};\n        return fetcher.get('progress', query)\n          .then(fetcher.json)\n          .then(data => {\n            return idb.updateCollection(this.storeID, this.collectionID, coll => {\n              const i = coll.contents\n                .findIndex(e => e.workflowID === query.id);\n              if (data.status === 'failure') {  // No data found on server\n                coll.contents[i].status = 'failure';\n              } else {\n                coll.contents[i] = data;\n              }\n            });\n          });\n      });\n    return Promise.all(fs)\n      .then(() => idb.getCollection(this.storeID, this.collectionID))\n      .then(coll => {\n        this.contents = coll.contents;\n      });\n  }\n\n  /**\n   * Retrieve workflows and store it into a local store.\n   * @return {Promise}\n   */\n  pull() {\n    return this.fetch('pull');\n  }\n\n  /**\n   * Retrieve workflows, abort all ongoing workflow task\n   * and store it into a local store.\n   * @return {Promise}\n   */\n  abort() {\n    return this.fetch('abort');\n  }\n\n  /**\n   * Return total number of records\n   * @return {float} total number of records\n   */\n  size() {\n    return _.sum(this.contents.map(e => e.records.length));\n  }\n\n  /**\n   * Return status\n   * @return {string} status\n   */\n  status() {\n    if (this.contents.some(e => e.status === 'interrupted')) return 'interrupted';\n    if (this.contents.some(e => e.status === 'running')) return 'running';\n    if (this.contents.some(e => e.status === 'queued')) return 'queued';\n    if (this.contents.some(e => e.status === 'ready')) return 'ready';\n    if (this.contents.some(e => e.status === 'aborted')) return 'aborted';\n    if (this.contents.some(e => e.status === 'failure')) return 'failure';\n    return 'done';\n  }\n\n  /**\n   * Return ongoing or not\n   * @return {bool} ongoing or not\n   */\n  ongoing() {\n    const s = ['ready', 'queued', 'running', 'interrupted'];\n    return s.includes(this.status());\n  }\n\n  /**\n   * Return percentage of workflow progress\n   * @return {float} progress in percent\n   */\n  progress() {\n    return _.min(this.contents.map(e => e.progress));\n  }\n\n  /**\n   * Return total execution time\n   * @return {float} total time\n   */\n  execTime() {\n    return _.sum(this.contents.map(e => e.execTime));\n  }\n\n  /**\n   * Export collection object as JSON\n   * @return {object} collection JSON\n   */\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: this.collectionID,\n      name: this.name,\n      fields: this.fields,\n      contents: this.contents\n    };\n  }\n}\n","\n/** @module common/transform */\n\nimport d3 from 'd3';\n\n\nexport default class TransformState {\n  constructor(width, height, transform) {\n    this.fieldWidth = width;\n    this.fieldHeight = height;\n\n    this.viewBox = {\n      top: 0,\n      right: this.fieldWidth,\n      bottom: this.fieldHeight,\n      left: 0\n    };\n\n    this.focusArea = {};\n    this.focusAreaMargin = 50;\n\n    this.boundary = {\n      top: 0,\n      right: this.fieldWidth,\n      bottom: this.fieldHeight,\n      left: 0\n    };\n\n    this.transform = transform || {x: 0, y: 0, k: 1};\n    this.prevTransform = {\n      x: this.transform.x,\n      y: this.transform.y,\n      k: this.transform.k\n    };\n\n    this.resizeNotifier = () => {};\n  }\n\n  setFocusArea() {\n    const tx = this.transform.x;\n    const ty = this.transform.y;\n    const tk = this.transform.k;\n    const margin = this.focusAreaMargin;\n    this.focusArea.top = (this.viewBox.top - ty) / tk - margin;\n    this.focusArea.left = (this.viewBox.left - tx) / tk - margin;\n    this.focusArea.bottom = (this.viewBox.bottom - ty) / tk + margin;\n    this.focusArea.right = (this.viewBox.right - tx) / tk + margin;\n    // this.showFocusArea();  // debug\n  }\n\n  setViewBox(width, height) {\n    this.viewBox.right = width;\n    this.viewBox.bottom = height;\n    // this.showViewBox();  // debug\n    this.setFocusArea();\n  }\n\n  setTransform(tx, ty, tk) {\n    this.transform.x = tx;\n    this.transform.y = ty;\n    this.transform.k = tk;\n    // this.showTransform(); // debug\n    this.setFocusArea();\n  }\n\n  fitTransform() {\n    const vh = this.viewBox.bottom;\n    const vw = this.viewBox.right;\n    const vr = vw / vh;\n    const bh = this.boundary.bottom - this.boundary.top;\n    const bw = this.boundary.right - this.boundary.left;\n    const br = bw / bh;\n    const isPortrait = vr >= br;\n    const tk = isPortrait ? vh / bh : vw / bw;\n    const adjustH = isPortrait ? (vw - bw) / 2 : 0;\n    const adjustV = isPortrait ? 0 : (vh - bh) / 2;\n    const tx = -(this.boundary.left + adjustH) * tk;\n    const ty = -(this.boundary.top + adjustV) * tk;\n    this.setTransform(tx, ty, tk);\n  }\n\n  showTransform() {\n    d3.select('#debug-transform')\n      .text(JSON.stringify(this.transform));\n  }\n\n  showFocusArea() {\n    d3.select('#debug-focusarea')\n      .text(JSON.stringify(this.focusArea));\n  }\n\n  showViewBox() {\n    d3.select('#debug-viewbox')\n      .text(JSON.stringify(this.viewBox));\n  }\n}\n","\n/** @module common/scale */\n\nimport d3 from 'd3';\n\n\nconst colorScales = [\n  {key: 'monoblack', type: 'monocolor', colors: ['#333333'], unknown: '#333333'},\n  {key: 'monogray', type: 'monocolor', colors: ['#cccccc'], unknown: '#cccccc'},\n  {key: 'nodeDefault', type: 'monocolor', colors: ['#7fffd4'], unknown: '#7fffd4'},\n  {key: 'aquamarine', type: 'bicolor',\n   colors: ['#778899', '#7fffd4'], unknown: '#f0f0f0'},\n  {key: 'chartreuse', type: 'bicolor',\n   colors: ['#778899', '#7fff00'], unknown: '#f0f0f0'},\n  {key: 'salmon', type: 'bicolor',\n   colors: ['#778899', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'violet', type: 'bicolor',\n   colors: ['#778899', '#ee82ee'], unknown: '#f0f0f0'},\n  {key: 'temperature', type: 'tricolor',\n   colors: ['#87ceeb', '#fff5ee', '#fa8072'], unknown: '#f0f0f0'},\n  {key: 'spectrum', type: 'tricolor',\n   colors: ['#6495ed', '#ccff66', '#ffa500'], unknown: '#f0f0f0'},\n  {key: 'category10', type: 'categorical',\n   colors: ['#8dd3c7','#ffffb3','#bebada','#fb8072','#80b1d3','#fdb462',\n    '#b3de69','#fccde5','#bc80bd','#ccebc5'], unknown: '#f0f0f0'},\n  {key: 'cbsafe', type: 'categorical',\n   colors: ['#543005','#8c510a','#bf812d','#dfc27d','#f6e8c3','#c7eae5',\n   '#80cdc1','#35978f','#01665e','#003c30'], unknown: '#f0f0f0'},\n  {key: 'category20', type: 'categorical',\n   colors: d3.schemePaired.concat(d3.schemeSet2), unknown: '#f0f0f0'},\n  {key: 'category40', type: 'categorical',\n   colors: d3.schemePaired.concat(d3.schemePastel2, d3.schemeSet2, d3.schemeSet3),\n   unknown: '#f0f0f0'},\n  {key: 'custom', type: 'custom', colors: ['#ffffff'], text: 'custom'}\n];\n\n\nconst types = [\n  {key: 'linear', name: 'Linear', func: d3.scaleLinear},\n  {key: 'log', name: 'Log', func: d3.scaleLog},\n  {key: 'quantize', name: 'Quantize', func: d3.scaleQuantize},\n  {key: 'ordinal', name: 'Ordinal', func: d3.scaleOrdinal}\n];\n\n\nfunction scaleFunction(state) {\n  const cscale = colorScales.find(e => e.key === state.color);\n  let range;\n  let unknown;\n  if (cscale && cscale.key !== 'custom') {\n      range = cscale.colors;\n      unknown = cscale.unknown;\n  } else {\n    range = state.range;\n    unknown = state.unknown;\n  }\n  let domain = null;\n  if (range.length === 3) {\n    const mid = (parseFloat(state.domain[0]) + parseFloat(state.domain[1])) / 2;\n    domain = [state.domain[0], mid, state.domain[1]];\n  } else {\n    domain = state.domain;\n  }\n  // Build\n  let scaleFunc = types.find(e => e.key === state.scale).func();\n  scaleFunc = scaleFunc.domain(domain);\n  scaleFunc = scaleFunc.range(range);\n  if (['linear', 'log'].includes(state.scale)) {\n    scaleFunc = scaleFunc.clamp(true);\n  }\n\n  return d => {\n    // Sanitize\n    if (d === '' || typeof d === 'undefined' || d === null) {\n      return unknown;  // invalid values\n    }\n    if (['linear', 'log'].includes(state.scale) && parseFloat(d) != d) {\n      return unknown;  // texts\n    }\n    if (state.scale === 'log' && d <= 0) {\n      return unknown;  // negative values in log scale\n    }\n    // Apply function\n    const result = scaleFunc(d);\n    if (result === undefined) {\n      return unknown;  // TODO: specify unexpected behavior\n    }\n    return result;\n  };\n}\n\n\nexport default {\n  colorScales, types, scaleFunction\n};\n","\n/** @module component/formBox */\n\n\nimport d3 from 'd3';\n\n\nfunction textBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text');\n}\n\nfunction updateTextBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction textBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction readonlyBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .property('readonly', true);\n}\n\n\nfunction textareaBox(selection, label, rows) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows);\n}\n\nfunction updateTextareaBox(selection, value) {\n  selection.select('textarea').property('value', value);\n}\n\nfunction updateTextareaPlaceholder(selection, placeholder) {\n  selection.select('textarea').attr('placeholder', placeholder);\n}\n\nfunction textareaBoxValue(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value;  // TODO: 0 is falsy\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder;\n  return '';\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n').filter(e => e.length > 0);\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder.split('\\n').filter(e => e.length > 0);\n  return [];\n}\n\n\nfunction checkBox(selection, label) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox');\n  box.append('span')\n      .text(label);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, label, min, max, step) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'number')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step);\n}\n\nfunction updateNumberBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction numberFloatValid(selection) {\n  const value = numberBoxFloatValue(selection);\n  const min = parseInt(selection.select('input').attr('min'));\n  const max = parseInt(selection.select('input').attr('max'));\n  const valid = !isNaN(value) && value >= min && value <= max;\n  selection.select('input')\n      .style('background-color', valid ? '#ffffff' : '#ffcccc');\n  return valid;\n}\n\nfunction numberBoxIntValue(selection) {\n  return parseInt(selection.select('input').property('value'));\n}\n\nfunction numberBoxFloatValue(selection) {\n  return parseFloat(selection.select('input').property('value'));\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n    .append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'color');\n}\n\n\nfunction updateColorBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\n\nfunction colorBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction fileInputBox(selection, label, accept) {\nselection\n    .classed('form-group', true)\n    .classed('form-row', true);\nselection.append('label')\n    .classed('col-form-label', true)\n    .classed('col-form-label-sm', true)\n    .classed('col-4', true)\n    .text(label);\nselection.append('input')\n    .classed('form-control', true)\n    .classed('form-control-sm', true)\n    .classed('form-control-file', true)\n    .classed('col-8', true)\n    .attr('type', 'file')\n    .attr('accept', accept);\n}\n\nfunction clearFileInput(selection) {\n  // TODO: FileList object (input.files) may be a readonly property\n  const accept = selection.select('input').attr();\n  selection.select('input').remove();\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('form-control-file', true)\n      .classed('col-8', true)\n      .attr('type', 'file')\n      .attr('accept', accept);\n}\n\nfunction fileInputBoxValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\n\nexport default {\n  textBox, updateTextBox, textBoxValue, readonlyBox,\n  textareaBox, updateTextareaBox, updateTextareaPlaceholder,\n  textareaBoxValue, textareaBoxLines,\n  checkBox, updateCheckBox, checkBoxValue,\n  numberBox, updateNumberBox, numberFloatValid,\n  numberBoxIntValue, numberBoxFloatValue,\n  colorBox, updateColorBox, colorBoxValue,\n  fileInputBox, clearFileInput, fileInputBoxValue\n};\n","\n/** @module component/shape */\n\nimport {default as misc} from '../common/misc.js';\n\n\nfunction monocolorBar(selection, colors, text) {\n  selection.attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none');\n  const group = selection.append('g');\n  group.append('rect')\n      .attr('x', 0).attr('y', 0)\n      .attr('width', 100).attr('height', 10)\n      .attr('fill', colors[0]);\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 10)\n      .attr('font-size', 12)\n      .text(text);\n}\n\nfunction bicolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n      .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n      .attr('offset', 1).attr('stop-color', colors[1]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction tricolorBar(selection, colors, text) {\n  const id = misc.uuidv4().slice(0, 8);  // Aboid inline SVG ID dupulicate\n  selection.call(monocolorBar, colors, text);\n  const grad = selection.append('defs')\n    .append('linearGradient')\n      .attr('id', id);\n  grad.append('stop')\n    .attr('offset', 0).attr('stop-color', colors[0]);\n  grad.append('stop')\n    .attr('offset', 0.5).attr('stop-color', colors[1]);\n  grad.append('stop')\n    .attr('offset', 1).attr('stop-color', colors[2]);\n  selection.select('rect')\n      .attr('fill', `url(#${id})`);\n}\n\nfunction categoricalBar(selection, colors, text) {\n  selection.attr('viewBox', '0 0 100 10')\n      .attr('preserveAspectRatio', 'none');\n  const sw = 100 / colors.length;\n  const group = selection.append('g');\n  colors.forEach((e, i) => {\n    group.append('rect')\n        .attr('x', sw * i).attr('y', 0)\n        .attr('width', sw).attr('height', 20)\n        .attr('fill', colors[i]);\n  });\n  group.append('text')\n      .attr('text-anchor', 'middle')\n      .attr('x', 50).attr('y', 20)\n      .attr('font-size', 20)\n      .text(text);\n}\n\nfunction setSize(selection, width, height) {\n  selection.attr('width', width).attr('height', height);\n}\n\n\nconst colorBar = {\n  'monocolor': monocolorBar,\n  'bicolor': bicolorBar,\n  'tricolor': tricolorBar,\n  'categorical': categoricalBar,\n  'custom': monocolorBar\n};\n\n\nexport default {\n  colorBar, setSize\n};\n","\n/** @module component/formListBox */\n\nimport d3 from 'd3';\n\nimport {default as shape} from './shape.js';\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction selectBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('select')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n}\n\nfunction selectBoxItems(selection, items) {\n  const options = selection.select('select')\n    .selectAll('option')\n      .data(items, d => d.key);\n  options.exit().remove();\n  options.enter()\n    .append('option')\n      .attr('value', d => d.key)\n      .text(d => d.name);\n}\n\nfunction updateSelectBox(selection, value) {\n  selection.select('select').property('value', value);\n}\n\nfunction selectBoxValue(selection) {\n  return selection.select('select').property('value');\n}\n\n\n/**\n * Render select box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction checklistBox(selection, label) {\n  // TODO: scroll\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('ul')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n}\n\nfunction checklistBoxItems(selection, items) {\n  const listitems = selection.select('ul')\n    .selectAll('li')\n      .data(items, d => d.key);\n  listitems.exit().remove();\n  const form = listitems.enter()\n    .append('li')\n      .attr('class', 'form-check')\n    .append('label')\n      .attr('class', 'form-check-label');\n  form.append('input')\n      .attr('type', 'checkbox')\n      .attr('class', 'form-check-input')\n      .property('value', d => d.key);\n  form.append('span')\n      .text(d => d.name);\n}\n\nfunction updateChecklistBox(selection, values) {\n  if (!values) return;\n  selection.selectAll('input')\n    .each(function (d) {\n      d3.select(this).property('checked', values.includes(d.key));\n    });\n}\n\nfunction checklistBoxValue(selection) {\n  return selection.selectAll('input:checked').data().map(d => d.key);\n}\n\nfunction anyChecked(selection) {\n  return checklistBoxValue(selection).length > 0;\n}\n\n\nfunction colorScaleBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label || 'Colorscale');\n  const form = selection.append('div')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true);\n  const dropdown = form.append('div')\n      .classed('btn-group', true)\n      .classed('mr-1', true);\n  dropdown.append('button')\n      .classed('btn', true)\n      .classed(`btn-light`, true)\n      .classed('btn-sm', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'dropdown');\n  dropdown.append('div')\n      .classed('dropdown-menu', true)\n      .classed('py-0', true);\n  form.append('span')\n      .classed('selected', true);\n}\n\nfunction colorScaleBoxItems(selection, items) {\n  const listitems = selection.select('.dropdown-menu')\n    .selectAll('a')\n      .data(items, d => d);\n  listitems.exit().remove();\n  listitems.enter()\n    .append('a')\n      .classed('dropdown-item', true)\n      .classed('py-0', true)\n      .attr('href', '#')\n      .attr('title', d => d.key)\n      .on('click', function (d) {\n        selection.call(setSelectedColorScale, d);\n        selection.dispatch('change', {bubbles: true});\n      })\n    .append('svg')\n      .each(function (d) {\n        d3.select(this)\n          .call(shape.colorBar[d.type], d.colors, d.text)\n          .call(shape.setSize, 100, 10);\n      });\n}\n\nfunction setSelectedColorScale(selection, item) {\n  const selected = selection.select('.selected');\n  selected.selectAll('svg').remove();\n  selected.datum(item);  // Bind selected item record\n  selected.append('svg')\n      .call(shape.colorBar[item.type], item.colors, item.text)\n      .call(shape.setSize, 100, 10);\n}\n\nfunction updateColorScaleBox(selection, key) {\n  const data = selection.select('.dropdown-menu')\n    .selectAll('a').data();\n  const item = data.find(e => e.key === key);\n  selection.call(setSelectedColorScale, item);\n}\n\nfunction colorScaleBoxValue(selection) {\n  return selection.select('.selected').datum().key;\n}\n\nfunction colorScaleBoxItem(selection) {\n  return selection.select('.selected').datum();\n}\n\n\nexport default {\n  selectBox, selectBoxItems, updateSelectBox, selectBoxValue,\n  checklistBox, checklistBoxItems, updateChecklistBox, checklistBoxValue,\n  anyChecked,\n  colorScaleBox, colorScaleBoxItems, updateColorScaleBox,\n  colorScaleBoxValue, colorScaleBoxItem\n};\n","\n/** @module component/formRangeBox */\n\nimport d3 from 'd3';\n\n\n/**\n * Render range box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction rangeBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  const f = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true);\n  f.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('min');\n  f.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('min', true)\n      .attr('type', 'text');\n  const t = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-4', true)\n      .classed('mb-1', true);\n  t.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('max');\n  t.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('max', true)\n      .attr('type', 'text');\n}\n\n\nfunction updateRangeBox(selection, range) {\n  selection.select('.min').property('value', range[0]);\n  selection.select('.max').property('value', range[1]);\n  selection.selectAll('.min,.max')\n    .on('input', function () {\n      if (!rangeBoxValid(selection)) {\n        d3.event.stopPropagation();\n      }\n    })\n    .dispatch('input', {bubbles: true});\n}\n\n\nfunction rangeBoxValid(selection) {\n  const min = selection.select('.min').property('value');\n  const max = selection.select('.max').property('value');\n  const valid = v => v !== '' && !isNaN(v);\n  selection.select('.min')\n      .style('background-color', valid(min) ? '#ffffff' : '#ffcccc');\n  selection.select('.max')\n      .style('background-color', valid(max) ? '#ffffff' : '#ffcccc');\n  return valid(min) && valid(max);\n}\n\n\nfunction rangeBoxValues(selection) {\n  return [\n    parseFloat(selection.select('.min').property('value')),\n    parseFloat(selection.select('.max').property('value'))\n  ];\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true)\n      .text(label);\n  const f = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  f.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('min');\n  f.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('min', true)\n      .attr('type', 'color');\n  const m = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  m.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('mid');\n  m.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('mid', true)\n      .attr('type', 'color');\n  const t = selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-3', true)\n      .classed('mb-1', true);\n  t.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('py-0', true)\n      .text('max');\n  t.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('max', true)\n      .attr('type', 'color');\n  selection\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n}\n\n\nfunction updateColorRangeBox(selection, range) {\n  selection.select('.min').property('value', range[0]);\n  selection.select('.mid').property('value', range[1]);\n  selection.select('.max').property('value', range[2]);\n}\n\n\nfunction colorRangeBoxValues(selection) {\n  return [\n    selection.select('.min').property('value'),\n    selection.select('.mid').property('value'),\n    selection.select('.max').property('value')\n  ];\n}\n\n\nexport default {\n  rangeBox, updateRangeBox, rangeBoxValues, rangeBoxValid,\n  colorRangeBox, updateColorRangeBox, colorRangeBoxValues\n};\n","\n/** @module component/formBoxGroup */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\n\nimport {default as box} from './formBox.js';\nimport {default as lbox} from './formListBox.js';\nimport {default as rbox} from './formRangeBox.js';\n\n\n/**\n * Render color range control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorRangeGroup(selection, colorScales) {\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('colorscale', true)\n      .classed('mb-2', true)\n      .call(lbox.colorScaleBox, 'Colorscale')\n      .call(lbox.colorScaleBoxItems, colorScales);\n\n  // Custom colorscale\n  const id = misc.uuidv4().slice(0, 8);\n  selection.append('div')\n      .classed('form-row', true)\n      .classed('justify-content-end', true)\n    .append('button')\n      .classed('btn', true)\n      .classed('btn-sm', true)\n      .classed('btn-outline-primary', true)\n      .classed('dropdown-toggle', true)\n      .attr('data-toggle', 'collapse')\n      .attr('data-target', `#${id}-collapse`)\n      .attr('aria-expanded', 'false')\n      .attr('aria-controls', `${id}-collapse`)\n      .text('Custom colorscale');\n  const collapse = selection.append('div')\n      .classed('collapse', true)\n      .attr('id', `${id}-collapse`)\n    .append('div')\n      .classed('card', true)\n      .classed('card-body', true)\n      .classed('p-2', true);\n  const customColorRanges = [\n    {key: 'continuous', name: 'Continuous'},\n    {key: 'two-piece', name: 'Two-piece'}\n  ];\n  collapse.append('div')\n      .classed('rangetype', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Range type')\n      .call(lbox.selectBoxItems, customColorRanges);\n  collapse.append('div')\n      .classed('range', true)\n      .classed('mb-1', true)\n      .call(rbox.colorRangeBox, 'Range');\n  collapse.append('div')\n      .classed('unknown', true)\n      .classed('mb-1', true)\n      .call(box.colorBox, 'Unknown');\n}\n\n\nfunction updateColorRangeGroup(selection, cscale, range, unknown) {\n  const customRange = () => {\n    const cs = lbox.colorScaleBoxValue(selection.select('.colorscale'));\n    const rg = lbox.selectBoxValue(selection.select('.rangetype'));\n    const customScale = cs === 'custom';\n    selection.selectAll('.rangetype, .range, .unknown')\n        .selectAll('select, input')\n        .property('disabled', !customScale)\n        .style('opacity',  customScale ? null : 0.3);\n    selection.select('.range').select('.mid')\n        .property('disabled', !customScale || rg === 'continuous')\n        .style('opacity', customScale && rg !== 'continuous' ? null : 0.3);\n  };\n  selection.select('.colorscale')\n      .call(lbox.updateColorScaleBox, cscale)\n      .on('change', function () {\n        customRange();\n      });\n  const rtype = range.length === 2 ? 'continuous' : 'two-piece';\n  selection.select('.rangetype')\n      .call(lbox.updateSelectBox, rtype)\n      .on('change', function () {\n        customRange();\n      })\n      .dispatch('change');\n  const rboxValues = range.length === 2  ? [range[0], null, range[1]] : range;\n  selection.select('.range')\n      .call(rbox.updateColorRangeBox, rboxValues)\n      .on('focusin', () => {\n        selection.dispatch('change', {bubbles: true});\n      });\n  selection.select('.unknown')\n      .call(box.updateColorBox, unknown)\n      .on('focusin', () => {\n        selection.dispatch('change', {bubbles: true});\n      });\n}\n\n\nfunction colorRangeGroupValue(selection) {\n  const colorScale = lbox.colorScaleBoxItem(selection.select('.colorscale'));\n  const rtype = lbox.selectBoxValue(selection.select('.rangetype'));\n  const range = rbox.colorRangeBoxValues(selection.select('.range'));\n  const unknown = box.colorBoxValue(selection.select('.unknown'));\n  return {\n    color: colorScale.key,\n    colorScaleType: colorScale.type,\n    range: rtype === 'continuous' ? [range[0], range[2]] : range,\n    unknown: unknown\n  };\n}\n\n\n/**\n * Render scale and domain control box group\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction scaleBoxGroup(selection) {\n  const scaleOptions = [\n    {key: 'linear', name: 'Linear'},\n    {key: 'log', name: 'Log'}\n  ];\n  selection\n      .classed('mb-3', true);\n  selection.append('div')\n      .classed('scale', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Scale')\n      .call(lbox.selectBoxItems, scaleOptions);\n  selection.append('div')\n      .classed('domain', true)\n      .classed('mb-1', true)\n      .call(rbox.rangeBox, 'Domain');\n}\n\n\nfunction updateScaleBoxGroup(selection, scale, domain) {\n  selection.select('.scale')\n      .call(lbox.updateSelectBox, scale);\n  selection.select('.domain')\n      .call(rbox.updateRangeBox, domain)\n      .on('input', function () {\n        scaleBoxGroupValid(selection);\n      });\n  selection.selectAll('.scale, .domain')\n      .on('change', function () {\n        if (!scaleBoxGroupValid(selection)) {\n          d3.event.stopPropagation();\n        }\n      });\n}\n\n\nfunction scaleBoxGroupValid(selection) {\n  if (!rbox.rangeBoxValid(selection.select('.domain'))) return false;\n  if (lbox.selectBoxValue(selection.select('.scale')) === 'linear') return true;\n  const values = rbox.rangeBoxValues(selection.select('.domain'));\n  selection.select('.domain').select('.min')\n      .style('background-color', values[0] > 0 ? '#ffffff' : '#ffcccc');\n  selection.select('.domain').select('.max')\n      .style('background-color', values[1] > 0 ? '#ffffff' : '#ffcccc');\n  const validScale = lbox.selectBoxValue(selection.select('.scale')) !== '';\n    selection.select('.scale').select('select')\n        .style('background-color', validScale ? '#ffffff' : '#ffcccc');\n  return values[0] > 0 && values[1] > 0 && validScale;\n}\n\n\nfunction scaleBoxGroupValue(selection) {\n  const scale = lbox.selectBoxValue(selection.select('.scale'));\n  const domain = rbox.rangeBoxValues(selection.select('.domain'));\n  return {\n    scale: scale || 'linear', \n    domain: domain\n  };\n}\n\n\nexport default {\n  colorRangeGroup, updateColorRangeGroup, colorRangeGroupValue,\n  scaleBoxGroup, updateScaleBoxGroup, scaleBoxGroupValue, scaleBoxGroupValid\n};\n","\n/** @module component/controlBox */\n\nimport d3 from 'd3';\n\nimport {default as box} from '../component/formBox.js';\nimport {default as lbox} from '../component/formListBox.js';\nimport {default as rbox} from '../component/formRangeBox.js';\nimport {default as group} from '../component/formBoxGroup.js';\n\n\nfunction colorControlBox(selection, colorScales, fieldName) {\n  selection.append('div')\n      .classed('field', true)\n      .call(lbox.selectBox, fieldName || 'Field');\n  selection.append('div')\n      .classed('range', true)\n      .call(group.colorRangeGroup, colorScales);\n  selection.append('div')\n      .classed('scale', true)\n      .call(group.scaleBoxGroup);\n}\n\n\nfunction updateColorControlBox(selection, fieldOptions, colorState) {\n  selection.select('.field')\n      .call(lbox.selectBoxItems, fieldOptions)\n      .call(lbox.updateSelectBox, colorState.field);\n  selection.select('.range')\n      .call(group.updateColorRangeGroup, colorState.color,\n            colorState.range, colorState.unknown);\n  selection.select('.scale')\n      .call(group.updateScaleBoxGroup, colorState.scale, colorState.domain);\n  selection.selectAll('.field, .range, .scale')\n      .on('change', function () {\n        if (!colorControlValid(selection)) {\n          d3.event.stopPropagation();\n        }\n      })\n      .dispatch('change');\n}\n\n\nfunction colorControlValid(selection) {\n  const values = group.colorRangeGroupValue(selection.select('.range'));\n  const noScale = ['categorical', 'monocolor'].includes(values.colorScaleType);\n  selection.select('.scale').selectAll('select,input')\n    .property('disabled', noScale)\n    .style('opacity', noScale ? 0.3 : null);\n  const scaleValid = group.scaleBoxGroupValid(selection.select('.scale'));\n  return noScale || scaleValid;\n}\n\n\nfunction colorControlBoxState(selection) {\n  const range = group.colorRangeGroupValue(selection.select('.range'));\n  const scale = group.scaleBoxGroupValue(selection.select('.scale'));\n  return {\n    field: lbox.selectBoxValue(selection.select('.field')),\n    color: range.color,\n    range: range.range,\n    unknown: range.unknown,\n    scale: range.colorScaleType === 'categorical' ? 'ordinal': scale.scale,\n    domain: scale.domain\n  };\n}\n\n\nfunction sizeControlBox(selection, fieldName) {\n  selection.append('div')\n      .classed('field', true)\n      .call(lbox.selectBox, fieldName || 'Field');\n  selection.append('div')\n      .classed('range', true)\n      .call(rbox.rangeBox, 'Range');\n  selection.append('div')\n      .classed('unknown', true)\n      .classed('mb-3', true)\n      .call(box.textBox, 'Unknown', 0, 1000, 1)\n    .select('input')\n      .classed('col-8', false)\n      .classed('col-3', true);\n  selection.append('div')\n      .classed('scale', true)\n      .call(group.scaleBoxGroup);\n}\n\n\nfunction updateSizeControlBox(selection, fieldOptions, sizeState) {\n  selection.select('.field')\n      .call(lbox.selectBoxItems, fieldOptions)\n      .call(lbox.updateSelectBox, sizeState.field);\n  selection.select('.range')\n      .call(rbox.updateRangeBox, sizeState.range);\n  selection.select('.unknown')\n      .call(box.updateTextBox, sizeState.unknown);\n  selection.select('.scale')\n      .call(group.updateScaleBoxGroup, sizeState.scale, sizeState.domain);\n  selection.selectAll('.range, .unknown')\n      .on('input', function () {\n        sizeRangeValid(selection);\n      });\n  selection.selectAll('.field, .range, .unknown, .scale')\n      .on('change', function () {\n        if (!sizeControlValid(selection)) {\n          d3.event.stopPropagation();\n        }\n      });\n}\n\nfunction sizeRangeValid(selection) {\n  if (!rbox.rangeBoxValid(selection.select('.range'))) return false;\n  const range = rbox.rangeBoxValues(selection.select('.range'));\n  const unk = box.textBoxValue(selection.select('.unknown'));\n  const validUnk = unk !== '' && !isNaN(unk) && unk > 0;\n  selection.select('.range').select('.min')\n      .style('background-color', range[0] > 0 ? '#ffffff' : '#ffcccc');\n  selection.select('.range').select('.max')\n      .style('background-color', range[1] > 0 ? '#ffffff' : '#ffcccc');\n  selection.select('.unknown').select('input')\n      .style('background-color', validUnk ? '#ffffff' : '#ffcccc');\n  return range[0] > 0 && range[1] > 0 && validUnk;\n}\n\n\nfunction sizeControlValid(selection) {\n  if (!group.scaleBoxGroupValid(selection.select('.scale'))) return false;\n  return sizeRangeValid(selection);\n}\n\n\nfunction sizeControlBoxState(selection) {\n  const scale = group.scaleBoxGroupValue(selection.select('.scale'));\n  return {\n    field: lbox.selectBoxValue(selection.select('.field')),\n    range: rbox.rangeBoxValues(selection.select('.range')),\n    unknown: box.textBoxValue(selection.select('.unknown')),\n    scale: scale.scale,\n    domain: scale.domain\n  };\n}\n\n\nfunction labelControlBox(selection, colorScales) {\n  // nodeLabel.visible\n  selection.append('div')\n    .append('div')\n      .classed('visible', true)\n      .call(box.checkBox, 'Show labels');\n  // nodeLabel\n  const labelGroup = selection.append('div')\n      .classed('mb-3', true);\n  labelGroup.append('div')\n      .classed('text', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'Text field');\n  labelGroup.append('div')\n      .classed('size', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Font size', 4, 100, 1);\n  // nodeLabelColor\n  selection.call(colorControlBox, colorScales, 'Color field');\n}\n\n\nfunction updateLabelControlBox(selection, fieldOptions,\n                               labelState, colorState) {\n  // nodeLabel.visible\n  selection.select('.visible')\n      .call(box.updateCheckBox, labelState.visible);\n  // nodeLabel.field\n  selection.select('.text')\n      .call(lbox.selectBoxItems, fieldOptions)\n      .call(lbox.updateSelectBox, labelState.field);\n  // nodeLabel.size\n  selection.select('.size')\n      .call(box.updateNumberBox, labelState.size)\n      .on('input', function () {\n        box.numberFloatValid(d3.select(this));\n      });\n  // nodeLabelColor\n  selection.call(updateColorControlBox, fieldOptions, colorState)\n      .selectAll('.visible, .text, .size, .field, .range, .scale')\n      .on('change', function () {\n        if (!labelControlValid(selection)) {\n          d3.event.stopPropagation();\n        }\n      })\n      .dispatch('change');\n}\n\n\nfunction labelControlValid(selection) {\n  if (!box.numberFloatValid(selection.select('.size'))) return false;\n  return colorControlValid(selection);\n}\n\n\nfunction labelControlBoxState(selection) {\n  return {\n    label: {\n      field: lbox.selectBoxValue(selection.select('.text')),\n      size: box.numberBoxFloatValue(selection.select('.size')),\n      visible: box.checkBoxValue(selection.select('.visible'))\n    },\n    labelColor: colorControlBoxState(selection)\n  };\n}\n\n\nfunction controlBoxFrame(selection, navID, contentID) {\n  selection.append('nav')\n    .append('div')\n      .classed('nav', true)\n      .classed('nav-tabs', true)\n      .attr('id', navID)\n      .attr('role', 'tablist');\n  selection.append('div')\n      .classed('tab-content', true)\n      .classed('p-2', true)\n      .attr('id', contentID);\n}\n\n\nfunction controlBoxNav(selection, id, label) {\n  selection\n      .classed('nav-item', true)\n      .classed('nav-link', true)\n      .classed('py-1', true)\n      .attr('id', `${id}-tab`)\n      .attr('data-toggle', 'tab')\n      .attr('href', `#${id}`)\n      .attr('role', 'tab')\n      .attr('aria-controls', id)\n      .attr('aria-selected', 'false')\n      .text(label);\n}\n\n\nfunction controlBoxItem(selection, id) {\n  selection\n      .classed('tab-pane', true)\n      .classed('fade', true)\n      .classed('container', true)\n      .classed('px-0', true)\n      .attr('id', id)\n      .attr('role', 'tabpanel')\n      .attr('aria-labelledby', `${id}-tab`);\n}\n\n\nexport default {\n  colorControlBox, updateColorControlBox, colorControlValid, colorControlBoxState,\n  sizeControlBox, updateSizeControlBox, sizeControlValid, sizeControlBoxState,\n  labelControlBox, updateLabelControlBox, labelControlValid, labelControlBoxState,\n  controlBoxFrame, controlBoxNav, controlBoxItem\n};\n","\n/** @module tile/controlBox */\n\nimport _ from 'lodash';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as cscale} from '../common/scale.js';\n\nimport {default as box} from '../component/formBox.js';\nimport {default as cbox} from '../component/controlBox.js';\nimport {default as lbox} from '../component/formListBox.js';\n\n\nfunction mainControlBox(selection) {\n  const chunkGroup = selection.append('div')\n      .classed('panel-group', true)\n      .classed('mb-3', true);\n  chunkGroup.append('div')\n      .classed('rowcnt', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Rows', 1, 9999, 1);\n  chunkGroup.append('div')\n      .classed('colcnt', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'Columns', 1, 9999, 1);\n  chunkGroup.append('div')\n      .classed('groupby', true)\n      .classed('mb-1', true)\n      .call(lbox.selectBox, 'GroupBy');\n  chunkGroup.append('div')\n      .classed('crow', true)\n      .classed('mb-1', true)\n      .call(box.numberBox, 'ChunksPerRow', 1, 999, 1);\n  chunkGroup.append('div')\n      .classed('showcol', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Show column number');\n  chunkGroup.append('div')\n      .classed('showrow', true)\n      .classed('mb-1', true)\n      .call(box.checkBox, 'Show row number');\n}\n\n\nfunction updateMainControlBox(selection, state) {\n  // Network threshold\n  const chunkGroup = selection.select('.panel-group');\n  chunkGroup.select('.rowcnt')\n      .call(box.updateNumberBox, state.rowCount);\n  chunkGroup.select('.colcnt')\n      .call(box.updateNumberBox, state.columnCount);\n  chunkGroup.select('.groupby')\n    .call(lbox.selectBoxItems,\n          state.items.fields.filter(e => misc.sortType(e.format) !== 'none'))\n    .call(lbox.updateSelectBox, state.groupField || '');\n  chunkGroup.select('.crow')\n      .call(box.updateNumberBox, state.chunksPerRow);\n  chunkGroup.select('.showcol')\n      .call(box.updateCheckBox, state.showColumnNumber);\n  chunkGroup.select('.showrow')\n      .call(box.updateCheckBox, state.showRowNumber);\n  chunkGroup.selectAll('.rowcnt, .colcnt, .groupby, .crow, .showcol, .showrow')\n      .on('change', function () {\n        state.rowCount = box.numberBoxIntValue(chunkGroup.select('.rowcnt'));\n        state.columnCount = box.numberBoxIntValue(chunkGroup.select('.colcnt'));\n        state.groupField = lbox.selectBoxValue(chunkGroup.select('.groupby'));\n        state.chunksPerRow = box.numberBoxIntValue(chunkGroup.select('.crow'));\n        state.showColumnNumber = box.checkBoxValue(chunkGroup.select('.showcol'));\n        state.showRowNumber = box.checkBoxValue(chunkGroup.select('.showrow'));\n        state.updateFieldNotifier();\n      });\n}\n\n\nfunction updateTileColorControlBox(selection, state) {\n  const fieldOptions = state.items.fields\n    .filter(e => misc.sortType(e.format) !== 'none');\n  selection\n    .call(cbox.updateColorControlBox, fieldOptions, state.tileColor)\n    .on('change', function() {\n      state.tileColor = cbox.colorControlBoxState(selection);\n      if (state.tileColor.scale === 'ordinal') {\n        const keys = state.items.records().map(e => e[state.tileColor.field]);\n        state.tileColor.domain = _.uniq(keys).sort();\n      }\n      state.updateItemAttrNotifier();\n    });\n}\n\n\nfunction updateTileValueControlBox(selection, state) {\n  const fieldOptions = state.items.fields\n    .filter(e => misc.sortType(e.format) !== 'none');\n  selection\n      .call(cbox.updateLabelControlBox, fieldOptions,\n            state.tileValue, state.tileValueColor)\n      .on('change', function() {\n        const values = cbox.labelControlBoxState(selection);\n        state.tileValue = values.label;\n        state.tileValueColor = values.labelColor;\n        if (state.tileValueColor.scale === 'ordinal') {\n          const keys = state.items.records()\n            .map(e => e[state.tileValueColor.field]);\n          state.tileValueColor.domain = _.uniq(keys).sort();\n        }\n        state.updateItemAttrNotifier();\n      });\n}\n\n\nfunction controlBox(selection, state) {\n  // Clean up\n  selection.select('nav').remove();\n  selection.select('.tab-content').remove();\n\n  selection.call(\n    cbox.controlBoxFrame, 'control-frame-nav', 'control-frame-content');\n  const tabs = selection.select('.nav-tabs');\n  const content = selection.select('.tab-content');\n\n  // Main\n  tabs.append('a')\n      .classed('active', true)\n      .attr('aria-selected', 'true')\n      .call(cbox.controlBoxNav, 'control-main', 'Main');\n  content.append('div')\n      .classed('show', true)\n      .classed('active', true)\n      .classed('control-main', true)\n      .call(cbox.controlBoxItem, 'control-main')\n      .call(mainControlBox, state);\n\n  // Color\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-color', 'Color');\n  content.append('div')\n      .classed('control-color', true)\n      .call(cbox.controlBoxItem, 'control-color')\n      .call(cbox.colorControlBox, cscale.colorScales);\n\n  // Text\n  tabs.append('a')\n      .call(cbox.controlBoxNav, 'control-value', 'Value');\n  content.append('div')\n      .classed('control-value', true)\n      .call(cbox.controlBoxItem, 'control-value')\n      .call(cbox.labelControlBox, cscale.colorScales);\n\n  selection.call(updateControlBox, state);\n}\n\n\nfunction updateControlBox(selection, state) {\n  selection.select('.control-main')\n      .call(updateMainControlBox, state);\n  selection.select('.control-color')\n      .call(updateTileColorControlBox, state);\n  selection.select('.control-value')\n      .call(updateTileValueControlBox, state);\n}\n\n\nexport default {\n  controlBox, updateControlBox\n};\n","\n/** @module component/transform */\n\n\nfunction transform(selection, tx, ty, tk) {\n  selection.select('.field')\n    .attr('transform', `translate(${tx}, ${ty}) scale(${tk})`);\n}\n\n\nfunction resize(selection, state) {\n  const area = selection.node();\n  const width = area.offsetWidth;\n  const height = area.offsetHeight;\n  selection.select('.view')\n      .attr('viewBox', `0 0 ${width} ${height}`)\n    .select('.boundary')\n      .attr('width', width)\n      .attr('height', height);\n  state.setViewBox(width, height);\n  state.resizeNotifier();\n}\n\n\nfunction viewFrame(selection, state) {\n  selection\n    .style('width', '100%')\n    .style('height', '100%');\n  selection.select('.view').remove(); // Clean up\n  selection.append('svg')\n    .classed('view', true);\n  selection.call(resize, state);\n}\n\n\nfunction view(selection, state) {\n  selection\n    .attr('preserveAspectRatio', 'xMinYMin meet')\n    .attr('pointer-events', 'all')\n    .attr('viewBox', `0 0 ${state.viewBox.right} ${state.viewBox.bottom}`)\n    .style('width', '100%')\n    .style('height', '100%');\n\n  // Clean up\n  selection.select('.boundary').remove();\n  selection.select('.field').remove();\n\n  // Boundary\n  selection.append('rect')\n      .classed('boundary', true)\n      .attr('x', 0)\n      .attr('y', 0)\n      .attr('width', state.viewBox.right)\n      .attr('height', state.viewBox.bottom)\n      .attr('fill', '#ffffff')\n      .attr('stroke-width', 1)\n      .attr('stroke', '#cccccc');\n  // Field\n  selection.append('g')\n      .classed('field', true)\n      .style('opacity', 1e-6)\n    .transition()\n      .duration(1000)\n      .style('opacity', 1);\n}\n\n\nexport default {\n  transform, resize, viewFrame, view\n};\n","\n/** @module tile/component */\n\nimport {default as scale} from '../common/scale.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as transform} from '../component/transform.js';\n\n\nfunction updateItems(selection, state) {\n  const itemsToRender = state.itemsToRender();\n  const items = selection.selectAll('.item')\n    .data(itemsToRender, d => d.index);\n  items.exit().remove();\n  const entered = items.enter()\n    .append('g')\n      .attr('class', 'item');\n  entered.append('rect')\n      .attr('class', 'tile')\n      .attr('x', 0)\n      .attr('y', 0)\n      .style('stroke-width', 1)\n      .style('stroke', '#cccccc');\n  entered.append('g')\n      .attr('class', 'tile-content');\n  entered.append('text')\n      .attr('class', 'tile-value');\n  const merged = entered.merge(items);\n  merged.select('.tile')\n      .attr('width', state.columnWidth)\n      .attr('height', state.rowHeight);\n  if (state.enableFocusedView) {\n    state.focusedView = itemsToRender.length < state.focusedViewThreshold;\n  }\n  if (state.focusedView && state.tileContent.visible) {\n    merged.select('.tile-content').html(d => d.structure);\n    merged.select('.tile-content')\n      .select('svg')\n        .attr('width', state.columnWidth)\n        .attr('height', state.rowHeight);\n  } else {\n    merged.select('.tile-content').select('svg').remove();\n  }\n  selection.call(updateItemAttrs, state);\n}\n\n\nfunction updateItemAttrs(selection, state) {\n  const colorConv = scale.scaleFunction(state.tileColor);\n  const valueColorConv = scale.scaleFunction(state.tileValueColor);\n  const items = selection.selectAll('.item')\n      .attr('transform', d => `translate(${d.x}, ${d.y})`);\n  items.select('.tile')\n      .style('fill', d => colorConv(d[state.tileColor.field]));\n  items.select('.tile-value')\n      .text(d => {\n        if (state.tileValue.field === null) return '';\n        const field = state.items.fields\n          .find(e => e.key === state.tileValue.field);\n        if (field.format === 'd3_format') {\n          return misc.formatNum(d[state.tileValue.field], field.d3_format);\n        }\n        return d[state.tileValue.field];\n      })\n      .attr('x', state.columnWidth * 0.05)\n      .attr('y', state.rowHeight * 0.75)\n      .attr('font-size', state.rowHeight * 0.5)\n      .attr('textLength', state.columnWidth * 0.9)\n      .attr('lengthAdjust', 'spacingAndGlyphs')\n      .attr('visibility', state.tileValue.visible ? 'inherit' : 'hidden')\n      .style('fill',\n        d => valueColorConv(d[state.tileValueColor.field]));\n}\n\n\nfunction tileView(selection, state) {\n  selection.call(transform.view, state);\n  const items = selection.select('.field')\n    .append('g').classed('tl-items', true);\n  state.updateFieldNotifier = () => {\n    state.setFieldSize();\n    items.call(updateItems, state);\n  };\n  state.updateItemNotifier = () => {\n    items.call(updateItems, state);\n  };\n  state.updateItemAttrNotifier = () => {\n    items.call(updateItemAttrs, state);\n  };\n  state.updateFieldNotifier();\n}\n\n\nexport default {\n  updateItems, updateItemAttrs, tileView\n};\n","\n/** @module tile/interaction */\n\nimport d3 from 'd3';\n\nimport {default as transform} from '../component/transform.js';\n\n\nfunction zoomListener(selection, state) {\n  return d3.zoom()\n    .scaleExtent(state.scaleExtent)\n    .translateExtent(state.translateExtent)\n    .on('zoom', function() {\n      const t = d3.event.transform;\n      selection.call(transform.transform, t.x, t.y, t.k);\n    })\n    .on('end', function() {\n      const t = d3.event.transform;\n      state.setTransform(t.x, t.y, t.k);\n      state.prevTransform = {x: t.x, y: t.y, k: t.k};\n      state.updateItemNotifier();\n    });\n}\n\n\nfunction setInteraction(selection, state) {\n  state.zoomListener = zoomListener(selection, state);\n  selection.call(state.zoomListener);\n  state.resizeNotifier = () => {\n    selection.call(setInteraction, state);\n    state.updateItemNotifier();\n  };\n  // Resume zoom event\n  const t = state.transform;\n  selection\n      .call(transform.transform, t.x, t.y, t.k)\n      .call(\n        d3.zoom().transform,\n        d3.zoomIdentity.translate(t.x, t.y).scale(t.k)\n      );\n}\n\n\nexport default {\n  zoomListener, setInteraction\n};\n","\n/** @module tile */\n\n\nimport TileState from './tile/state.js';\nimport {default as control} from './tile/controlBox.js';\nimport {default as component} from './tile/component.js';\nimport {default as interaction} from './tile/interaction.js';\n\n\nexport default {\n  TileState, control, component, interaction\n};\n","\n/** @module tile/state */\n\nimport _ from 'lodash';\n\nimport Collection from '../common/collection.js';\nimport TransformState from  '../common/transform.js';\nimport {default as idb} from '../common/idb.js';\n\n\nexport default class TileState extends TransformState {\n  constructor(view, items) {\n    super(1200, 800, view.fieldTransform);\n\n    /* Settings */\n\n    this.chunkMarginRatio = 0.05;\n\n    this.focusedViewThreshold = 200;\n    this.enableFocusedView = true;\n    this.focusedView = false;\n\n\n    /* Attributes */\n\n    this.viewID = view.viewID || null;\n    this.storeID = view.storeID || null;\n    this.name = view.name;\n\n    this.items = new Collection(items);\n    this.its = JSON.parse(JSON.stringify(this.items.records()));\n\n\n    /* Appearance */\n\n    this.rowCount = view.rowCount || 8;\n    this.columnCount = view.columnCount || 12;\n    this.groupField = view.groupField || null;\n    this.chunksPerRow = view.chunksPerRow || 1;\n    this.fixRowCount = view.fixRowCount || false;\n    this.fixColumnCount = view.fixColumnCount || false;\n    this.tileAspectRatio = 1;\n    this.showRowNumber = view.showRowNumber || false;\n    this.showColumnNumber = view.showColumnNumber || false;\n\n    /* Appearance */\n    const defaultTileField = this.items.fields[0].key || null;\n    const fillIfNull = (obj, updater) => {\n      Object.entries(updater).forEach(e => {\n        if (!obj.hasOwnProperty(e[0])) {\n          obj[e[0]] = e[1];\n        }\n      });\n    };\n\n    this.tileContent = {};\n    const defaultTileContent = {\n      field: null, visible: false\n    };\n    if (view.hasOwnProperty('tileContent')) {\n      this.tileContent = view.tileContent;\n    }\n    fillIfNull(this.tileContent, defaultTileContent);\n\n    this.tileColor = {};\n    const defaultTileColor = {\n      field: defaultTileField, color: 'monogray',\n      scale: 'linear', domain: [0, 1],\n      range: ['#7fffd4', '#7fffd4'], unknown: '#7fffd4'\n    };\n    if (view.hasOwnProperty('tileColor')) {\n      this.tileColor = view.tileColor;\n    }\n    fillIfNull(this.tileColor, defaultTileColor);\n\n    this.tileValue = {};\n    const defaultTileValue = {\n      field: null, size: 12, visible: false,\n      halign: 2, valign: 2\n    };\n    if (view.hasOwnProperty('tileValue')) {\n      this.tileValue = view.tileValue;\n    }\n    fillIfNull(this.tileValue, defaultTileValue);\n\n    this.tileValueColor = {};\n    const defaultTileValueColor = {\n      field: defaultTileField, color: 'monoblack',\n      scale: 'linear', domain: [0, 1],\n      range: ['#7fffd4', '#7fffd4'], unknown: '#7fffd4'\n    };\n    if (view.hasOwnProperty('tileValueColor')) {\n      this.tileValueColor = view.tileValueColor;\n    }\n    fillIfNull(this.tileValueColor, defaultTileValueColor);\n\n\n    // Drawing\n    this.scaleExtent = [1, Infinity];\n    this.translateExtent = [[0, 0], [this.fieldWidth, Infinity]];\n\n    this.chunkWidth = null;\n    this.chunkHeight = null;\n    this.chunkMarginH = null;\n    this.chunkMarginV = null;\n    this.columnWidth = null;\n    this.rowHeight = null;\n\n    // Event listener\n    this.zoomListener = null;\n\n    // Event notifiers\n    this.updateFieldNotifier = null;\n    this.updateItemNotifier = null;\n    this.updateItemAttrNotifier = null;\n  }\n\n  setViewBox(width, height) {\n    this.viewBox.right = width;\n    this.viewBox.bottom = height;\n    // this.showViewBox();  // debug\n    const vw = this.viewBox.right;\n    const bw = this.boundary.right - this.boundary.left;\n    this.scaleExtent = [vw / bw, Infinity];\n    this.translateExtent = [[0, 0], [bw, Infinity]];\n    this.setTransform(0, 0, vw / bw);\n    this.setFocusArea();\n  }\n\n  setCoords() {\n    this.its.forEach(item => {\n      const cRow = Math.floor(item.chunk / this.chunksPerRow);\n      const cCol = item.chunk % this.chunksPerRow;\n      item.x = this.chunkWidth * cCol + this.chunkMarginH * (cCol + 1) + this.columnWidth * item.col;\n      item.y = this.chunkHeight * cRow + this.chunkMarginV * (cRow + 1) + this.rowHeight * item.row;\n    });\n  }\n\n  setIndices() {\n    const tileCount = this.columnCount * this.rowCount;\n    let totalChunks = 0;\n    Object.entries(_.groupBy(this.its, this.groupBy))\n      .sort(group => group[0])\n      .forEach((group, i) => {\n        group[1].forEach((rcd, j) => {\n          const tileIdx = j % tileCount;\n          rcd.group = i;\n          rcd.chunk = Math.floor(j / tileCount) + totalChunks;\n          rcd.row = Math.floor(tileIdx / this.columnCount);\n          rcd.col = tileIdx % this.columnCount;\n        });\n        totalChunks += Math.ceil(group[1].length / tileCount);\n    });\n    this.setCoords();\n  }\n\n  setFieldSize() {\n    this.chunkWidth = this.fieldWidth /\n      (this.chunksPerRow + this.chunkMarginRatio * (this.chunksPerRow + 1));\n    this.chunkHeight = this.chunkWidth * this.tileAspectRatio;\n    this.chunkMarginH = this.chunkWidth * this.chunkMarginRatio;\n    this.chunkMarginV = this.chunkHeight * this.chunkMarginRatio;\n    this.columnWidth = this.chunkWidth / this.columnCount;\n    this.rowHeight = this.columnWidth * this.tileAspectRatio;\n    this.setIndices();\n  }\n\n  itemsToRender() {\n    return this.its.filter(\n      e => this.focusArea.top < e.y\n        && this.focusArea.left < e.x\n        && this.focusArea.bottom > e.y\n        && this.focusArea.right > e.x\n    );\n  }\n\n  save() {\n    return idb.updateItem(this.storeID, item => {\n      const i = item.items\n        .findIndex(e => e.collectionID === this.items.collectionID);\n      item.items[i] = this.items.export();\n      const vi = item.views.findIndex(e => e.viewID === this.viewID);\n      item.views[vi] = this.export();\n    });\n  }\n\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/tile_v1.0.json\",\n      viewID: this.viewID,\n      name: this.name,\n      viewType: \"tile\",\n      items: this.items.collectionID,\n      rowCount: this.rowCount,\n      columnCount: this.columnCount,\n      groupField: this.groupField,\n      chunksPerRow: this.chunksPerRow,\n      tileContent: this.tileContent,\n      tileColor: this.tileColor,\n      tileValue: this.tileValue,\n      tileValueColor: this.tileValueColor,\n      fieldTransform: this.transform\n    };\n  }\n}\n"],"names":["sortType","fmt","includes","formatNum","value","d3format","Number","isNaN","parseFloat","d3","format","partialMatch","query","target","toString","toUpperCase","indexOf","uuidv4","replace","c","r","Math","random","statusConv","Queued","In progress","Aborting","Aborted","Completed","Failure","dataTypeConv","datatable","connection","v07_to_v08_nodes","json","fields","columns","map","e","sort","id","name","dataType","schemaVersion","revision","status","records","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v10_nodes","reference","convertNetwork","data","edges","hasOwnProperty","nodes","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","key","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","forEach","i","index","_structure","_index","source","v08_graph","nodeContentVisible","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","params","v10_edges","$schema","convertPackage","now","Date","isNW","v08_nodes","width","height","convertTable","specs","views","dataset","push","collectionID","contents","workflowID","workflow","viewID","viewType","rows","sortOrder","filterText","checkpoints","type","date","description","networkThresholdCutoff","filter","view","minConnThld","currentConnThld","schema","items","idb","Dexie","getAllItems","orderBy","reverse","toArray","updateItem","storeID","updateFunc","where","equals","modify","catch","err","console","error","version","stores","reset","delete","then","getItem","first","importItem","legacy","misc","slice","sessionStarted","put","newDatagrid","response","toLocaleString","timeZone","deleteItem","getView","appendView","viewObj","item","pos","findIndex","splice","updateView","_","isFunction","deleteView","bin","Object","entries","entry","getCollection","collID","colls","coll","appendCollection","collObj","updateCollection","baseURL","get","url","q","keys","length","JSON","stringify","fetch","credentials","res","Promise","reject","Error","statusText","resolve","blob","post","formdata","method","body","serverStatus","server","singleToMulti","mapping","newMapping","m","mappingToTable","mp","concat","rcd","f","tableToMapping","table","ignore","row","csvToMapping","csvString","lines","split","header","shift","headerIdx","h","line","values","k","Array","apply","fd","uniqBy","Collection","[object Object]","this","autoIndex","content","addField","fs","mapper","flatten","command","fetcher","all","sum","some","min","TransformState","transform","fieldWidth","fieldHeight","viewBox","top","right","bottom","left","focusArea","focusAreaMargin","boundary","x","y","prevTransform","resizeNotifier","tx","ty","tk","margin","setFocusArea","vh","vw","vr","bh","bw","isPortrait","adjustH","adjustV","setTransform","select","colorScales","colors","schemePaired","schemeSet2","schemePastel2","schemeSet3","types","func","scaleLinear","scaleLog","scaleQuantize","scaleOrdinal","scaleFunction","state","cscale","color","mid","scaleFunc","clamp","d","result","undefined","numberBoxFloatValue","selection","property","textBox","classed","append","attr","updateTextBox","textBoxValue","readonlyBox","textareaBox","updateTextareaBox","updateTextareaPlaceholder","placeholder","textareaBoxValue","textareaBoxLines","checkBox","box","updateCheckBox","checked","checkBoxValue","numberBox","max","step","updateNumberBox","numberFloatValid","parseInt","valid","style","numberBoxIntValue","colorBox","on","event","stopPropagation","updateColorBox","colorBoxValue","fileInputBox","accept","clearFileInput","remove","fileInputBoxValue","monocolorBar","group","colorBar","monocolor","bicolor","call","grad","tricolor","categorical","sw","custom","setSize","checklistBoxValue","selectAll","setSelectedColorScale","selected","datum","shape","selectBox","selectBoxItems","options","exit","enter","updateSelectBox","selectBoxValue","checklistBox","checklistBoxItems","listitems","form","updateChecklistBox","each","anyChecked","colorScaleBox","dropdown","colorScaleBoxItems","dispatch","bubbles","updateColorScaleBox","colorScaleBoxValue","colorScaleBoxItem","rangeBoxValid","v","rangeBox","t","updateRangeBox","rangeBoxValues","colorRangeBox","updateColorRangeBox","colorRangeBoxValues","scaleBoxGroupValid","rbox","lbox","validScale","colorRangeGroup","collapse","updateColorRangeGroup","customRange","cs","rg","customScale","rtype","rboxValues","colorRangeGroupValue","colorScale","colorScaleType","scaleBoxGroup","updateScaleBoxGroup","scaleBoxGroupValue","colorControlBox","fieldName","updateColorControlBox","fieldOptions","colorState","colorControlValid","noScale","scaleValid","colorControlBoxState","sizeRangeValid","unk","validUnk","sizeControlValid","labelControlValid","sizeControlBox","updateSizeControlBox","sizeState","sizeControlBoxState","labelControlBox","labelGroup","updateLabelControlBox","labelState","labelControlBoxState","labelColor","controlBoxFrame","navID","contentID","controlBoxNav","controlBoxItem","mainControlBox","chunkGroup","updateMainControlBox","rowCount","columnCount","groupField","chunksPerRow","showColumnNumber","showRowNumber","updateFieldNotifier","updateTileColorControlBox","cbox","tileColor","uniq","updateItemAttrNotifier","updateTileValueControlBox","tileValue","tileValueColor","updateControlBox","resize","area","node","offsetWidth","offsetHeight","setViewBox","viewFrame","transition","duration","updateItems","itemsToRender","entered","merged","merge","columnWidth","rowHeight","enableFocusedView","focusedView","focusedViewThreshold","tileContent","html","updateItemAttrs","colorConv","valueColorConv","d3_format","zoomListener","zoom","scaleExtent","translateExtent","updateItemNotifier","TileState","super","chunkMarginRatio","its","parse","fixRowCount","fixColumnCount","tileAspectRatio","defaultTileField","fillIfNull","obj","updater","defaultTileColor","halign","valign","defaultTileValueColor","Infinity","chunkWidth","chunkHeight","chunkMarginH","chunkMarginV","cRow","floor","chunk","cCol","col","tileCount","totalChunks","groupBy","j","tileIdx","ceil","setCoords","setIndices","export","vi","control","controlBox","tabs","component","tileView","setFieldSize","interaction","setInteraction","zoomIdentity","translate"],"mappings":"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"}