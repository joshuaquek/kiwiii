{"version":3,"file":"kw-datagrid.js","sources":["../src/common/legacySchema.js","../src/common/misc.js","../src/common/idb.js","../src/common/fetcher.js","../src/common/mapper.js","../src/common/collection.js","../src/datagrid/component.js","../src/datagrid/rowFactory.js","../src/common/image.js","../src/component/formBox.js","../src/datagrid.js","../src/datagrid/state.js","../src/datagrid/rowFilter.js","../src/datagrid/sort.js"],"sourcesContent":["\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: [\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ],\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  data.fields.forEach(e => {\n    if (e.key === 'structure') {\n      e.format = 'svg';\n    }\n    delete e.width;\n    delete e.height;\n  });\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nfunction convertPackage(json) {\n  if (json.hasOwnProperty('views')) return json;\n  const now = new Date();\n  const isNW = json.hasOwnProperty('edges');\n  const data = isNW ? convertNetwork(json) : convertTable(json);\n  const nodes = isNW ? data.nodes : data;\n  const specs = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    name: data.edges.name,\n    views: [],\n    dataset: []\n  };\n  specs.dataset.push({\n    $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n    collectionID: nodes.id,\n    name: nodes.name,\n    contents: [{\n      $schema: nodes.$schema,\n      workflowID: nodes.reference.workflow,\n      name: nodes.name,\n      fields: nodes.fields,\n      records: nodes.records,\n      created: nodes.created,\n      status: nodes.status,\n      query: nodes.query,\n      execTime: nodes.execTime,\n      progress: nodes.progress\n    }]\n  });\n  specs.views.push({\n    $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n    viewID: nodes.id,\n    name: nodes.name,\n    viewType: \"datagrid\",\n    rows: nodes.id,\n    fields: nodes.fields,\n    sortOrder: null,\n    filterText: null,\n    checkpoints: [{\n      type: 'convert',\n      date: now.toString(),\n      description: 'converted from legacy format'\n    }]\n  });\n  if (isNW) {\n    specs.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: data.edges.id,\n      name: data.edges.name,\n      contents: [{\n        $schema: data.edges.$schema,\n        workflowID: data.edges.reference.workflow,\n        name: data.edges.name,\n        fields: data.edges.fields,\n        records: data.edges.records,\n        created: data.edges.created,\n        status: data.edges.status,\n        query: data.edges.query,\n        execTime: data.edges.execTime,\n        progress: data.edges.progress\n      }]\n    });\n    specs.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n      viewID: data.edges.id,\n      name: data.edges.name,\n      viewType: \"network\",\n      nodes: nodes.id,\n      edges: data.edges.id,\n      nodeColor: data.edges.snapshot.nodeColor,\n      nodeSize: data.edges.snapshot.nodeSize,\n      nodeLabel: data.edges.snapshot.nodeLabel,\n      nodeLabelColor: data.edges.snapshot.nodeLabelColor,\n      edgeWidth: data.edges.snapshot.edgeWidth,\n      edgeLabel: data.edges.snapshot.edgeLabel,\n      networkThreshold: data.edges.snapshot.networkThreshold,\n      networkThresholdCutoff: data.edges.snapshot.networkThresholdCutoff,\n      fieldTransform: data.edges.snapshot.fieldTransform,\n      coords: data.edges.snapshot.coords,\n      checkpoints: [{\n        type: 'convert',\n        date: now.toString(),\n        description: 'converted from legacy format'\n      }]\n    });\n  }\n  specs.views.filter(e => e.viewType === 'network')\n    .forEach(view => {\n      view.minConnThld = view.networkThresholdCutoff;\n      view.currentConnThld = view.networkThreshold;\n      if (view.hasOwnProperty('nodeLabel')) {\n        view.nodeLabel.field = view.nodeLabel.text;\n      }\n      if (view.hasOwnProperty('edgeLabel')) {\n        view.edgeLabel.field = 'weight';\n      }\n      if (view.hasOwnProperty('edgeWidth')) {\n        view.edgeWidth.field = 'weight';\n      }\n    });\n  return specs;\n}\n\n\nexport default {\n  convertPackage\n};\n","\n/** @module common/misc */\n\nimport d3 from 'd3';\n\n\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  sortType, formatNum, partialMatch, uuidv4\n};\n","\n/** @module common/idb */\n\nimport _ from 'lodash';\nimport Dexie from 'Dexie';\n\nimport {default as misc} from './misc.js';\nimport {default as legacy} from './legacySchema.js';\n\n// TODO: need package, view and dataset tables?\nconst schema = {\n  items: 'storeID, sessionStarted'\n};\n\nlet idb = new Dexie('Store');\nidb.version(1).stores(schema);\n\n\n/**\n * Delete all data store\n * Try this before dealing with local db issues\n */\nfunction reset() {\n  return idb.delete().then(() => {\n    idb = new Dexie('Store');\n    idb.version(1).stores(schema);\n  });\n}\n\n\n/**\n * Returns all data store items\n * @return {array} data store objects\n */\nfunction getAllItems() {\n  return idb.items\n    .orderBy('sessionStarted')\n    .reverse()\n    .toArray();\n}\n\n\n/**\n * Get data store items by store ID\n * @param {string} storeID - store ID\n * @return {array} data store object\n */\nfunction getItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .first()\n    .catch(err => {\n      console.error(`IDBError: Unexpected table ID: ${storeID}`, err);\n    });\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - storeID if sucessfully added\n */\nfunction importItem(data) {\n  // Legacy format converter\n  if (!data.hasOwnProperty('views')) {\n    data = legacy.convertPackage(data);\n  }\n  const now = new Date();\n  data.storeID = misc.uuidv4().slice(0, 8);\n  data.sessionStarted = now.toString();\n  return idb.items.put(data);\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} response - response data\n * @return {string} - viewID if sucessfully added\n */\nfunction newDatagrid(response) {\n  const now = new Date();\n  const date = now.toLocaleString('en-GB', { timeZone: 'Asia/Tokyo'});\n  const storeID = misc.uuidv4().slice(0, 8);\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  const data = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    storeID: storeID,\n    name: viewID,  // TODO: generate from response.query\n    views: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n        viewID: viewID,\n        name: viewID,  // TODO: generate from response.query\n        viewType: \"datagrid\",\n        rows: collectionID,\n        checkpoints: [\n          {type: 'creation', date: date}\n        ]\n      }\n    ],\n    dataset: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: collectionID,\n        contents: [response]\n      }\n    ],\n    sessionStarted: date\n  };\n  return idb.items.put(data)\n    .then(() => ({storeID: storeID, viewID:viewID}));\n}\n\n\n/**\n * Update data object in the store\n * @param {string} storeID - store ID\n * @param {function} updateFunc - update function\n * @return {integer} - number of updated items\n */\nfunction updateItem(storeID, updateFunc) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .modify(updateFunc)\n    .catch(err => {\n      console.error('IDBError: Update failed', err);\n    });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteItem(storeID) {\n  return idb.items\n    .where('storeID')\n    .equals(storeID)\n    .delete();\n}\n\n\n/**\n * Returns a view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @return {array} view objects\n */\nfunction getView(storeID, viewID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).views)\n    .then(views => {\n      const view = views.find(e => e.viewID === viewID);\n      if (!view) return;\n      view.storeID = storeID;\n      return view;\n    });\n}\n\n\n/**\n * Append a view next to a specific view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object\n */\nfunction appendView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos + 1, 0, viewObj);\n  });\n}\n\n\n/**\n * Update view\n * @param {string} storeID - store ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object or update function\n */\nfunction updateView(storeID, viewID, viewObj) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    if (_.isFunction(viewObj)) {\n      viewObj(item.views[pos]);\n    } else {\n      item.views[pos] = viewObj;\n    }\n  });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} storeID - store ID\n * @return {integer} - number of deleted items\n */\nfunction deleteView(storeID, viewID) {\n  return updateItem(storeID, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos, 1);\n    // prune orphaned collections\n    const bin = {};\n    item.dataset.forEach(e => { bin[e.collectionID] = 0; });\n    item.views.forEach(view => {\n      ['rows', 'items', 'nodes', 'edges']\n        .filter(e => view.hasOwnProperty(e))\n        .forEach(e => { bin[view[e]] += 1; });\n    });\n    Object.entries(bin).forEach(entry => {\n      if (!entry[1]) {\n        const i = item.dataset.findIndex(e => e.collectionID === entry[0]);\n        item.dataset.splice(i, 1);\n      }\n    });\n  });\n}\n\n\n/**\n * Returns a collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @return {array} Collection objects\n */\nfunction getCollection(storeID, collID) {\n  return getAllItems()\n    .then(items => items.find(e => e.storeID === storeID).dataset)\n    .then(colls => {\n      const coll = colls.find(e => e.collectionID === collID);\n      if (!coll) return;\n      coll.storeID = storeID;\n      return coll;\n    });\n}\n\n\n/**\n * Append a view next to a specific view\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @param {object} collObj - Collection object\n */\nfunction appendCollection(storeID, collID, collObj) {\n  return updateItem(storeID, item => {\n    const pos = item.dataset.findIndex(e => e.collectionID === collID);\n    item.dataset.splice(pos + 1, 0, collObj);\n  });\n}\n\n\n/**\n * Update collection\n * @param {string} storeID - store ID\n * @param {string} collID - Collection ID\n * @param {object} collObj - Collection object or update function\n */\nfunction updateCollection(storeID, collID, collObj) {\n  return updateItem(storeID, item => {\n    const pos = item.dataset.findIndex(e => e.collectionID === collID);\n    if (_.isFunction(collObj)) {\n      collObj(item.dataset[pos]);\n    } else {\n      item.dataset[pos] = collObj;\n    }\n  });\n}\n\n\nexport default {\n  reset, getAllItems, getItem, importItem, newDatagrid, updateItem, deleteItem,\n  getView, appendView, updateView, deleteView,\n  getCollection, appendCollection, updateCollection\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '../req/';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\nfunction serverStatus() {\n  const response = {};\n  return get('server')\n    .then(json)\n    .then(res => {\n      response.server = res;\n    })\n    .then(() => get('schema'))\n    .then(json)\n    .then(res => {\n      response.schema = res;\n    })\n    .then(() => response);\n}\n\n\nexport default {\n  get, json, text, blob, post, error, serverStatus\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: [keyField].concat(mp.fields),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: table.fields.filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key)),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: fields,\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(mp.fields)\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module common/collection */\n\nimport _ from 'lodash';\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as mapper} from './mapper.js';\n\n\nexport default class Collection {\n  /**\n   * Create Collection from a flashflood response datatable\n   * If data is not specified, put datatables later by this.append(data)\n   * @param {object} coll - Collection or response object\n   */\n  constructor(coll) {\n    // Settings\n    this.autoIndex = 'index';  // enumerate records\n\n    this.collectionID = coll.collectionID || null;\n    this.storeID = coll.storeID || null;\n    this.name = coll.name || null;\n    this.contents = coll.contents || [coll];\n    this.fields = [];\n    this.contents.forEach(content => {\n      content.fields.forEach(e => this.addField(e));\n    });\n  }\n\n  /**\n   * Add fields\n   * @param {array} fs - list of fields\n   */\n  addField(field) {\n    if (this.fields.find(e => e.key === field.key)) return;\n    if (!field.hasOwnProperty('name')) field.name = field.key;\n    if (!field.hasOwnProperty('visible')) field.visible = true;\n    if (field.hasOwnProperty('d3_format')) field.format = 'd3_format';\n    if (!field.hasOwnProperty('format')) field.format = 'raw';\n    this.fields.push(field);\n  }\n\n  /**\n   * Update fields properties\n   * @param {array} fs - list of fields\n   */\n  updateFields(fs) {\n    this.fields = [];\n    fs.forEach(e => this.addField(e));\n  }\n\n  /**\n   * Join fields\n   * @param {object} mapping - column mapper object\n   */\n  joinFields(mapping) {\n    this.contents.forEach(c => {\n      mapper.apply(c, mapping);\n    });\n    if (mapping.hasOwnProperty('fields')) {\n      mapping.fields.forEach(e => this.addField(e));\n    } else {\n      this.addField(mapping.field);\n    }\n  }\n\n  /**\n   * Return all records of the collection\n   * @return {array} records\n   */\n  records() {\n    return _.flatten(this.contents.map(e => e.records));\n  }\n\n  fetch(command) {\n    const fs = this.contents\n      .filter(e => ['running', 'ready', 'interrupted', 'queued'].includes(e.status))\n      .map(content => {\n        const query = {id: content.workflowID, command: command};\n        return fetcher.get('progress', query)\n          .then(fetcher.json)\n          .then(data => {\n            return idb.updateCollection(this.storeID, this.collectionID, coll => {\n              const i = coll.contents\n                .findIndex(e => e.workflowID === query.id);\n              if (data.status === 'failure') {  // No data found on server\n                coll.contents[i].status = 'failure';\n              } else {\n                coll.contents[i] = data;\n              }\n            });\n          });\n      });\n    return Promise.all(fs)\n      .then(() => idb.getCollection(this.storeID, this.collectionID))\n      .then(coll => {\n        this.contents = coll.contents;\n      });\n  }\n\n  /**\n   * Retrieve workflows and store it into a local store.\n   * @return {Promise}\n   */\n  pull() {\n    return this.fetch('pull');\n  }\n\n  /**\n   * Retrieve workflows, abort all ongoing workflow task\n   * and store it into a local store.\n   * @return {Promise}\n   */\n  abort() {\n    return this.fetch('abort');\n  }\n\n  /**\n   * Return total number of records\n   * @return {float} total number of records\n   */\n  size() {\n    return _.sum(this.contents.map(e => e.records.length));\n  }\n\n  /**\n   * Return status\n   * @return {string} status\n   */\n  status() {\n    if (this.contents.some(e => e.status === 'interrupted')) return 'interrupted';\n    if (this.contents.some(e => e.status === 'running')) return 'running';\n    if (this.contents.some(e => e.status === 'queued')) return 'queued';\n    if (this.contents.some(e => e.status === 'ready')) return 'ready';\n    if (this.contents.some(e => e.status === 'aborted')) return 'aborted';\n    if (this.contents.some(e => e.status === 'failure')) return 'failure';\n    return 'done';\n  }\n\n  /**\n   * Return ongoing or not\n   * @return {bool} ongoing or not\n   */\n  ongoing() {\n    const s = ['ready', 'queued', 'running', 'interrupted'];\n    return s.includes(this.status());\n  }\n\n  /**\n   * Return percentage of workflow progress\n   * @return {float} progress in percent\n   */\n  progress() {\n    return _.min(this.contents.map(e => e.progress));\n  }\n\n  /**\n   * Return total execution time\n   * @return {float} total time\n   */\n  execTime() {\n    return _.sum(this.contents.map(e => e.execTime));\n  }\n\n  /**\n   * Export collection object as JSON\n   * @return {object} collection JSON\n   */\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: this.collectionID,\n      name: this.name,\n      fields: this.fields,\n      contents: this.contents\n    };\n  }\n}\n","\n/** @module datagrid/component */\n\nimport d3 from 'd3';\n\n\nfunction headerCellRenderer(header) {\n  header.style('display', 'inline-block')\n    .style('width', d => `${d.width}%`)\n    .text(d => d.name);\n}\n\n\nfunction updateHeader(selection, state) {\n  const header = selection.select('.dg-header');\n  header.selectAll('.dg-hcell').remove();\n  header.selectAll('.dg-hcell').data(state.visibleFields)\n    .enter().append('div')\n      .classed('dg-hcell', true)\n      .call(state.headerCellRenderer);\n}\n\n\nfunction updateRows(selection, state) {\n  const rows = selection.select('.dg-body')\n    .selectAll('.dg-row')\n      .data(state.recordsToShow(), state.keyFunc);\n  rows.exit().remove();\n  rows.selectAll('.dg-cell').remove();\n  rows.enter()\n    .append('div')\n      .attr('class', 'dg-row')\n      .style('position', 'absolute')\n      .style('width', '100%')\n    .merge(rows)\n      .style('height', `${state.rowHeight}px`)\n      .each(function (d, i) {\n        const rowIndex = state.viewportTop + i;\n        const rowPos = rowIndex * state.rowHeight;\n        d3.select(this)\n          .style('transform', `translate(0px, ${rowPos}px)`)\n          .classed('odd', (rowIndex) % 2 === 0)\n          .call(state.rowFactory(), d);\n      });\n}\n\n\nfunction updateViewport(selection, state, scrollPos) {\n  selection.select('.dg-body').style('height', `${state.bodyHeight}px`);\n  state.setScrollPosition(scrollPos);\n  selection.call(updateRows, state, scrollPos);\n  selection.select('.dg-viewport').node().scrollTop = scrollPos * state.rowHeight;\n}\n\n\nfunction resize(selection, state) {\n  const viewport = selection.select('.dg-viewport');\n  const viewportTop = viewport.node().getBoundingClientRect().top;\n  state.resizeViewport(window.innerHeight - viewportTop - 5);\n  viewport.style('height', `${state.viewportHeight}px`);\n}\n\n\nfunction datagrid(selection, state) {\n  selection.append('div')\n      .classed('dg-header', true);\n  selection.append('div')\n      .classed('dg-viewport', true)\n      .style('overflow-y', 'auto')\n      .on('scroll', function () {\n        const pos = Math.floor(this.scrollTop / state.rowHeight);\n        if (pos !== state.previousViewportTop) {\n          state.setScrollPosition(pos);\n          selection.call(updateRows, state, pos);\n        }\n      })\n    .append('div')\n      .classed('dg-body', true)\n      .style('position', 'relative');\n  state.updateContentsNotifier = () => {\n    state.applyHeader();\n    selection.call(updateHeader, state);\n    selection.call(resize, state);\n    state.applyData();\n    selection.call(updateViewport, state, state.viewportTop);\n  };\n  state.updateFilterNotifier = value => {\n    state.setFilterText(value);\n    selection.call(updateViewport, state, 0);\n  };\n  state.updateContentsNotifier();  // TODO: remove\n}\n\n\n\nexport default {\n  headerCellRenderer, updateHeader, updateRows, updateViewport,\n  resize, datagrid\n};\n","\n/** @module datagrid/rowFactory */\n\nimport {default as misc} from '../common/misc.js';\nimport {default as img} from '../common/image.js';\n\n\nfunction d3Format(selection, record, field) {\n  selection.text(misc.formatNum(record[field.key], field.d3_format));\n}\n\n\nfunction text(selection, record, field) {\n  selection.text(record[field.key]);\n}\n\n\nfunction date(selection, record, field) {\n  // TODO; formatter\n  selection.text(record[field.key]);\n}\n\n\nfunction html(selection, record, field) {\n  selection.html(record[field.key]);\n}\n\n\nfunction compound_id(selection, record, field) {\n  selection.append('a')\n      .attr('href',`profile.html?compound=${record[field.key]}`)\n      .attr('target', '_blank')\n      .text(record[field.key]);\n}\n\n\nfunction image(selection, record, field) {\n  selection.append('img')\n      .attr('width', 180)\n      .attr('height', 180)\n      .attr('src', record[field.key]);\n}\n\nfunction checkbox(selection, record, field) {\n  selection.append('input')\n      .attr('type', 'checkbox')\n      .property('checked', record[field.key])\n      .property('disabled', field.disabled ? record[field.disabled] : false)\n      .on('click', function () {\n        record[field.key] = this.checked;\n      });\n}\n\nfunction textField(selection, record, field) {\n  selection.append('input')\n      .attr('type', 'text')\n      .style('width', '90%')\n      .property('value', record[field.key])\n      .on('change', function () {\n        record[field.key] = this.value;\n      });\n}\n\nfunction call(selection, value) {\n  selection.call(value);\n}\n\n\nconst cellFunc = {\n  numeric: text,\n  text: text,\n  date: date,\n  raw: text,\n  d3_format: d3Format,\n  compound_id: compound_id,\n  assay_id: text,\n  list: text,\n  plot: img.plotCell,\n  image: image,\n  checkbox: checkbox,\n  text_field: textField,\n  control: call,\n  svg: html,\n  html: html\n};\n\n\nfunction rowCell(selection) {\n  selection.classed('dg-cell', true)\n    .classed('align-middle', true)\n    .classed('text-truncate', true)\n    .style('display', 'inline-block');\n}\n\n\nfunction rowFactory(fields) {\n  return (selection, record) => {\n    fields.forEach(field => {\n      const cell = selection.append('div')\n          .call(rowCell)\n          .style('width', `${field.width}%`);\n      if (!record.hasOwnProperty(field.key)) return;\n      cell.call(cellFunc[field.format], record, field);\n    });\n  };\n}\n\n\nexport default {\n  d3Format, text, html, compound_id, image, checkbox, textField, call,\n  rowCell, rowFactory\n};\n","\n/** @module common/image */\n\nimport vega from 'vega';\n\n\nfunction plotCell(selection, record, field) {\n  new vega.View(vega.parse(record[field.key]))\n    .initialize(selection.node())\n    .run();\n}\n\n\nfunction plotThumbnail(vegaSpec) {\n  const view = new vega.View(vega.parse(vegaSpec));\n  return view.toImageURL('png');  // Promise\n}\n\n\nfunction binaryToDataURI(binary) {\n  return new Promise(resolve => {\n    const reader = new FileReader();\n    reader.onload = event => {\n      resolve(event.target.result);\n    };\n    reader.readAsDataURL(binary);\n  });\n}\n\n\nexport default {\n  plotCell, plotThumbnail, binaryToDataURI\n};\n","\n/** @module component/formBox */\n\n\nimport d3 from 'd3';\n\n\nfunction textBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text');\n}\n\nfunction updateTextBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction textBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction readonlyBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .property('readonly', true);\n}\n\n\nfunction textareaBox(selection, label, rows) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows);\n}\n\nfunction updateTextareaBox(selection, value) {\n  selection.select('textarea').property('value', value);\n}\n\nfunction updateTextareaPlaceholder(selection, placeholder) {\n  selection.select('textarea').attr('placeholder', placeholder);\n}\n\nfunction textareaBoxValue(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value;  // TODO: 0 is falsy\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder;\n  return '';\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n').filter(e => e.length > 0);\n  const placeholder = selection.select('textarea').attr('placeholder');\n  if (placeholder) return placeholder.split('\\n').filter(e => e.length > 0);\n  return [];\n}\n\n\nfunction checkBox(selection, label) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox');\n  box.append('span')\n      .text(label);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, label, min, max, step) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('align-items-center', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'number')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step);\n}\n\nfunction updateNumberBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\nfunction numberFloatValid(selection) {\n  const value = numberBoxFloatValue(selection);\n  const min = parseInt(selection.select('input').attr('min'));\n  const max = parseInt(selection.select('input').attr('max'));\n  const valid = !isNaN(value) && value >= min && value <= max;\n  selection.select('input')\n      .style('background-color', valid ? '#ffffff' : '#ffcccc');\n  return valid;\n}\n\nfunction numberBoxIntValue(selection) {\n  return parseInt(selection.select('input').property('value'));\n}\n\nfunction numberBoxFloatValue(selection) {\n  return parseFloat(selection.select('input').property('value'));\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n    .append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'color');\n}\n\n\nfunction updateColorBox(selection, value) {\n  selection.select('input').property('value', value);\n}\n\n\nfunction colorBoxValue(selection) {\n  return selection.select('input').property('value');\n}\n\n\nfunction fileInputBox(selection, label, accept) {\nselection\n    .classed('form-group', true)\n    .classed('form-row', true);\nselection.append('label')\n    .classed('col-form-label', true)\n    .classed('col-form-label-sm', true)\n    .classed('col-4', true)\n    .text(label);\nselection.append('input')\n    .classed('form-control', true)\n    .classed('form-control-sm', true)\n    .classed('form-control-file', true)\n    .classed('col-8', true)\n    .attr('type', 'file')\n    .attr('accept', accept);\n}\n\nfunction clearFileInput(selection) {\n  // TODO: FileList object (input.files) may be a readonly property\n  const accept = selection.select('input').attr();\n  selection.select('input').remove();\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('form-control-file', true)\n      .classed('col-8', true)\n      .attr('type', 'file')\n      .attr('accept', accept);\n}\n\nfunction fileInputBoxValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\n\nexport default {\n  textBox, updateTextBox, textBoxValue, readonlyBox,\n  textareaBox, updateTextareaBox, updateTextareaPlaceholder,\n  textareaBoxValue, textareaBoxLines,\n  checkBox, updateCheckBox, checkBoxValue,\n  numberBox, updateNumberBox, numberFloatValid,\n  numberBoxIntValue, numberBoxFloatValue,\n  colorBox, updateColorBox, colorBoxValue,\n  fileInputBox, clearFileInput, fileInputBoxValue\n};\n","\n/** @module datagrid */\n\nimport {default as legacy} from './common/legacySchema.js';\n\nimport DatagridState from './datagrid/state.js';\nimport {default as component} from './datagrid/component.js';\nimport {default as rowFilter} from './datagrid/rowFilter.js';\nimport {default as sort} from './datagrid/sort.js';\n\n\nexport default {\n  DatagridState, component, rowFilter, sort, legacy\n};\n","\n/** @module datagrid/state */\n\nimport _ from 'lodash';\n\nimport Collection from '../common/collection.js';\nimport {default as idb} from '../common/idb.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as component} from './component.js';\nimport {default as factory} from './rowFactory.js';\n\n\nexport default class DatagridState {\n  constructor(view, coll) {\n    this.storeID = view.storeID || null;\n    this.viewID = view.viewID || null;\n    this.name = view.name || null;\n    this.sortOrder = view.sortOrder || [];\n    this.filterText = view.filterText || null;\n    this.rows = new Collection(coll);\n\n    this.visibleFields = null;\n    this.sortedRecords = null;\n    this.filteredRecords = null;\n\n    // TODO: auto adjust\n    this.defaultColumnHeight = {\n      numeric: 40,\n      text: 40,\n      none: 200\n    };\n    this.scrollBarSpace = 20;\n    this.keyFunc = d => d.index;\n\n    // Size\n    this.rowHeight = null;\n    this.bodyHeight = null;\n\n    // Viewport\n    this.viewportHeight = null;\n    this.numViewportRows = null;\n    this.viewportTop = 0;\n    this.previousViewportTop = null;\n    this.viewportBottom = null;\n\n    this.fixedViewportHeight = null;\n\n    // Event notifier\n    this.updateContentsNotifier = null;\n    this.updateFilterNotifier = null;\n\n    this.headerCellRenderer = component.headerCellRenderer;\n    this.rowFactory = () => factory.rowFactory(this.visibleFields);\n  }\n\n  /**\n   * Set viewport height and number of rows to show\n   * @param {int} height - viewport height\n   */\n  setViewportSize(height) {\n    this.viewportHeight = this.fixedViewportHeight || height;\n  }\n\n  /**\n   * Set range of the row indices to show\n   * @param {int} position - Index of the top row to show\n   */\n  setScrollPosition(position) {\n    this.previousViewportTop = this.viewportTop;\n    this.viewportTop = position;\n    this.viewportBottom = Math.min(\n      this.viewportTop + this.numViewportRows, this.filteredRecords.length);\n  }\n\n  setNumViewportRows() {\n    this.numViewportRows = Math.ceil(this.viewportHeight / this.rowHeight) + 1;\n  }\n\n  resizeViewport(height) {\n    this.setViewportSize(height);\n    this.setNumViewportRows();\n  }\n\n  /**\n   * Apply header data\n   */\n  applyHeader() {\n    this.visibleFields = this.rows.fields.filter(e => e.visible);\n    const widthfSum = this.visibleFields.reduce((a, c) => a + (c.widthf || 1), 0);\n    this.visibleFields = this.visibleFields.map(e => {\n      const field = {\n        width: (e.widthf || 1) / widthfSum * 100,\n        height: e.height || this.defaultColumnHeight[misc.sortType(e.format)]\n      };\n      return Object.assign(field, e);\n    });\n    this.rowHeight = this.visibleFields\n      .reduce((a, b) => a.height > b.height ? a : b, 0).height;\n  }\n\n  /**\n   * Apply row data\n   * 1. applyHeader: define fields and set rowHeight\n   * 2. resize: measure actual window size and calc viewportHeight\n   * 3. applyData: calc number of rows from rowHeight and viewportHeight\n   * 4. setScrollPosition: calc row index range\n   * 5. recordsToShow: slice rows to show\n   */\n  applyData() {\n    this.setNumViewportRows();\n    this.applyOrder();\n  }\n\n  applyOrder(key, order) {\n    if (key) {\n      this.sortedRecords = _.orderBy(this.rows.records().slice(), [key], [order]);\n    } else {\n      const keys = this.sortOrder.map(e => e.key);\n      const orders = this.sortOrder.map(e => e.order);\n      if (keys) {\n        this.sortedRecords = _.orderBy(this.rows.records().slice(), keys, orders);\n      }\n    }\n    this.applyFilter();\n  }\n\n  applyFilter() {\n    if (this.filterText === null) {\n      this.filteredRecords = this.sortedRecords.slice();\n    } else {\n      const fields = this.visibleFields\n        .filter(e => misc.sortType(e.format) !== 'none')\n        .map(e => e.key);\n      this.filteredRecords = this.sortedRecords.filter(row => {\n        return fields.some(f => misc.partialMatch(this.filterText, row[f]));\n      });\n    }\n    this.bodyHeight = this.filteredRecords.length * this.rowHeight;\n  }\n\n  setSortOrder(key, order) {\n    const ki  = this.sortOrder.findIndex(e => e.key);\n    const obj = {key: key, order: order};\n    if (ki !== -1) this.sortOrder.splice(ki, 1);\n    this.sortOrder.splice(0, 0, obj);\n    this.applyOrder(key, order);\n  }\n\n  setFilterText(text) {\n    this.filterText = text;\n    this.applyFilter();\n  }\n\n  updateFields(fs) {\n    this.rows.updateFields(fs);\n  }\n\n  joinFields(mapping) {\n    this.rows.joinFields(mapping);\n    this.applyData();\n  }\n\n  recordsToShow() {\n    return this.filteredRecords.slice(this.viewportTop, this.viewportBottom);\n  }\n\n  save() {\n    return idb.updateItem(this.storeID, item => {\n      const ci = item.dataset\n        .findIndex(e => e.collectionID === this.rows.collectionID);\n      item.dataset[ci] = this.rows.export();\n      const vi = item.views.findIndex(e => e.viewID === this.viewID);\n      item.views[vi] = this.export();\n    });\n  }\n\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n      viewID: this.viewID,\n      name: this.name,\n      viewType: \"datagrid\",\n      rows: this.rows.collectionID,\n      sortOrder: this.sortOrder,\n      filterText: this.filterText\n    };\n  }\n}\n","\n/** @module datagrid/rowFilter */\n\nimport {default as box} from '../component/formBox.js';\n\n\nfunction setFilter(selection, state) {\n  const searchBox = selection\n      .classed('row', true)\n      .classed('justify-content-end', true)\n    .append('div')\n      .classed('col-5', true)\n      .call(box.textBox, 'Search');\n  searchBox.select('label').classed('text-right', true);\n  searchBox.select('input')\n    .on('keyup', function () {\n      state.updateFilterNotifier(box.textBoxValue(searchBox));\n    });\n}\n\n\nexport default {\n  setFilter\n};\n","\n/** @module datagrid/sort */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as component} from './component.js';\n\n\nfunction setSort(selection, state) {\n  state.headerCellRenderer = header => {\n    header.style('display', 'inline-block')\n      .style('width', d => `${d.width}%`)\n      .text(d => d.name)\n      .filter(d => misc.sortType(d.format) !== 'none')\n      .append('span').append('a')\n        .attr('id', d => `sort-${d.key}`)\n        .text('^v')\n        .style('display', 'inline-block')\n        .style('width', '30px')\n        .style('text-align', 'center')\n      .on('click', d => {\n        const isAsc = d3.select(`#sort-${d.key}`).text() === 'v';\n        d3.select(`#sort-${d.key}`).text(isAsc ? '^' : 'v');\n        state.setSortOrder(d.key, isAsc ? 'desc' : 'asc');\n        selection.call(component.updateRows, state);\n      });\n  };\n}\n\n\nexport default {\n  setSort\n};\n"],"names":["statusConv","Queued","In progress","Aborting","Aborted","Completed","Failure","dataTypeConv","datatable","connection","v07_to_v08_nodes","json","fields","columns","map","e","sort","format","id","name","dataType","schemaVersion","revision","status","records","query","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v10_nodes","reference","convertNetwork","data","edges","hasOwnProperty","nodes","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","key","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","forEach","i","index","_structure","_index","source","target","v08_graph","nodeContentVisible","d3","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","params","v10_edges","$schema","convertPackage","now","Date","isNW","v08_nodes","width","height","convertTable","specs","views","dataset","push","collectionID","contents","workflowID","workflow","viewID","viewType","rows","sortOrder","filterText","checkpoints","type","date","toString","description","networkThresholdCutoff","filter","view","minConnThld","currentConnThld","sortType","fmt","includes","formatNum","value","d3format","Number","isNaN","parseFloat","partialMatch","toUpperCase","indexOf","uuidv4","replace","c","r","Math","random","schema","items","idb","Dexie","getAllItems","orderBy","reverse","toArray","updateItem","storeID","updateFunc","where","equals","modify","catch","err","console","error","version","stores","reset","delete","then","getItem","first","importItem","legacy","misc","slice","sessionStarted","put","newDatagrid","response","toLocaleString","timeZone","deleteItem","getView","appendView","viewObj","item","pos","findIndex","splice","updateView","_","isFunction","deleteView","bin","Object","entries","entry","getCollection","collID","colls","coll","appendCollection","collObj","updateCollection","baseURL","get","url","q","keys","length","JSON","stringify","fetch","credentials","res","Promise","reject","Error","statusText","resolve","blob","post","formdata","method","body","serverStatus","server","singleToMulti","mapping","newMapping","m","mappingToTable","mp","concat","rcd","f","tableToMapping","table","ignore","row","csvToMapping","csvString","lines","split","header","shift","headerIdx","h","line","values","k","Array","apply","fd","uniqBy","Collection","[object Object]","this","autoIndex","content","addField","fs","mapper","flatten","command","fetcher","all","sum","some","min","updateHeader","selection","state","select","selectAll","remove","visibleFields","enter","append","classed","call","headerCellRenderer","updateRows","recordsToShow","keyFunc","exit","attr","style","merge","rowHeight","each","d","rowIndex","viewportTop","rowPos","rowFactory","updateViewport","scrollPos","bodyHeight","setScrollPosition","node","scrollTop","resize","viewport","getBoundingClientRect","top","resizeViewport","window","innerHeight","viewportHeight","datagrid","on","floor","previousViewportTop","updateContentsNotifier","applyHeader","applyData","updateFilterNotifier","setFilterText","d3Format","record","d3_format","html","compound_id","image","checkbox","property","disabled","checked","textField","cellFunc","numeric","raw","assay_id","list","plot","plotCell","vega","View","parse","initialize","run","plotThumbnail","vegaSpec","toImageURL","binaryToDataURI","binary","reader","FileReader","onload","event","result","readAsDataURL","text_field","control","svg","rowCell","cell","numberBoxFloatValue","textBox","updateTextBox","textBoxValue","readonlyBox","textareaBox","updateTextareaBox","updateTextareaPlaceholder","placeholder","textareaBoxValue","textareaBoxLines","checkBox","box","updateCheckBox","checkBoxValue","numberBox","max","step","updateNumberBox","numberFloatValid","parseInt","valid","numberBoxIntValue","colorBox","stopPropagation","updateColorBox","colorBoxValue","fileInputBox","accept","clearFileInput","fileInputBoxValue","DatagridState","sortedRecords","filteredRecords","defaultColumnHeight","none","scrollBarSpace","numViewportRows","viewportBottom","fixedViewportHeight","component","factory","position","ceil","setViewportSize","setNumViewportRows","widthfSum","reduce","a","widthf","assign","b","applyOrder","order","orders","applyFilter","ki","obj","updateFields","joinFields","ci","export","vi","rowFilter","setFilter","searchBox","setSort","isAsc","setSortOrder"],"mappings":"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"}