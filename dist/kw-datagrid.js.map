{"version":3,"file":"kw-datagrid.js","sources":["../src/common/legacySchema.js","../src/common/misc.js","../src/common/idb.js","../src/common/fetcher.js","../src/common/mapper.js","../src/common/collection.js","../src/datagrid/component.js","../src/datagrid/rowFactory.js","../src/common/image.js","../src/component/badge.js","../src/component/formBox.js","../src/datagrid.js","../src/datagrid/state.js","../src/datagrid/rowFilter.js","../src/datagrid/sort.js"],"sourcesContent":["\n/** @module common/legacySchema */\n\nimport d3 from 'd3';\n\n\nconst statusConv = {\n  Queued: 'ready',\n  'In progress': 'running',\n  Aborting: 'running',\n  Aborted: 'aborted',\n  Completed: 'done',\n  Failure: 'failure'\n};\n\nconst dataTypeConv = {\n  datatable: 'nodes',\n  connection: 'edges'\n};\n\nfunction v07_to_v08_nodes(json) {\n  const fields = json.columns.map(e => {\n    if (e.sort === 'numeric') {\n      e.format = 'numeric';\n    } else if (e.sort === 'text') {\n      e.format = 'text';\n    } else if (e.sort === 'none') {\n      e.format = 'raw';\n    }\n    return e;\n  });\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    status: statusConv[json.status],\n    fields: fields,\n    records: json.records,\n    query: json.query,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n  };\n}\n\nfunction v07_to_v08_edges(json, nodeFields) {\n  const snp = {\n    fieldTransform: json.snapshot.fieldTransform,\n    nodePositions: json.snapshot.nodePositions,\n    nodeColor: {},\n    nodeSize: {},\n    nodeLabel: {},\n    edge: {}\n  };\n  if (json.snapshot.hasOwnProperty('nodeColor')) {\n    snp.nodeColor.id = json.snapshot.nodeColor.id;\n    snp.nodeColor.scale = json.snapshot.nodeColor.scale;\n    snp.nodeColor.field = nodeFields.find(e => e.key === json.snapshot.nodeColor.column);\n  } else {\n    snp.nodeColor = {\n      id: 'color', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeSize')) {\n    snp.nodeSize.id = json.snapshot.nodeSize.id;\n    snp.nodeSize.scale = json.snapshot.nodeSize.scale;\n    snp.nodeSize.field = nodeFields.find(e => e.key === json.snapshot.nodeSize.column);\n  } else {\n    snp.nodeSize = {\n      id: 'size', field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: [20, 20], unknown: 20}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeLabel')) {\n    snp.nodeLabel.id = json.snapshot.nodeLabel.id;\n    snp.nodeLabel.size = json.snapshot.nodeLabel.size;\n    snp.nodeLabel.text = json.snapshot.nodeLabel.text;\n    snp.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n    snp.nodeLabel.scale = json.snapshot.nodeLabel.scale;\n    snp.nodeLabel.field = nodeFields.find(e => e.key === json.snapshot.nodeLabel.column);\n  } else {\n    snp.nodeLabel = {\n      id: 'label', size: 12, text: 'index', visible: false, field: nodeFields[0],\n      scale: {scale: 'linear', domain: [0, 1], range: ['black', 'white'], unknown: 'gray'}\n    };\n  }\n  if (json.snapshot.hasOwnProperty('nodeContent')) {\n    snp.nodeContent = json.snapshot.nodeContent;\n  } else {\n    snp.nodeContent = {structure: {visible: false}};\n  }\n  if (json.snapshot.hasOwnProperty('edge')) {\n    snp.edge = json.snapshot.edge;\n  } else {\n    snp.edge = {\n      id: 'label', label: {size: 10, visible: false}, visible: true,\n      scale: {scale: 'linear', domain: [0, 1], range: [5, 5], unknown: 5}\n    };\n  }\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: dataTypeConv[json.format],\n    schemaVersion: 0.8,\n    revision: 0,\n    reference: {\n      nodes: json.nodeTableId\n    },\n    status: statusConv[json.status],\n    fields: [\n      {'key': 'source'},\n      {'key': 'target'},\n      {'key': 'weight'}\n    ],\n    records: json.records,\n    query: json.query,\n    networkThreshold: json.networkThreshold,\n    taskCount: json.searchCount,\n    doneCount: json.searchDoneCount | json.searchCount,\n    resultCount: json.recordCount,\n    progress: json.progress | 100,\n    execTime: json.execTime,\n    created: json.startDate | json.responseDate,\n    snapshot: snp\n  };\n}\n\n\nfunction v08_nodes(json) {\n  json.records.forEach((e, i) => {\n    e.index = i;\n    e.structure = e._structure;\n    delete e._index;\n    delete e._structure;\n  });\n  json.fields.forEach(e => {\n    if (e.key === '_index') e.key = 'index';\n    if (e.key === '_structure') e.key = 'structure';\n    if (e.sort === 'numeric') e.format = 'numeric';\n    if (e.sort === 'text') e.format = 'text';\n    if (e.sort === 'none') e.format = 'raw';\n  });\n  return json;\n}\n\nfunction v08_graph(json) {\n  if (!json.edges.hasOwnProperty('reference')) { // ver0.8.0-0.8.1\n    json.edges.reference = {nodes: json.edges.nodesID};\n  }\n  if (json.nodes.fields.find(e => e.key === '_index')) {\n    const idx_converter = {};\n    json.nodes.records.forEach((e, i) => {\n        e.index = i;\n        e.structure = e._structure;\n        idx_converter[e._index] = e.index;\n        delete e._index;\n        delete e._structure;\n    });\n    json.edges.records.forEach(e => {\n        e.source = idx_converter[e.source];\n        e.target = idx_converter[e.target];\n    });\n    json.nodes.fields.forEach(e => {\n      if (e.key === '_index') e.key = 'index';\n      if (e.key === '_structure') e.key = 'structure';\n      if (e.sort === 'numeric') e.format = 'numeric';\n      if (e.sort === 'text') e.format = 'text';\n      if (e.sort === 'none') e.format = 'raw';\n    });\n  }\n  return json;\n}\n\nfunction v10_nodes(json) {\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: json.query,\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    reference: {}\n  };\n}\n\n\nfunction v10_edges(json) {\n  const snapshot = {\n    networkThreshold: json.networkThreshold\n  };\n  snapshot.nodeContentVisible = json.snapshot.nodeContent.structure.visible;\n  snapshot.nodeColor = json.snapshot.nodeColor.scale || {};\n  if (snapshot.nodeColor.field) {\n    snapshot.nodeColor.field = json.snapshot.nodeColor.field.key;\n    if (snapshot.nodeColor.field === '_index') {\n      snapshot.nodeColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeColor.scale === 'ordinal') {\n    snapshot.nodeColor.range = d3.schemeCategory20;\n  }\n  snapshot.nodeSize = json.snapshot.nodeSize.scale || {};\n  if (json.snapshot.nodeSize.field) {\n    snapshot.nodeSize.field = json.snapshot.nodeSize.field.key;\n    if (snapshot.nodeSize.field === '_index') {\n      snapshot.nodeSize.field = 'index';\n    }\n  }\n  snapshot.nodeLabel = {};\n  if (json.snapshot.nodeLabel.text) {\n    snapshot.nodeLabel.text = json.snapshot.nodeLabel.text.key;\n    if (snapshot.nodeLabel.text === '_index') {\n      snapshot.nodeLabel.text = 'index';\n    }\n  }\n  snapshot.nodeLabel.size = json.snapshot.nodeLabel.size;\n  snapshot.nodeLabel.visible = json.snapshot.nodeLabel.visible;\n  snapshot.nodeLabelColor = json.snapshot.nodeLabel.scale || {};\n  if (json.snapshot.nodeLabel.field) {\n    snapshot.nodeLabelColor.field = json.snapshot.nodeLabel.field.key;\n    if (snapshot.nodeLabelColor.field === '_index') {\n      snapshot.nodeLabelColor.field = 'index';\n    }\n  }\n  if (snapshot.nodeLabelColor.scale === 'ordinal') {\n    snapshot.nodeLabelColor.range = d3.schemeCategory20;\n  }\n  snapshot.edgeVisible = json.snapshot.edge.visible;\n  snapshot.edgeWidth = json.snapshot.edge.scale || {};\n  snapshot.edgeLabel = {};\n  snapshot.edgeLabel.size = json.snapshot.edge.label.size;\n  snapshot.edgeLabel.visible = json.snapshot.edge.label.visible;\n  snapshot.networkThreshold = json.networkThreshold || json.query.threshold;\n  snapshot.coords = json.snapshot.nodePositions;\n  // TODO: when created date is lost\n  return {\n    id: json.id,\n    name: json.name,\n    dataType: json.dataType,\n    schemaVersion: '0.10',\n    revision: json.revision,\n    status: json.status,\n    fields: json.fields,\n    records: json.records,\n    query: {params: json.query},\n    progress: json.progress,\n    execTime: json.execTime,\n    created: json.created,\n    snapshot: snapshot,\n    reference: json.reference\n  };\n}\n\nfunction convertTable(json) {\n  let data = json;\n  if (!(data.hasOwnProperty('schemaVersion') || data.hasOwnProperty('$schema'))) { // v0.7\n    data = v07_to_v08_nodes(data);\n  }\n  if (data.schemaVersion == '0.8') {\n    data = v08_nodes(data);\n    data = v10_nodes(data);\n  }\n  if (!data.hasOwnProperty('$schema')) {\n    delete data.schemaVersion;\n    delete data.revision;\n    data.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  data.fields.forEach(e => {\n    if (e.key === 'structure') {\n      e.format = 'svg';\n    }\n    delete e.width;\n    delete e.height;\n  });\n  return data;\n}\n\nfunction convertNetwork(json) {\n  let data = json;\n  if (!(data.edges.hasOwnProperty('schemaVersion') || data.edges.hasOwnProperty('$schema'))) { // v0.7\n    data.nodes = v07_to_v08_nodes(data.nodes);\n    data.edges = v07_to_v08_edges(data.edges, data.nodes.fields);\n  }\n  if (data.edges.schemaVersion == '0.8' || data.edges.schemaVersion === 0.1) {  // wrong conversion of '0.10'\n    data = v08_graph(data);\n    data.nodes = v10_nodes(data.nodes);\n    data.edges = v10_edges(data.edges);\n  }\n  if (!data.edges.hasOwnProperty('$schema')) {\n    delete data.nodes.schemaVersion;\n    delete data.edges.schemaVersion;\n    delete data.nodes.revision;\n    delete data.edges.revision;\n    data.nodes.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n    data.edges.$schema = \"https://mojaie.github.io/flashflood/_static/specs/job_result_v1.0.json\";\n  }\n  return data;\n}\n\n\nfunction convertPackage(json) {\n  let specs = {};\n  if (!json.hasOwnProperty('views')) {\n    const now = new Date();\n    const isNW = json.hasOwnProperty('edges');\n    const data = isNW ? convertNetwork(json) : convertTable(json);\n    const nodes = isNW ? data.nodes : data;\n    specs = {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n      name: data.edges.name,\n      views: [],\n      dataset: []\n    };\n    specs.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: nodes.id,\n      name: nodes.name,\n      contents: [{\n        $schema: nodes.$schema,\n        workflowID: nodes.reference.workflow,\n        name: nodes.name,\n        fields: nodes.fields,\n        records: nodes.records,\n        created: nodes.created,\n        status: nodes.status,\n        query: nodes.query,\n        execTime: nodes.execTime,\n        progress: nodes.progress\n      }]\n    });\n    specs.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n      viewID: nodes.id,\n      name: nodes.name,\n      viewType: \"datagrid\",\n      rows: nodes.id,\n      fields: nodes.fields,\n      sortOrder: null,\n      filterText: null,\n      checkpoints: [{\n        type: 'convert',\n        date: now.toString(),\n        description: 'converted from legacy format'\n      }]\n    });\n    if (isNW) {\n      specs.dataset.push({\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: data.edges.id,\n        name: data.edges.name,\n        contents: [{\n          $schema: data.edges.$schema,\n          workflowID: data.edges.reference.workflow,\n          name: data.edges.name,\n          fields: data.edges.fields,\n          records: data.edges.records,\n          created: data.edges.created,\n          status: data.edges.status,\n          query: data.edges.query,\n          execTime: data.edges.execTime,\n          progress: data.edges.progress\n        }]\n      });\n      specs.views.push({\n        $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n        viewID: data.edges.id,\n        name: data.edges.name,\n        viewType: \"network\",\n        nodes: nodes.id,\n        edges: data.edges.id,\n        nodeColor: data.edges.snapshot.nodeColor,\n        nodeSize: data.edges.snapshot.nodeSize,\n        nodeLabel: data.edges.snapshot.nodeLabel,\n        nodeLabelColor: data.edges.snapshot.nodeLabelColor,\n        edgeWidth: data.edges.snapshot.edgeWidth,\n        edgeLabel: data.edges.snapshot.edgeLabel,\n        networkThreshold: data.edges.snapshot.networkThreshold,\n        networkThresholdCutoff: data.edges.snapshot.networkThresholdCutoff,\n        fieldTransform: data.edges.snapshot.fieldTransform,\n        coords: data.edges.snapshot.coords,\n        checkpoints: [{\n          type: 'convert',\n          date: now.toString(),\n          description: 'converted from legacy format'\n        }]\n      });\n    }\n    specs.views.filter(e => e.viewType === 'network')\n      .forEach(view => {\n        view.minConnThld = view.networkThresholdCutoff;\n        view.currentConnThld = view.networkThreshold;\n        if (view.hasOwnProperty('nodeLabel')) {\n          view.nodeLabel.field = view.nodeLabel.text;\n        }\n        if (view.hasOwnProperty('edgeLabel')) {\n          view.edgeLabel.field = 'weight';\n        }\n        if (view.hasOwnProperty('edgeWidth')) {\n          view.edgeWidth.field = 'weight';\n        }\n      });\n  } else {\n    specs = json;\n  }\n  specs.views.filter(e => e.viewType === 'network')\n    .forEach(view => {\n      if (!view.nodeColor.field) { view.nodeColor.field = 'index' ;}\n      if (!view.nodeSize.field) { view.nodeSize.field = 'index' ;}\n      if (!view.nodeLabel.field) { view.nodeLabel.field = 'index' ;}\n      if (!view.nodeLabelColor.field) { view.nodeLabelColor.field = 'index' ;}\n      if (!view.edgeColor) {\n        view.edgeColor = {\n          field: 'weight', color: 'monogray',\n          scale: 'linear', domain: [0, 1],\n          range: ['#999999', '#999999'], unknown: '#cccccc'\n        };\n      } else if (!view.edgeColor.field) { view.edgeColor.field = 'weight' ;}\n      if (!view.edgeWidth.field) { view.edgeWidth.field = 'weight' ;}\n      if (!view.edgeLabel.field) { view.edgeLabel.field = 'weight' ;}\n      if (!view.edgeLabelColor) {\n        view.edgeLabelColor = {\n          field: 'weight', color: 'monoblack',\n          scale: 'linear', domain: [1, 1],\n          range: ['#333333', '#333333'], unknown: '#cccccc'\n        };\n      } else if (!view.edgeLabelColor.field) { view.edgeLabelColor.field = 'weight' ;}\n    });\n  return specs;\n}\n\n\nexport default {\n  convertPackage\n};\n","\n/** @module common/misc */\n\nimport d3 from 'd3';\n\n\n// TODO: re-define\nfunction sortType(fmt) {\n  if (['numeric', 'd3_format'].includes(fmt)) return 'numeric';\n  if (['text', 'compound_id', 'assay_id', 'list'].includes(fmt)) return 'text';\n  if (['text_field', 'checkbox', 'html'].includes(fmt)) return 'html';\n  return 'none';\n}\n\n\n/**\n * Format number\n * @param {object} value - value\n * @param {string} type - si | scientific | rounded | raw\n */\nfunction formatNum(value, d3format) {\n  if (value === undefined || value === null || Number.isNaN(value)) return '';\n  return value == parseFloat(value) ? d3.format(d3format)(value) : value;\n}\n\n\nfunction partialMatch(query, target) {\n  if (target === undefined || target === null || target === '') return false;\n  return target.toString().toUpperCase()\n    .indexOf(query.toString().toUpperCase()) !== -1;\n}\n\n\n// Ref. https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n\nexport default {\n  sortType, formatNum, partialMatch, uuidv4\n};\n","\n/** @module common/idb */\n\nimport _ from 'lodash';\n\nimport {default as misc} from './misc.js';\nimport {default as legacy} from './legacySchema.js';\n\n\n// Increment versions if IDB schema has updated.\nconst pkgStoreVersion = 2;\nconst assetStoreVersion = 1;\n\n\nfunction connect(name, version, createObj) {\n  return new Promise((resolve, reject) => {\n    const request = window.indexedDB.open(name, version);\n    request.onsuccess = function () {\n      resolve(this.result);\n    };\n    request.onerror = event => reject(event);\n    request.onupgradeneeded = event => {\n      createObj(event.currentTarget.result);\n    };\n  });\n}\n\n\nconst instance = {\n  pkgs: connect(\"Packages\", pkgStoreVersion, db => {\n    db.createObjectStore(\"Packages\", {keyPath: 'id'});\n  }),\n  assets: connect(\"Assets\", assetStoreVersion, db => {\n    db.createObjectStore(\"Assets\", {keyPath: 'key'});\n  })\n};\n\n\n/**\n * Clear database\n * @param {string} dbid - database ID\n */\nfunction clear(dbid) {\n  return new Promise((resolve, reject) => {\n    return instance[dbid].then(db => {\n      const req = db.transaction(db.name, 'readwrite')\n          .objectStore(db.name).clear();\n        req.onsuccess = () => resolve();\n        req.onerror = event => reject(event);\n    });\n  });\n}\n\n\n/**\n * Delete all data in the local storage\n */\nfunction clearAll() {\n  return Promise.all([clear('pkgs'), clear('assets')]);\n}\n\n\n/**\n * Returns all packages\n * @return {Promise} Promise of list of packages\n */\nfunction getAllItems() {\n  return new Promise(resolve => {\n    const res = [];\n    return instance.pkgs.then(db => {\n      db.transaction(db.name)\n        .objectStore(db.name).openCursor()\n        .onsuccess = event => {\n          const cursor = event.target.result;\n          if (cursor) {\n            res.push(cursor.value);\n            cursor.continue();\n          } else {\n            resolve(res);\n          }\n        };\n    });\n  });\n}\n\n\n/**\n * Get packages by instance ID\n * @param {string} id - Package instance ID\n * @return {array} data store object\n */\nfunction getItem(id) {\n  return new Promise((resolve, reject) => {\n    return instance.pkgs.then(db => {\n      const req = db.transaction(db.name)\n        .objectStore(db.name).get(id);\n      req.onsuccess = event => resolve(event.target.result);\n      req.onerror = event => reject(event);\n    });\n  });\n}\n\n\n/**\n * Put data object in the store\n * @param {string} value - value to store\n */\nfunction putItem(value) {\n  return new Promise((resolve, reject) => {\n    return instance.pkgs.then(db => {\n      const obj = db.transaction(db.name, 'readwrite')\n        .objectStore(db.name);\n      const req = obj.put(value);\n      req.onerror = event => reject(event);\n      req.onsuccess = () => resolve();\n    });\n  });\n}\n\n\n/**\n * Update package in the store\n * @param {string} id - Package instance ID\n * @param {function} updater - update function\n */\nfunction updateItem(id, updater) {\n  return new Promise((resolve, reject) => {\n    return instance.pkgs.then(db => {\n      const obj = db.transaction(db.name, 'readwrite')\n        .objectStore(db.name);\n      const req = obj.get(id);\n      req.onerror = event => reject(event);\n      req.onsuccess = event => {\n        const res = event.target.result;\n        updater(res);\n        const upd = obj.put(res);\n        upd.onsuccess = () => resolve();\n        upd.onerror = event => reject(event);\n      };\n    });\n  });\n}\n\n\n/**\n * Delete a package\n * @param {string} id - Package instance ID\n */\nfunction deleteItem(id) {\n  return new Promise((resolve, reject) => {\n    return instance.pkgs.then(db => {\n      const req = db.transaction(db.name, 'readwrite')\n        .objectStore(db.name).delete(id);\n      req.onerror = event => reject(event);\n      req.onsuccess = () => resolve();\n    });\n  });\n}\n\n\n/**\n * Returns a view\n * @param {string} id - Package instance ID\n * @param {string} viewID - view ID\n * @return {array} view objects\n */\nfunction getView(id, viewID) {\n  return getItem(id)\n    .then(pkg => pkg.views.find(e => e.viewID === viewID));\n}\n\n\n/**\n * Append a view next to a specific view\n * @param {string} id - Package instance ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object\n */\nfunction appendView(id, viewID, viewObj) {\n  return updateItem(id, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos + 1, 0, viewObj);\n  });\n}\n\n\n/**\n * Update view\n * @param {string} id - Package instance ID\n * @param {string} viewID - view ID\n * @param {object} viewObj - view object or update function\n */\nfunction updateView(id, viewID, viewObj) {\n  return updateItem(id, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    if (_.isFunction(viewObj)) {\n      viewObj(item.views[pos]);\n    } else {\n      item.views[pos] = viewObj;\n    }\n  });\n}\n\n\n/**\n * Delete a data object from the store\n * @param {string} id - Package instance ID\n * @return {integer} - number of deleted items\n */\nfunction deleteView(id, viewID) {\n  return updateItem(id, item => {\n    const pos = item.views.findIndex(e => e.viewID === viewID);\n    item.views.splice(pos, 1);\n    // prune orphaned collections\n    const bin = {};\n    item.dataset.forEach(e => { bin[e.collectionID] = 0; });\n    item.views.forEach(view => {\n      ['rows', 'items', 'nodes', 'edges']\n        .filter(e => view.hasOwnProperty(e))\n        .forEach(e => { bin[view[e]] += 1; });\n    });\n    Object.entries(bin).forEach(entry => {\n      if (!entry[1]) {\n        const i = item.dataset.findIndex(e => e.collectionID === entry[0]);\n        item.dataset.splice(i, 1);\n      }\n    });\n  });\n}\n\n\n/**\n * Returns all collections in the store\n * @return {array} Collection objects\n */\nfunction getAllCollections() {\n  return getAllItems()\n    .then(items => _.flatten(\n      items.map(item => {\n        return item.dataset.map(coll => {\n          coll.instance = item.id;\n          return coll;\n        });\n      })\n    ));\n}\n\n\n/**\n * Returns a collection\n * @param {string} id - Package instance ID\n * @param {string} collID - Collection ID\n * @return {array} Collection objects\n */\nfunction getCollection(id, collID) {\n  return getItem(id)\n    .then(pkg => pkg.dataset.find(e => e.collectionID === collID));\n}\n\n\nfunction addCollection(id, collID, collObj) {\n  return updateItem(id, item => {\n    item.dataset.push(collObj);\n  });\n}\n\n/**\n * Update collection\n * @param {string} id - Package instance ID\n * @param {string} collID - Collection ID\n * @param {object} collObj - Collection object or update function\n */\nfunction updateCollection(id, collID, collObj) {\n  return updateItem(id, item => {\n    const pos = item.dataset.findIndex(e => e.collectionID === collID);\n    if (_.isFunction(collObj)) {\n      collObj(item.dataset[pos]);\n    } else {\n      item.dataset[pos] = collObj;\n    }\n  });\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} data - data\n * @return {string} - id if sucessfully added\n */\nfunction importItem(data) {\n  // Legacy format converter\n  data = legacy.convertPackage(data);\n\n  const now = new Date();\n  data.id = misc.uuidv4().slice(0, 8);\n  data.sessionStarted = now.toString();\n  return putItem(data);\n}\n\n\n/**\n * Insert a data object to the store\n * @param {object} response - response data\n * @return {string} - viewID if sucessfully added\n */\nfunction newDatagrid(response) {\n  const now = new Date();\n  const date = now.toLocaleString('en-GB', { timeZone: 'Asia/Tokyo'});\n  const instance = misc.uuidv4().slice(0, 8);\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  const data = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    id: instance,\n    name: response.name,\n    views: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n        viewID: viewID,\n        name: response.name,\n        viewType: \"datagrid\",\n        rows: collectionID,\n        checkpoints: [\n          {type: 'creation', date: date}\n        ]\n      }\n    ],\n    dataset: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: collectionID,\n        name: response.name,\n        contents: [response]\n      }\n    ],\n    sessionStarted: date\n  };\n  return putItem(data)\n    .then(() => ({instance: instance, viewID:viewID}));\n}\n\n\nfunction addDatagrid(instance, response) {\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  return updateItem(instance, item => {\n    item.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n      viewID: viewID,\n      name: response.name,\n      viewType: \"datagrid\",\n      rows: collectionID,\n    });\n    item.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: collectionID,\n      name: response.name,\n      contents: [response]\n    });\n  }).then(() => viewID);\n}\n\n\nfunction new384Tiles(response) {\n  const now = new Date();\n  const date = now.toLocaleString('en-GB', { timeZone: 'Asia/Tokyo'});\n  const instance = misc.uuidv4().slice(0, 8);\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  const data = {\n    $schema: \"https://mojaie.github.io/kiwiii/specs/package_v1.0.json\",\n    id: instance,\n    name: response.name,\n    views: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/tile_v1.0.json\",\n        viewID: viewID,\n        name: `${response.name}_tiles`,\n        viewType: 'tile',\n        items: collectionID,\n        rowCount: 16,\n        columnCount: 24\n      }\n    ],\n    dataset: [\n      {\n        $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n        collectionID: collectionID,\n        name: response.name,\n        contents: [response]\n      }\n    ],\n    sessionStarted: date\n  };\n  return putItem(data)\n    .then(() => ({instance: instance, viewID:viewID}));\n}\n\n\nfunction add384Tiles(instance, response) {\n  const viewID = misc.uuidv4().slice(0, 8);\n  const collectionID = response.workflowID.slice(0, 8);\n  return updateItem(instance, item => {\n    item.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/tile_v1.0.json\",\n      viewID: viewID,\n      name: `${response.name}_tiles`,\n      viewType: 'tile',\n      items: collectionID,\n      rowCount: 16,\n      columnCount: 24,\n      chunksPerRow: 10\n    });\n    item.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: collectionID,\n      name: response.name,\n      contents: [response]\n    });\n  }).then(() => viewID);\n}\n\n\n/**\n * Store new network view\n * @param {string} instance - Package instance ID\n * @param {string} nodesID - ID of nodes collection\n * @param {string} nodesName - Name of nodes collection\n * @param {object} response - Response object\n */\nfunction newNetwork(instance, nodesID, nodesName, response) {\n  const viewID = misc.uuidv4().slice(0, 8);\n  const edgesID = response.workflowID.slice(0, 8);\n  return updateItem(instance, item => {\n    item.views.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/network_v1.0.json\",\n      viewID: viewID,\n      name: `${nodesName}_${response.name}`,\n      viewType: 'network',\n      nodes: nodesID,\n      edges: edgesID,\n      minConnThld: response.query.params.threshold\n    });\n    item.dataset.push({\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: edgesID,\n      name: response.name,\n      contents: [response]\n    });\n  }).then(() => viewID);\n}\n\n\n/**\n * Get asset by a key\n * @param {string} key - key\n * @return {array} asset object (if not found, resolve with undefined)\n */\nfunction getAsset(key) {\n  return new Promise((resolve, reject) => {\n    return instance.assets.then(db => {\n      const req = db.transaction(db.name)\n        .objectStore(db.name).get(key);\n      req.onsuccess = event => {\n        const undef = event.target.result === undefined;\n        const value = undef ? undefined : event.target.result.value;\n        resolve(value);\n      };\n      req.onerror = event => reject(event);\n    });\n  });\n}\n\n/**\n * Put asset object with a key\n * @param {string} key - key\n * @param {string} content - asset to store\n */\nfunction putAsset(key, content) {\n  return new Promise((resolve, reject) => {\n    return instance.assets.then(db => {\n      const obj = db.transaction(db.name, 'readwrite')\n        .objectStore(db.name);\n      const req = obj.put({key: key, value: content});\n      req.onerror = event => reject(event);\n      req.onsuccess = () => resolve();\n    });\n  });\n}\n\n\nexport default {\n  clear, clearAll, getAllItems, getItem, updateItem, deleteItem,\n  getView, appendView, updateView, deleteView,\n  getAllCollections, getCollection, addCollection, updateCollection,\n  importItem, newDatagrid, addDatagrid, add384Tiles, newNetwork,\n  getAsset, putAsset\n};\n","\n/** @module common/fetcher */\n\n\nconst baseURL = '../req/';\n\nfunction get(url, query={}) {\n  const isEmpty = Object.keys(query).length;\n  const q = isEmpty ? `?query=${JSON.stringify(query)}` : '';\n  return fetch(\n    `${baseURL}${url}${q}`,\n    {\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction json(response) {\n  return response.json();\n}\n\nfunction text(response) {\n  return response.text();\n}\n\nfunction blob(response) {\n  return response.blob();\n}\n\nfunction post(url, formdata) {\n  return fetch(\n    `${baseURL}${url}`,\n    {\n      method: 'POST',\n      body: formdata,\n      credentials: 'include'\n    }\n  ).then(res => {\n    if (res.status !== 200) {\n      return Promise.reject(new Error(res.statusText));\n    }\n    return Promise.resolve(res);\n  });\n}\n\nfunction error(err) {\n  console.error(err);\n  return null;\n}\n\nfunction serverStatus() {\n  const response = {};\n  return get('server')\n    .then(json)\n    .then(res => {\n      response.server = res;\n    })\n    .then(() => get('schema'))\n    .then(json)\n    .then(res => {\n      response.schema = res;\n    })\n    .then(() => response);\n}\n\n\nfunction batchRequest(reqs, interval) {\n  const ress = reqs.map((req, i) => {\n    return new Promise(resolve => {\n      setTimeout(() => resolve(req()), i * interval * 1000);\n    });\n  });\n  return Promise.all(ress);\n}\n\n\nfunction sequentialBatchRequest(reqs, interval) {\n  const ress = [];\n  const batch = reqs.reduce((a, b) => {\n    return a\n      .then(res => {\n        if (res) ress.push(res);\n        return new Promise(resolve => {\n          setTimeout(() => resolve(b()), interval * 1000);\n        });\n      });\n  }, Promise.resolve());\n  return batch.then(() => ress);\n}\n\n\n\nexport default {\n  get, json, text, blob, post, error, serverStatus, batchRequest\n};\n","\n/** @module common/mapper */\n\nimport _ from 'lodash';\n\n\n/**\n * Convert single field mapping to multi field mapping\n * @param {object} mapping - single field mapping\n * @return {object} multi field mapping\n */\nfunction singleToMulti(mapping) {\n  const newMapping = {};\n  Object.entries(mapping.mapping).forEach(m => {\n    newMapping[m[0]] = [m[1]];\n  });\n  return {\n    created: mapping.created,\n    fields: [mapping.field],\n    key: mapping.key,\n    mapping: newMapping\n  };\n}\n\n\n/**\n * Convert field mapping to table\n * @param {object} mapping - field mapping\n * @return {object} table object\n */\nfunction mappingToTable(mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  const keyField = {key: mp.key, format: 'text'};\n  const data = {\n    fields: [keyField].concat(mp.fields),\n    records: Object.entries(mp.mapping).map(entry => {\n      const rcd = {};\n      rcd[mp.key] = entry[0];\n      mp.fields.forEach((f, i) => {\n        rcd[f.key] = entry[1][i];\n      });\n      return rcd;\n    })\n  };\n  return data;\n}\n\n\n/**\n * Convert table to field mapping\n * @param {object} table - table\n * @param {object} key - key\n * @return {object} field mapping\n */\nfunction tableToMapping(table, key, ignore=['index']) {\n  const now = new Date();\n  const mapping = {\n    created: now.toString(),\n    fields: table.fields.filter(e => e.key !== key)\n      .filter(e => !ignore.includes(e.key)),\n    key: key,\n    mapping: {}\n  };\n  table.records.forEach(row => {\n    mapping.mapping[row[key]] = mapping.fields.map(e => row[e.key]);\n  });\n  return mapping;\n}\n\n\n/**\n * Convert csv text to field mapping\n * @param {string} csvString - csv data text\n * @return {object} field mapping\n */\nfunction csvToMapping(csvString) {\n  const lines = csvString.split(/\\n|\\r|\\r\\n/);\n  const header = lines.shift().split(',');\n  const key = header.shift();\n  const now = new Date();\n  const headerIdx = [];\n  const fields = [];\n  header.forEach((h, i) => {\n    if (h === '') return;\n    headerIdx.push(i);\n    fields.push({key: h, format: 'text'});\n  });\n  const mapping = {\n    created: now.toString(),\n    fields: fields,\n    key: key,\n    mapping: {}\n  };\n  lines.forEach(line => {\n    const values = line.split(',');\n    const k = values.shift();\n    mapping.mapping[k] = Array(headerIdx.length);\n    headerIdx.forEach(i => {\n      mapping.mapping[k][i] = values[i];\n    });\n  });\n  return mapping;\n}\n\n\n/**\n * Apply mapping to the data (in-place)\n * @param {object} data - datatable JSON\n * @param {object} mapping - mapping JSON\n * @return {undefined} undefined\n */\nfunction apply(data, mapping) {\n  const mp = mapping.hasOwnProperty('field') ? singleToMulti(mapping) : mapping;\n  data.records\n    .filter(rcd => mp.mapping.hasOwnProperty(rcd[mp.key]))\n    .forEach(rcd => {\n      mp.fields.forEach((fd, i) => {\n        rcd[fd.key] = mp.mapping[rcd[mp.key]][i];\n      });\n    });\n  data.fields =  _(data.fields)\n    .concat(mp.fields)\n    .uniqBy('key')\n    .value();\n}\n\nexport default {\n  singleToMulti, mappingToTable, tableToMapping, csvToMapping, apply\n};\n","\n/** @module common/collection */\n\nimport _ from 'lodash';\n\nimport {default as idb} from './idb.js';\nimport {default as fetcher} from './fetcher.js';\nimport {default as mapper} from './mapper.js';\n\n\nexport default class Collection {\n  /**\n   * Create Collection from a flashflood response datatable\n   * If data is not specified, put datatables later by this.append(data)\n   * @param {object} coll - Collection or response object\n   */\n  constructor(coll) {\n    // Settings\n    this.autoIndex = 'index';  // enumerate records\n\n    this.collectionID = coll.collectionID || null;\n    this.instance = coll.instance || null;\n    this.name = coll.name || null;\n    if (coll.records) {\n      this.contents = [coll];\n      this.fields = [];\n    } else {\n      this.contents = coll.contents;\n      this.fields = coll.fields || [];\n    }\n    this.contents.forEach(content => {\n      content.fields.forEach(e => this.addField(e));\n    });\n  }\n\n  /**\n   * Add fields\n   * @param {array} fs - list of fields\n   */\n  addField(field) {\n    if (this.fields.find(e => e.key === field.key)) return;\n    if (!field.hasOwnProperty('name')) field.name = field.key;\n    if (!field.hasOwnProperty('visible')) field.visible = true;\n    if (field.hasOwnProperty('d3_format')) field.format = 'd3_format';\n    if (!field.hasOwnProperty('format')) field.format = 'raw';\n    this.fields.push(field);\n  }\n\n  /**\n   * Update fields properties\n   * @param {array} fs - list of fields\n   */\n  updateFields(fs) {\n    this.fields = [];\n    fs.forEach(e => this.addField(e));\n  }\n\n  /**\n   * Join fields\n   * @param {object} mapping - column mapper object\n   */\n  joinFields(mapping) {\n    this.contents.forEach(c => {\n      mapper.apply(c, mapping);\n    });\n    if (mapping.hasOwnProperty('fields')) {\n      mapping.fields.forEach(e => this.addField(e));\n    } else {\n      this.addField(mapping.field);\n    }\n  }\n\n  /**\n   * Apply function to the original data records\n   * new fields should be manually added by Collection.addField\n   * @param {function} func - function to be applied\n   */\n  apply(func) {\n    this.contents.forEach(content => {\n      content.records.forEach(rcd => {\n        func(rcd);\n      });\n    });\n  }\n\n  /**\n   * Return all records of the collection\n   * @return {array} records\n   */\n  records() {\n    return _.flatten(this.contents.map(e => e.records));\n  }\n\n  fetch(command) {\n    const fs = this.contents\n      .filter(e => ['running', 'ready', 'interrupted', 'queued'].includes(e.status))\n      .map(content => {\n        const query = {id: content.workflowID, command: command};\n        return fetcher.get('progress', query)\n          .then(fetcher.json)\n          .then(data => {\n            return idb.updateCollection(this.instance, this.collectionID, coll => {\n              const i = coll.contents\n                .findIndex(e => e.workflowID === query.id);\n              if (data.status === 'failure') {  // No data found on server\n                coll.contents[i].status = 'failure';\n              } else {\n                coll.contents[i] = data;\n              }\n            });\n          });\n      });\n    return Promise.all(fs)\n      .then(() => idb.getCollection(this.instance, this.collectionID))\n      .then(coll => {\n        this.contents = coll.contents;\n      });\n  }\n\n  /**\n   * Retrieve workflows and store it into a local store.\n   * @return {Promise}\n   */\n  pull() {\n    return this.fetch('pull');\n  }\n\n  /**\n   * Retrieve workflows, abort all ongoing workflow task\n   * and store it into a local store.\n   * @return {Promise}\n   */\n  abort() {\n    return this.fetch('abort');\n  }\n\n  /**\n   * Return total number of records\n   * @return {float} total number of records\n   */\n  size() {\n    return _.sum(this.contents.map(e => e.records.length));\n  }\n\n  /**\n   * Return status\n   * @return {string} status\n   */\n  status() {\n    if (this.contents.some(e => e.status === 'interrupted')) return 'interrupted';\n    if (this.contents.some(e => e.status === 'running')) return 'running';\n    if (this.contents.some(e => e.status === 'queued')) return 'queued';\n    if (this.contents.some(e => e.status === 'ready')) return 'ready';\n    if (this.contents.some(e => e.status === 'aborted')) return 'aborted';\n    if (this.contents.some(e => e.status === 'failure')) return 'failure';\n    return 'done';\n  }\n\n  /**\n   * Return ongoing or not\n   * @return {bool} ongoing or not\n   */\n  ongoing() {\n    const s = ['ready', 'queued', 'running', 'interrupted'];\n    return s.includes(this.status());\n  }\n\n  /**\n   * Return percentage of workflow progress\n   * @return {float} progress in percent\n   */\n  progress() {\n    return _.min(this.contents.map(e => e.progress));\n  }\n\n  /**\n   * Return total execution time\n   * @return {float} total time\n   */\n  execTime() {\n    return _.sum(this.contents.map(e => e.execTime));\n  }\n\n  /**\n   * Export collection object as JSON\n   * @return {object} collection JSON\n   */\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/collection_v1.0.json\",\n      collectionID: this.collectionID,\n      name: this.name,\n      fields: this.fields,\n      contents: this.contents\n    };\n  }\n}\n","\n/** @module datagrid/component */\n\nimport d3 from 'd3';\n\n\nfunction headerCellRenderer(header) {\n  header.style('display', 'inline-block')\n    .style('width', d => `${d.width}%`)\n    .text(d => d.name);\n}\n\n\nfunction updateHeader(selection, state) {\n  const header = selection.select('.dg-header');\n  header.selectAll('.dg-hcell').remove();\n  header.selectAll('.dg-hcell').data(state.visibleFields)\n    .enter().append('div')\n      .classed('dg-hcell', true)\n      .call(state.headerCellRenderer);\n}\n\n\nfunction updateRows(selection, state) {\n  const rows = selection.select('.dg-body')\n    .selectAll('.dg-row')\n      .data(state.recordsToShow(), state.keyFunc);\n  rows.exit().remove();\n  rows.selectAll('.dg-cell').remove();\n  rows.enter()\n    .append('div')\n      .attr('class', 'dg-row')\n      .style('position', 'absolute')\n      .style('width', '100%')\n    .merge(rows)\n      .style('height', `${state.rowHeight}px`)\n      .each(function (d, i) {\n        const rowIndex = state.viewportTop + i;\n        const rowPos = rowIndex * state.rowHeight;\n        d3.select(this)\n          .style('transform', `translate(0px, ${rowPos}px)`)\n          .classed('odd', (rowIndex) % 2 === 0)\n          .call(state.rowFactory(), d);\n      });\n}\n\n\nfunction updateViewport(selection, state, scrollPos) {\n  selection.select('.dg-body').style('height', `${state.bodyHeight}px`);\n  state.setScrollPosition(scrollPos);\n  selection.call(updateRows, state, scrollPos);\n  selection.select('.dg-viewport').node().scrollTop = scrollPos * state.rowHeight;\n}\n\n\nfunction resize(selection, state) {\n  const viewport = selection.select('.dg-viewport');\n  const viewportTop = viewport.node().getBoundingClientRect().top;\n  state.resizeViewport(window.innerHeight - viewportTop - 5);\n  viewport.style('height', `${state.viewportHeight}px`);\n}\n\n\nfunction datagrid(selection, state) {\n  selection.append('div')\n      .classed('dg-header', true);\n  selection.append('div')\n      .classed('dg-viewport', true)\n      .style('overflow-y', 'auto')\n      .on('scroll', function () {\n        const pos = Math.floor(this.scrollTop / state.rowHeight);\n        if (pos !== state.previousViewportTop) {\n          state.setScrollPosition(pos);\n          selection.call(updateRows, state, pos);\n        }\n      })\n    .append('div')\n      .classed('dg-body', true)\n      .style('position', 'relative');\n  state.updateContentsNotifier = () => {\n    state.applyHeader();\n    selection.call(updateHeader, state);\n    selection.call(resize, state);\n    state.applyData();\n    selection.call(updateViewport, state, state.viewportTop);\n  };\n  state.updateFilterNotifier = value => {\n    state.setFilterText(value);\n    selection.call(updateViewport, state, 0);\n  };\n}\n\n\n\nexport default {\n  headerCellRenderer, updateHeader, updateRows, updateViewport,\n  resize, datagrid\n};\n","\n/** @module datagrid/rowFactory */\n\nimport {default as misc} from '../common/misc.js';\nimport {default as idb} from '../common/idb.js';\nimport {default as img} from '../common/image.js';\n\n\nfunction d3Format(selection, record, field) {\n  selection.text(misc.formatNum(record[field.key], field.d3_format));\n}\n\n\nfunction text(selection, record, field) {\n  selection.text(record[field.key]);\n}\n\n\nfunction date(selection, record, field) {\n  // TODO; formatter\n  selection.text(record[field.key]);\n}\n\n\nfunction html(selection, record, field) {\n  // TODO: Check vulnerabilities\n  selection.html(record[field.key]);\n}\n\n\nfunction compoundID(selection, record, field) {\n  selection.append('a')\n      .attr('href',`profile.html?compound=${record[field.key]}`)\n      .attr('target', '_blank')\n      .text(record[field.key]);\n}\n\n\nfunction image(selection, record, field) {\n  selection.append('img')\n      .attr('width', 180)\n      .attr('height', 180)\n      .attr('src', record[field.key]);\n}\n\n\nfunction checkbox(selection, record, field) {\n  selection.append('input')\n      .attr('type', 'checkbox')\n      .property('checked', record[field.key])\n      .property('disabled', field.disabled ? record[field.disabled] : false)\n      .on('click', function () {\n        record[field.key] = this.checked;\n      });\n}\n\n\nfunction textField(selection, record, field) {\n  selection.append('input')\n      .attr('type', 'text')\n      .style('width', '90%')\n      .property('value', record[field.key])\n      .on('change', function () {\n        record[field.key] = this.value;\n      });\n}\n\n\nfunction call(selection, value) {\n  selection.call(value);\n}\n\n\nfunction asyncImage(selection, record, field) {\n  const req = `${field.request}${record[field.key]}`;\n  idb.getAsset(req)\n    .then(res => {\n      if (res !== undefined) return res;\n      return fetch(req, { credentials: 'include' })\n        .then(res => res.blob())\n        .then(res => idb.putAsset(req, res).then(() => res));\n    })\n    .then(obj => {\n      selection.append('img')\n          .attr('width', 180)\n          .attr('height', 180)\n          .attr('src', URL.createObjectURL(obj));\n    });\n}\n\n\nfunction asyncHtml(selection, record, field) {\n  const req = `${field.request}${record[field.key]}`;\n  idb.getAsset(req)\n    .then(res => {\n      if (res !== undefined) return res;\n      return fetch(req, { credentials: 'include' })\n        .then(res => res.text())\n        .then(res => idb.putAsset(req, res).then(() => res));\n    })\n    .then(txt => {\n      selection.html(txt);\n    });\n}\n\n\nconst cellFunc = {\n  numeric: text,\n  text: text,\n  date: date,\n  raw: text,\n  d3_format: d3Format,\n  compound_id: compoundID,\n  assay_id: text,\n  list: text,\n  plot: img.plotCell,\n  image: image,\n  checkbox: checkbox,\n  text_field: textField,\n  control: call,\n  svg: html,\n  html: html,\n  async_image: asyncImage,\n  async_html: asyncHtml\n};\n\n\nfunction rowCell(selection) {\n  selection.classed('dg-cell', true)\n    .classed('align-middle', true)\n    .classed('text-truncate', true)\n    .style('display', 'inline-block');\n}\n\n\nfunction rowFactory(fields) {\n  return (selection, record) => {\n    fields.forEach(field => {\n      const cell = selection.append('div')\n          .call(rowCell)\n          .style('width', `${field.width}%`);\n      if (!record.hasOwnProperty(field.key)) return;\n      cell.call(cellFunc[field.format], record, field);\n    });\n  };\n}\n\n\nexport default {\n  d3Format, text, html, compoundID, image, checkbox, textField, call,\n  asyncImage, asyncHtml,\n  rowCell, rowFactory\n};\n","\n/** @module common/image */\n\nimport vega from 'vega';\n\n\nfunction plotCell(selection, record, field) {\n  new vega.View(vega.parse(record[field.key]))\n    .initialize(selection.node())\n    .run();\n}\n\n\nfunction plotThumbnail(vegaSpec) {\n  const view = new vega.View(vega.parse(vegaSpec));\n  return view.toImageURL('png');  // Promise\n}\n\n\nfunction binaryToDataURI(binary) {\n  return new Promise(resolve => {\n    const reader = new FileReader();\n    reader.onload = event => {\n      resolve(event.target.result);\n    };\n    reader.readAsDataURL(binary);\n  });\n}\n\n\nexport default {\n  plotCell, plotThumbnail, binaryToDataURI\n};\n","\n/** @module component/badge */\n\nimport d3 from 'd3';\n\nconst assetBaseURL = '../assets/';\nconst iconBaseURL = '../assets/icon/';\n\n\nfunction badge(selection) {\n  selection.classed('badge', true);\n  selection.append('img')\n      .classed('icon', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('text', true);\n}\n\n\nfunction updateBadge(selection, text, type, icon) {\n  selection.classed(`badge-${type}`, true);\n  selection.select('.icon')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null);\n  selection.select('.text')\n      .text(text);\n}\n\n\nfunction notify(selection) {\n  selection\n    .style('opacity', 0)\n    .style('display', 'inline')\n    .transition()\n      .duration(500)\n      .ease(d3.easeLinear)\n      .style(\"opacity\", 1.0)\n    .transition()\n      .delay(3000)\n      .duration(1000)\n      .ease(d3.easeLinear)\n      .style(\"opacity\", 0)\n      .on('end', function () {\n        selection.style('display', 'none');\n      });\n}\n\n\nfunction loadingCircle(selection) {\n  selection\n      .style('display', 'none')\n    .append('img')\n      .attr('src', `${assetBaseURL}loading1.gif`)\n      .style('width', '2rem')\n      .style('height', '2rem');\n}\n\n\nfunction alert(selection) {\n  selection.classed('alert', true)\n      .classed('px-1', true)\n      .classed('py-0', true);\n  selection.append('img')\n      .classed('icon', true)\n      .style('width', '1.25rem')\n      .style('height', '1.25rem');\n  selection.append('span')\n      .classed('text', true)\n      .style('font-size', '75%');\n}\n\n\nfunction updateAlert(selection, text, type, icon) {\n  selection.classed(`alert-${type}`, true);\n  selection.select('.icon')\n      .attr('src', icon ? `${iconBaseURL}${icon}.svg` : null);\n  selection.select('.text')\n      .text(text);\n}\n\n\nfunction invalidFeedback(selection) {\n  selection.classed('invalid-feedback', true)\n      .style('display', 'none');\n  selection.append('img')\n      .classed('icon', true)\n      .attr('src', `${iconBaseURL}caution-salmon.svg`)\n      .style('width', '1rem')\n      .style('height', '1rem');\n  selection.append('span')\n      .classed('invalid-msg', true);\n}\n\nfunction updateInvalidMessage(selection, msg) {\n  selection.select('.invalid-msg')\n      .text(msg);\n}\n\n\nexport default {\n  badge, updateBadge, notify, loadingCircle,\n  alert, updateAlert, invalidFeedback, updateInvalidMessage\n};\n","\n/** @module component/formBox */\n\nimport d3 from 'd3';\n\nimport {default as badge} from './badge.js';\n\n\nfunction updateFormValue(selection, value) {\n  selection.select('.form-control').property('value', value);\n  selection.call(setValidity, true);  // Clear validity state\n}\n\n\nfunction formValue(selection) {\n  return selection.select('.form-control').property('value');\n}\n\n\nfunction formValid(selection) {\n  return selection.select('.form-control').node().checkValidity();\n}\n\n\nfunction setValidity(selection, valid) {\n  selection.select('.invalid-feedback')\n      .style('display', valid ? 'none': 'inherit');\n  selection.select('.form-control')\n      .style('background-color', valid ? null : '#ffcccc');\n}\n\n\nfunction textBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .on('input', function () {\n        const valid = formValid(selection);\n        selection.call(setValidity, valid);\n      });\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\n\nfunction readonlyBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control-plaintext', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'text')\n      .attr('readonly', 'readonly');\n}\n\nfunction updateReadonlyValue(selection, value) {\n  selection.select('.form-control-plaintext').property('value', value);\n}\n\nfunction readonlyValue(selection) {\n  return selection.select('.form-control-plaintext').property('value');\n}\n\n\nfunction textareaBox(selection, label, rows, placeholder) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  const formLabel = selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  formLabel.append('div')\n      .call(badge.invalidFeedback);\n  selection.append('textarea')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('rows', rows)\n      .attr('placeholder', placeholder)\n      .on('input', function () {\n        const valid = textareaValid(selection);\n        selection.call(setValidity, valid);\n      });\n}\n\nfunction textareaBoxLines(selection) {\n  const value = selection.select('textarea').property('value');\n  if (value) return value.split('\\n')\n    .map(e => e.replace(/^\\s+|\\s+$/g, ''))  // strip spaces\n    .filter(e => e.length > 0);\n  return [];\n}\n\nfunction textareaValid(selection) {\n  return /\\s*?\\w\\s*?/.test(formValue(selection));\n}\n\n\nfunction checkBox(selection, label) {\n  const box = selection\n      .classed('form-group', true)\n      .classed('form-row', true)\n      .classed('form-check', true)\n    .append('label')\n      .classed('form-check-label', true)\n      .classed('col-form-label-sm', true);\n  box.append('input')\n      .classed('form-check-input', true)\n      .attr('type', 'checkbox');\n  box.append('span')\n      .text(label);\n}\n\nfunction updateCheckBox(selection, checked) {\n  selection.select('input').property('checked', checked);\n}\n\nfunction checkBoxValue(selection) {\n  return selection.select('input').property('checked');\n}\n\n\nfunction numberBox(selection, label) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('col-8', true)\n      .attr('type', 'number')\n      .on('input', function () {\n        const valid = formValid(selection);\n        selection.call(setValidity, valid);\n      });\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\nfunction updateNumberRange(selection, min, max, step) {\n  selection.select('.form-control')\n      .attr('min', min)\n      .attr('max', max)\n      .attr('step', step)\n      .dispatch('input', {bubbles: true});\n}\n\n\n/**\n * Render color scale box components\n * @param {d3.selection} selection - selection of box container (div element)\n */\nfunction colorBox(selection, label) {\n  selection\n      .classed('form-row', true)\n      .classed('align-items-center', true)\n      .on('change', () => {\n        // avoid update by mousemove on the colorpicker\n        d3.event.stopPropagation();\n      });\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n      .text(label);\n  selection.append('div')\n      .classed('form-group', true)\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .classed('mb-1', true)\n    .append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .attr('type', 'color');\n}\n\n\nfunction fileInputBox(selection, label, accept) {\n  selection\n      .classed('form-group', true)\n      .classed('form-row', true);\n  selection.append('label')\n      .classed('col-form-label', true)\n      .classed('col-form-label-sm', true)\n      .classed('col-4', true)\n      .text(label);\n  selection.append('input')\n      .classed('form-control', true)\n      .classed('form-control-sm', true)\n      .classed('form-control-file', true)\n      .classed('col-8', true)\n      .attr('type', 'file')\n      .attr('accept', accept)\n      .on('change', function () {\n        const valid = fileInputValid(selection);\n        selection.call(setValidity, valid);\n      });\n  selection.append('div')\n      .classed('col-4', true);\n  selection.append('div')\n      .call(badge.invalidFeedback)\n      .classed('col-8', true);\n}\n\nfunction clearFileInput(selection) {\n  // TODO: FileList object (input.files) may be a readonly property\n  const label = selection.select('label').text();\n  const accept = selection.select('input').attr('accept');\n  selection.selectAll('*').remove();\n  selection.call(fileInputBox, label, accept);\n}\n\nfunction fileInputValue(selection) {\n  return selection.select('input').property('files')[0];\n}\n\nfunction fileInputValid(selection) {\n  // TODO: attribute 'require' does not work with input type=file\n  return selection.select('input').property('files').length > 0;\n}\n\n\nexport default {\n  updateFormValue, formValue, formValid, setValidity,\n  textBox, readonlyBox, updateReadonlyValue, readonlyValue,\n  textareaBox, textareaBoxLines, textareaValid,\n  numberBox, updateNumberRange,\n  checkBox, updateCheckBox, checkBoxValue,\n  colorBox,\n  fileInputBox, clearFileInput, fileInputValue, fileInputValid\n};\n","\n/** @module datagrid */\n\nimport {default as legacy} from './common/legacySchema.js';\n\nimport DatagridState from './datagrid/state.js';\nimport {default as component} from './datagrid/component.js';\nimport {default as rowFilter} from './datagrid/rowFilter.js';\nimport {default as sort} from './datagrid/sort.js';\n\n\nexport default {\n  DatagridState, component, rowFilter, sort, legacy\n};\n","\n/** @module datagrid/state */\n\nimport _ from 'lodash';\n\nimport Collection from '../common/collection.js';\nimport {default as idb} from '../common/idb.js';\nimport {default as misc} from '../common/misc.js';\n\nimport {default as component} from './component.js';\nimport {default as factory} from './rowFactory.js';\n\n\nexport default class DatagridState {\n  constructor(view, coll) {\n    this.instance = view.instance || null;\n    this.viewID = view.viewID || null;\n    this.name = view.name || null;\n    this.sortOrder = view.sortOrder || [];\n    this.filterText = view.filterText || null;\n    this.rows = new Collection(coll);\n\n    this.visibleFields = null;\n    this.sortedRecords = null;\n    this.filteredRecords = null;\n\n    // TODO: auto adjust\n    this.defaultColumnHeight = {\n      numeric: 40,\n      text: 40,\n      html: 40,\n      none: 200\n    };\n    this.scrollBarSpace = 20;\n    this.keyFunc = d => d.index;\n\n    // Size\n    this.rowHeight = null;\n    this.bodyHeight = null;\n\n    // Viewport\n    this.viewportHeight = null;\n    this.numViewportRows = null;\n    this.viewportTop = 0;\n    this.previousViewportTop = null;\n    this.viewportBottom = null;\n\n    this.fixedViewportHeight = null;\n\n    // Event notifier\n    this.updateContentsNotifier = null;\n    this.updateFilterNotifier = null;\n\n    this.headerCellRenderer = component.headerCellRenderer;\n    this.rowFactory = () => factory.rowFactory(this.visibleFields);\n  }\n\n  /**\n   * Set viewport height and number of rows to show\n   * @param {int} height - viewport height\n   */\n  setViewportSize(height) {\n    this.viewportHeight = this.fixedViewportHeight || height;\n  }\n\n  /**\n   * Set range of the row indices to show\n   * @param {int} position - Index of the top row to show\n   */\n  setScrollPosition(position) {\n    this.previousViewportTop = this.viewportTop;\n    this.viewportTop = position;\n    this.viewportBottom = Math.min(\n      this.viewportTop + this.numViewportRows, this.filteredRecords.length);\n  }\n\n  setNumViewportRows() {\n    this.numViewportRows = Math.ceil(this.viewportHeight / this.rowHeight) + 1;\n  }\n\n  resizeViewport(height) {\n    this.setViewportSize(height);\n    this.setNumViewportRows();\n  }\n\n  /**\n   * Apply header data\n   */\n  applyHeader() {\n    this.visibleFields = this.rows.fields.filter(e => e.visible);\n    const widthfSum = this.visibleFields.reduce((a, c) => a + (c.widthf || 1), 0);\n    this.visibleFields = this.visibleFields.map(e => {\n      const field = {\n        width: (e.widthf || 1) / widthfSum * 100,\n        height: e.height || this.defaultColumnHeight[misc.sortType(e.format)]\n      };\n      return Object.assign(field, e);\n    });\n    this.rowHeight = this.visibleFields\n      .reduce((a, b) => a.height > b.height ? a : b, 0).height;\n  }\n\n  /**\n   * Apply row data\n   * 1. applyHeader: define fields and set rowHeight\n   * 2. resize: measure actual window size and calc viewportHeight\n   * 3. applyData: calc number of rows from rowHeight and viewportHeight\n   * 4. setScrollPosition: calc row index range\n   * 5. recordsToShow: slice rows to show\n   */\n  applyData() {\n    this.setNumViewportRows();\n    this.applyOrder();\n  }\n\n  applyOrder(key, order) {\n    if (key) {\n      this.sortedRecords = _.orderBy(this.rows.records().slice(), [key], [order]);\n    } else {\n      const keys = this.sortOrder.map(e => e.key);\n      const orders = this.sortOrder.map(e => e.order);\n      if (keys) {\n        this.sortedRecords = _.orderBy(this.rows.records().slice(), keys, orders);\n      }\n    }\n    this.applyFilter();\n  }\n\n  applyFilter() {\n    if (this.filterText === null) {\n      this.filteredRecords = this.sortedRecords.slice();\n    } else {\n      const fields = this.visibleFields\n        .filter(e => misc.sortType(e.format) !== 'none')\n        .map(e => e.key);\n      this.filteredRecords = this.sortedRecords.filter(row => {\n        return fields.some(f => misc.partialMatch(this.filterText, row[f]));\n      });\n    }\n    this.bodyHeight = this.filteredRecords.length * this.rowHeight;\n  }\n\n  setSortOrder(key, order) {\n    const ki  = this.sortOrder.findIndex(e => e.key);\n    const obj = {key: key, order: order};\n    if (ki !== -1) this.sortOrder.splice(ki, 1);\n    this.sortOrder.splice(0, 0, obj);\n    this.applyOrder(key, order);\n  }\n\n  setFilterText(text) {\n    this.filterText = text;\n    this.applyFilter();\n  }\n\n  updateFields(fs) {\n    this.rows.updateFields(fs);\n  }\n\n  joinFields(mapping) {\n    this.rows.joinFields(mapping);\n    this.applyData();\n  }\n\n  recordsToShow() {\n    return this.filteredRecords.slice(this.viewportTop, this.viewportBottom);\n  }\n\n  save() {\n    return idb.updateItem(this.instance, item => {\n      const ci = item.dataset\n        .findIndex(e => e.collectionID === this.rows.collectionID);\n      item.dataset[ci] = this.rows.export();\n      const vi = item.views.findIndex(e => e.viewID === this.viewID);\n      item.views[vi] = this.export();\n    });\n  }\n\n  export() {\n    return {\n      $schema: \"https://mojaie.github.io/kiwiii/specs/datagrid_v1.0.json\",\n      viewID: this.viewID,\n      name: this.name,\n      viewType: \"datagrid\",\n      rows: this.rows.collectionID,\n      sortOrder: this.sortOrder,\n      filterText: this.filterText\n    };\n  }\n}\n","\n/** @module datagrid/rowFilter */\n\nimport {default as box} from '../component/formBox.js';\n\n\nfunction setFilter(selection, state) {\n  const searchBox = selection\n      .classed('row', true)\n      .classed('justify-content-end', true)\n    .append('div')\n      .classed('col-5', true)\n      .call(box.textBox, 'Search');\n  searchBox.select('label').classed('text-right', true);\n  searchBox.select('input')\n    .on('keyup', function () {\n      state.updateFilterNotifier(box.formValue(searchBox));\n    });\n}\n\n\nexport default {\n  setFilter\n};\n","\n/** @module datagrid/sort */\n\nimport d3 from 'd3';\n\nimport {default as misc} from '../common/misc.js';\nimport {default as component} from './component.js';\n\n\nfunction setSort(selection, state) {\n  state.headerCellRenderer = header => {\n    header.style('display', 'inline-block')\n      .style('width', d => `${d.width}%`)\n      .text(d => d.name)\n      .filter(d => misc.sortType(d.format) !== 'none')\n      .append('span').append('a')\n        .attr('id', d => `sort-${d.key}`)\n        .text('^v')\n        .style('display', 'inline-block')\n        .style('width', '30px')\n        .style('text-align', 'center')\n      .on('click', d => {\n        const isAsc = d3.select(`#sort-${d.key}`).text() === 'v';\n        d3.select(`#sort-${d.key}`).text(isAsc ? '^' : 'v');\n        state.setSortOrder(d.key, isAsc ? 'desc' : 'asc');\n        selection.call(component.updateRows, state);\n      });\n  };\n}\n\n\nexport default {\n  setSort\n};\n"],"names":["statusConv","Queued","In progress","Aborting","Aborted","Completed","Failure","dataTypeConv","datatable","connection","v07_to_v08_nodes","json","fields","columns","map","e","sort","format","id","name","dataType","schemaVersion","revision","status","records","query","taskCount","searchCount","doneCount","searchDoneCount","resultCount","recordCount","progress","execTime","created","startDate","responseDate","v10_nodes","reference","convertNetwork","data","edges","hasOwnProperty","nodes","nodeFields","snp","fieldTransform","snapshot","nodePositions","nodeColor","nodeSize","nodeLabel","edge","scale","field","find","key","column","domain","range","unknown","size","text","visible","nodeContent","structure","label","nodeTableId","networkThreshold","v07_to_v08_edges","nodesID","idx_converter","forEach","i","index","_structure","_index","source","target","v08_graph","nodeContentVisible","d3","schemeCategory20","nodeLabelColor","edgeVisible","edgeWidth","edgeLabel","threshold","coords","params","v10_edges","$schema","convertPackage","specs","now","Date","isNW","v08_nodes","width","height","convertTable","views","dataset","push","collectionID","contents","workflowID","workflow","viewID","viewType","rows","sortOrder","filterText","checkpoints","type","date","toString","description","networkThresholdCutoff","filter","view","minConnThld","currentConnThld","edgeColor","color","edgeLabelColor","sortType","fmt","includes","formatNum","value","d3format","undefined","Number","isNaN","parseFloat","partialMatch","toUpperCase","indexOf","uuidv4","replace","c","r","Math","random","connect","version","createObj","Promise","resolve","reject","request","window","indexedDB","open","onsuccess","this","result","onerror","event","onupgradeneeded","currentTarget","instance","pkgs","db","createObjectStore","keyPath","assets","clear","dbid","then","req","transaction","objectStore","getAllItems","res","openCursor","cursor","continue","getItem","get","putItem","put","updateItem","updater","obj","upd","clearAll","all","deleteItem","delete","getView","pkg","appendView","viewObj","item","pos","findIndex","splice","updateView","_","isFunction","deleteView","bin","Object","entries","entry","getAllCollections","items","flatten","coll","getCollection","collID","addCollection","collObj","updateCollection","importItem","legacy","misc","slice","sessionStarted","newDatagrid","response","toLocaleString","timeZone","addDatagrid","add384Tiles","rowCount","columnCount","chunksPerRow","newNetwork","nodesName","edgesID","getAsset","putAsset","content","baseURL","url","q","keys","length","JSON","stringify","fetch","credentials","Error","statusText","blob","post","formdata","method","body","error","err","console","serverStatus","server","schema","batchRequest","reqs","interval","ress","setTimeout","singleToMulti","mapping","newMapping","m","mappingToTable","mp","concat","rcd","f","tableToMapping","table","ignore","row","csvToMapping","csvString","lines","split","header","shift","headerIdx","h","line","values","k","Array","apply","fd","uniqBy","Collection","[object Object]","autoIndex","addField","fs","mapper","func","command","fetcher","idb","sum","some","min","updateHeader","selection","state","select","selectAll","remove","visibleFields","enter","append","classed","call","headerCellRenderer","updateRows","recordsToShow","keyFunc","exit","attr","style","merge","rowHeight","each","d","rowIndex","viewportTop","rowPos","rowFactory","updateViewport","scrollPos","bodyHeight","setScrollPosition","node","scrollTop","resize","viewport","getBoundingClientRect","top","resizeViewport","innerHeight","viewportHeight","datagrid","on","floor","previousViewportTop","updateContentsNotifier","applyHeader","applyData","updateFilterNotifier","setFilterText","d3Format","record","d3_format","html","compoundID","image","checkbox","property","disabled","checked","textField","asyncImage","URL","createObjectURL","asyncHtml","txt","cellFunc","numeric","raw","compound_id","assay_id","list","plot","plotCell","vega","View","parse","initialize","run","plotThumbnail","vegaSpec","toImageURL","binaryToDataURI","binary","reader","FileReader","onload","readAsDataURL","text_field","control","svg","async_image","async_html","rowCell","cell","assetBaseURL","iconBaseURL","badge","updateBadge","icon","notify","transition","duration","ease","easeLinear","delay","loadingCircle","alert","updateAlert","invalidFeedback","updateInvalidMessage","msg","formValue","formValid","checkValidity","setValidity","valid","textareaValid","test","fileInputBox","accept","fileInputValid","updateFormValue","textBox","readonlyBox","updateReadonlyValue","readonlyValue","textareaBox","placeholder","textareaBoxLines","numberBox","updateNumberRange","max","step","dispatch","bubbles","checkBox","box","updateCheckBox","checkBoxValue","colorBox","stopPropagation","clearFileInput","fileInputValue","DatagridState","sortedRecords","filteredRecords","defaultColumnHeight","none","scrollBarSpace","numViewportRows","viewportBottom","fixedViewportHeight","component","factory","position","ceil","setViewportSize","setNumViewportRows","widthfSum","reduce","a","widthf","assign","b","applyOrder","order","orderBy","orders","applyFilter","ki","updateFields","joinFields","ci","export","vi","rowFilter","setFilter","searchBox","setSort","isAsc","setSortOrder"],"mappings":"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"}